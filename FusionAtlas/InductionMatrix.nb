(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67051,       1752]
NotebookOptionsPosition[     64045,       1650]
NotebookOutlinePosition[     64460,       1668]
CellTagsIndexPosition[     64417,       1665]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["InductionMatrix package", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.420291647194886*^9, 3.420291647915923*^9}, {
  3.422317712155013*^9, 3.4223177168517666`*^9}, {3.4327775537006736`*^9, 
  3.4327775569353247`*^9}, {3.447362169800737*^9, 3.4473621701584797`*^9}, {
  3.62914181790036*^9, 3.629141821234551*^9}, {3.629142101447197*^9, 
  3.629142106581141*^9}, {3.6350177448740664`*^9, 3.63501774672686*^9}}],

Cell["\<\
A subpackage for FusionAtlas v0.
March 11 2015, Scott Morrison and Kevin Walker, packaged with David Penneys\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291651250718*^9, 3.4202916677744784`*^9}, {
  3.432777559849515*^9, 3.432777570454765*^9}, {3.447362173061289*^9, 
  3.44736217826915*^9}, {3.62914182309914*^9, 3.6291418341933613`*^9}, {
  3.635017753846423*^9, 3.635017767128454*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 InitializationCell->True],

Cell["---text goes here---", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291674724472*^9, 3.420291680042118*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.629142254973199*^9, 3.629142254974373*^9}}],

Cell[CellGroupData[{

Cell["Start of package", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.420295317242155*^9, 3.4202953180032496`*^9}}],

Cell["Specify package dependencies:", "Text",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`InductionMatrix`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`TensorSolver`\>\"", ",", 
      "\"\<FusionAtlas`FormalCodegrees`\>\""}], "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4202916841079645`*^9, 3.420291695754712*^9}, {
  3.420293246855085*^9, 3.420293279181568*^9}, {3.4223177805233216`*^9, 
  3.422317795274533*^9}, {3.422318235116995*^9, 3.4223182432486877`*^9}, {
  3.432777576673707*^9, 3.4327775869484816`*^9}, {3.4327796677505283`*^9, 
  3.432779670003768*^9}, {3.434561456512453*^9, 3.434561465345154*^9}, {
  3.441994559392016*^9, 3.441994566564913*^9}, {3.6291406512241707`*^9, 
  3.629140653980494*^9}, {3.629140727883437*^9, 3.629140728811976*^9}, {
  3.6291420738596573`*^9, 3.629142076889803*^9}, {3.635017772363525*^9, 
  3.635017782991023*^9}, {3.635018204317058*^9, 3.635018207740631*^9}, {
  3.635019535056429*^9, 3.635019543560801*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage messages", "Subsection",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InductionMatrices", "::", "usage"}], "=", 
   "\"\<InductionMatrices[fr_FusionRules] computes the possible induction \
matrices to the centre for a fusion ring.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllDecompositions", "::", "usage"}], "=", 
   "\"\<AllDecompositions[m] for m a symmetric non-negative integer matrix, \
gives all matrices a so a.Transpose[a] == m\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635017899819322*^9, 3.635017925420052*^9}, {
  3.67549492437112*^9, 3.67549495301793*^9}, {3.675495043609414*^9, 
  3.675495046058992*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internals", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"Clear", "[", "InductionMatrices", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InductionMatrices", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{
   RowBox[{"InductionMatrices", "[", "fr", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "dimensionData"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dimensionData", "=", 
       RowBox[{"DimensionData", "[", "fr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IntegerQ", "[", 
          RowBox[{
          "dimensionData", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "1", ",", 
         RowBox[{"identify\[Zeta]", "[", 
          RowBox[{"dimensionData", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"AlgebraicDecompositions", "[", 
           RowBox[{
            RowBox[{"AnnularHoms", "[", "fr", "]"}], ",", "dimensionData"}], 
           "]"}], ",", 
          RowBox[{"m_", "/;", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "m", "]"}], ",", 
              RowBox[{"UnitVector", "[", 
               RowBox[{
                RowBox[{"Length", "[", "m", "]"}], ",", "1"}], "]"}]}], "]"}],
             "\[GreaterEqual]", "1"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"CheckGaloisAction", "[", 
         RowBox[{"n", ",", "dimensionData"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635017860042878*^9, 3.635017887646093*^9}, {
  3.635019858543016*^9, 3.635019863800818*^9}, {3.65655115057771*^9, 
  3.65655119340775*^9}, {3.673242105284544*^9, 3.673242130717972*^9}, {
  3.6732421986305656`*^9, 3.6732422086838503`*^9}, {3.673695470991569*^9, 
  3.673695533014018*^9}, {3.67830234055389*^9, 3.678302352694222*^9}, {
  3.6797150537906113`*^9, 3.67971507147259*^9}, {3.679715109028116*^9, 
  3.6797151102187433`*^9}, {3.6797162988784122`*^9, 3.679716302087953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckGaloisAction", "[", 
    RowBox[{"n_", ",", "dimensionData_"}], "]"}], "[", "inductionMatrix_", 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[ScriptCapitalD]", ",", "dimensions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[ScriptCapitalD]", "=", 
      RowBox[{
      "dimensionData", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dimensions", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"dimensionData", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ")"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"abs", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
               RowBox[{"#", "/", "\[ScriptCapitalD]"}], "]"}], 
              "\[ScriptCapitalD]"}], "]"}], "&"}], "/@", "dimensions"}], 
          "]"}], "\[Equal]", "dimensions"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736953240427933`*^9, 3.673695468741119*^9}, 
   3.673695604904006*^9, {3.673696166666641*^9, 3.6736961667409286`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Zeta]", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Zeta]", "[", "n", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Cyclotomic", "[", 
          RowBox[{"n", ",", "#"}], "]"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"p", "[", "m", "]"}], ",", "m"}], "]"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AlgebraicNumber", "[", 
        RowBox[{
         RowBox[{"Root", "[", 
          RowBox[{"p", ",", "d"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "~", "Join", "~", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"d", "-", "2"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559513223258071*^9, 3.5595132326436863`*^9}, {
  3.559515807400446*^9, 3.559515812406694*^9}, {3.559516359567793*^9, 
  3.559516375742578*^9}, {3.559516452342175*^9, 3.559516572539567*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "identify\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"identify\[Zeta]", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"identify\[Zeta]", "[", "z", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"z", "=!=", 
          RowBox[{"\[Zeta]", "[", "n", "]"}]}], "\[And]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", "\[LessEqual]", "2"}], "\[Or]", 
           RowBox[{"z", "=!=", 
            RowBox[{
             RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ")"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "n"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673273387342866*^9, 3.673273457125387*^9}, {
  3.6732739292935753`*^9, 3.673273938008869*^9}, {3.673273976255681*^9, 
  3.673273990424286*^9}, {3.673274020853307*^9, 3.673274042181876*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", "X_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"ToCyclotomicField", "[", 
    RowBox[{"X", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{"X_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"ToCyclotomicField", "[", 
     RowBox[{"Flatten", "[", "X", "]"}], "]"}], ",", 
    RowBox[{"Length", "[", 
     RowBox[{"X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "n_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "n"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "z___"}], "}"}], ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tnf", ",", 
      RowBox[{"k", "=", "1"}], ",", "zt", ",", "p"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tnf", "=", 
         RowBox[{"cachedToNumberField", "[", 
          RowBox[{"x", ",", 
           RowBox[{"\[Zeta]", "[", "n", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"tnf", ",", "_ToNumberField"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"n0", "=", 
            RowBox[{"k", " ", "n"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tnf", "=", 
            RowBox[{"cachedToNumberField", "[", 
             RowBox[{"x", ",", 
              RowBox[{"\[Zeta]", "[", 
               RowBox[{"k", " ", "n"}], "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToNumberField", "::", "nnfel"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zt", ",", "p"}], "}"}], "=", 
      RowBox[{"ToCyclotomicField", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"k", " ", "n"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"AlgebraicNumberPolynomial", "[", 
          RowBox[{"tnf", ",", 
           SuperscriptBox[
            RowBox[{"\[Zeta]", "[", "p", "]"}], 
            RowBox[{"p", "/", 
             RowBox[{"(", 
              RowBox[{"k", " ", "n"}], ")"}]}]]}], "]"}], "}"}], "~", "Join", 
        "~", "zt"}], ",", "p"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656310652850071*^9, 3.656310943220831*^9}, {
  3.656311004720512*^9, 3.6563110260225267`*^9}, {3.656311131968268*^9, 
  3.656311145284636*^9}, {3.656311176849099*^9, 3.656311197455339*^9}, {
  3.656311237033141*^9, 3.656311237381052*^9}, {3.6565307557902393`*^9, 
  3.6565307601829433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AnnularHoms", "[", "f_FusionRules", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "d", ",", "n", ",", "objects"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], "/.", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
      RowBox[{"Length", "[", 
       RowBox[{"m", "[", 
        RowBox[{"i", ",", "j", ",", "j"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"i_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"Ordering", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"i", ",", "i", ",", "i"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
      RowBox[{"Range", "[", 
       RowBox[{"n", "[", 
        RowBox[{"0", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"objects", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "k"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"f", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "All", ",", "1"}], 
               "\[RightDoubleBracket]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"n", "[", 
             RowBox[{"i", ",", "i"}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"s", ",", 
            RowBox[{
            "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "t"}], "\[RightDoubleBracket]"}], 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{
             RowBox[{
             "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{
               RowBox[{
               "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[LeftDoubleBracket]", "t", "\[RightDoubleBracket]"}]}],
            "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"n", "[", 
            RowBox[{
             RowBox[{
             "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", 
           RowBox[{"n", "[", 
            RowBox[{
             RowBox[{
             "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "objects"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "objects"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.583164611159027*^9, 3.583164752340878*^9}, {
   3.583164811288595*^9, 3.583164820325527*^9}, {3.583207954508881*^9, 
   3.583207982215139*^9}, {3.5832080198512487`*^9, 3.583208104684793*^9}, {
   3.58320814245363*^9, 3.583208473624316*^9}, {3.583208540061185*^9, 
   3.58320857054126*^9}, 3.585639427959614*^9, {3.585640002144498*^9, 
   3.585640005348798*^9}, {3.624472800589087*^9, 3.6244728151997137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AnnularHoms", "[", 
   RowBox[{"{", 
    RowBox[{"G1_BigraphWithDuals", ",", "G2_BigraphWithDuals"}], "}"}], "]"}],
   ":=", 
  RowBox[{"AnnularHoms", "/@", 
   RowBox[{"FindFusionRules", "[", 
    RowBox[{"G1", ",", "G2"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5854442151133842`*^9, 3.585444239077674*^9}, {
  3.585444365483189*^9, 3.5854443679694033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionData", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"\[Lambda]0_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "\[ScriptCapitalD]", ",", "dims", ",", 
      "dimsForFormalCodegrees"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"ToCyclotomicField", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Lambda]0", "\[Equal]", "0"}], ",", 
         RowBox[{"RootReduce", "[", 
          RowBox[{"GlobalEvenDimension", "[", 
           RowBox[{"G", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
         ",", "\[Lambda]0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalD]", "=", 
      RowBox[{"ToNumberField", "[", 
       RowBox[{
        RowBox[{"GlobalEvenDimension", "[", 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
        "\[Lambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ToNumberField", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"DimensionsByDepth", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", ";;", "2"}], "\[RightDoubleBracket]"}], "]"}],
            ",", "\[Lambda]"}], "]"}], "~", "Join", "~", 
         RowBox[{"ZeroVector", "[", 
          RowBox[{"GraphEvenRank", "[", 
           RowBox[{
           "G", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ZeroVector", "[", 
          RowBox[{"GraphEvenRank", "[", 
           RowBox[{
           "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
           "]"}], "~", "Join", "~", 
         RowBox[{"ToNumberField", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"DimensionsByDepth", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", ";;", "2"}], "\[RightDoubleBracket]"}], "]"}],
            ",", "\[Lambda]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.585444437848752*^9, 3.585444713987541*^9}, {
  3.5854454106943197`*^9, 3.58544541172124*^9}, {3.58544567213783*^9, 
  3.585445672459074*^9}, {3.6732401984803467`*^9, 3.673240250087389*^9}, {
  3.673694993214608*^9, 3.673694997520184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionData", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "dims", ",", "codegrees", ",", "\[ScriptCapitalD]"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dims", "=", 
      RowBox[{"ToCyclotomicField", "[", 
       RowBox[{"ToNumberField", "[", 
        RowBox[{"FPDimensions", "[", "fr", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"dims", ",", "_AlgebraicNumber"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Lambda]", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"dims", ",", "_AlgebraicNumber"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"codegrees", "=", 
         RowBox[{"ToNumberField", "[", 
          RowBox[{
           RowBox[{"FormalCodegrees", "[", "fr", "]"}], ",", "\[Lambda]"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"codegrees", "=", 
        RowBox[{"FormalCodegrees", "[", "fr", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"dims", "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalD]", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        SuperscriptBox["d", "2"], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "dims"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", 
       RowBox[{"{", "dims", "}"}], ",", 
       RowBox[{"\[ScriptCapitalD]", "/", "codegrees"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.624473055812643*^9, 3.6244730578246593`*^9}, {
  3.6244731034260178`*^9, 3.624473124218602*^9}, {3.624473163865199*^9, 
  3.6244732978434067`*^9}, {3.624473467747518*^9, 3.624473477115738*^9}, {
  3.6350195499695272`*^9, 3.635019574115898*^9}, {3.67324037211523*^9, 
  3.6732404629923286`*^9}, {3.673240541734582*^9, 3.673240672809713*^9}, {
  3.673241581673567*^9, 3.6732416043011703`*^9}, {3.6736950011040897`*^9, 
  3.673695005450727*^9}, {3.673695737126361*^9, 3.673695742359037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dNumberQ", "=", "FusionAtlas`dTest`Private`dNumberQ"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58544594405521*^9, 3.585445951798936*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "columnCondition", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"columnCondition", "[", 
    RowBox[{"{", 
     RowBox[{
     "\[ScriptCapitalD]_", ",", "dims_", ",", "dimsForFormalCodegrees_"}], 
     "}"}], "]"}], "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"columnCondition", "[", 
     RowBox[{"{", 
      RowBox[{
      "\[ScriptCapitalD]", ",", "dims", ",", "dimsForFormalCodegrees"}], 
      "}"}], "]"}], "[", "v", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", 
       RowBox[{"dims", ".", "v"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberOfColumnsToCheck", "--"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"True", "\[Or]", 
         RowBox[{
          RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[NotEqual]", "1"}], "\[Or]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Complement", "[", 
            RowBox[{"d", ",", "dimsForFormalCodegrees"}], "]"}], "]"}], 
          "\[Equal]", "0"}]}], ")"}], "\[And]", "\[IndentingNewLine]", 
       RowBox[{"dimensionCondition", "[", 
        RowBox[{"\[ScriptCapitalD]", ",", "d"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\n", 
 RowBox[{"Clear", "[", "dimensionCondition", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dimensionCondition", "[", 
   RowBox[{"\[ScriptCapitalD]_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dimensionCondition", "[", 
    RowBox[{"\[ScriptCapitalD]", ",", "d"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"N", "[", "#", "]"}], "]"}], ">", "0"}], "&"}], "/@", 
        "d"}], ")"}]}], ")"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"AlgebraicIntegerQ", "/@", 
        RowBox[{"(", 
         RowBox[{"\[ScriptCapitalD]", "/", "d"}], ")"}]}], ")"}]}], ")"}], 
    "\[And]", 
    RowBox[{"(", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"dNumberQ", "/@", "d"}], ")"}]}], ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608460369636609*^9, 3.6084604206376657`*^9}, {
  3.6084605136917973`*^9, 3.608460517885446*^9}, {3.6084608412575693`*^9, 
  3.6084608425029173`*^9}, {3.6084610507591553`*^9, 3.608461100028492*^9}, {
  3.608467860364357*^9, 3.608467860731573*^9}, {3.673239750140459*^9, 
  3.673239874504198*^9}, {3.673240854915133*^9, 3.673240861326581*^9}, {
  3.673240899488885*^9, 3.673240910363091*^9}, {3.673241126014865*^9, 
  3.67324112616366*^9}, {3.673241855720387*^9, 3.673241858623171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DowndateCholeskyDecomposition", "[", 
   RowBox[{"L0_", ",", "x0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"L", "=", "L0"}], ",", 
      RowBox[{"x", "=", "x0"}], ",", 
      RowBox[{"p", "=", 
       RowBox[{"Length", "[", "x0", "]"}]}], ",", "d", ",", "r", ",", "c", 
      ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{
           "x", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", "<", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"L", "=", "None"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         SqrtBox["d"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"r", "/", 
          RowBox[{"L", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}],
           "/", 
          RowBox[{"L", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"k", ",", "L", ",", "x", ",", "r"}], "}"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], "=", "r"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"k", "+", "1"}], ";;"}]}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", 
              RowBox[{
               RowBox[{"k", "+", "1"}], ";;"}]}], "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{"s", " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"k", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}]}],
            ")"}], "/", "c"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"k", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"k", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
          "-", 
          RowBox[{"s", " ", 
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"k", ",", 
             RowBox[{
              RowBox[{"k", "+", "1"}], ";;"}]}], 
            "\[RightDoubleBracket]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "p"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "L", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
      "L"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608567715819522*^9, 3.6085677279516363`*^9}, {
   3.608567836352*^9, 3.608567929770317*^9}, {3.608567973490737*^9, 
   3.608568043032386*^9}, 3.6085681316351023`*^9, {3.6085682468919783`*^9, 
   3.608568257291821*^9}, {3.608568315421235*^9, 3.608568315501816*^9}, {
   3.608568420682132*^9, 3.608568420771722*^9}, {3.6085687672995453`*^9, 
   3.608568775787443*^9}, {3.6085688663119993`*^9, 3.608568868856811*^9}, {
   3.6085689744277687`*^9, 3.608568978898086*^9}, {3.6085690250809793`*^9, 
   3.6085690305306683`*^9}, {3.608569080117091*^9, 3.6085690839817257`*^9}, {
   3.6085694061224003`*^9, 3.608569414690346*^9}, {3.608570212766371*^9, 
   3.6085702336350718`*^9}, {3.608570416620504*^9, 3.608570443335074*^9}, {
   3.6085706824136677`*^9, 3.608570683896298*^9}, {3.608570840862548*^9, 
   3.608570885972731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisGroup", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisGroup", "[", "n", "]"}], "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"i_", "/;", 
      RowBox[{
       RowBox[{"GCD", "[", 
        RowBox[{"i", ",", "n"}], "]"}], "\[Equal]", "1"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"cachedToNumberField", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"cachedToNumberField", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{"ToNumberField", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673686725753374*^9, 3.673686770939899*^9}, {
  3.673686849260683*^9, 3.673686902399469*^9}, {3.673686987062258*^9, 
  3.6736869953556023`*^9}, {3.673687050025503*^9, 3.673687069983304*^9}, {
  3.673688025355649*^9, 3.673688036077937*^9}, {3.673695072182308*^9, 
  3.673695117895005*^9}, {3.673695149886935*^9, 3.673695169543399*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GaloisConjugates", "[", 
   RowBox[{"a", ":", 
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"x_", ",", "c_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"identify\[Zeta]", "[", "x", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Union", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"AlgebraicNumberPolynomial", "[", 
        RowBox[{"a", ",", 
         SuperscriptBox[
          RowBox[{"\[Zeta]", "[", "n", "]"}], "l"]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisConjugates", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  RowBox[{"{", "x", "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673686725753374*^9, 3.673686770939899*^9}, {
  3.673686849260683*^9, 3.673686902399469*^9}, {3.673686987062258*^9, 
  3.6736869953556023`*^9}, {3.673687050025503*^9, 3.673687069983304*^9}, {
  3.673688025355649*^9, 3.673688036077937*^9}, {3.673695072182308*^9, 
  3.673695117895005*^9}, {3.673695149886935*^9, 3.673695169543399*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cachedRootReduce", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"cachedRootReduce", "[", "x", "]"}], "=", 
   RowBox[{"RootReduce", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"abs", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sign", "[", 
    RowBox[{"cachedRootReduce", "[", "x", "]"}], "]"}], "x"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673696135789874*^9, 3.673696147269597*^9}, {
  3.673712212133128*^9, 3.673712226574008*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
    RowBox[{"a", ":", 
     RowBox[{"AlgebraicNumber", "[", 
      RowBox[{"r_", ",", "x_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"r", "\[Equal]", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "a", 
    "]"}], "=", 
   RowBox[{"AlgebraicNumberPolynomial", "[", 
    RowBox[{"a", ",", 
     SuperscriptBox[
      RowBox[{"\[Zeta]", "[", "n", "]"}], "l"]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
   RowBox[{"a", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "a"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673695259405733*^9, 3.6736952599174623`*^9}, {
  3.6737110650467253`*^9, 3.673711069653788*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AllowedColumns", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllowedColumns", "[", 
   RowBox[{"m_", ",", "dimensionData_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bounds", ",", "allColumns", ",", "\[ScriptCapitalD]", ",", 
      "allowedColumns", ",", "columnDimensions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bounds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"m", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numberOfColumnsToCheck", "=", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", "1"}], "&"}], "/@", "bounds"}], ")"}]}], "-", 
       "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allColumns", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{
                    "bounds", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "m", "]"}], "-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ".."}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numberOfColumnsToCheck", "=", 
      RowBox[{"Length", "[", "allColumns", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allowedColumns", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"allColumns", ",", 
         RowBox[{"c_", "/;", 
          RowBox[{
           RowBox[{"columnCondition", "[", "dimensionData", "]"}], "[", "c", 
           "]"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Now", " ", "check", " ", "that", " ", "for", " ", "every", " ", 
        "column", " ", "c"}], ",", " ", 
       RowBox[{
       "there", " ", "exist", " ", "columns", " ", "giving", " ", "all", " ", 
        "the", " ", "Galois", " ", "conjugates", " ", "of", " ", "dim", 
        RowBox[{
         RowBox[{"(", "c", ")"}], "/", "\[ScriptCapitalD]"}]}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalD]", "=", 
      RowBox[{
      "dimensionData", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"columnDimensions", "=", 
      RowBox[{"allowedColumns", ".", 
       RowBox[{"(", 
        RowBox[{"dimensionData", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"allowedColumns", ",", 
       RowBox[{"c_", "/;", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"abs", "[", 
             RowBox[{
              RowBox[{"GaloisConjugates", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"c", ".", 
                  RowBox[{"(", 
                   RowBox[{"dimensionData", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
                   ")"}]}], ")"}], "/", "\[ScriptCapitalD]"}], "]"}], 
              "\[ScriptCapitalD]"}], "]"}], ",", "columnDimensions"}], "]"}], 
          "]"}], "\[Equal]", "0"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.608463389540723*^9, 3.608463438554564*^9}, {
   3.608463505624701*^9, 3.608463549859934*^9}, {3.6084635951442003`*^9, 
   3.6084636492400084`*^9}, {3.608464429872801*^9, 3.608464502056863*^9}, {
   3.6084645667400703`*^9, 3.608464650606215*^9}, {3.60846469649899*^9, 
   3.6084647577815857`*^9}, {3.608464816411063*^9, 3.608464817861064*^9}, {
   3.608464849804948*^9, 3.608464917457321*^9}, {3.608465052337667*^9, 
   3.608465066978527*^9}, {3.608465152420589*^9, 3.608465206402211*^9}, {
   3.6084657749300222`*^9, 3.608465777670331*^9}, 3.608466009901339*^9, {
   3.608539290533451*^9, 3.608539291284547*^9}, {3.6085393273947983`*^9, 
   3.608539344487042*^9}, {3.60854146926865*^9, 3.608541471601282*^9}, {
   3.608542479520155*^9, 3.608542484118224*^9}, {3.608542535698172*^9, 
   3.60854255396424*^9}, {3.608547586421776*^9, 3.608547587508461*^9}, {
   3.6085685258611183`*^9, 3.608568558241502*^9}, {3.608570327316596*^9, 
   3.608570341567504*^9}, {3.67323988128712*^9, 3.6732398854261208`*^9}, {
   3.673240803247328*^9, 3.6732408078786497`*^9}, {3.6736873736831636`*^9, 
   3.673687561941558*^9}, {3.673696133257368*^9, 3.673696133303145*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllDecompositions", "[", "m_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bounds", ",", "columns"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bounds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"m", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"columns", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{
                    "bounds", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "m", "]"}], "-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ".."}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "/@", 
      RowBox[{"AlgebraicDecompositionsImplementation", "[", 
       RowBox[{"m", ",", 
        RowBox[{"N", "[", 
         RowBox[{"CholeskyDecomposition", "[", 
          RowBox[{"m", "+", 
           RowBox[{"0.001", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Length", "[", "m", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
        
        RowBox[{"{", "}"}], ",", "columns"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675494699060212*^9, 3.675494780506071*^9}, {
  3.675495053704006*^9, 3.675495055024501*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AlgebraicDecompositions", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlgebraicDecompositions", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"dimensionData", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"MatrixRank", "[", "m", "]"}], "\[Equal]", 
    RowBox[{"Length", "[", "m", "]"}]}]}], ":=", 
  RowBox[{
   RowBox[{"AlgebraicDecompositions", "[", 
    RowBox[{"m", ",", "dimensionData"}], "]"}], "=", 
   RowBox[{"Transpose", "/@", 
    RowBox[{"AlgebraicDecompositions", "[", 
     RowBox[{"m", ",", 
      RowBox[{"N", "[", 
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"m", "+", 
         RowBox[{"0.001", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Length", "[", "m", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
      "dimensionData", ",", 
      RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlgebraicDecompositions", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"{", 
      RowBox[{
      "\[ScriptCapitalD]_", ",", "dims_", ",", "dimsForFormalCodegrees_"}], 
      "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"MatrixRank", "[", "m", "]"}], "<", 
    RowBox[{"Length", "[", "m", "]"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mr", ",", "dr", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "dr", ",", "i"}], "}"}], "=", 
      RowBox[{"RankReduction", "[", 
       RowBox[{"m", ",", "dims"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "i", "]"}], ".", "#"}], "&"}], "/@", 
      RowBox[{"AlgebraicDecompositions", "[", 
       RowBox[{"mr", ",", 
        RowBox[{"{", 
         RowBox[{
         "\[ScriptCapitalD]", ",", "dr", ",", "dimsForFormalCodegrees"}], 
         "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlgebraicDecompositions", "[", 
   RowBox[{"m_", ",", "cholesky_", ",", 
    RowBox[{"{", 
     RowBox[{
     "\[ScriptCapitalD]_", ",", "dims_", ",", "dimsForFormalCodegrees_"}], 
     "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bounds", ",", "allColumns", ",", "allowedColumns"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allowedColumns", "=", 
      RowBox[{"AllowedColumns", "[", 
       RowBox[{"m", ",", 
        RowBox[{"{", 
         RowBox[{
         "\[ScriptCapitalD]", ",", "dims", ",", "dimsForFormalCodegrees"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AlgebraicDecompositionsImplementation", "[", 
      RowBox[{"m", ",", "cholesky", ",", 
       RowBox[{"{", "}"}], ",", "allowedColumns"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlgebraicDecompositionsImplementation", "[", 
   RowBox[{"m_", ",", "None", ",", "columns_", ",", "allowedColumns_"}], 
   "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlgebraicDecompositionsImplementation", "[", 
    RowBox[{"m_", ",", "cholesky_", ",", "columns_", ",", "allowedColumns_"}],
     "]"}], "/;", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", "m", "]"}], "]"}], "===", 
    RowBox[{"{", "0", "}"}]}]}], ":=", 
  RowBox[{"(", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"{", "columns", "}"}], "]"}], ";"}], "*)"}], 
   RowBox[{"{", "columns", "}"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlgebraicDecompositionsImplementation", "[", 
   RowBox[{"m_", ",", "cholesky_", ",", "columns_", ",", "allowedColumns_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "t", ",", "i", ",", "bounds", ",", "firstNonZeroRow", ",", "nextColumns",
       ",", "nextAllowedColumns"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"latestColumn", "=", "columns"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<decomposing: \>\"", " ", ",", "m", " ", ",", 
         "\"\< with columns: \>\"", ",", "columns"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bounds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"m", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"firstNonZeroRow", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"m", ",", 
         RowBox[{"x_Integer", "/;", 
          RowBox[{"x", ">", "0"}]}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "columns", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"allowedColumns", ",", 
            RowBox[{"columns", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nextAllowedColumns", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"allowedColumns", ",", "i"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nextAllowedColumns", "=", "allowedColumns"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nextAllowedColumns", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"nextAllowedColumns", ",", 
        RowBox[{"c_", "/;", 
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "c", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "\[LessEqual]", 
              RowBox[{
              "bounds", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nextColumns", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"nextAllowedColumns", ",", 
        RowBox[{"c_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "c", "\[LeftDoubleBracket]", "firstNonZeroRow", 
            "\[RightDoubleBracket]"}], "\[NotEqual]", "0"}], ")"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numberOfColumnsToCheck", "=", 
      RowBox[{"Length", "[", "nextColumns", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Length", "[", "allowedNextColumns", "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"AlgebraicDecompositionsImplementation", "[", 
          RowBox[{
           RowBox[{"m", "-", 
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "#", ",", "#"}], "]"}]}], ",", 
           RowBox[{"DowndateCholeskyDecomposition", "[", 
            RowBox[{"cholesky", ",", "#"}], "]"}], ",", 
           RowBox[{"columns", "~", "Join", "~", 
            RowBox[{"{", "#", "}"}]}], ",", "nextAllowedColumns"}], "]"}], 
         "&"}], "/@", "nextColumns"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5837934083597593`*^9, 3.583793424314098*^9}, {
   3.5837941477673903`*^9, 3.583794391460825*^9}, {3.583794425902256*^9, 
   3.583794438430148*^9}, {3.583794495587326*^9, 3.583794557394781*^9}, {
   3.5837946814302263`*^9, 3.583794716232341*^9}, {3.583794822875738*^9, 
   3.583794842947282*^9}, {3.583795076465529*^9, 3.58379516875603*^9}, {
   3.5837954393612003`*^9, 3.583795575672513*^9}, {3.583795826110423*^9, 
   3.5837958353962517`*^9}, {3.583798508974028*^9, 3.583798603203032*^9}, {
   3.583799931621435*^9, 3.583799932145424*^9}, {3.585444784626112*^9, 
   3.585444883576836*^9}, {3.585444913608963*^9, 3.585444927866254*^9}, 
   3.585445055391144*^9, {3.5854451006037817`*^9, 3.585445121781763*^9}, {
   3.5854452046194563`*^9, 3.5854452226486053`*^9}, {3.585445294734474*^9, 
   3.585445296465266*^9}, 3.5854454302135363`*^9, {3.585445517049199*^9, 
   3.5854456007608957`*^9}, {3.585445644557955*^9, 3.585445647981094*^9}, {
   3.585445691758939*^9, 3.585445697764112*^9}, {3.585445744596282*^9, 
   3.585445816467087*^9}, {3.585445960397233*^9, 3.58544601835833*^9}, {
   3.5854473600792027`*^9, 3.585447452446891*^9}, {3.585447490227434*^9, 
   3.5854474938326283`*^9}, {3.585447582306033*^9, 3.585447637943434*^9}, {
   3.585448036727215*^9, 3.585448063979295*^9}, {3.585448096502005*^9, 
   3.5854481370433083`*^9}, {3.585449347350812*^9, 3.585449358959113*^9}, {
   3.608460118573309*^9, 3.60846012010649*^9}, {3.608460239193838*^9, 
   3.608460293016597*^9}, {3.6084604894942427`*^9, 3.608460489609517*^9}, {
   3.6084613821011267`*^9, 3.608461385582403*^9}, {3.6084614203761587`*^9, 
   3.60846175869493*^9}, {3.608461900835903*^9, 3.608461957965858*^9}, {
   3.6084620024676943`*^9, 3.608462003064507*^9}, {3.608462852870409*^9, 
   3.608462853982164*^9}, {3.6084632808859663`*^9, 3.6084633180346937`*^9}, {
   3.608463427117345*^9, 3.608463452537208*^9}, {3.608464520259479*^9, 
   3.6084645404133797`*^9}, {3.608465785450405*^9, 3.60846578590132*^9}, {
   3.608465827991824*^9, 3.608465828366447*^9}, {3.608465988350417*^9, 
   3.608466014536043*^9}, {3.6085473977653713`*^9, 3.608547573213583*^9}, {
   3.60854761934486*^9, 3.608547628454473*^9}, {3.608547665555552*^9, 
   3.6085477035900173`*^9}, {3.608568471744676*^9, 3.608568499423252*^9}, {
   3.608568580476446*^9, 3.6085686430042877`*^9}, {3.608568738610157*^9, 
   3.608568739703361*^9}, {3.608568789857811*^9, 3.608568792052541*^9}, {
   3.608570248371028*^9, 3.608570305767346*^9}, {3.608570346212834*^9, 
   3.6085703529342422`*^9}, {3.608570523305707*^9, 3.608570538891124*^9}, {
   3.608570678469449*^9, 3.608570701495418*^9}, {3.608570927168522*^9, 
   3.608570940786001*^9}, {3.624139315025169*^9, 3.624139322451178*^9}, {
   3.673239916059412*^9, 3.673239948309577*^9}, {3.6732399882181892`*^9, 
   3.6732400881460752`*^9}, {3.673240147625396*^9, 3.673240171127829*^9}, {
   3.6732410276452837`*^9, 3.673241040669786*^9}, {3.6737957158729477`*^9, 
   3.673795720495494*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"identityColumn", "[", 
   RowBox[{"FusionRules", "[", 
    RowBox[{"_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"m_", ",", "___"}], "}"}]}], "}"}]}], "]"}], "]"}], ":=", 
  RowBox[{"UnitVector", "[", 
   RowBox[{
    RowBox[{"Length", "[", "m", "]"}], ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6244733674261017`*^9, 3.62447339695944*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FindSpanningSet", "[", 
   RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"FindSpanningSetI", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"{", "}"}], ",", "m"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindSpanningSet", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindSpanningSetI", "[", 
   RowBox[{"considered_", ",", "basis_", ",", "rowReduced_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "basis"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindSpanningSetI", "[", 
   RowBox[{
   "considered_", ",", "basis_", ",", "rowReduced_", ",", "remaining_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newRR", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newRR", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"RowReduce", "[", 
         RowBox[{"rowReduced", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{
           "remaining", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ".."}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "newRR", "]"}], "\[Equal]", 
        RowBox[{"Length", "[", "rowReduced", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FindSpanningSetI", "[", 
        RowBox[{
         RowBox[{"considered", "+", "1"}], ",", "basis", ",", "rowReduced", 
         ",", 
         RowBox[{"Rest", "[", "remaining", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FindSpanningSetI", "[", 
        RowBox[{
         RowBox[{"considered", "+", "1"}], ",", 
         RowBox[{"basis", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"considered", "+", "1"}], "}"}]}], ",", "newRR", ",", 
         RowBox[{"Rest", "[", "remaining", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517842790731937*^9, 3.517842978035831*^9}, 
   3.517843020555119*^9, {3.51784308118477*^9, 3.517843088054842*^9}, {
   3.5178431885979567`*^9, 3.51784319624757*^9}, {3.5178432337253036`*^9, 
   3.517843233933169*^9}, {3.585446270714548*^9, 3.585446281835586*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RankReduction", "[", 
   RowBox[{"m_", ",", "dims_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "o", ",", "mr", ",", "m2", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"o", "=", 
      RowBox[{"Ordering", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"m", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"FindSpanningSet", "[", 
       RowBox[{"m", "\[LeftDoubleBracket]", 
        RowBox[{"o", ",", "o"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mr", "=", 
      RowBox[{
       RowBox[{"m", "\[LeftDoubleBracket]", 
        RowBox[{"o", ",", "o"}], "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"p", ",", "p"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"p", "~", "Join", "~", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}], ",", "p"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"oi", "=", 
      RowBox[{"InversePermutation", "[", "o", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pi", "=", 
      RowBox[{"InversePermutation", "[", "p", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m2", "=", 
      RowBox[{
       RowBox[{"m", "\[LeftDoubleBracket]", 
        RowBox[{"o", ",", "o"}], "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"p", ",", "p"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"RowReduce", "[", 
         RowBox[{"NullSpace", "[", 
          RowBox[{"NullSpace", "[", "m2", "]"}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "pi"}], "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "oi"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mr", ",", 
       RowBox[{"dims", ".", 
        RowBox[{"Transpose", "[", "i", "]"}]}], ",", "i"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.58544610997962*^9, 3.5854461136175833`*^9}, {
  3.5854462992889*^9, 3.5854463605972157`*^9}, {3.585446416744179*^9, 
  3.585446464902676*^9}, {3.585446538542015*^9, 3.585446666272718*^9}, {
  3.585446975214747*^9, 3.585446981136207*^9}, {3.585447026661457*^9, 
  3.585447126158331*^9}, {3.585447241939806*^9, 3.5854472705578527`*^9}, {
  3.585447318681527*^9, 3.585447323096136*^9}, {3.585447465519421*^9, 
  3.585447470280488*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291412978622007`*^9, 3.629141300184711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291413009800043`*^9, 3.629141302389662*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
Evaluator->"Local (2)",
WindowSize->{1221, 778},
WindowMargins->{{Automatic, 36}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 432, 6, 51, "Subtitle",
 InitializationCell->True],
Cell[1015, 30, 420, 8, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1460, 42, 58, 1, 64, "Section",
 InitializationCell->True],
Cell[1521, 45, 129, 2, 30, "Text",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1687, 52, 60, 1, 64, "Section",
 InitializationCell->True],
Cell[1750, 55, 247, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[2022, 65, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[2158, 69, 72, 1, 30, "Text",
 InitializationCell->True],
Cell[2233, 72, 1129, 21, 46, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3399, 98, 63, 1, 44, "Subsection",
 InitializationCell->True],
Cell[3465, 101, 663, 15, 63, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4165, 121, 58, 1, 44, "Subsection",
 InitializationCell->True],
Cell[4226, 124, 119, 3, 28, "Input",
 InitializationCell->True],
Cell[4348, 129, 2385, 54, 165, "Input",
 InitializationCell->True],
Cell[6736, 185, 1713, 45, 97, "Input",
 InitializationCell->True],
Cell[8452, 232, 1462, 40, 63, "Input",
 InitializationCell->True],
Cell[9917, 274, 1086, 27, 46, "Input",
 InitializationCell->True],
Cell[11006, 303, 3250, 86, 281, "Input",
 InitializationCell->True],
Cell[14259, 391, 6097, 155, 165, "Input",
 InitializationCell->True],
Cell[20359, 548, 426, 11, 28, "Input",
 InitializationCell->True],
Cell[20788, 561, 3083, 75, 114, "Input",
 InitializationCell->True],
Cell[23874, 638, 2512, 60, 215, "Input",
 InitializationCell->True],
Cell[26389, 700, 202, 5, 28, "Input",
 InitializationCell->True],
Cell[26594, 707, 2811, 72, 165, "Input",
 InitializationCell->True],
Cell[29408, 781, 4565, 110, 317, "Input",
 InitializationCell->True],
Cell[33976, 893, 526, 17, 28, "Input",
 InitializationCell->True],
Cell[34505, 912, 666, 14, 28, "Input",
 InitializationCell->True],
Cell[35174, 928, 1345, 34, 95, "Input",
 InitializationCell->True],
Cell[36522, 964, 520, 13, 46, "Input",
 InitializationCell->True],
Cell[37045, 979, 1088, 33, 53, "Input",
 InitializationCell->True],
Cell[38136, 1014, 5817, 134, 250, "Input",
 InitializationCell->True],
Cell[43956, 1150, 2596, 67, 131, "Input",
 InitializationCell->True],
Cell[46555, 1219, 11137, 257, 607, "Input",
 InitializationCell->True],
Cell[57695, 1478, 531, 15, 28, "Input",
 InitializationCell->True],
Cell[58229, 1495, 2432, 61, 182, "Input",
 InitializationCell->True],
Cell[60664, 1558, 3000, 75, 199, "Input",
 InitializationCell->True],
Cell[63667, 1635, 164, 4, 28, "Input",
 InitializationCell->True],
Cell[63834, 1641, 171, 4, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
