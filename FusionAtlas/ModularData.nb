(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    351479,       8940]
NotebookOptionsPosition[    338413,       8536]
NotebookOutlinePosition[    338804,       8553]
CellTagsIndexPosition[    338761,       8550]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ModularData package", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.420291647194886*^9, 3.420291647915923*^9}, {
  3.422317712155013*^9, 3.4223177168517666`*^9}, {3.4327775537006736`*^9, 
  3.4327775569353247`*^9}, {3.447362169800737*^9, 3.4473621701584797`*^9}, {
  3.62914181790036*^9, 3.629141821234551*^9}, {3.629142101447197*^9, 
  3.629142106581141*^9}, {3.6350177448740664`*^9, 3.63501774672686*^9}, {
  3.6801473554591312`*^9, 3.680147356663054*^9}}],

Cell["\<\
A subpackage for FusionAtlas.
August 14 2016, Scott Morrison, Terry Gannon, Corey Jones, and Henry Tucker\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291651250718*^9, 3.4202916677744784`*^9}, {
  3.432777559849515*^9, 3.432777570454765*^9}, {3.447362173061289*^9, 
  3.44736217826915*^9}, {3.62914182309914*^9, 3.6291418341933613`*^9}, {
  3.635017753846423*^9, 3.635017767128454*^9}, {3.6801473598840857`*^9, 
  3.680147367492038*^9}, {3.680147405694536*^9, 3.680147417632457*^9}}],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.629142254973199*^9, 3.629142254974373*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"$RecursionLimit", ",", "4096"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680438328689768*^9, 3.680438335100368*^9}}],

Cell[CellGroupData[{

Cell["Start of package", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.420295317242155*^9, 3.4202953180032496`*^9}}],

Cell["Specify package dependencies:", "Text",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`ModularData`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`TensorSolver`\>\"", ",", 
      "\"\<FusionAtlas`FormalCodegrees`\>\"", ",", 
      "\"\<FusionAtlas`InductionMatrix`\>\"", ",", 
      "\"\<FusionAtlas`DisplayGraphs`\>\""}], "}"}]}], "]"}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4202916841079645`*^9, 3.420291695754712*^9}, {
  3.420293246855085*^9, 3.420293279181568*^9}, {3.4223177805233216`*^9, 
  3.422317795274533*^9}, {3.422318235116995*^9, 3.4223182432486877`*^9}, {
  3.432777576673707*^9, 3.4327775869484816`*^9}, {3.4327796677505283`*^9, 
  3.432779670003768*^9}, {3.434561456512453*^9, 3.434561465345154*^9}, {
  3.441994559392016*^9, 3.441994566564913*^9}, {3.6291406512241707`*^9, 
  3.629140653980494*^9}, {3.629140727883437*^9, 3.629140728811976*^9}, {
  3.6291420738596573`*^9, 3.629142076889803*^9}, {3.635017772363525*^9, 
  3.635017782991023*^9}, {3.635018204317058*^9, 3.635018207740631*^9}, {
  3.635019535056429*^9, 3.635019543560801*^9}, {3.68014744113973*^9, 
  3.680147446258232*^9}, {3.680154679009303*^9, 3.68015468791164*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage messages", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindModularData", "::", "usage"}], "=", 
   "\"\<FindModularData[X_] computes all possible modular data for the \
centre; the argument X may be a fusion ring and induction matrix, a fusion \
ring, the rank 3 tensor of fusion multiplicities, a matrix of fusion \
multiplicities for a single object, or a principal graph.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635017899819322*^9, 3.635017925420052*^9}, {
  3.67549492437112*^9, 3.67549495301793*^9}, {3.675495043609414*^9, 
  3.675495046058992*^9}, {3.680147447909884*^9, 3.680147554092256*^9}}],

Cell[BoxData[
 RowBox[{"ExplicitGenerators", ";", "CharacterTable", ";", "GaloisGroup", ";",
   "GaloisAction", ";", "GaloisGroupGenerators", ";", "PossibleConductors", 
  ";", "workOnRepresentations", ";", "SInRepresentation", ";", 
  "TInRepresentation", ";", "DimensionsFromInductionMatrix", ";", 
  "GaloisOrbitClumps", ";", "PossibleGaloisImages", ";", 
  "PossibleGaloisTraces", ";", "RepresentationsForRank", ";", 
  "RepresentationsForInductionMatrix", ";", "SaveRepresentationsForRank", ";",
   "SaveCharacterTables", ";", "SaveGenerators", ";", "SaveConjugacyClasses", 
  ";", "AllocateEigenvaluesToGaloisOrbitClumps", ";", 
  "AllocateEigenvaluesToSimples", ";", 
  "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", ";", 
  "AllocateEigenvaluesToSimplesAndCompleteGaloisActions", ";", 
  "FindQLinearSolutions"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680606780808073*^9, 3.680606829217884*^9}, 
   3.680607074335917*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internals", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algebraic and cyclotomic numbers", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.6743212074562073`*^9, 3.6743212239642076`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Zeta]", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Zeta]", "[", "n", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Cyclotomic", "[", 
          RowBox[{"n", ",", "#"}], "]"}], "]"}], "&"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"p", "[", "m", "]"}], ",", "m"}], "]"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AlgebraicNumber", "[", 
        RowBox[{
         RowBox[{"Root", "[", 
          RowBox[{"p", ",", "d"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "~", "Join", "~", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"d", "-", "2"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559513223258071*^9, 3.5595132326436863`*^9}, {
  3.559515807400446*^9, 3.559515812406694*^9}, {3.559516359567793*^9, 
  3.559516375742578*^9}, {3.559516452342175*^9, 3.559516572539567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]inv", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Zeta]inv", "[", "n", "]"}], "=", 
   SuperscriptBox[
    RowBox[{"\[Zeta]", "[", "n", "]"}], 
    RowBox[{"-", "1"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626835174179533*^9, 3.6268351886741877`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "identify\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"identify\[Zeta]", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"identify\[Zeta]", "[", "z", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"z", "=!=", 
          RowBox[{"\[Zeta]", "[", "n", "]"}]}], "\[And]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", "\[LessEqual]", "2"}], "\[Or]", 
           RowBox[{"z", "=!=", 
            RowBox[{
             RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ")"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "n"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673273387342866*^9, 3.673273457125387*^9}, {
  3.6732739292935753`*^9, 3.673273938008869*^9}, {3.673273976255681*^9, 
  3.673273990424286*^9}, {3.673274020853307*^9, 3.673274042181876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", "[", "cachedToNumberField", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"cachedToNumberField", "[", 
    RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"ToNumberField", "[", 
        RowBox[{"X", ",", "Y"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"result", ",", "_ToNumberField"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cachedToNumberField", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], "=", "result"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}],
     "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656311146971908*^9, 3.6563111619485693`*^9}, {
   3.679715744810058*^9, 3.679715750305299*^9}, {3.679715796799189*^9, 
   3.679715868344956*^9}, {3.679716030225524*^9, 3.679716069364304*^9}, 
   3.6801876507617607`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", "X_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"ToCyclotomicField", "[", 
    RowBox[{"X", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{"X_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"ToCyclotomicField", "[", 
     RowBox[{"Flatten", "[", "X", "]"}], "]"}], ",", 
    RowBox[{"Length", "[", 
     RowBox[{"X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "n_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "n"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{"{", "x", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCyclotomicField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "z___"}], "}"}], ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tnf", ",", 
      RowBox[{"k", "=", "1"}], ",", "zt", ",", "p"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tnf", "=", 
         RowBox[{"cachedToNumberField", "[", 
          RowBox[{"x", ",", 
           RowBox[{"\[Zeta]", "[", "n", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"tnf", ",", "_ToNumberField"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"n0", "=", 
            RowBox[{"k", " ", "n"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tnf", "=", 
            RowBox[{"cachedToNumberField", "[", 
             RowBox[{"x", ",", 
              RowBox[{"\[Zeta]", "[", 
               RowBox[{"k", " ", "n"}], "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToNumberField", "::", "nnfel"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zt", ",", "p"}], "}"}], "=", 
      RowBox[{"ToCyclotomicField", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"k", " ", "n"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"AlgebraicNumberPolynomial", "[", 
          RowBox[{"tnf", ",", 
           SuperscriptBox[
            RowBox[{"\[Zeta]", "[", "p", "]"}], 
            RowBox[{"p", "/", 
             RowBox[{"(", 
              RowBox[{"k", " ", "n"}], ")"}]}]]}], "]"}], "}"}], "~", "Join", 
        "~", "zt"}], ",", "p"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656310652850071*^9, 3.656310943220831*^9}, {
  3.656311004720512*^9, 3.6563110260225267`*^9}, {3.656311131968268*^9, 
  3.656311145284636*^9}, {3.656311176849099*^9, 3.656311197455339*^9}, {
  3.656311237033141*^9, 3.656311237381052*^9}, {3.6565307557902393`*^9, 
  3.6565307601829433`*^9}, {3.679638645664609*^9, 3.679638664244668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrimePowers", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
    "&"}], "/@", 
   RowBox[{"FactorInteger", "[", "n", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673591782255433*^9, 3.6735917945891113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LiftToCommonCyclotomicField", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exponents", ",", "N"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"exponents", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"identify\[Zeta]", "/@", 
        RowBox[{"Union", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"AlgebraicNumber", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], "\[RuleDelayed]", "a"}], ",", 
           "\[Infinity]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"LCM", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "1", "}"}], "~", "Join", "~", "exponents"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"exponents", "===", 
        RowBox[{"{", "N", "}"}]}], ",", "\[IndentingNewLine]", "x", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"a", ":", 
          RowBox[{"AlgebraicNumber", "[", 
           RowBox[{"z_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"identify\[Zeta]", "[", "z", "]"}], "\[Equal]", "N"}], 
           ",", "a", ",", 
           RowBox[{"AlgebraicNumberPolynomial", "[", 
            RowBox[{"a", ",", 
             SuperscriptBox[
              RowBox[{"\[Zeta]", "[", "N", "]"}], 
              RowBox[{"N", "/", 
               RowBox[{"identify\[Zeta]", "[", "z", "]"}]}]]}], "]"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678953938966761*^9, 3.6789540106891537`*^9}, {
  3.67895459189841*^9, 3.678954596625936*^9}, {3.678957199600021*^9, 
  3.6789572608250513`*^9}}],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"AlgebraicConjugate", ",", "Listable"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlgebraicConjugate", "[", "n_Integer", "]"}], ":=", 
  "n"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626598259658656*^9, 3.6265982763923273`*^9}, {
  3.626681119570726*^9, 3.62668114172405*^9}, {3.626834780559732*^9, 
  3.626834780813352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CyclotomicOrder", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CyclotomicOrder", "[", "x", "]"}], "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}], "/", 
     RowBox[{"Arg", "[", "x", "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626816783546278*^9, 3.626816938572517*^9}, 
   3.626818211838941*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AlgebraicConjugate", "[", "a_AlgebraicNumber", "]"}], ":=", 
  RowBox[{"AlgebraicNumberPolynomial", "[", 
   RowBox[{"a", ",", 
    RowBox[{"\[Zeta]inv", "[", 
     RowBox[{"CyclotomicOrder", "[", 
      RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlgebraicConjugate", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "x"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626834636036372*^9, 3.6268346762981987`*^9}, {
  3.626834719656191*^9, 3.6268347397564497`*^9}, {3.626834977886137*^9, 
  3.626834990564331*^9}, {3.626835070497987*^9, 3.626835127840558*^9}, {
  3.6268351933763027`*^9, 3.6268351961216927`*^9}, {3.62683522730613*^9, 
  3.626835230001079*^9}, {3.626835720706133*^9, 3.626835721529357*^9}, {
  3.674401586120199*^9, 3.67440159576958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UniqueGaloisConjugate", "[", 
   RowBox[{"a", ":", 
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"x_", ",", "__"}], "]"}]}], "]"}], ":=", 
  RowBox[{"ToNumberField", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RootReduce", "[", "a", "]"}], "/.", 
     RowBox[{
      RowBox[{"z", ":", 
       RowBox[{"Power", "[", 
        RowBox[{"_", ",", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"-", "z"}]}]}], ",", "x"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6266805151609297`*^9, 3.626680560419626*^9}, {
  3.626681089707329*^9, 3.626681089802528*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Handling GZIP files", "Section",
 CellChangeTimes->{{3.6801484911130877`*^9, 3.680148502575367*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FusionAtlasDirectory", "[", "]"}], ",", 
      "\"\<modularData\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "dataDirectory", "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", "dataDirectory", "]"}]}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6801501325239477`*^9, 3.6801501843539886`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GZIP", "[", 
    RowBox[{"data_", ",", "filename_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}]}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Put", "[", 
       RowBox[{"data", ",", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"filename", ",", " ", 
          RowBox[{"-", "3"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<cd \>\"", "<>", 
        RowBox[{"DirectoryName", "[", "filename", "]"}], "<>", 
        "\"\< && gzip \>\"", "<>", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"filename", ",", " ", 
          RowBox[{"-", "3"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678845765804377*^9, 3.678845855071946*^9}, {
  3.67885726261788*^9, 3.678857272715775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportGZIP", "[", "filename_", "]"}], "/;", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"unzipped", "=", 
       RowBox[{"\"\</tmp/unzipped\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<-\>\"", "<>", 
        
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"StringDrop", "[", 
           RowBox[{"filename", ",", " ", 
            RowBox[{"-", "3"}]}], "]"}], ",", 
          RowBox[{"StringLength", "[", 
           RowBox[{"DirectoryName", "[", "filename", "]"}], "]"}]}], 
         "]"}]}]}], ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Run", "[", 
      RowBox[{"\"\<cd \>\"", "<>", 
       RowBox[{"DirectoryName", "[", "filename", "]"}], "<>", 
       "\"\< && gzip -cd \>\"", "<>", "filename", "<>", "\"\< > \>\"", "<>", 
       "unzipped"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Get", "[", "unzipped", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteFile", "[", "unzipped", "]"}], ";", "\[IndentingNewLine]",
      "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678934204124782*^9, 3.678934241514166*^9}, {
  3.6789343257586184`*^9, 3.67893447082731*^9}, {3.678934638089252*^9, 
  3.6789346510792227`*^9}, {3.67893472345182*^9, 3.678934723931559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHA1", "[", "x_", "]"}], ":=", 
  RowBox[{"IntegerString", "[", 
   RowBox[{
    RowBox[{"Hash", "[", 
     RowBox[{"x", ",", "\"\<SHA1\>\""}], "]"}], ",", "16", ",", "32"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6788454156579933`*^9, 3.678845417513482*^9}, 
   3.678845481484509*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["GAP interface", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321029314937*^9, 3.6743210380003643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAP", "[", 
   RowBox[{"SL", "[", 
    RowBox[{"2", ",", 
     SubscriptBox["Z", "N_"]}], "]"}], "]"}], ":=", 
  RowBox[{"\"\<Group([[[0,1],[-1,0]],[[1,1],[0,1]]]*One(Integers mod \>\"", "<>", 
   RowBox[{"ToString", "[", "N", "]"}], "<>", "\"\<))\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673271184739356*^9, 3.673271213963241*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAPPath", "=", "\"\<~/gap/gap\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680148051245047*^9, 3.680148060845536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Execute", "[", "cmd_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lines", ",", "return"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Calling GAP:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "cmd", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"return", "=", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<echo '\>\"", "<>", "cmd", "<>", "\"\<' | \>\"", "<>", "GAPPath", 
        "<>", "\"\< -x 10000 -o 16g > /tmp/gap\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<.out\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"\"\</tmp/gap\>\"", "<>", 
           RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
           "\"\<.out\>\""}], ",", "\"\<String\>\""}], "]"}], ",", 
        "\"\<\\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"return", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"lines", ",", 
             RowBox[{"l_", "/;", 
              RowBox[{"!", 
               RowBox[{"StringFreeQ", "[", 
                RowBox[{"l", ",", "\"\<+++++++\>\""}], "]"}]}]}]}], "]"}], 
           "<", "3"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<It looks like something went wrong running GAP (error code \
\>\"", "<>", 
             RowBox[{"ToString", "[", "return", "]"}], "<>", 
             "\"\<). Please check that you have GAP installed, and modify \
FusionAtlas`ModularData`Private`GAPPath if necessary.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "/@", "lines"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "lines"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6732752854541283`*^9, 3.6732753398729687`*^9}, {
   3.673275448613121*^9, 3.673275449881894*^9}, 3.6732763770593243`*^9, 
   3.673276722614603*^9, {3.673589132440914*^9, 3.673589141002243*^9}, {
   3.678934066547827*^9, 3.678934072260149*^9}, {3.6797754764261723`*^9, 
   3.679775477136386*^9}, {3.680147885876754*^9, 3.680147953256157*^9}, {
   3.680148065210949*^9, 3.680148080237525*^9}, {3.68015314884172*^9, 
   3.680153151280357*^9}, {3.680153182438315*^9, 3.680153194841539*^9}, {
   3.6801552632545633`*^9, 3.680155276890233*^9}, {3.6801555410490923`*^9, 
   3.680155629181378*^9}}],

Cell[CellGroupData[{

Cell["Explicit generators", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321091240383*^9, 3.6743210976338663`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "uses", " ", "Vahid", " ", 
    RowBox[{"Dabbaghian", "'"}], "s", " ", "RepSn", " ", "package", " ", 
    "for", " ", 
    RowBox[{"GAP", ":", " ", "http", ":"}]}], "//", 
   RowBox[{
    RowBox[{"www", ".", "gap"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"system", ".", "org"}], "/", "Packages"}], "/", 
     RowBox[{"repsn", ".", "html"}]}]}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673278901464404*^9, 3.6732789212562037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q_", "]"}], "[", "k_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "S", ",", "T", ",", "N", ",", "i", ",", "Q", ",", "invQ"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"Execute", "[", 
        RowBox[{
        "\"\<\nLoadPackage(\\\"repsn\\\");\nS:=[[0,1],[-1,0]]*One(Integers \
mod \>\"", "<>", 
         RowBox[{"ToString", "[", "q", "]"}], "<>", 
         "\"\<);;\nT:=[[1,1],[0,1]]*One(Integers mod \>\"", "<>", 
         RowBox[{"ToString", "[", "q", "]"}], "<>", 
         "\"\<);;\nG:=Group([S,T]);;\n\
rep:=IrreducibleAffordingRepresentation(Irr(G)[\>\"", "<>", 
         RowBox[{"ToString", "[", "k", "]"}], "<>", 
         "\"\<]);;\nPrint(\\\"+++++++\\\");\nS^rep;\nPrint(\\\"+++++++\\\");\n\
T^rep;\nPrint(\\\"+++++++\\\");\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"contextToExpression", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StringJoin", "@@", "out"}], ")"}], ",", 
              "\"\<+++++++\>\""}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], "/.", 
           
           RowBox[{"s_String", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"StringReplace", "[", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<gap> \>\"", "\[RuleDelayed]", "\"\<\>\""}], ",", 
                 RowBox[{"\"\<[\>\"", "\[RuleDelayed]", "\"\<{\>\""}], ",", 
                 RowBox[{"\"\<]\>\"", "\[RuleDelayed]", "\"\<}\>\""}], ",", 
                 RowBox[{
                  RowBox[{"\"\<E(\>\"", "~~", 
                   RowBox[{"n", ":", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", 
                   "\"\<)\>\""}], "\[RuleDelayed]", 
                  RowBox[{
                  "\"\<\[Zeta][\>\"", "<>", "n", "<>", "\"\<]\>\""}]}]}], 
                "}"}]}], "]"}], ")"}]}]}], ")"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"LCM", "[", 
        RowBox[{"q", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"identify\[Zeta]", "/@", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", ",", "T"}], "}"}], ",", 
               RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
                RowBox[{
                "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ",", "\[Infinity]"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Lifting to Q[\[Zeta][\>\"", "<>", 
        RowBox[{"ToString", "[", "N", "]"}], "<>", "\"\<]]\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"S", ",", "T"}], "}"}], "/.", 
        RowBox[{
         RowBox[{"a", ":", 
          RowBox[{"AlgebraicNumber", "[", 
           RowBox[{"z_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"AlgebraicNumberPolynomial", "[", 
          RowBox[{"a", ",", 
           SuperscriptBox[
            RowBox[{"\[Zeta]", "[", "N", "]"}], 
            RowBox[{"N", "/", 
             RowBox[{"identify\[Zeta]", "[", "z", "]"}]}]]}], "]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastS", ",", "lastT"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Computing eigenspaces...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigenspaces", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
        RowBox[{
         RowBox[{"NullSpace", "[", 
          RowBox[{
           RowBox[{"T", "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"\[Zeta]", "[", "N", "]"}], 
              RowBox[{"i", " ", 
               RowBox[{"N", "/", "q"}]}]], 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "T", "]"}], "]"}]}]}], ",", 
           RowBox[{
           "\"\<Method\>\"", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"q", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "@@", "eigenspaces"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Inverting change of basis...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"lastQ", "=", "Q"}], ";", "\[IndentingNewLine]", 
      RowBox[{"invQ", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Q", ",", 
         RowBox[{
         "\"\<Method\>\"", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Done!\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"invQ", ".", "S", ".", "Q"}], ",", 
        RowBox[{"invQ", ".", "T", ".", "Q"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673275785723749*^9, 3.673275875231045*^9}, {
   3.673275993887827*^9, 3.673276008483047*^9}, {3.673276040341206*^9, 
   3.6732761406762238`*^9}, {3.6732761734166613`*^9, 3.673276174058674*^9}, {
   3.6732763428227577`*^9, 3.67327634441643*^9}, {3.673276414219142*^9, 
   3.673276427152121*^9}, 3.673276567595786*^9, {3.673276657094429*^9, 
   3.673276665671742*^9}, {3.67327670225669*^9, 3.6732767139981413`*^9}, {
   3.673276755181868*^9, 3.67327681510819*^9}, {3.673278617669506*^9, 
   3.673278703485704*^9}, 3.67358960357768*^9, {3.6735897503078327`*^9, 
   3.673589754867977*^9}, {3.673590854416176*^9, 3.6735909465265617`*^9}, {
   3.673591285952467*^9, 3.67359129376431*^9}, {3.673591582373382*^9, 
   3.6735915826388893`*^9}, {3.6735923961560287`*^9, 3.673592398293146*^9}, {
   3.673592441357317*^9, 3.673592441469851*^9}, 3.680152202828776*^9, 
   3.680153308064568*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveGenerators", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<explicitGenerators.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadGenerators", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<explicitGenerators.m\>\""}], "}"}],
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
          RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}]}]}], ";"}], 
       ")"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673629474711771*^9, 
  3.673629475815337*^9}, {3.680150194141305*^9, 3.6801501961832037`*^9}, {
  3.680342277640565*^9, 3.6803423020055847`*^9}}],

Cell[BoxData[
 RowBox[{"LoadGenerators", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6802657964064093`*^9, 3.6802657984280663`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Character tables", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321105609541*^9, 3.674321108877654*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ReadCharacterTable", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", "gapName_List", "]"}], ":=", 
  RowBox[{"ReadCharacterTable", "@@", "gapName"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", "gapName_", "]"}], ":=", 
  RowBox[{"ReadCharacterTable", "[", 
   RowBox[{"\"\<\>\"", ",", "gapName"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", 
   RowBox[{"stuff_", ",", "gapName_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ReadCharacterTable", "[", 
    RowBox[{"stuff", ",", "gapName"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "lines", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lines", "=", 
       RowBox[{"Execute", "[", 
        RowBox[{
        "stuff", "<>", "\"\<Display(CharacterTable(\>\"", "<>", "gapName", 
         "<>", "\"\<));\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Calculated the character table for \>\"", "<>", "gapName", "<>", 
        "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"TableForm", "[", "lines", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"lines", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"-", "1"}]}], "}"}], "+", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"lines", ",", 
             RowBox[{"s_", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"s", ",", 
                RowBox[{"\"\<gap>\>\"", "~~", "___"}]}], "]"}]}], ",", 
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "lines"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6265963325923357`*^9, 3.626596366210232*^9}, {
  3.673244751955676*^9, 3.6732447519986753`*^9}, {3.673589084476933*^9, 
  3.673589090257818*^9}, {3.6735891579602013`*^9, 3.673589181232705*^9}, {
  3.673589248877458*^9, 3.673589250299822*^9}, {3.680148125200514*^9, 
  3.680148140867038*^9}, {3.680545657363784*^9, 3.680545749898059*^9}, {
  3.6805457806702633`*^9, 3.6805458677450027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyUnitarity", "[", "table_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"table1", ",", "M", ",", "conjugacyClassSizes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table1", "=", 
      RowBox[{"ToCyclotomicField", "[", "table", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"AlgebraicConjugate", "[", 
        RowBox[{"Transpose", "[", "table1", "]"}], "]"}], ".", "table1"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{
       RowBox[{
       "conjugacyClassSizes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "/", "conjugacyClassSizes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"table1", ".", 
        RowBox[{"AlgebraicConjugate", "[", 
         RowBox[{"conjugacyClassSizes", " ", 
          RowBox[{"Transpose", "[", "table1", "]"}]}], "]"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"Plus", "@@", "conjugacyClassSizes"}], ")"}]}], "===", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "M", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626681169399117*^9, 3.626681236064234*^9}, {
  3.626681463930812*^9, 3.626681464600976*^9}, {3.6266814947222633`*^9, 
  3.626681538015633*^9}, {3.626681570857834*^9, 3.626681608259412*^9}, {
  3.62668417570864*^9, 3.626684188137061*^9}, {3.6268184698549013`*^9, 
  3.626818472407775*^9}, {3.626834112275057*^9, 3.6268341574031563`*^9}, {
  3.626834922946801*^9, 3.6268349388200073`*^9}, {3.626835549256691*^9, 
  3.626835553249207*^9}, {3.674319222083482*^9, 3.6743192229505167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyUnitarityNumerically", "[", "table_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"table1", ",", "M", ",", "conjugacyClassSizes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table1", "=", 
      RowBox[{"N", "[", 
       RowBox[{"table", ",", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"Transpose", "[", "table1", "]"}], "]"}], ".", "table1"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
        "conjugacyClassSizes", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "/", "conjugacyClassSizes"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"table1", ".", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"conjugacyClassSizes", " ", 
              RowBox[{"Transpose", "[", "table1", "]"}]}], "]"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"Plus", "@@", "conjugacyClassSizes"}], ")"}]}], "-", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Length", "[", "M", "]"}], "]"}]}], "]"}], "]"}], "]"}], "===", 
      RowBox[{"{", "0", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.626681169399117*^9, 3.626681236064234*^9}, {
  3.626681463930812*^9, 3.626681464600976*^9}, {3.6266814947222633`*^9, 
  3.626681538015633*^9}, {3.626681570857834*^9, 3.626681608259412*^9}, {
  3.62668417570864*^9, 3.626684188137061*^9}, {3.6268184698549013`*^9, 
  3.626818472407775*^9}, {3.626834112275057*^9, 3.6268341574031563`*^9}, {
  3.626834922946801*^9, 3.6268349388200073`*^9}, {3.626835447620901*^9, 
  3.626835579945406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"contextToExpression", "[", "X_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ToExpression", "[", "X", "]"}], "/.", 
     RowBox[{"Global`\[Zeta]", "\[Rule]", "\[Zeta]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.68015209650705*^9, 3.68015215834869*^9}, {
  3.680152324262897*^9, 3.6801523469947157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", "[", "CharacterTable", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CharacterTable", "[", "gapName__", "]"}], ":=", 
   RowBox[{
    StyleBox[
     RowBox[{"CharacterTable", "[", "gapName", "]"}], "Input"], 
    StyleBox["=", "Input"], 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lines", ",", "Xpos", ",", "conjugacyClasses", ",", "representations", 
        ",", "values", ",", "numberOfConjugacyClasses", ",", 
        "parseRepresentation", ",", "result"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lines", "=", 
        RowBox[{"ReadCharacterTable", "[", "gapName", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"lines", ",", 
           RowBox[{"s_String", "/;", 
            RowBox[{"StringMatchQ", "[", 
             RowBox[{"s", ",", 
              RowBox[{"\"\<X.\>\"", "~~", "___"}]}], "]"}]}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conjugacyClasses", "=", 
        RowBox[{"lines", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"Min", "[", "Xpos", "]"}], "-", "2"}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"representations", "=", 
        RowBox[{
        "lines", "\[LeftDoubleBracket]", "Xpos", "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"values", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", "Xpos", "]"}], "+", "1"}], ">", 
           RowBox[{"Length", "[", "lines", "]"}]}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"lines", ",", 
              RowBox[{
               RowBox[{"Max", "[", "Xpos", "]"}], "+", "1"}]}], "]"}], ",", 
            RowBox[{"s_String", "/;", 
             RowBox[{"!", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"s", ",", 
                RowBox[{"Whitespace", "~~", "\"\<= \>\"", "~~", "___"}]}], 
               "]"}]}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numberOfConjugacyClasses", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"conjugacyClasses", ",", "Whitespace"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"values", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"#", ",", "\"\< = \>\""}], "]"}], "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n_", ",", "v_"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"n", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"contextToExpression", "[", 
               RowBox[{"StringReplace", "[", 
                RowBox[{"v", ",", 
                 RowBox[{
                  RowBox[{"\"\<E(\>\"", "~~", 
                   RowBox[{"k", ":", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", 
                   "\"\<)\>\""}], "\[RuleDelayed]", 
                  RowBox[{
                  "\"\<\[Zeta][\>\"", "<>", "k", "<>", "\"\<]\>\""}]}]}], 
                "]"}], "]"}], ")"}]}]}]}], "&"}], "/@", "values"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parseRepresentation", "[", "line_", "]"}], ":=", 
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"Rest", "[", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"line", ",", "Whitespace"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<.\>\"", "\[Rule]", "\"\<0\>\""}], "}"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", "NumberString"}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"contextToExpression", "[", "n", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"\"\<-\>\"", "~~", 
                RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"\"\<\\\\*\>\"", "~~", 
                RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"UniqueGaloisConjugate", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"\"\<-\\\\*\>\"", "~~", 
                RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"-", 
             RowBox[{"UniqueGaloisConjugate", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"n", ",", "2"}], "]"}], "/.", "values"}], ")"}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"\"\</\>\"", "~~", 
                RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"AlgebraicConjugate", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"\"\<-/\>\"", "~~", 
                RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"-", 
             RowBox[{"AlgebraicConjugate", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"n", ",", "2"}], "]"}], "/.", "values"}], ")"}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"n", ",", 
               RowBox[{"LetterCharacter", ".."}]}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"n", "/.", "values"}], ")"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"parseRepresentation", "/@", "representations"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"VerifyUnitarityNumerically", "[", "result", "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Something went wrong; the character table doesn't look right: \
\>\"", "]"}], ";", 
          RowBox[{"Print", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"TableForm", "[", "lines", "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626596234236416*^9, 3.626596276017675*^9}, {
   3.6265963069033813`*^9, 3.626596310420295*^9}, {3.626596360126576*^9, 
   3.6265963750628633`*^9}, {3.626596424222068*^9, 3.626596581962577*^9}, {
   3.626597678741082*^9, 3.6265978229686737`*^9}, {3.6265979151464443`*^9, 
   3.626598107357348*^9}, {3.626598148858068*^9, 3.626598154988405*^9}, {
   3.626598215619999*^9, 3.62659822502139*^9}, {3.6265982566885757`*^9, 
   3.626598257583007*^9}, {3.626598287676174*^9, 3.6265983776860323`*^9}, {
   3.626667039761416*^9, 3.626667064639202*^9}, {3.626680350533383*^9, 
   3.626680407546751*^9}, {3.626680476033584*^9, 3.6266804857850733`*^9}, {
   3.626681616352686*^9, 3.626681651898209*^9}, 3.6266816887039347`*^9, {
   3.626818476095702*^9, 3.62681847857191*^9}, {3.62683552998414*^9, 
   3.626835531094002*^9}, {3.626835627235353*^9, 3.6268356380877132`*^9}, {
   3.67358902604956*^9, 3.673589039759945*^9}, {3.68015216892763*^9, 
   3.680152171206592*^9}, 3.680187666203034*^9, 3.680545651853711*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveCharacterTables", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"DownValues", "[", "CharacterTable", "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<characterTables.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadCharacterTables", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<characterTables.m\>\""}], "}"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "CharacterTable", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "CharacterTable", "]"}]}]}], ";"}], 
       ")"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.673623871088582*^9, 3.673623903004717*^9}, {
  3.6736294556006107`*^9, 3.673629456476226*^9}, {3.680150197835127*^9, 
  3.680150198910924*^9}, {3.6803423154091473`*^9, 3.680342343444729*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadCharacterTables", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680266165463256*^9, 3.680266168051859*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conjugacy classes", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321114221084*^9, 3.674321119728623*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConjugacyClassOf", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassOf", "[", "q_", "]"}], "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjugacyClassOf", "[", "q", "]"}], "[", "m", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cmd", ",", "lines"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cmd", "=", 
       RowBox[{"\"\<Position(ConjugacyClasses(\>\"", "<>", 
        RowBox[{"GAP", "[", 
         RowBox[{"SL", "[", 
          RowBox[{"2", ",", 
           SubscriptBox["Z", "q"]}], "]"}], "]"}], "<>", 
        "\"\<),ConjugacyClass(\>\"", "<>", 
        RowBox[{"GAP", "[", 
         RowBox[{"SL", "[", 
          RowBox[{"2", ",", 
           SubscriptBox["Z", "q"]}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "m", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
            RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}], 
        "<>", "\"\<*One(Integers mod \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<)));\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Execute", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"lines", "\[LeftDoubleBracket]", 
          RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673249299683311*^9, 3.6732494002702703`*^9}, {
  3.6732496734177427`*^9, 3.673249706656019*^9}, {3.673249743824984*^9, 
  3.67324975443012*^9}, {3.673249849385849*^9, 3.673249931347777*^9}, {
  3.673262992079442*^9, 3.6732630551772757`*^9}, {3.673271348369938*^9, 
  3.673271402645377*^9}, {3.673271444079761*^9, 3.673271454151167*^9}, {
  3.673271505632031*^9, 3.67327155836096*^9}, {3.673271836746817*^9, 
  3.673271848041964*^9}, {3.6735893766065187`*^9, 3.6735893876177273`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveConjugacyClasses", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], "}"}],
          "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}], 
          ",", 
          RowBox[{"r_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"r", ",", "Blank"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
          "}"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}], ",", 
          RowBox[{"r_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"r", ",", "Blank"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], "}"}],
          "]"}]}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadConjugacyClasses", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], "}"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
          "}"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
             "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}]}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], "}"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
             "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
  3.67977563314568*^9, 3.679775710344492*^9}, {3.680150200069454*^9, 
  3.68015020359295*^9}, {3.680154615081362*^9, 3.680154637487946*^9}, {
  3.680342363319174*^9, 3.680342392829647*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassesOfGalois", "[", "q_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"ConjugacyClassesOfGalois", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"galois", ",", "cmd", ",", "lines"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"galois", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"GaloisGroup", "[", "q", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
           RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{"\"\<m := \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], " ", "<>", 
        "\"\<;; G := Group([[[0,1],[-1,0]],[[1,1],[0,1]]]*One(Integers mod \
m));; cc := ConjugacyClasses(G);; List(\>\"", "<>", "galois", "<>", 
        "\"\<, n -> Position(cc,ConjugacyClass(G,[[n, 0], [0, \
n^(-1)]]*One(Integers mod m))));\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Execute", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GaloisGroup", "[", "q", "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"lines", "\[LeftDoubleBracket]", 
                RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
               RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], 
            "]"}], "]"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679774791057385*^9, 3.679774811247024*^9}, {
   3.679774954208333*^9, 3.679775046641527*^9}, {3.679775487884172*^9, 
   3.6797755087709723`*^9}, 3.6797755423582582`*^9, {3.679775591220932*^9, 
   3.679775608446178*^9}, {3.680154215003539*^9, 3.680154219380002*^9}, {
   3.680154261259097*^9, 3.6801543065778646`*^9}, {3.6801544244547*^9, 
   3.680154466123228*^9}, {3.680154532658349*^9, 3.6801545738499613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cmd", ",", "lines"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{"\"\<m := \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], " ", "<>", 
        "\"\<;; G := Group([[[0,1],[-1,0]],[[1,1],[0,1]]]*One(Integers mod \
m));; cc := ConjugacyClasses(G);; List([0..(m-1)], n -> \
Position(cc,ConjugacyClass(G,[[1, n], [0, 1]]*One(Integers mod \
m))));\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Execute", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"lines", "\[LeftDoubleBracket]", 
            RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
           RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679774791057385*^9, 3.679774811247024*^9}, {
   3.679774954208333*^9, 3.679775046641527*^9}, {3.679775487884172*^9, 
   3.6797755087709723`*^9}, 3.6797755423582582`*^9, {3.679775591220932*^9, 
   3.679775608446178*^9}}],

Cell[BoxData[
 RowBox[{"LoadConjugacyClasses", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680266178294631*^9, 3.680266181814823*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321141515586*^9, 3.67432114502276*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisMatrix", "[", 
   RowBox[{"n_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisMatrix", "[", 
    RowBox[{"n", ",", "l"}], "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"s", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"t", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"c", ".", "s", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"PowerMod", "[", 
             RowBox[{"l", ",", 
              RowBox[{"-", "1"}], ",", "n"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "s", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "l"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "s", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"PowerMod", "[", 
             RowBox[{"l", ",", 
              RowBox[{"-", "1"}], ",", "n"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "n"}], "]"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590189650071*^9, 3.673590261909614*^9}, {
  3.6790269233476963`*^9, 3.679026939436719*^9}, {3.679037657462017*^9, 
  3.679037660370302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"which", " ", "irrep"}], " ", "*)"}], ",", "l_"}], 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisInRepresentation", "[", 
    RowBox[{"q", ",", "k", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "T"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{
        RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{"S", ",", "3"}], "]"}], ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "q"}], "]"}]}], "]"}], ".", "S", ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", "l"}], "]"}], ".", "S", ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "q"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590374432272*^9, 3.6735903953073177`*^9}, {
  3.673590427913817*^9, 3.673590509080974*^9}, {3.673591042404852*^9, 
  3.6735910476763487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockDiagonalMatrix", "=", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "\[Rule]", "#"}], "&"}], ",", 
          "#", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray`SparseBlockMatrix", "[", "r", "]"}], "]"}]}], 
     "]"}], "&"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736109859435673`*^9, 3.6736109902959347`*^9}, {
  3.6736110795350637`*^9, 3.6736110826049*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
      " ", "prime", " ", "powers"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"KroneckerProduct", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GaloisInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"l", ",", 
          RowBox[{
          "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], "]"}], "/.", 
      RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
       RowBox[{"AlgebraicNumberPolynomial", "[", 
        RowBox[{"a", ",", 
         SuperscriptBox[
          RowBox[{"\[Zeta]", "[", "n", "]"}], 
          RowBox[{"n", "/", 
           RowBox[{"identify\[Zeta]", "[", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}]]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], "]"}]}],
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}], ",", "l_"}], "]"}], ":=", 
  RowBox[{"BlockDiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GaloisInRepresentation", "[", 
      RowBox[{"n", ",", "V", ",", "l"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673610854191732*^9, 3.673610899977078*^9}, {
  3.673610997061048*^9, 3.6736110009117203`*^9}, {3.6736110567513*^9, 
  3.673611057801929*^9}, {3.678951495635023*^9, 3.678951509784313*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer", 
    RowBox[{"(*", " ", 
     RowBox[{"which", " ", "irrep"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CharacterTable", "[", 
    RowBox[{"GAP", "[", 
     RowBox[{"SL", "[", 
      RowBox[{"2", ",", 
       SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
   
   RowBox[{"k", ",", 
    RowBox[{"l", "/.", 
     RowBox[{"ConjugacyClassesOfGalois", "[", "q", "]"}]}]}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6735905891227837`*^9, 3.673590649937274*^9}, {
  3.673590718235251*^9, 3.673590732550767*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
      " ", "prime", " ", "powers"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"TraceOfGalois", "[", 
    RowBox[{"n", ",", "ks", ",", "l"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"TraceOfGalois", "[", 
      RowBox[{
       RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Mod", "[", 
        RowBox[{"l", ",", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], "]"}]}],
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}], ",", "l_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"TraceOfGalois", "[", 
     RowBox[{"n", ",", "V", ",", "l"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673591682869156*^9, 3.673591799206078*^9}, 
   3.673597380355487*^9, {3.673597414805829*^9, 3.6735975302214127`*^9}, {
   3.673597762764237*^9, 3.6735977640125837`*^9}, {3.673598245540802*^9, 
   3.673598245737605*^9}, {3.67426847515958*^9, 3.67426848169601*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisGroup", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisGroup", "[", "n", "]"}], "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"i_", "/;", 
      RowBox[{
       RowBox[{"GCD", "[", 
        RowBox[{"i", ",", "n"}], "]"}], "\[Equal]", "1"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaloisConjugates", "[", "n_", "]"}], "[", 
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"s_", ",", "a_"}], "]"}], "]"}], "/;", 
   RowBox[{"s", "\[Equal]", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"s", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "~", "Join", "~", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"m", "-", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "a", "]"}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaloisConjugates", "[", "n_", "]"}], "[", 
   RowBox[{"k", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"k", ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.624232558998745*^9, 3.624232565589562*^9}, {
   3.624233352200313*^9, 3.624233357314949*^9}, 3.673598837839374*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GaloisInverse", "[", "n_", "]"}], "[", "l_", "]"}], ":=", 
  RowBox[{"PowerMod", "[", 
   RowBox[{"l", ",", 
    RowBox[{"-", "1"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674449370104599*^9, 3.674449389615471*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
    RowBox[{"a", ":", 
     RowBox[{"AlgebraicNumber", "[", 
      RowBox[{"r_", ",", "x_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"r", "\[Equal]", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "a", 
    "]"}], "=", 
   RowBox[{"AlgebraicNumberPolynomial", "[", 
    RowBox[{"a", ",", 
     SuperscriptBox[
      RowBox[{"\[Zeta]", "[", "n", "]"}], "l"]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
   RowBox[{"a", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "a"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.607038844019298*^9, 3.60703891506844*^9}, {
  3.624233495702753*^9, 3.624233503532878*^9}, {3.67360296017706*^9, 
  3.6736029642130413`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "GaloisGroupRepresentatives", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisGroupRepresentatives", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisGroupRepresentatives", "[", "n", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"iterators", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iterators", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], ",", "0", ",", 
           RowBox[{
            RowBox[{"MultiplicativeOrder", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], 
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
              "n"}], "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Rule]", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "&"}],
        "/@", 
       RowBox[{
        RowBox[{"Tally", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}],
                    "}"}]}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"Product", "[", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    RowBox[{"a", "[", "i", "]"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}],
                     "}"}]}], "]"}], ",", "n"}], "]"}]}], "}"}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "iterators"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}], "-", 
             "1"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626391341296324*^9, 3.6263913586984*^9}, {
  3.626391630342885*^9, 3.626391869471766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisGroupElementAsProductOfGenerators", "[", 
   RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"k", "/.", 
   RowBox[{"GaloisGroupRepresentatives", "[", "n", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626391871883709*^9, 3.626391888054914*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "GeneratorsOfUnitsModPrimePower", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679868630069418*^9, 3.6798686309090567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q_", "]"}], "/;", 
   RowBox[{
    RowBox[{"PrimePowerQ", "[", "q", "]"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
     "2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"n", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CoprimeQ", "[", 
           RowBox[{"n", ",", "q"}], "]"}]}], "\[Or]", 
         RowBox[{
          RowBox[{"MultiplicativeOrder", "[", 
           RowBox[{"n", ",", "q"}], "]"}], "\[NotEqual]", 
          RowBox[{
           FractionBox["q", "p"], 
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}]}]}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "n", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.679868197202182*^9, 3.679868199683977*^9}, {
  3.679868229981814*^9, 3.679868406540401*^9}, {3.679868492678746*^9, 
  3.6798685015264397`*^9}, {3.6798685713993883`*^9, 3.679868637789536*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "2", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "4", "]"}], "=", 
   RowBox[{"{", "3", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679869303431965*^9, 3.6798693212406683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q_", "]"}], "/;", 
    RowBox[{
     RowBox[{"PrimePowerQ", "[", "q", "]"}], "\[And]", 
     RowBox[{
      RowBox[{
       RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "==", "2"}]}]}], "/;", 
   RowBox[{"q", "\[GreaterEqual]", "8"}]}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q", "]"}], "="}], "*)"}], 
  
  RowBox[{
   RowBox[{"{", "3", "}"}], "~", "Join", "~", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "/", "2"}], "-", "1"}], ",", 
         RowBox[{
          RowBox[{"q", "/", "2"}], "+", "1"}], ",", 
         RowBox[{"q", "-", "1"}]}], "}"}], ",", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"3", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"q", "-", "1"}], "]"}], ",", "q"}], "]"}]}], "]"}], ",", 
     "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67986888940781*^9, 3.679868983561346*^9}, {
  3.6798690194879837`*^9, 3.6798690477549343`*^9}, {3.6798691321177273`*^9, 
  3.679869186249852*^9}, {3.679869273133142*^9, 3.6798692963107557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GaloisGroupGenerators", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"factors", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
          "&"}], "/@", 
         RowBox[{"FactorInteger", "[", "n", "]"}]}]}], ",", "m"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "factors", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ChineseRemainder", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], 
             RowBox[{"UnitVector", "[", 
              RowBox[{"m", ",", "i"}], "]"}]}], "+", "1"}], ",", "factors"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"g", ",", 
           RowBox[{"GeneratorsOfUnitsModPrimePower", "[", 
            RowBox[{
            "factors", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679869453867043*^9, 3.679869456928082*^9}, {
  3.679869494007004*^9, 3.679869753942749*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explicit representations", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321165053524*^9, 3.6743211700533333`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "irrep"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], 
   "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "irrep"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590374432272*^9, 3.6735903953073177`*^9}, {
  3.673590427913817*^9, 3.673590509080974*^9}, {3.673591042404852*^9, 
  3.6735910476763487`*^9}, {3.6736272438275137`*^9, 3.673627269125494*^9}, {
  3.67362731226824*^9, 3.673627315932251*^9}, {3.673627400895301*^9, 
  3.673627408330306*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Sometimes", " ", "S", " ", "will", " ", "lie", " ", "in", " ", "an", " ", 
   "even", " ", "larger", " ", "number", " ", 
   RowBox[{"field", "."}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678953240185952*^9, 3.678953253624498*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "KroneckerProduct", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KroneckerProduct", "[", "X_", "]"}], ":=", 
  "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "KroneckerProduct", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680654556952324*^9, 3.6806545845225353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
     " ", "prime", " ", "powers"}], " ", "*)"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"LiftToCommonCyclotomicField", "[", 
   RowBox[{"KroneckerProduct", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], 
         "]"}]}], "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"LiftToCommonCyclotomicField", "[", 
   RowBox[{"BlockDiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", "V"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
     " ", "prime", " ", "powers"}], " ", "*)"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KroneckerProduct", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], 
         "]"}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
    RowBox[{"AlgebraicNumberPolynomial", "[", 
     RowBox[{"a", ",", 
      SuperscriptBox[
       RowBox[{"\[Zeta]", "[", "n", "]"}], 
       RowBox[{"n", "/", 
        RowBox[{"identify\[Zeta]", "[", 
         RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"BlockDiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"TInRepresentation", "[", 
      RowBox[{"n", ",", "V"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673627218103772*^9, 3.673627234370151*^9}, {
  3.673627321188748*^9, 3.673627389199526*^9}, {3.6736275035486383`*^9, 
  3.673627522065069*^9}, {3.673627555335623*^9, 3.673627587665968*^9}, {
  3.673627623289214*^9, 3.673627625562292*^9}, {3.67895402661269*^9, 
  3.678954048612468*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dimensions", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321270562765*^9, 3.674321274248431*^9}, {
  3.680148334483891*^9, 3.680148335318214*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "FPDimensions", ",", "GlobalDimension", ",", "DimensionsFromFusionRules", 
   ",", "DimensionsFromInductionMatrix", ",", 
   "DimensionsFromFusionRulesAndInductionMatrix"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638332140675*^9, 3.679638342505928*^9}, {
  3.679638462415886*^9, 3.679638473728271*^9}, {3.679638672586975*^9, 
  3.6796386789853067`*^9}, {3.679638737650552*^9, 3.679638749821282*^9}, {
  3.679639587897571*^9, 3.679639590474908*^9}, {3.6797159388415337`*^9, 
  3.6797159400950193`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPDimensions", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{
   RowBox[{"FPDimensions", "[", "fr", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", "#", "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Im", "[", "x", "]"}], "\[Equal]", "0"}]}]}], "]"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"fr", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1", ",", "2"}], 
     "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlobalDimension", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{
   RowBox[{"GlobalDimension", "[", "fr", "]"}], "=", 
   RowBox[{
    RowBox[{"ToCyclotomicField", "[", 
     SuperscriptBox[
      RowBox[{"Norm", "[", 
       RowBox[{"FPDimensions", "[", "fr", "]"}], "]"}], "2"], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638332140675*^9, 3.679638342505928*^9}, {
  3.679638462415886*^9, 3.679638473728271*^9}, {3.679638672586975*^9, 
  3.6796386789853067`*^9}, {3.679638737650552*^9, 3.679638749821282*^9}, {
  3.679639587897571*^9, 3.679639590474908*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromFusionRules", "[", "fusion_", "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromFusionRules", "[", "fusion", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", "N"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{"GlobalDimension", "[", "fusion", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"\[ScriptCapitalD]", ",", "_AlgebraicNumber", ",", 
         RowBox[{"identify\[Zeta]", "[", 
          RowBox[{
          "\[ScriptCapitalD]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "_", ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"cachedToNumberField", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\[Zeta]", "[", "N", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"FPDimensions", "[", "fusion", "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638202659284*^9, 3.679638219310869*^9}, {
  3.6796383500375443`*^9, 3.679638446369623*^9}, {3.679638483605053*^9, 
  3.679638500966988*^9}, {3.679638573942164*^9, 3.679638577441923*^9}, {
  3.6796387231846857`*^9, 3.679638723533449*^9}, {3.679638759618478*^9, 
  3.679638771443263*^9}, {3.679638819816077*^9, 3.67963886996809*^9}, {
  3.679638905589645*^9, 3.679638917482868*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
   RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
    RowBox[{"fusion", ",", " ", "induction"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], "=", 
       RowBox[{"DimensionsFromFusionRules", "[", "fusion", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "induction", "]"}], ".", "dims"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796389319558764`*^9, 3.679639018656682*^9}, {
  3.679639578047474*^9, 3.6796395788755198`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromInductionMatrix", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}], 
   "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimensions", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimensions", "=", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ".", 
           "inductionMatrix"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"RootReduce", "[", 
            RowBox[{"#", "/", 
             RowBox[{"Norm", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"dimensions", ",", 
            RowBox[{"d_", "/;", 
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{"NonNegative", "[", "d", "]"}], ")"}]}]}]}], "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"dimensions", "/", 
         RowBox[{"Min", "[", "dimensions", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"ToCyclotomicField", "[", "dimensions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"dimensions", ",", 
          RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
           RowBox[{"identify\[Zeta]", "[", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cachedToNumberField", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sum", "[", 
              RowBox[{
               SuperscriptBox["d", "2"], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "dimensions"}], "}"}]}], "]"}], 
             RowBox[{"1", "/", "2"}]], ",", 
            RowBox[{"\[Zeta]", "[", "n", "]"}]}], "]"}], ",", "dimensions"}], 
         "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744026172470083`*^9, 3.674402703755024*^9}, {
  3.679714132087799*^9, 3.679714172151655*^9}, {3.679715528483037*^9, 
  3.67971554975563*^9}, {3.679715979892489*^9, 3.679716009464252*^9}, {
  3.679716117084673*^9, 3.6797161174351587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromInductionMatrix", "[", 
   RowBox[{"N_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromInductionMatrix", "[", 
    RowBox[{"N", ",", "inductionMatrix"}], "]"}], "=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "dims"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "dims"}], "}"}], "=", 
       RowBox[{
       "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dims", "/.", 
       RowBox[{"x_AlgebraicNumber", "\[RuleDelayed]", 
        RowBox[{"AlgebraicNumberPolynomial", "[", 
         RowBox[{"x", ",", 
          SuperscriptBox[
           RowBox[{"\[Zeta]", "[", "N", "]"}], 
           RowBox[{"N", "/", "n"}]]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673608023923111*^9, 3.67360809867362*^9}, {
  3.673609065365941*^9, 3.673609067483259*^9}, {3.673609112157552*^9, 
  3.6736091145168667`*^9}, {3.6736091529678164`*^9, 3.673609180792027*^9}, {
  3.673609217664603*^9, 3.673609233739463*^9}, {3.679609224236594*^9, 
  3.679609285778534*^9}, {3.679609373755597*^9, 3.679609384248747*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveDimensionsFromInductionMatrix", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], ";", 
    RowBox[{"AbortProtect", "[", 
     RowBox[{"Put", "[", 
      RowBox[{
       RowBox[{"DownValues", "[", "DimensionsFromInductionMatrix", "]"}], ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "dataDirectory", ",", "\"\<dimensionsFromInductionMatrix.m\>\""}], 
         "}"}], "]"}]}], "]"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], ":=", 
  RowBox[{
   RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], "=", 
   RowBox[{
   "LoadDimensionsFromInductionMatrix", "[", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadDimensionsFromInductionMatrix", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", "\"\<dimensionsFromInductionMatrix.m\>\""}], 
        "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DownValues", "[", "DimensionsFromInductionMatrix", "]"}], 
        "=", 
        RowBox[{
         RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
         RowBox[{
         "DownValues", "[", "DimensionsFromInductionMatrix", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.673623871088582*^9, 3.673623903004717*^9}, {
  3.6736294556006107`*^9, 3.673629456476226*^9}, {3.679635020090423*^9, 
  3.6796351797175913`*^9}, {3.6801502048713207`*^9, 3.6801502064871063`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "CheckGaloisVerlinde", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67963946385703*^9, 3.679639466995453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "dimensions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "dimensions"}], "}"}], "=", 
      RowBox[{
      "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckGaloisVerlinde", "[", 
      RowBox[{"n", ",", "dimensions"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674402536323017*^9, 3.674402545026346*^9}, {
  3.6744027193598633`*^9, 3.6744027394071493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", 
   RowBox[{"fusion_FusionRules", ",", 
    RowBox[{"inductionMatrix_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", ",", "dimensions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dimensions", "=", 
      RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
       RowBox[{"fusion", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "_AlgebraicNumber", ",", 
        RowBox[{"identify\[Zeta]", "[", 
         RowBox[{"dimensions", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", "_",
         ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CheckGaloisVerlinde", "[", 
      RowBox[{"N", ",", "dimensions"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674402536323017*^9, 3.674402545026346*^9}, {
  3.6744027193598633`*^9, 3.6744027394071493`*^9}, {3.679639093482317*^9, 
  3.679639218255072*^9}, {3.67963938705122*^9, 3.6796393917223787`*^9}, {
  3.6796394397293158`*^9, 3.679639446194785*^9}, {3.6796394819179792`*^9, 
  3.679639483818695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"dimensions", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"{", 
        RowBox[{"___", "?", "NumericQ"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CheckGaloisVerlinde", "[", 
    RowBox[{"n", ",", "dimensions"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "galoisElements"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "/", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", "l_", "]"}], ":=", 
       RowBox[{
        RowBox[{"S", "[", "l", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "/@", 
         RowBox[{"S", "[", "1", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"galoisElements", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"GroupBy", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"S", "[", "l", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "&"}]}], "]"}], "]"}]}], ")"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NonNegative", "[", "#", "]"}], "\[And]", 
           RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"S", "[", "x", "]"}], "\[LeftDoubleBracket]", "w", 
                 "\[RightDoubleBracket]"}], 
                RowBox[{
                 RowBox[{"S", "[", "y", "]"}], "\[LeftDoubleBracket]", "w", 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"AlgebraicConjugate", "[", 
                 RowBox[{
                  RowBox[{"S", "[", "z", "]"}], "\[LeftDoubleBracket]", "w", 
                  "\[RightDoubleBracket]"}], "]"}]}], 
               RowBox[{
                RowBox[{"S", "[", "1", "]"}], "\[LeftDoubleBracket]", "w", 
                "\[RightDoubleBracket]"}]], ",", 
              RowBox[{"{", 
               RowBox[{"w", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "dimensions", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "galoisElements"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "galoisElements"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "galoisElements"}], "}"}]}], "]"}], "]"}]}], 
        ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674401832147462*^9, 3.674401972442823*^9}, {
  3.674402075082011*^9, 3.67440213459937*^9}, {3.674403333984891*^9, 
  3.6744034791195908`*^9}, {3.674403548058298*^9, 3.674403561062214*^9}, {
  3.6796390752959423`*^9, 3.679639085514188*^9}, {3.679639452419858*^9, 
  3.679639457980597*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois orbits", "Section",
 CellChangeTimes->{{3.680148343494872*^9, 3.680148347669621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisOrbitClumps", "[", 
   RowBox[{"n_", ",", "dimension_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisOrbitClumps", "[", 
    RowBox[{"n", ",", "dimension"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "clumps", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"clumps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"#", "~", "Join", "~", 
           RowBox[{"(", 
            RowBox[{"-", "#"}], ")"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "#2", "]"}], "[", 
             
             FractionBox["#1", 
              RowBox[{
              "dimension", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]], "]"}], 
            RowBox[{
            "dimension", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "&"}], ",", 
          RowBox[{
          "dimension", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"GaloisGroup", "[", "n", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"clumps", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Union", "[", "clumps", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736032941688004`*^9, 3.673603304991187*^9}, {
  3.6736033501877737`*^9, 3.673603415699252*^9}, {3.673850440514183*^9, 
  3.673850443281953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisOrbitClumps", "[", "induction_", "]"}], ":=", 
  RowBox[{"GaloisOrbitClumps", "@@", 
   RowBox[{
   "DimensionsFromInductionMatrix", "[", "induction", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679609667887207*^9, 3.6796097131728497`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "TODO", " ", "this", " ", "could", " ", "be", " ", "tightened", " ", "in", 
   " ", "many", " ", "ways"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744029946276283`*^9, 3.6744030063258247`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "PossibleConductors", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679271857713122*^9, 3.6792718591959476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PossibleConductors", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleConductors", "[", "inductionMatrix", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rank", ",", "inductionsFromOne", ",", "dimensions", ",", 
       "\[ScriptCapitalD]", ",", "n", ",", "primes", ",", "powers", ",", 
       RowBox[{"l", "=", "3"}], ",", "largestClump"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimensions", "=", 
       RowBox[{
        RowBox[{
        "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "dimensions", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rank", "=", 
       RowBox[{"Length", "[", "dimensions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inductionsFromOne", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"largestClump", "=", 
       RowBox[{"Max", "@@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", 
          RowBox[{"GaloisOrbitClumps", "[", "inductionMatrix", "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         SuperscriptBox["d", "2"], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "dimensions"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"identify\[Zeta]", "[", 
        RowBox[{
        "\[ScriptCapitalD]", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"primes", "=", 
       RowBox[{
        RowBox[{"FactorInteger", "[", 
         RowBox[{"AlgebraicNumberNorm", "[", "\[ScriptCapitalD]", "]"}], 
         "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sizeOfOrbit", "[", 
        RowBox[{"p_", ",", "k_"}], "]"}], ":=", 
       RowBox[{
        SuperscriptBox["p", 
         RowBox[{"k", "-", "1"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sizeOfOrbit", "[", 
        RowBox[{"2", ",", "k_"}], "]"}], ":=", 
       RowBox[{"Max", "[", 
        RowBox[{"1", ",", 
         SuperscriptBox["2", 
          RowBox[{"k", "-", "3"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"powers", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"\[Infinity]", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "primes", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Max", "@@", "powers"}], ")"}], "\[GreaterEqual]", "l"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"l", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"powers", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"Length", "[", "primes", "]"}], "}"}]}], "]"}], "]"}],
             ",", 
            RowBox[{"t_", "/;", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"sizeOfOrbit", "[", 
                    RowBox[{
                    RowBox[{
                    "primes", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "primes", "]"}]}], "}"}]}], 
                  "]"}]}], "\[LessEqual]", "largestClump"}], ")"}], "\[And]", 
              
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"sizeOfOrbit", "[", 
                   RowBox[{
                    RowBox[{
                    "primes", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "primes", "]"}]}], "}"}]}], "]"}], 
                "\[LessEqual]", 
                RowBox[{"rank", "-", "inductionsFromOne"}]}], ")"}]}]}]}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          SuperscriptBox["primes", "#"], ")"}]}], "&"}], "/@", "powers"}]}]}],
     "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743188814669943`*^9, 3.674318969796857*^9}, {
  3.67431901242109*^9, 3.674319043968659*^9}, {3.6743190873402147`*^9, 
  3.674319171038666*^9}, {3.6743192400273037`*^9, 3.6743192861735497`*^9}, {
  3.6743194582404222`*^9, 3.674319465357841*^9}, {3.674319896207004*^9, 
  3.674319938566409*^9}, {3.6743199769371843`*^9, 3.674320143366035*^9}, {
  3.67432017950727*^9, 3.674320228605503*^9}, {3.6743202666537313`*^9, 
  3.674320292496298*^9}, {3.6743203626986027`*^9, 3.6743204978411427`*^9}, {
  3.6743205385036*^9, 3.674320605651841*^9}, {3.674320652505465*^9, 
  3.674320702737761*^9}, {3.674320748074478*^9, 3.6743207747924643`*^9}, {
  3.679271784284289*^9, 3.679271843077331*^9}, {3.679609772864616*^9, 
  3.679609796385971*^9}, {3.679609849792782*^9, 3.679609888684486*^9}, {
  3.679716244490705*^9, 3.6797162539136667`*^9}, {3.6797168328095217`*^9, 
  3.6797168668970737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"PossibleGaloisImages", ",", "PossibleGaloisImagesWithSigns"}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267667275382*^9, 3.674267668516333*^9}, {
  3.67428078441434*^9, 3.674280784564576*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n_", ",", "dimensions_", ",", "1"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
           FractionBox["#", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]], "]"}], 
          RowBox[{
          "dimensions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "&"}], "/@", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"#", "|", 
            RowBox[{"(", 
             RowBox[{"-", "#"}], ")"}]}], ",", "1"}], "]"}], "]"}], "&"}], "/@",
        "images"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"PossibleGaloisImages", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673855727505419*^9, 3.673855927276881*^9}, {
  3.6742807393971786`*^9, 3.6742807584666*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n", ",", 
    RowBox[{"DimensionsFromInductionMatrix", "[", 
     RowBox[{"n", ",", "induction"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680368473627098*^9, 3.680368503625592*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PossibleGaloisImagesWithSigns", "[", 
    RowBox[{"n_", ",", "dimensions_", ",", "1"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImagesWithSigns", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImagesWithSigns", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
           FractionBox["#", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]], "]"}], 
          RowBox[{
          "dimensions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "&"}], "/@", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "#", ",", "1"}], "]"}], "~", 
          "Join", "~", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"-", "#"}], ",", "1"}], "]"}]}], ")"}]}], "]"}], "&"}], 
       "/@", "images"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267042641481*^9, 3.6742670649916067`*^9}, 
   3.674267661924692*^9, {3.674280768700495*^9, 3.674280776575099*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{
   "n_Integer", ",", "dimensions_List", ",", "eigenvalues_List", ",", "1"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "i", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{
   "n_Integer", ",", "dimensions_List", ",", "eigenvalues_List", ",", 
    "l_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n", ",", "dimensions", ",", "eigenvalues", ",", "l"}], "]"}], 
   "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
             FractionBox[
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]], "]"}], 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l", "2"], 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "eigenvalues"}], "}"}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", "eigenvalues"}], "}"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "|", 
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ")"}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], ",", "1"}], "]"}], "]"}], "&"}], "/@", "images"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673855727505419*^9, 3.673855927276881*^9}, {
  3.673887255877717*^9, 3.673887375446603*^9}, {3.673888831339181*^9, 
  3.67388883180464*^9}, {3.67439846941578*^9, 3.674398480192709*^9}, {
  3.674448455099105*^9, 3.6744485060729113`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "PossibleGaloisTraces", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742687944821653`*^9, 3.674268795506605*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", "x_List", "}"}], "]"}], ":=", "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", 
    RowBox[{"x_List", ",", "y_List", ",", "z___List"}], "}"}], "]"}], ":=", 
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"Plus", ",", "x", ",", "y", ",", "1"}], "]"}], "]"}], "]"}], 
     ",", "z"}], "}"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680525981651346*^9, 3.680526046109359*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PossibleGaloisTraces", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisTraces", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"images", ",", "contributions"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
          RowBox[{"PossibleGaloisImagesWithSigns", "[", 
           RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", "k"}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], ">", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "k"}]}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], ">", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", "k"}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "==", "1"}]}]}], ":=", 
       RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "k"}]}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "==", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"i", ",", "k"}], "]"}]}], "\[And]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"i", ",", 
            RowBox[{"-", "k"}]}], "]"}]}]}]}], ":=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"possibleSums", "[", 
       RowBox[{"contributions", "/@", "images"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisTraces", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"PossibleGaloisTraces", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267099521884*^9, 3.674267338967619*^9}, {
  3.674267390681664*^9, 3.6742674321482*^9}, {3.674267647867557*^9, 
  3.674267652962418*^9}, {3.674267824736973*^9, 3.674267840595292*^9}, {
  3.6742688274630213`*^9, 3.6742688658937187`*^9}, {3.674269046589498*^9, 
  3.674269050949356*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MaximumGaloisFixedPoints", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MaximumGaloisFixedPoints", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "}"}], ",", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"d_", "/;", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ga", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
              
              FractionBox["d", "\[ScriptCapitalD]"], "]"}], 
             "\[ScriptCapitalD]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"ga", "\[Equal]", "d"}], "||", 
           RowBox[{"ga", "\[Equal]", 
            RowBox[{"-", "d"}]}]}]}], "]"}]}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MaximumGaloisFixedPoints", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"MaximumGaloisFixedPoints", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673598452031055*^9, 3.673598548901844*^9}, {
  3.67359862857131*^9, 3.6735986349487057`*^9}, {3.673598721337178*^9, 
  3.673598813895955*^9}, {3.673599092986308*^9, 3.673599129159224*^9}, {
  3.6735992620608997`*^9, 3.67359931667159*^9}, {3.673599405086472*^9, 
  3.673599426907958*^9}, {3.6735995374593897`*^9, 3.673599567194325*^9}, {
  3.673603311031201*^9, 3.6736033196752462`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Representations of SL(2, Z)", "Section",
 CellChangeTimes->{{3.6801484516644583`*^9, 3.6801484627752934`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RepresentationSign", "[", 
    RowBox[{"q_", ",", "k_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"RepresentationSign", "[", 
    RowBox[{"q", ",", "k"}], "]"}], "=", 
   RowBox[{"Sign", "[", 
    RowBox[{
     RowBox[{"CharacterTable", "[", 
      RowBox[{"GAP", "[", 
       RowBox[{"SL", "[", 
        RowBox[{"2", ",", 
         SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"ConjugacyClassOf", "[", "q", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], 
     "\[RightDoubleBracket]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationSign", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"RepresentationSign", "[", 
     RowBox[{
      RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ts"}], "}"}], "]"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6732717781129017`*^9, 3.673271805239646*^9}, {
  3.6732718544660397`*^9, 3.673271897463438*^9}, {3.673272383959339*^9, 
  3.673272386489653*^9}, {3.674228163706032*^9, 3.674228226867364*^9}, {
  3.674302977413322*^9, 3.674302982155661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"totalModOne", "[", "x___", "]"}], ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"{", "x", "}"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674315127331531*^9, 3.6743151423848457`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TEigenvalues", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"N", ",", "t"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"primePowers", "=", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], "&"}],
         "/@", 
        RowBox[{"FactorInteger", "[", "N", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{"totalModOne", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TEigenvalues", "[", 
            RowBox[{
             RowBox[{
             "primePowers", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "primePowers", "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TEigenvalues", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"TEigenvalues", "[", 
     RowBox[{"N", ",", "#"}], "]"}], "&"}], "/@", "ts"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673258489574758*^9, 3.673258720265759*^9}, {
   3.673258756066778*^9, 3.673258763827278*^9}, {3.673258795803809*^9, 
   3.673258798313781*^9}, {3.673258909827633*^9, 3.673258925835452*^9}, {
   3.673259070058572*^9, 3.673259073612702*^9}, {3.673259328898554*^9, 
   3.673259336138247*^9}, {3.6732597430403337`*^9, 3.673259749264928*^9}, {
   3.673271731067898*^9, 3.673271733484187*^9}, {3.673271961448656*^9, 
   3.6732719950497828`*^9}, {3.673273492456805*^9, 3.6732735520355463`*^9}, 
   3.673273804345687*^9, {3.673273847949361*^9, 3.673273862768269*^9}, {
   3.673274049268762*^9, 3.6732740656218357`*^9}, {3.673864002946683*^9, 
   3.673864024751486*^9}, {3.6742236284195127`*^9, 3.674223641977296*^9}, {
   3.674225993421636*^9, 3.674226005055986*^9}, {3.6743151486517687`*^9, 
   3.6743151612258263`*^9}, {3.678846505297694*^9, 3.678846509321157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "\[Chi]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"tr", 
        RowBox[{"(", 
         RowBox[{"M", "^", "r"}], ")"}]}], " ", ")"}], "_", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "0"}], "}"}], "^", 
       RowBox[{"{", 
        RowBox[{"n", "-", "1"}], "}"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "lists", " ", "all", " ", "the", " ", "eigenvalues", " ", 
      "of", " ", "M", " ", "which", " ", "are", " ", "n"}], "-", 
     RowBox[{"th", " ", "roots", " ", "of", " ", 
      RowBox[{"unity", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NewtonsIdentity", "[", 
    RowBox[{"n_", ",", "\[Chi]_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox["m", "n"], ",", 
        RowBox[{"{", 
         RowBox[{"RootReduce", "[", 
          RowBox[{
           FractionBox["1", "n"], 
           RowBox[{"\[Chi]", ".", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"\[Zeta]", "[", "n", "]"}], 
               RowBox[{
                RowBox[{"-", "m"}], " ", "l"}]], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "0", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "}"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791996413000803`*^9, 3.679199755796049*^9}, {
  3.679200491652883*^9, 3.679200496733272*^9}, {3.679201095830701*^9, 
  3.6792010989896927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"q_", ",", "k_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"q", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Chi]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lastTEigenvalues", "=", 
       RowBox[{"{", 
        RowBox[{"q", ",", "k"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{
        RowBox[{"liftCyclotomicNumber", "[", "q", "]"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CharacterTable", "[", 
            RowBox[{"GAP", "[", 
             RowBox[{"SL", "[", 
              RowBox[{"2", ",", 
               SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", 
            RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q", "]"}]}], "}"}]}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NewtonsIdentity", "[", 
       RowBox[{"q", ",", "\[Chi]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674222987365498*^9, 3.6742230157499638`*^9}, {
  3.6742230618338203`*^9, 3.674223088470738*^9}, {3.67422323360533*^9, 
  3.674223399122788*^9}, {3.674223603275249*^9, 3.674223604068536*^9}, {
  3.674224263192213*^9, 3.674224294170306*^9}, {3.674224448588017*^9, 
  3.674224451400116*^9}, {3.6742245145082273`*^9, 3.674224516461429*^9}, {
  3.674228791771707*^9, 3.674228792962185*^9}, {3.674294369672274*^9, 
  3.674294373681929*^9}, {3.674294405165576*^9, 3.674294412489703*^9}, {
  3.674315179133437*^9, 3.674315183663919*^9}, {3.678846394546916*^9, 
  3.678846397576939*^9}, {3.678847927370228*^9, 3.678847927683766*^9}, {
  3.679199765932877*^9, 3.679199772574225*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"liftCyclotomicNumber", "[", "N_", "]"}], "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"liftCyclotomicNumber", "[", "N_", "]"}], "[", "a_AlgebraicNumber",
    "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"liftCyclotomicNumber", "[", "N", "]"}], "[", "a", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"LCM", "[", 
        RowBox[{"N", ",", 
         RowBox[{"identify\[Zeta]", "[", 
          RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AlgebraicNumberPolynomial", "[", 
      RowBox[{"a", ",", 
       SuperscriptBox[
        RowBox[{"\[Zeta]", "[", "n", "]"}], 
        RowBox[{"n", "/", 
         RowBox[{"identify\[Zeta]", "[", 
          RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}]]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673863891547611*^9, 3.673863967979216*^9}, 
   3.6742244547998323`*^9, {3.674224541749132*^9, 3.674224545780651*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveTEigenvalues", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"DownValues", "[", "TEigenvalues", "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<tEigenvalues.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadTEigenvalues", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", "TEigenvalues", "]"}], "=", 
     RowBox[{
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dataDirectory", ",", "\"\<tEigenvalues.m\>\""}], "}"}], 
        "]"}], "]"}], "~", "Join", "~", 
      RowBox[{"DownValues", "[", "TEigenvalues", "]"}]}]}], ";"}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
  3.674225166648288*^9, 3.674225199974859*^9}, {3.680150207668816*^9, 
  3.680150208728025*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationConductor", "[", 
    RowBox[{"N", ",", "t"}], "]"}], "=", 
   RowBox[{"LCM", "@@", 
    RowBox[{"(", 
     RowBox[{"Denominator", "/@", 
      RowBox[{"TEigenvalues", "[", 
       RowBox[{"N", ",", "t"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"LCM", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"RepresentationConductor", "[", 
       RowBox[{"N", ",", "#"}], "]"}], "&"}], "/@", "ts"}], 
    ")"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674223936228441*^9, 3.674223964582719*^9}, {
  3.674224015932994*^9, 3.674224027937842*^9}, {3.67423044054665*^9, 
  3.674230461980967*^9}, {3.674230501524974*^9, 3.674230507862986*^9}, {
  3.674235069291807*^9, 3.674235076259884*^9}, {3.6743152316598167`*^9, 
  3.674315233373547*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RepresentationDimension", "[", 
    RowBox[{"q_", ",", "t_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"RepresentationDimension", "[", 
    RowBox[{"q", ",", "t"}], "]"}], "=", 
   RowBox[{
    RowBox[{"CharacterTable", "[", 
     RowBox[{"GAP", "[", 
      RowBox[{"SL", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"t", ",", "1"}], 
    "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationDimension", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"RepresentationDimension", "[", 
     RowBox[{
      RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PrimePowers", "[", "n", "]"}], ",", "t"}], "}"}], "]"}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationDimension", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"RepresentationDimension", "[", 
     RowBox[{"n", ",", "t"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "ts"}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674224704501307*^9, 3.674224839506255*^9}, {
  3.6742256904203253`*^9, 3.6742256906469507`*^9}, {3.6742944668567343`*^9, 
  3.674294472005439*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addMaps", "[", 
   RowBox[{"m1_", ",", "m2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "keys", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keys", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"m1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "~", "Join", 
        "~", 
        RowBox[{"m2", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"m1", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}], "+", 
         RowBox[{"Replace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"m2", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}]}]}], "&"}], "/@",
       "keys"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674228348363014*^9, 3.674228392788529*^9}, {
  3.67422844424015*^9, 3.674228477669386*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", "4000"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743187590681257`*^9, 3.674318759105624*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankDirty", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674448017847733*^9, 3.67444802434074*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRank", "[", 
   RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationsForRank", "[", 
    RowBox[{"n", ",", "r"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "characterTables", ",", "tuples", ",", "PartialRepresentation", ",", 
       "addRepresentation", ",", "addRepresentations", ",", "representations",
        ",", "factors", ",", "trivial"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Enumerating allowed representation types for conductor \>\"", ",",
         "n", ",", " ", "\"\< and rank \>\"", " ", ",", "r", ",", 
        "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"characterTables", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"CharacterTable", "[", 
          RowBox[{"GAP", "[", 
           RowBox[{"SL", "[", 
            RowBox[{"2", ",", 
             SubscriptBox["Z", "#"]}], "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"PrimePowers", "[", "n", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"characterTables0", "=", "characterTables"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", 
             RowBox[{"Sequence", "@@", " ", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "/@", "characterTables"}], "]"}]}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"PrimePowers", "[", "n", "]"}], "]"}], "-", "1"}]}], 
          "]"}], ",", 
         RowBox[{"t_", "/;", 
          RowBox[{
           RowBox[{"RepresentationDimension", "[", 
            RowBox[{"n", ",", "t"}], "]"}], "\[LessEqual]", "r"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"GroupBy", "[", 
           RowBox[{"tuples", ",", 
            RowBox[{
             RowBox[{"RepresentationConductor", "[", 
              RowBox[{"n", ",", "#"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"!", 
                RowBox[{"Divisible", "[", 
                 RowBox[{
                  RowBox[{
                  "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "#"}], "]"}]}], "&"}], "/@", 
              RowBox[{"Reverse", "[", 
               RowBox[{"PrimePowers", "[", "n", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Rule]", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"Function", "[", 
             RowBox[{"ts", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "ts"}], "]"}], ",", "0"}], "]"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"RepresentationSign", "[", 
                  RowBox[{"n", ",", "ts"}], "]"}]}]}], "}"}]}], "]"}]}], 
           "]"}]}], "&"}], "/@", "tuples"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentation", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "conductor_Integer"}], "]"}], "[", 
        "pr_PartialRepresentation", "]"}], ":=", 
       RowBox[{"{", "pr", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", ":", 
             RowBox[{"{", "__Integer", "}"}]}], ",", "others___"}], "}"}], 
          ",", "conductor_Integer"}], "]"}], "[", 
        RowBox[{"pr", ":", 
         RowBox[{"PartialRepresentation", "[", 
          RowBox[{
           RowBox[{"ts", ":", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ",", 
           "remainingDimension_Integer", ",", "open_List", ",", 
           "signedMultiplicities_List"}], "]"}]}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"max", ",", "min"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"pr0", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"pr", ",", "2"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"max", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{"remainingDimension", "/", 
             RowBox[{"RepresentationDimension", "[", 
              RowBox[{"n", ",", "t"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "check", " ", "that", " ", "either", " ", "this", " ", 
             "representation", " ", "has", " ", "1"}], ",", " ", 
            RowBox[{
            "or", " ", "all", " ", "eigenvalues", " ", "have", " ", 
             "appeared", " ", "previously"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"max", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"max", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"TEigenvalues", "[", 
                   RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}], "\[Or]", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], ",", "open"}], "]"}], 
                  "]"}], "\[Equal]", "0"}]}], ",", "\[Infinity]", ",", "0"}], 
              "]"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"TEigenvalues", "[", 
                 RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}]}], 
             "\[And]", 
             RowBox[{"Negative", "[", 
              RowBox[{"RepresentationSign", "[", 
               RowBox[{"n", ",", "t"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "look", " ", "at", " ", "the", " ", "signed", " ", 
              "multiplicities"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"min", "=", 
              RowBox[{"Min", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"signedMultiplicities", "~", "Join", "~", 
                    RowBox[{"{", 
                    RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}], "/", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}], "/@", 
                 RowBox[{"Tally", "[", 
                  RowBox[{"TEigenvalues", "[", 
                   RowBox[{"n", ",", "t"}], "]"}], "]"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"max", "=", 
              RowBox[{"Min", "[", 
               RowBox[{"max", ",", "min"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"addRepresentation", "[", 
              RowBox[{
               RowBox[{"{", "others", "}"}], ",", "conductor"}], "]"}], "/@", 
             
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
                 "pr", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "PartialRepresentation", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ts", "~", "Join", "~", 
                    RowBox[{"Table", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"{", "k", "}"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"remainingDimension", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"RepresentationDimension", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "[", 
                    RowBox[{"open", ",", 
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "open"}], "\[IndentingNewLine]", 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"addMaps", "[", 
                    RowBox[{"signedMultiplicities", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Rule", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", " ", 
                    RowBox[{"RepresentationSign", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}]}], "}"}], "#"}], ")"}]}],
                     "&"}], "/@", 
                    RowBox[{"Tally", "[", 
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "max"}], "}"}]}], "]"}]}], 
            ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentations", "[", 
         RowBox[{"{", "}"}], "]"}], "[", "pr_PartialRepresentation", "]"}], ":=", 
       RowBox[{"{", "pr", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentations", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"conductor_Integer", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ts", ":", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ")"}]}], 
           ",", "others___"}], "}"}], "]"}], "[", "pr_PartialRepresentation", 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{
            RowBox[{"addRepresentation", "[", 
             RowBox[{"ts", ",", "conductor"}], "]"}], "[", "pr", "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Length", "[", "result", "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "if", " ", "the", " ", "conductor", " ", "is", " ", "a", " ", 
             "prime", " ", "power"}], ",", " ", 
            RowBox[{
            "make", " ", "sure", " ", "that", " ", "by", " ", "now", " ", 
             RowBox[{"we", "'"}], "ve", " ", "actually", " ", "used", " ", 
             "something", " ", "with", " ", "large", " ", "enough", " ", 
             "conductor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"PrimePowers", "[", "n", "]"}], ",", "conductor"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RepresentationConductor", "[", 
                  RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"result", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"result", ",", 
                RowBox[{
                 RowBox[{"PartialRepresentation", "[", 
                  RowBox[{
                   RowBox[{"Ts", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ",", 
                   "___"}], "]"}], "/;", 
                 RowBox[{"Divisible", "[", 
                  RowBox[{
                   RowBox[{"RepresentationConductor", "[", 
                    RowBox[{"n", ",", "Ts"}], "]"}], ",", "conductor"}], 
                  "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Length", "[", "result", "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"addRepresentations", "[", 
              RowBox[{"{", "others", "}"}], "]"}], "/@", "result"}], 
            ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"addRepresentations", "[", 
          RowBox[{"Most", "[", "tuples", "]"}], "]"}], "[", 
         RowBox[{"PartialRepresentation", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"r", "-", "1"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trivial", "=", 
       RowBox[{"tuples", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", "1"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"RepresentationDimension", "[", 
             RowBox[{"n", ",", "#"}], "]"}]}], "}"}], "&"}], ",", 
         "representations", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "~", "Join", "~", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"trivial", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"r", "-", 
              RowBox[{"Total", "[", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}],
              "}"}]}], "]"}]}], "&"}], "/@", "representations"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"TEigenvalues", "[", 
            RowBox[{"n", ",", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}],
           "}"}], "&"}], "/@", "representations"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"representations", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"V_", ",", "Ts_"}], "}"}], "/;", 
          RowBox[{"And", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RepresentationSign", "[", 
                   RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                  ")"}]}], ")"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Count", "[", 
                   RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "Ts"}], 
                ")"}]}], "\[GreaterEqual]", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "Ts", "]"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RepresentationsForRankDirty", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"RepresentationsForRankDirty", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Found \>\"", ",", 
        RowBox[{"Length", "[", "representations", "]"}], ",", 
        "\"\< allowed representation types for conductor \>\"", ",", "n", ",",
         " ", "\"\< and rank \>\"", " ", ",", "r", ",", "\"\<.\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "representations"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674230832416952*^9, 3.67423097617251*^9}, {
   3.6742312886123543`*^9, 3.674231381281761*^9}, {3.674231472859879*^9, 
   3.674231510649126*^9}, {3.674231796961651*^9, 3.6742318248550177`*^9}, {
   3.674232037030352*^9, 3.674232040503496*^9}, {3.674232155963846*^9, 
   3.674232197568727*^9}, {3.674232298235715*^9, 3.674232358973792*^9}, {
   3.674233808511428*^9, 3.67423380906094*^9}, {3.674234153498393*^9, 
   3.674234154515156*^9}, {3.674269145338408*^9, 3.6742691493895597`*^9}, {
   3.67426918602917*^9, 3.674269189281974*^9}, {3.67429378669037*^9, 
   3.674293788666318*^9}, {3.674293846618498*^9, 3.6742938492114143`*^9}, {
   3.674294514517082*^9, 3.674294522489119*^9}, 3.6742945785774403`*^9, {
   3.674296942094186*^9, 3.674296945895481*^9}, {3.674302526221505*^9, 
   3.674302788567927*^9}, {3.674302860916792*^9, 3.674302864075162*^9}, {
   3.674302929516963*^9, 3.6743029396658087`*^9}, {3.674303131426222*^9, 
   3.674303133435749*^9}, {3.6743038594312687`*^9, 3.674303860523182*^9}, {
   3.674303990807996*^9, 3.674304012182138*^9}, {3.67430414688848*^9, 
   3.674304157139578*^9}, {3.674304204022972*^9, 3.674304208503298*^9}, {
   3.674304241951063*^9, 3.674304242269184*^9}, {3.674315307379437*^9, 
   3.674315330152927*^9}, {3.674441912079411*^9, 3.674441912237359*^9}, {
   3.6744480387819223`*^9, 3.674448061397019*^9}, {3.678846747510187*^9, 
   3.678846757726787*^9}, {3.678846902438807*^9, 3.6788469056719*^9}, {
   3.678846975109734*^9, 3.678847018544424*^9}, {3.678847932814382*^9, 
   3.678847933155014*^9}, {3.680154965297255*^9, 3.6801550059865913`*^9}, {
   3.6801660497767887`*^9, 3.680166070192688*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForDimensions", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"dimensions", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalD]_", "?", "NumericQ"}], ",", 
       RowBox[{"{", 
        RowBox[{"__", "?", "NumericQ"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationsForDimensions", "[", 
    RowBox[{"N", ",", "dimensions"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RepresentationsForRankLoaded", ",", "N"}], "]"}]}], ",", 
        RowBox[{"LoadRepresentationsForRank", "[", "N", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"RepresentationsForRank", "[", 
         RowBox[{"N", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V_", ",", "_"}], "}"}], "/;", "\[IndentingNewLine]", 
         RowBox[{"And", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"PossibleGaloisTraces", "[", 
               RowBox[{"N", ",", "dimensions", ",", "l"}], "]"}], ",", 
              RowBox[{"TraceOfGalois", "[", 
               RowBox[{"N", ",", 
                RowBox[{"V", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "l"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"GaloisGroup", "[", "N", "]"}]}], "}"}]}], "]"}]}]}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673599701496853*^9, 3.673599755282938*^9}, {
   3.6735997992787437`*^9, 3.673599894208951*^9}, {3.673599999721713*^9, 
   3.673600001713118*^9}, {3.673600197801176*^9, 3.673600202256765*^9}, {
   3.673604605175838*^9, 3.6736046524432707`*^9}, {3.6736093862036057`*^9, 
   3.673609398020556*^9}, {3.6742677253035316`*^9, 3.6742677462227*^9}, 
   3.6742678589276943`*^9, 3.674268557739408*^9, {3.6742690773237534`*^9, 
   3.6742690882612553`*^9}, {3.674269177188816*^9, 3.674269201387014*^9}, {
   3.6806883828513393`*^9, 3.68068841897427*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForInductionMatrix", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"inductionMatrix", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dimensions", ",", "numberOfObjectsInInductionOfOne", ",", "result"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dimensions", "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"N", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numberOfObjectsInInductionOfOne", "=", 
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
        "inductionMatrix", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"RepresentationsForDimensions", "[", 
         RowBox[{"N", ",", "dimensions"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V_", ",", "Ts_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "Ts", "]"}], ",", "0"}], "]"}], 
          "\[GreaterEqual]", "numberOfObjectsInInductionOfOne"}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Found \>\"", ",", 
       RowBox[{"Length", "[", "result", "]"}], ",", 
       "\"\< allowed representation types for conductor \>\"", ",", "N", ",", 
       " ", "\"\< and induction matrix \>\"", " ", ",", 
       RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}], ",", 
       "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673607852003065*^9, 3.67360798616073*^9}, {
   3.673608028127212*^9, 3.673608028994296*^9}, 3.673608106872764*^9, {
   3.673609323387515*^9, 3.673609329691607*^9}, {3.674269203823463*^9, 
   3.674269213064312*^9}, {3.6742694649269753`*^9, 3.674269465213312*^9}, 
   3.674315419121025*^9, {3.680156653342833*^9, 3.6801566877605753`*^9}, {
   3.680185229079178*^9, 3.680185230059222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankProgress", "[", "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"Max", "@@", 
         RowBox[{"(", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}], 
          ")"}]}]}], ")"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "RepresentationsForRank", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p_", "\[RuleDelayed]", "_"}], ")"}], "/;", 
            RowBox[{"IntegerQ", "[", 
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}]}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}]}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "&"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674353276938614*^9, 3.674353414978703*^9}, {
  3.674353896676588*^9, 3.674353971188244*^9}, {3.6743547909740458`*^9, 
  3.6743547960154543`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SaveRepresentationsForRank", "[", "]"}], ":=", 
   RowBox[{
   "SaveRepresentationsForRank", "/@", "RepresentationsForRankDirty"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadRepresentationsForRank", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadRepresentationsForRank", "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"___", "~~", "\"\<-\>\"", "~~", 
             RowBox[{"(", 
              RowBox[{"n", ":", 
               RowBox[{"(", 
                RowBox[{"DigitCharacter", ".."}], ")"}]}], ")"}], "~~", 
             "\"\<.m.gz\>\""}], "\[RuleDelayed]", 
            RowBox[{"ToExpression", "[", "n", "]"}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"FileNames", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
           "dataDirectory", ",", "\"\<representationsForRank-*.m.gz\>\""}], 
           "}"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
   3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
   3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
   3.674225166648288*^9, 3.674225199974859*^9}, {3.67423591077455*^9, 
   3.674235935569606*^9}, {3.674269218981852*^9, 3.67426924013776*^9}, {
   3.674314656672751*^9, 3.674314771720552*^9}, 3.674314886128626*^9, {
   3.674354843245688*^9, 3.674354884523196*^9}, {3.674354919825839*^9, 
   3.6743550052990513`*^9}, {3.67435503713531*^9, 3.674355080570799*^9}, 
   3.674448111915172*^9, 3.680150209968822*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SaveRepresentationsForRank", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "outputDirectory", ",", "timing"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RepresentationsForRankLoaded", ",", "n"}], "]"}]}], ",", 
        RowBox[{"LoadRepresentationsForRank", "[", "n", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"DownValues", "[", "RepresentationsForRank", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p_", "\[RuleDelayed]", "v_"}], ")"}], "/;", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
              "n"}], "\[And]", 
             RowBox[{"IntegerQ", "[", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
           ")"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
            "\[Rule]", 
            RowBox[{"v", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1", ",", "All", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Nothing to do.\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Exporting data for conductor \>\"", ",", "n", ",", 
           "\"\<. Raw bytes: \>\"", ",", 
           RowBox[{"ByteCount", "[", "data", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outputDirectory", "=", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"dataDirectory", ",", "\"\<representationsForRank\>\""}], 
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
           RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"timing", "=", 
          RowBox[{
           RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
            RowBox[{"GZIP", "[", 
             RowBox[{"data", ",", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"outputDirectory", ",", 
                 RowBox[{"\"\<representationsForRank-\>\"", "<>", 
                  RowBox[{"ToString", "[", "n", "]"}], "<>", 
                  "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<... completed in \>\"", ",", "timing", ",", " ", 
           "\"\< seconds.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"RepresentationsForRankDirty", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"RepresentationsForRankDirty", ",", "n"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadRepresentationsForRank", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"file", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"file", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<representationsForRank\>\"", ",", 
         RowBox[{"\"\<representationsForRank-\>\"", "<>", 
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.m.gz\>\""}]}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "file", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"ImportGZIP", "[", "file", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Cases", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n", ",", "k_"}], "}"}], "\[Rule]", "Vs_"}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"RepresentationsForRank", "[", 
              RowBox[{"n", ",", "k"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"ts", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"RepresentationDimension", "[", 
                    RowBox[{"n", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
                    "ts"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", "ts"}]}], 
                  "}"}]}], "]"}], "/@", "Vs"}], ")"}]}], ")"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepresentationsForRankLoaded", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"RepresentationsForRankLoaded", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674354260163171*^9, 3.674354404099144*^9}, {
   3.674354436476481*^9, 3.674354443681622*^9}, {3.6743545871387167`*^9, 
   3.67435458859577*^9}, {3.674354618706223*^9, 3.6743546449714327`*^9}, {
   3.674354760015973*^9, 3.6743547673032*^9}, {3.674355793246188*^9, 
   3.6743558054783688`*^9}, {3.67435689163768*^9, 3.674356909120037*^9}, {
   3.67435697801904*^9, 3.6743570378173437`*^9}, {3.674448075666171*^9, 
   3.674448096365569*^9}, {3.674483826516465*^9, 3.6744838607585583`*^9}, {
   3.674488731007412*^9, 3.67448873253117*^9}, {3.674488831838587*^9, 
   3.674488859603511*^9}, 3.674490639025166*^9, {3.67449067764618*^9, 
   3.67449071880405*^9}, {3.6744908457838383`*^9, 3.674490878533125*^9}, {
   3.678844687830817*^9, 3.678844730770919*^9}, {3.678845372657634*^9, 
   3.678845375850752*^9}, {3.678845903797264*^9, 3.678845922561534*^9}, {
   3.678855052692078*^9, 3.6788550564379787`*^9}, {3.678857257251955*^9, 
   3.678857259518745*^9}, {3.678934149826137*^9, 3.678934150253211*^9}, {
   3.680150210950354*^9, 3.6801502120133333`*^9}, {3.6801527695450172`*^9, 
   3.680152814773881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankLoaded", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744906686851187`*^9, 3.674490673064184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SaveAll", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"SaveRepresentationsForRank", "[", "]"}], ";", 
    RowBox[{"SaveTEigenvalues", "[", "]"}], ";", 
    RowBox[{"SaveConjugacyClasses", "[", "]"}], ";", 
    RowBox[{"SaveCharacterTables", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"SaveGenerators", "[", "]"}], ";"}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743023871034803`*^9, 3.6743024327250957`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"workOnRepresentations", "[", 
   RowBox[{"conductors_", ",", 
    RowBox[{"rank_:", "\[Infinity]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "status", ",", "min", ",", "i", ",", "timing", ",", "length", ",", 
      RowBox[{"counter", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadRepresentationsForRank", "/@", "conductors"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"status", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "0.0", ",", "0", ",", "0"}], "}"}], "&"}], "/@", 
       "conductors"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Min", "@@", 
          RowBox[{"status", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], ")"}], "<",
         "rank"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", "=", 
         RowBox[{"Min", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"status", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
            RowBox[{
             SuperscriptBox["10.", 
              RowBox[{"-", "4"}]], 
             RowBox[{"status", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"status", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_", ",", "m_", ",", "_", ",", "l_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"m", "+", 
               RowBox[{
                SuperscriptBox["10.", 
                 RowBox[{"-", "4"}]], "l"}]}], "\[LessEqual]", 
              RowBox[{"min", "+", 
               SuperscriptBox["10.", 
                RowBox[{"-", "6"}]]}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Running RepresentationsForRank[\>\"", ",", 
          RowBox[{"status", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          "\"\<,\>\"", ",", 
          RowBox[{
           RowBox[{"status", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", "1"}], 
          ",", " ", "\"\<] ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"timing", ",", "length"}], "}"}], "=", 
         RowBox[{"AbsoluteTiming", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"RepresentationsForRank", "[", 
            RowBox[{
             RowBox[{"status", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"status", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
              "1"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Took \>\"", ",", "timing", ",", "\"\< seconds.\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Found \>\"", ",", "length", ",", "\"\< decompositions.\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "status", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"status", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "timing",
            ",", 
           RowBox[{
            RowBox[{"status", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", "1"}], 
           ",", "length"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"status", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"status", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "rank", ",", "_"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Finished ... saving results.\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"SaveRepresentationsForRank", "/@", "conductors"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674235251575635*^9, 3.674235528107317*^9}, {
   3.6742356344376*^9, 3.674235739506126*^9}, 3.674269550050127*^9, {
   3.674304371057325*^9, 3.6743044075105953`*^9}, {3.674304591763979*^9, 
   3.674304606874475*^9}, {3.674305919377289*^9, 3.674305922317007*^9}, {
   3.674356583449444*^9, 3.67435664329037*^9}, {3.6743679364542522`*^9, 
   3.674367951776993*^9}, {3.674367990851894*^9, 3.674367999455201*^9}, {
   3.674467197297576*^9, 3.674467205159286*^9}, {3.679276235641449*^9, 
   3.6792762367121363`*^9}, {3.680688348549494*^9, 3.680688366495412*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Allocating eigenvalues", "Section",
 CellChangeTimes->{{3.680148587893887*^9, 3.680148592652047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LiftsOf1", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}], ",", "1"}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6738498530548143`*^9, 3.6738498586415358`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListDifference", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a___", ",", "b_", ",", "c___"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b_", ",", "d___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"ListDifference", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "c"}], "}"}], ",", 
    RowBox[{"{", "d", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListDifference", "[", 
   RowBox[{"L_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "L"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673851012734758*^9, 3.6738510449309998`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToGaloisOrbitClumps", "[", 
   RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outputDirectory", ",", "filename", ",", "liftsOf1", ",", "result", ",", 
      "EigenvalueClumps", ",", "allocations", ",", 
      "AllocateEigenvaluesToGaloisOrbitClumpsImpl", ",", 
      "AllocateEigenvaluesToGaloisOrbitClumpsImpl0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToGaloisOrbitClumps\>\""}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", "inductionMatrix", "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Allocating T-eigenvalues to Galois orbit clumps for \>\"", ",", 
          
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", "X___", "]"}], ":=", 
         RowBox[{
          RowBox[{
          "AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", "X", "]"}], "=", 
          RowBox[{
          "AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", "X", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", "}"}]}], "]"}], ":=", 
         RowBox[{"{", "allocations", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eigenvalues_", ",", "0", ",", 
               RowBox[{"minimumAllowedClump_:", "1"}]}], "}"}], ",", 
             "otherEigenvalues___"}], "}"}]}], "]"}], ":=", 
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations", ",", 
           RowBox[{"{", "otherEigenvalues", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eigenvalues_", ",", "multiplicity_", ",", 
               RowBox[{"minimumAllowedClump_:", "1"}]}], "}"}], ",", 
             "otherEigenvalues___"}], "}"}]}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "positions", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "decide", " ", "which", " ", "clumps", " ", "have", " ", "enough",
              " ", "room"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"positions", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"allocations", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"simples_", ",", "allocatedEigenvalues_"}], "}"}],
                    "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "simples", "]"}], "-", 
                    RowBox[{"Length", "[", "allocatedEigenvalues", "]"}], "-", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"simples", ",", 
                    RowBox[{"Alternatives", "@@", "liftsOf1"}]}], "]"}], "-", 
                    
                    RowBox[{"Count", "[", 
                    RowBox[{"allocatedEigenvalues", ",", "0"}], "]"}], "-", 
                    RowBox[{"Count", "[", 
                    RowBox[{"eigenvalues", ",", "0"}], "]"}]}], ")"}], ",", 
                    "0"}], "]"}]}], "\[GreaterEqual]", 
                    RowBox[{"Length", "[", "eigenvalues", "]"}]}], ")"}]}], 
                  ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"p_", "/;", 
                RowBox[{"p", "\[GreaterEqual]", "minimumAllowedClump"}]}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", "p", "}"}], ",", 
                 RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
                  RowBox[{
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"allocations", ",", 
                    RowBox[{"p", "\[Rule]", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{
                    "allocations", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"2", "\[Rule]", 
                    RowBox[{
                    RowBox[{"allocations", "\[LeftDoubleBracket]", 
                    RowBox[{"p", ",", "2"}], "\[RightDoubleBracket]"}], "~", 
                    "Join", "~", "eigenvalues"}]}]}], "]"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"eigenvalues", ",", 
                    RowBox[{"multiplicity", "-", "1"}], ",", "p"}], "}"}], 
                    ",", "otherEigenvalues"}], "}"}]}], "]"}]}], "]"}], "/@", 
               "positions"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"{", "}"}], "]"}], ":=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"eigenvalues", ":", 
           RowBox[{"{", 
            RowBox[{"__", "?", "NumericQ"}], "}"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"EigenvalueClumps", "[", "eigenvalues", "]"}], "=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "clump", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"clump", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["l", "2"], 
                    RowBox[{
                    "eigenvalues", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "clump", "}"}], "~", "Join", "~", 
              RowBox[{"EigenvalueClumps", "[", 
               RowBox[{"ListDifference", "[", 
                RowBox[{"eigenvalues", ",", "clump"}], "]"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"eigenvalueLists", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"__", "?", "NumericQ"}], "}"}], ".."}], "}"}]}], "]"}], 
         ":=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"EigenvalueClumps", "[", "#", "]"}], "&"}], "/@", 
            "eigenvalueLists"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"liftsOf1", "=", 
         RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allocations", "=", 
         RowBox[{"RepresentationsForInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"representation", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"representation", "~", "Join", "~", 
                 RowBox[{"{", "#", "}"}]}], "&"}], "/@", 
               RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"GaloisOrbitClumps", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"DimensionsFromInductionMatrix", "[", 
                    RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"Tally", "[", 
                  RowBox[{"EigenvalueClumps", "[", 
                   RowBox[{
                   "representation", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], "]"}]}]}], 
             "]"}], ",", "allocations"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< ways to allocate T-eigenvalues to the Galois orbit clumps for \
\>\"", ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673848999883732*^9, 3.6738492522886953`*^9}, {
   3.6738498702135344`*^9, 3.673849875961112*^9}, {3.6738512769057302`*^9, 
   3.673851286172144*^9}, {3.6738521787570047`*^9, 3.673852181244804*^9}, 
   3.673852317118577*^9, {3.673856240120695*^9, 3.673856244351918*^9}, 
   3.6738628527322493`*^9, {3.674269575781764*^9, 3.6742695772550163`*^9}, {
   3.678845276978421*^9, 3.678845360259757*^9}, {3.6788454025516567`*^9, 
   3.678845411584402*^9}, {3.678845486864637*^9, 3.678845490220063*^9}, {
   3.6788572347041817`*^9, 3.678857239599328*^9}, {3.678857702275263*^9, 
   3.678857716581044*^9}, {3.678934154942212*^9, 3.678934155826182*^9}, {
   3.67927518382932*^9, 3.679275269077188*^9}, {3.679275319077376*^9, 
   3.6792753471448183`*^9}, {3.6792753838286*^9, 3.679275434621409*^9}, {
   3.679352376490192*^9, 3.679352381492366*^9}, {3.679353282294774*^9, 
   3.679353282462228*^9}, {3.679368373128183*^9, 3.6793683734023237`*^9}, {
   3.679368416970613*^9, 3.679368418131886*^9}, 3.680148569578554*^9, 
   3.680150213116271*^9, {3.680152468620266*^9, 3.6801525207273617`*^9}, {
   3.680156600171886*^9, 3.6801566245536537`*^9}, {3.680166011429926*^9, 
   3.680166033264419*^9}, {3.680166676105117*^9, 3.680166683123006*^9}, {
   3.680177026718829*^9, 3.6801770390569143`*^9}, {3.680184987693706*^9, 
   3.680184994427549*^9}, {3.680302027991516*^9, 3.680302032277274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix", "]"}], "=", 
   
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"GroupBy", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"inductionMatrix", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "#"}], "\[RightDoubleBracket]"}], "&"}]}], "]"}],
      "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673852569995378*^9, 3.6738526492423897`*^9}, {
  3.673852968204924*^9, 3.673852974146366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalenceClassesOfSimples", "[", 
   RowBox[{"induction_", ",", "eigenvalues_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"GroupBy", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", 
        RowBox[{
        "induction", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"induction", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "#1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "eigenvalues", "\[LeftDoubleBracket]", "#1", 
          "\[RightDoubleBracket]"}]}], "}"}], "&"}]}], "]"}], "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67445019381915*^9, 3.674450259987748*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "[", "AllocateEigenvaluesToSimples", "]"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673888999655917*^9, 3.673889000942994*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AllocateEigenvaluesToSimples", "[", 
     RowBox[{"n", ",", "inductionMatrix", ",", "clumps"}], "]"}], "="}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toAssign", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toAssign", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix", "]"}], 
        ",", 
        RowBox[{"Function", "[", 
         RowBox[{"class", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"class", ",", 
                RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}]}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"DimensionsFromInductionMatrix", "[", 
               RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{
               "class", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"AllocateEigenvaluesToSimples", "[", 
       RowBox[{
       "n", ",", "inductionMatrix", ",", "clumps", ",", "toAssign", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"DimensionsFromInductionMatrix", "[", 
             RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
         "]"}], ",", 
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"DimensionsFromInductionMatrix", "[", 
             RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "2"], 
          "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"result", ",", 
       RowBox[{"r_", "/;", 
        RowBox[{"And", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "@@", 
             RowBox[{"(", 
              RowBox[{"Length", "/@", 
               RowBox[{"PossibleGaloisImages", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"DimensionsFromInductionMatrix", "[", 
                  RowBox[{"n", ",", "inductionMatrix"}], "]"}], ",", "r", ",",
                  "l"}], "]"}]}], ")"}]}], "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"GaloisGroupGenerators", "[", "n", "]"}]}], "}"}]}], 
          "]"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673853325922226*^9, 3.673853349737873*^9}, {
   3.6738573048556623`*^9, 3.673857400886141*^9}, {3.673857498569078*^9, 
   3.673857530740897*^9}, {3.673857657556403*^9, 3.673857694211245*^9}, {
   3.673858138463969*^9, 3.673858144938106*^9}, {3.673858714655789*^9, 
   3.673858719844413*^9}, {3.673888885699607*^9, 3.673888988366816*^9}, 
   3.680148617442622*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_", ",", 
    RowBox[{"{", "}"}], ",", "assigned_", ",", "_", ",", "_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "T", ",", "\[ScriptCapitalD]", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "now", " ", "we", " ", "check", " ", "the", " ", "top", " ", "left", 
       " ", "entry", " ", "of", " ", "STS"}], "=", 
      RowBox[{"TST", " ", "exactly"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"Sort", "[", "assigned", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      SuperscriptBox[
       RowBox[{"\[Zeta]", "[", "n", "]"}], 
       RowBox[{"n", " ", "t"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"counter", "++"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", "d"}], "}"}], "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           SuperscriptBox["d", "2"], ")"}], ".", "T"}], "-", 
         "\[ScriptCapitalD]"}], "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "t", "}"}], ",", 
       RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67385289565*^9, 3.673852959640892*^9}, {
   3.673853005497538*^9, 3.673853015670753*^9}, {3.673853289612453*^9, 
   3.673853324352941*^9}, {3.673853359437171*^9, 3.673853367168154*^9}, {
   3.673853516438046*^9, 3.6738535183186483`*^9}, {3.6738539320618277`*^9, 
   3.673853936449142*^9}, {3.6738539927568493`*^9, 3.6738540135919037`*^9}, {
   3.673854196853718*^9, 3.673854200443177*^9}, {3.67385434483575*^9, 
   3.673854411869487*^9}, {3.673856091369698*^9, 3.673856093609171*^9}, {
   3.673856916052457*^9, 3.6738569168296213`*^9}, {3.6738569901476097`*^9, 
   3.673856991989357*^9}, {3.6738570509373417`*^9, 3.673857055827697*^9}, {
   3.6738571779761753`*^9, 3.67385720507815*^9}, {3.6738572430318317`*^9, 
   3.673857245463071*^9}, {3.673857677716651*^9, 3.673857678893882*^9}, {
   3.6743159477201242`*^9, 3.674315968601039*^9}, {3.674318719012391*^9, 
   3.674318719063364*^9}, 3.680148654121207*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_", ",", 
    RowBox[{"{", 
     RowBox[{"toAssign_", ",", "others___"}], "}"}], ",", "assigned_", ",", 
    "partialSum_", ",", "totalRemainingDimension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "subsets", ",", "dims"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"N", "[", "partialSum", "]"}], "]"}], "\[GreaterEqual]", 
       RowBox[{"totalRemainingDimension", "+", "1"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"stoppedEarly", "++"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dims", "=", 
        RowBox[{
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "toAssign"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"clumps", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"simples_", ",", "_"}], "}"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"simples", ",", "toAssign"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"Length", "[", "toAssign", "]"}]}]}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subsets", "=", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}], ",", 
              "toAssign"}], "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "toAssign", "]"}], "}"}]}], "]"}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Union", "[", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"clumps", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "toAssign", "]"}], "}"}]}], "]"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "could", " ", "try", " ", "to", " ", "filter", " ", "the",
           " ", "subsets", " ", "early"}], ",", " ", 
         RowBox[{
         "checking", " ", "compatibility", " ", "with", " ", "possible", " ", 
          "Galois", " ", 
          RowBox[{"actions", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"for", " ", "now"}], ",", " ", 
         RowBox[{
         "we", " ", "just", " ", "check", " ", "after", " ", "all", " ", 
          "have", " ", "been", " ", "allocated"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"subset", ",", 
            RowBox[{"AllocateEigenvaluesToSimples", "[", 
             RowBox[{"n", ",", "inductionMatrix", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"clumps", ",", 
                RowBox[{"i", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ListDifference", "[", 
                    RowBox[{
                    RowBox[{"clumps", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "toAssign"}], "]"}], ",", 
                   RowBox[{"ListDifference", "[", 
                    RowBox[{
                    RowBox[{"clumps", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    "subset"}], "]"}]}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", "others", "}"}], ",", 
              RowBox[{"assigned", "~", "Join", "~", 
               RowBox[{"Thread", "[", 
                RowBox[{"toAssign", "\[Rule]", "subset"}], "]"}]}], ",", 
              RowBox[{"partialSum", "+", 
               RowBox[{
                RowBox[{"(", 
                 SuperscriptBox["dims", "2"], ")"}], ".", 
                RowBox[{"(", 
                 SuperscriptBox[
                  RowBox[{"\[Zeta]", "[", "n", "]"}], 
                  RowBox[{"n", " ", "subset"}]], ")"}]}]}], ",", 
              RowBox[{"Chop", "[", 
               RowBox[{"totalRemainingDimension", "-", 
                RowBox[{"dims", ".", "dims"}]}], "]"}]}], "]"}]}], "]"}], "/@",
           "subsets"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6738533731159763`*^9, 3.673853500092545*^9}, {
   3.673853555194577*^9, 3.6738536558648853`*^9}, {3.67385371611808*^9, 
   3.673853717760006*^9}, {3.673853814749874*^9, 3.673853872557906*^9}, {
   3.673855347020949*^9, 3.67385536798491*^9}, 3.6738572971195087`*^9, {
   3.673857458586851*^9, 3.673857465644885*^9}, {3.67385770029081*^9, 
   3.673857736735579*^9}, {3.673857800509128*^9, 3.673857808429364*^9}, {
   3.673857887404862*^9, 3.673858060745614*^9}, {3.673858181796905*^9, 
   3.6738581946953487`*^9}, {3.6738585483598757`*^9, 3.673858551534693*^9}, {
   3.6738609747566633`*^9, 3.6738609765947733`*^9}, {3.6738617846703253`*^9, 
   3.6738617850644693`*^9}, {3.674316006974701*^9, 3.6743160070319433`*^9}, {
   3.674316044935124*^9, 3.674316056240445*^9}, {3.6744476352814083`*^9, 
   3.6744476486008787`*^9}, 3.680148633096621*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"outputDirectory", ",", "filename", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", "\"\<allocateEigenvaluesToSimples\>\""}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", "inductionMatrix", "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "A", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "}"}], "&"}], "/@", 
                RowBox[{"AllocateEigenvaluesToSimples", "[", 
                 RowBox[{"n", ",", "inductionMatrix", ",", 
                  RowBox[{
                  "A", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", 
             RowBox[{"AllocateEigenvaluesToGaloisOrbitClumps", "[", 
              RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< candidate T-matrices for \>\"", ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673854443958605*^9, 3.673854536919653*^9}, {
   3.6788455129293823`*^9, 3.678845542755239*^9}, {3.6788572161951723`*^9, 
   3.678857221016027*^9}, {3.678857669248413*^9, 3.678857682998412*^9}, {
   3.678857827230777*^9, 3.678857828265324*^9}, {3.6789341602448177`*^9, 
   3.678934160613752*^9}, {3.679352347976351*^9, 3.679352356108346*^9}, 
   3.679608132128227*^9, 3.680150214294475*^9, {3.680152543129846*^9, 
   3.6801525701085997`*^9}, {3.680156500498102*^9, 3.680156552770372*^9}, {
   3.680165875353547*^9, 3.680165894309963*^9}, {3.680418023772415*^9, 
   3.6804180240657663`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frobenius-Schur indicators", "Section",
 CellChangeTimes->{{3.680148669394021*^9, 3.6801486788050756`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", "k_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dims", ",", "\[ScriptCapitalD]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[ScriptCapitalD]"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "1"}], 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Zeta]", "[", "n", "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", " ", 
              RowBox[{
              "Ts", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
             ")"}], "k"}]], 
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          RowBox[{"inductionMatrix", "\[LeftDoubleBracket]", 
           RowBox[{"m", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679194232652401*^9, 3.679194256513378*^9}, {
  3.6791943555572567`*^9, 3.67919456399506*^9}, {3.679194639766917*^9, 
  3.679194655358815*^9}, {3.679195357226183*^9, 3.6791953590487947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators1", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllocateEigenvaluesToSimples", "[", 
     RowBox[{"n", ",", "inductionMatrix"}], "]"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"a_", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FrobeniusSchurIndicators", "[", 
         RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "[", "1", "]"}], "\[Equal]", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "inductionMatrix", "]"}], ",", "1"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791979365055313`*^9, 3.679197975579067*^9}, 
   3.679202872497254*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FusionPower", "[", "fusion_", "]"}], "[", 
   RowBox[{"i_", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"i", "-", 
      RowBox[{"th", " ", "object"}]}], " ", "*)"}], ",", "k_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"raised", " ", "to", " ", "the", " ", "k"}], "-", 
     RowBox[{"th", " ", "power"}]}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"fusion", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1", ",", "2", ",", "i"}], "\[RightDoubleBracket]"}], 
     ",", "k"}], "]"}], ".", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"fusion", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
     ",", "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679196408602461*^9, 3.67919643060382*^9}, {
  3.679196462144663*^9, 3.67919651638107*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FrobeniusSchurIndicators", "[", 
      RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
     "Ts_", "]"}], "[", 
    RowBox[{"k_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"GCD", "[", 
     RowBox[{"k", ",", "l"}], "]"}], "\[Equal]", "1"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsind", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"FrobeniusSchurIndicators", "[", 
           RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
          "Ts", "]"}], "[", "k", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "k", "]"}], "[", "l", "]"}], "[", 
           RowBox[{"ToNumberField", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\[Zeta]", "[", "k", "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "$Failed", ",", 
          RowBox[{"{", 
           StyleBox[
            RowBox[{"ToNumberField", "::", "nnfel"}], "MessageName"], "}"}]}],
          "]"}], "&"}], "/@", "fsind"}]}], "\[IndentingNewLine]", "]"}], ",", 
    
    StyleBox[
     RowBox[{"ToNumberField", "::", "nnfel"}], "MessageName"]}], 
   StyleBox["]", "MessageName"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", 
   RowBox[{"k_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"GCD", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
          RowBox[{"m", ",", "g"}], "]"}], ".", 
         RowBox[{
          RowBox[{
           RowBox[{"FrobeniusSchurIndicators", "[", 
            RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
           "Ts", "]"}], "[", 
          RowBox[{
           RowBox[{"k", "/", "g"}], ",", 
           RowBox[{"l", "/", "g"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"result", ",", "$Failed"}], "]"}], ",", "result", ",", 
         "$Failed"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791948828602953`*^9, 3.679194915840851*^9}, {
  3.679195189727335*^9, 3.6791952980819902`*^9}, {3.679195362545627*^9, 
  3.6791953688264008`*^9}, {3.679196387593473*^9, 3.679196388791944*^9}, {
  3.679196554153584*^9, 3.67919657562857*^9}, {3.679196610665079*^9, 
  3.679196673630838*^9}, {3.679196707515403*^9, 3.679196707682146*^9}, {
  3.6791983515584106`*^9, 3.6791984100745783`*^9}, {3.6791985688925743`*^9, 
  3.679198623939399*^9}, {3.6806095433965282`*^9, 3.680609625054883*^9}, {
  3.680610343828656*^9, 3.680610354016274*^9}, {3.680610458138578*^9, 
  3.6806105303991337`*^9}, {3.680610609942226*^9, 3.680610619627862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerifyFrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", "k_", "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"traces", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FrobeniusSchurIndicators", "[", "Ts", "]"}], "[", 
              RowBox[{"k", ",", "l"}], "]"}], "\[LeftDoubleBracket]", "m", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "0", ",", 
              RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"traces", ",", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Length", "[", 
           RowBox[{"NewtonsIdentity", "[", 
            RowBox[{"k", ",", "traces"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"-", "\[Infinity]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
        RowBox[{"m", ",", "k"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"m", ",", "1", ",", 
      RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679200152398218*^9, 3.679200297271719*^9}, {
  3.679200421917721*^9, 3.679200427543573*^9}, {3.680609936244033*^9, 
  3.680609951766721*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reportedOnce", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reportFPIndicatorsInBadField", "[", "stuff___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "reportedOnce"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Found a Frobenius-Schur indicator that isn't even in the correct \
field: \>\"", ",", 
        RowBox[{"{", "stuff", "}"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"reportedOnce", "=", "True"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680610074707345*^9, 3.6806101277337627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k0_", ",", "inductionMatrix_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outputDirectory", ",", "filename", ",", "result", ",", "allocated"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators\>\"\
"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k0", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "inductionMatrix"}], "}"}], "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Looking for T-matrices for \>\"", ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", " ", "\"\< \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allocated", "=", 
         RowBox[{"AllocateEigenvaluesToSimples", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<... checking Frobenius-Schur indicators\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pairs", ",", "cachedFrobeniusSchurIndicators", ",", 
             "verifyFrobeniusSchurIndicators"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cachedFrobeniusSchurIndicators", "[", "Ts_", "]"}], 
              "[", "X___", "]"}], ":=", 
             RowBox[{
              RowBox[{
               RowBox[{"cachedFrobeniusSchurIndicators", "[", "Ts", "]"}], 
               "[", "X", "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"FrobeniusSchurIndicators", "[", 
                 RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], 
                "[", "Ts", "]"}], "[", "X", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"verifyFrobeniusSchurIndicators", "[", "Ts_", "]"}], 
              "[", "k_", "]"}], ":=", 
             RowBox[{
              RowBox[{
               RowBox[{"verifyFrobeniusSchurIndicators", "[", "Ts", "]"}], 
               "[", "k", "]"}], "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"traces", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "cachedFrobeniusSchurIndicators", "[", "Ts", "]"}], "[", 
                    RowBox[{"k", ",", "l"}], "]"}], "\[LeftDoubleBracket]", 
                    "m", "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "0", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"traces", ",", "$Failed"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Length", "[", 
                    RowBox[{"NewtonsIdentity", "[", 
                    RowBox[{"k", ",", "traces"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"reportFPIndicatorsInBadField", "[", 
                    RowBox[{
                    "n", ",", "fusion", ",", "inductionMatrix", ",", 
                    "traces"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"-", "\[Infinity]"}]}]}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
                    RowBox[{"m", ",", "k"}], "]"}], "\[LeftDoubleBracket]", 
                   "1", "\[RightDoubleBracket]"}]}], "}"}], 
                "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "1", ",", 
                  RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"AllocateEigenvaluesToSimples", "[", 
                RowBox[{"n", ",", "inductionMatrix"}], "]"}], "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"cachedFrobeniusSchurIndicators", "[", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "1", "]"}], "&"}], 
                "/@", 
                RowBox[{"AllocateEigenvaluesToSimples", "[", 
                 RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}], ";"}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"pairs", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"verifyFrobeniusSchurIndicators", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "k", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "k0"}], "}"}]}], "]"}]}], 
                 "}"}], "&"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                RowBox[{"allocated", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"a_", "/;", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"cachedFrobeniusSchurIndicators", "[", 
                    RowBox[{
                    "a", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "1", "]"}], 
                   "\[Equal]", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "inductionMatrix", "]"}], ",", 
                    "1"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "pairs", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Cases", "[", 
             RowBox[{"pairs", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x_", ",", "v_"}], "}"}], "/;", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&"}], "/@", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"v", ",", "1"}], "]"}]}], "]"}], "===", 
                 RowBox[{"{", "0", "}"}]}]}], "\[RuleDelayed]", "x"}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< T-matrices with good Frobenius-Schur indicators for \>\"", 
          ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", " ", "\"\< \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"TableForm", "[", "#", "]"}], "]"}], "&"}], "/@", 
           "result"}], ";"}], "*)"}], "\[IndentingNewLine]", "result"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791979365055313`*^9, 3.679197975579067*^9}, {
   3.679202175908864*^9, 3.679202323227816*^9}, {3.679202355632428*^9, 
   3.679202359073326*^9}, {3.679202394132509*^9, 3.6792024159502707`*^9}, 
   3.679202526878684*^9, {3.679202584179028*^9, 3.679202633646234*^9}, {
   3.6792026849092283`*^9, 3.679202710766276*^9}, {3.679203329782155*^9, 
   3.679203345365027*^9}, {3.679203411516075*^9, 3.679203416318056*^9}, 
   3.679255852443926*^9, {3.679265409215827*^9, 3.6792654334490967`*^9}, {
   3.679275830500469*^9, 3.67927599788645*^9}, {3.679276053317904*^9, 
   3.679276083063861*^9}, {3.679711299172565*^9, 3.679711308448831*^9}, {
   3.679711339045067*^9, 3.6797113542372303`*^9}, {3.6797114788758373`*^9, 
   3.6797115099430227`*^9}, {3.679711573062524*^9, 3.679711620491478*^9}, 
   3.6801502152098*^9, {3.6801525797872257`*^9, 3.6801526172948008`*^9}, {
   3.680153335858597*^9, 3.6801534059329977`*^9}, {3.680153456733128*^9, 
   3.6801534699982967`*^9}, {3.6801565324610777`*^9, 3.680156543636347*^9}, {
   3.680165918147871*^9, 3.6801659949181232`*^9}, 3.680418035859128*^9, {
   3.68060986329237*^9, 3.6806099134685297`*^9}, {3.680609991339525*^9, 
   3.6806100653050547`*^9}, 3.6806106522170563`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Progress", "[", 
    RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FileNames", "[", 
     RowBox[{"ToFileName", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
        RowBox[{"\"\<*\>\"", "<>", 
         RowBox[{"SHA1", "[", "induction", "]"}], "<>", "\"\<*\>\""}]}], 
       "}"}], "]"}], "]"}], "~", "Join", "~", 
    RowBox[{"FileNames", "[", 
     RowBox[{"ToFileName", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
        RowBox[{"\"\<*\>\"", "<>", 
         RowBox[{"SHA1", "[", 
          RowBox[{"{", 
           RowBox[{"fusion", ",", "induction"}], "}"}], "]"}], "<>", 
         "\"\<*\>\""}]}], "}"}], "]"}], "]"}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796031873527403`*^9, 3.679603226591681*^9}, {
  3.679603540878314*^9, 3.679603570609726*^9}, {3.679603622847403*^9, 
  3.679603634184362*^9}, {3.680150217154623*^9, 3.680150218268345*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"StillTodo", "[", 
    RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"PossibleConductors", "[", "induction", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\</\>\""}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "\"\<,\>\""}],
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Progress", "[", 
         RowBox[{"fusion", ",", "induction"}], "]"}], ",", 
        RowBox[{"s_", "/;", 
         RowBox[{"!", 
          RowBox[{"StringFreeQ", "[", 
           RowBox[{
           "s", ",", 
            "\"\<allocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators\
\>\""}], "]"}]}]}]}], "]"}]}]}], "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796038612976503`*^9, 3.679603978789209*^9}, {
  3.679604013609014*^9, 3.679604071223462*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois actions", "Section",
 CellChangeTimes->{{3.680148720878458*^9, 3.680148724414571*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "disaster"}], ";", " ", 
   RowBox[{"it", " ", "should", " ", "be", " ", "rewritten", " ", "from", " ", 
    RowBox[{"scratch", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.680260493476913*^9, 3.680260505605186*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "PartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674450299905356*^9, 3.6744503007512493`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"l", "\[Rule]", 
       RowBox[{"PossibleGaloisImages", "[", 
        RowBox[{"n", ",", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "induction"}], "]"}], ",", "l"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"EquivalenceClassesOfSimples", "[", "induction", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}], ",", "eigenvalues_List"}], "]"}], 
  ":=", 
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"l", "\[Rule]", 
       RowBox[{"PossibleGaloisImages", "[", 
        RowBox[{"n", ",", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "induction"}], "]"}], ",", "eigenvalues", ",", 
         "l"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"EquivalenceClassesOfSimples", "[", 
     RowBox[{"induction", ",", "eigenvalues"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742806499139*^9, 3.674280682433951*^9}, {
  3.67428083402915*^9, 3.674280834697342*^9}, {3.67428086533123*^9, 
  3.674280867527556*^9}, {3.674448323893629*^9, 3.6744483326234426`*^9}, {
  3.674450128998858*^9, 3.674450187659689*^9}, {3.6744503210646048`*^9, 
  3.6744503282133217`*^9}, {3.674450378684196*^9, 3.674450390939302*^9}, {
  3.674450594326188*^9, 3.674450596797525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitSymmetries", "[", 
   RowBox[{"pga_PartialGaloisAction", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"pga", ",", 
    RowBox[{"2", "\[Rule]", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{"#", ",", "ks"}], "]"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{"#", ",", "ks"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "&"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674450711506619*^9, 3.674450775983185*^9}, {
  3.6744509616120377`*^9, 3.674451047096899*^9}, {3.674451162778809*^9, 
  3.674451210312386*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "RefinePartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6788652728767843`*^9, 3.678865276005679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{"n_", ",", "pga_PartialGaloisAction"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"targets", ",", "l", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "look", " ", "for", " ", "a", " ", "Galois", " ", "element", " ", 
      "which", " ", 
      RowBox[{"isn", "'"}], "t", " ", "determined", " ", 
      RowBox[{"yet", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"targets", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{"images_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "images", "]"}], ">", "1"}]}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targets", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"targets", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], ",", 
            RowBox[{
             RowBox[{"GaloisGroup", "[", "n", "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}]}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "targets", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"we", "'"}], "re", " ", 
         RowBox[{"done", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GaloisAction", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
           RowBox[{
            RowBox[{"list", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "_Integer", "}"}], ".."}], "}"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"Flatten", "[", "list", "]"}]}]}], ",", 
          RowBox[{
          "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{
          RowBox[{"GaloisGroup", "[", "n", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"targets", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"targets", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lastPartialGaloisAction", "=", 
         RowBox[{"RefinePartialGaloisAction", "[", 
          RowBox[{"n", ",", 
           RowBox[{"SplitSymmetries", "[", 
            RowBox[{"pga", ",", 
             RowBox[{"{", "k", "}"}]}], "]"}], ",", "l", ",", "k"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674280498419908*^9, 3.674280641297702*^9}, {
   3.674280845502523*^9, 3.674280974218174*^9}, {3.674281205796764*^9, 
   3.6742812121068068`*^9}, {3.6744506998143063`*^9, 
   3.6744507085775213`*^9}, {3.6744509541634207`*^9, 
   3.6744509549199944`*^9}, {3.674451060655278*^9, 3.674451064939274*^9}, {
   3.678940325809029*^9, 3.678940353949073*^9}, {3.678940428203903*^9, 
   3.678940458244357*^9}, {3.6789406152337427`*^9, 3.6789406204814653`*^9}, {
   3.679870284125452*^9, 3.679870351611068*^9}, 3.67987047617235*^9, 
   3.6798706186546097`*^9, {3.67987069815661*^9, 3.679870727812195*^9}, {
   3.6798709677211113`*^9, 3.679870974256556*^9}, {3.680260286907276*^9, 
   3.68026031822917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"okay", ",", " ", 
      RowBox[{"decide", " ", "where", " ", "l", " ", "sends", " ", "k"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "/.", 
         RowBox[{
         "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"make", " ", "use", " ", "of", " ", 
       RowBox[{"symmetries", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"images", "=", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"images", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{
          "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"RefinePartialGaloisAction", "[", 
          RowBox[{"n", ",", 
           RowBox[{"SplitSymmetries", "[", 
            RowBox[{"pga", ",", 
             RowBox[{"{", "#", "}"}]}], "]"}], ",", "l", ",", "k", ",", 
           RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", "images"}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674280989695241*^9, 3.674281010614181*^9}, {
  3.67428106266956*^9, 3.674281075238667*^9}, {3.6742811671860847`*^9, 
  3.6742812210962667`*^9}, {3.674281425867353*^9, 3.674281426843789*^9}, {
  3.674282386444347*^9, 3.674282389345723*^9}, {3.674450820745191*^9, 
  3.674450902456018*^9}, {3.674450957496279*^9, 3.674450958208515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer", 
    ",", 
    RowBox[{"ms0", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678865354725484*^9, 3.678865361104784*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer", 
    ",", 
    RowBox[{"ms0", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ms", ",", "result", ",", "updateResult", ",", "rank"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          ",", "ms0"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"No", " ", "new", " ", "information"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", "pga", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ms", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{"ms0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ms", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"pga", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "\[Rule]", "images_"}], ")"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"l", "\[Rule]", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "ms", "]"}], "\[Equal]", "1"}], 
                   ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"#", ",", "ms"}], "]"}], "&"}], "/@", "images"}], 
                   ",", "images"}], "]"}], ",", 
                 RowBox[{"k", "\[Rule]", "ms"}]}], "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "And", " ", "now", " ", "we", " ", "should", " ", "propagate", " ",
             "information", " ", "to", " ", "all", " ", "other", " ", 
            "Galois", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"EnforcePartialGaloisActionInverses", "[", 
            RowBox[{"n", ",", "result", ",", "l", ",", "k"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rank", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"pga", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"Fold", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
                 RowBox[{"n", ",", "#1", ",", 
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "l", ",", 
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}], "&"}], ",", 
               RowBox[{"{", "result", "}"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{"List", ",", 
                   RowBox[{"GaloisGroup", "[", "n", "]"}], ",", 
                   RowBox[{"Range", "[", "rank", "]"}]}], "]"}], ",", "1"}], 
                "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"updateResult", "[", "r_", "]"}], ":=", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
               RowBox[{"n", ",", "#1", ",", "#2", ",", "l", ",", "k"}], "]"}],
               "&"}], ",", "r", ",", 
             RowBox[{"GaloisGroup", "[", "n", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"FixedPoint", "[", 
            RowBox[{"updateResult", ",", "result"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742812435042973`*^9, 3.674281332362499*^9}, {
   3.674281376860539*^9, 3.674281572174304*^9}, {3.674281640139617*^9, 
   3.6742817667155037`*^9}, {3.6742818896378927`*^9, 3.674281901599978*^9}, {
   3.674281937539963*^9, 3.674281960507712*^9}, {3.6742820157367887`*^9, 
   3.674282016976523*^9}, {3.674282345958955*^9, 3.674282347566839*^9}, {
   3.6742826025275717`*^9, 3.674282620576961*^9}, {3.674448659566967*^9, 
   3.674448708631042*^9}, {3.6744487585277348`*^9, 3.6744487814134502`*^9}, {
   3.674448945780901*^9, 3.6744489619858418`*^9}, {3.674449066800475*^9, 
   3.6744490754919043`*^9}, {3.674449424217626*^9, 3.6744494542275047`*^9}, 
   3.678864951972045*^9, 3.6788652661204023`*^9, {3.679871671982317*^9, 
   3.6798717068341703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"if", " ", "we", " ", "know", " ", "a", 
     RowBox[{"(", "k", ")"}], " ", "exactly"}], ",", " ", 
    RowBox[{"we", " ", "know", " ", 
     RowBox[{"a", "^", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], 
     RowBox[{"(", 
      RowBox[{"a", 
       RowBox[{"(", "k", ")"}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionInverses", "[", 
     RowBox[{"n_", ",", "pgas_List", ",", "a_Integer", ",", "k_Integer"}], 
     "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"EnforcePartialGaloisActionInverses", "[", 
         RowBox[{"n", ",", "#", ",", "a", ",", "k"}], "]"}], "&"}], "/@", 
       "pgas"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionInverses", "[", 
     RowBox[{
     "n_", ",", "pga_PartialGaloisAction", ",", "a_Integer", ",", 
      "k_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"RefinePartialGaloisAction", "[", 
         RowBox[{"n", ",", "pga", ",", 
          RowBox[{
           RowBox[{"GaloisInverse", "[", "n", "]"}], "[", "a", "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", "k", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "pga", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", "ab", ")"}], 
     RowBox[{"(", "k", ")"}], " ", "must", " ", "be", " ", "a", " ", "subset",
      " ", "of", " ", "a", 
     RowBox[{"(", 
      RowBox[{"b", 
       RowBox[{"(", "k", ")"}]}], ")"}]}], " ", "*)"}], 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
     RowBox[{
     "n_", ",", "pgas_List", ",", "a_Integer", ",", "b_Integer", ",", 
      "k_Integer"}], "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
         RowBox[{"n", ",", "#", ",", "a", ",", "b", ",", "k"}], "]"}], "&"}], 
       "/@", "pgas"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
     RowBox[{
     "n_", ",", "pga_PartialGaloisAction", ",", "a_Integer", ",", "b_Integer",
       ",", "k_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "targets", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"targets", "=", 
        RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "#", "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "k", "\[RightDoubleBracket]"}], ")"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "#", "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "k", "\[RightDoubleBracket]"}], ")"}]}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RefinePartialGaloisAction", "[", 
        RowBox[{"n", ",", "pga", ",", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"a", " ", "b"}], ",", "n"}], "]"}], ",", "k", ",", 
         "targets"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6742817767620707`*^9, 3.674281851207006*^9}, 
   3.674281910236332*^9, {3.67428194061932*^9, 3.674281985604301*^9}, {
   3.674282022615158*^9, 3.674282115891198*^9}, {3.674282288210284*^9, 
   3.6742822903758087`*^9}, {3.6744490262935743`*^9, 3.67444903684886*^9}, {
   3.6744490817318296`*^9, 3.6744492731716557`*^9}, {3.674449410666972*^9, 
   3.6744494143560143`*^9}, {3.674485149865754*^9, 3.674485157147599*^9}, {
   3.680149289753045*^9, 3.6801493112412853`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "CompletePartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742826771450443`*^9, 3.674282681250811*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompletePartialGaloisAction", "[", 
   RowBox[{"n_", ",", "pga_PartialGaloisAction"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "p_PartialGaloisAction", "]"}], ":=", 
      RowBox[{"f", "/@", 
       RowBox[{"RefinePartialGaloisAction", "[", 
        RowBox[{"n", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "ga_GaloisAction", "]"}], ":=", 
      RowBox[{"{", "ga", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"f", "[", "pga", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742824471048183`*^9, 3.674282534918243*^9}, {
   3.674282565141623*^9, 3.674282567295121*^9}, {3.674282635435296*^9, 
   3.674282636795899*^9}, {3.674449597528517*^9, 3.674449599895773*^9}, {
   3.674449818594322*^9, 3.6744499120281343`*^9}, 3.678865018538331*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mkString", "[", 
   RowBox[{"x_List", ",", "sep_"}], "]"}], ":=", 
  RowBox[{"StringJoin", "@@", 
   RowBox[{"(", 
    RowBox[{"ToString", "/@", 
     RowBox[{"Most", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"sep", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "x", "]"}], "}"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744939985828342`*^9, 3.674494044551668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DreadnautPath", "=", "\"\<~/bin/dreadnaut\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680149438588757*^9, 3.680149441131399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NautyHash", "[", "ga_GaloisAction", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "G", ",", "X", ",", "preamble", ",", "edges", ",", "partition", ",", 
      "cmd", ",", "return"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"1", "/.", 
        RowBox[{
        "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preamble", "=", 
      RowBox[{"\"\<c\\nn=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", "+", "2"}], ")"}], "X"}], "]"}], "<>", 
       "\"\< g\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"x", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"g", "+", "1"}], ")"}], "X"}]}], "]"}], "<>", 
                 "\"\< \>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"g", ",", "0", ",", 
                  RowBox[{"G", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
            "\"\<;\\n\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\< \>\"", "<>", 
            RowBox[{"(", 
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ga", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"g", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "/.", 
                    RowBox[{
                    "ga", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"x", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
                   "1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"g", "+", "1"}], ")"}], "X"}]}], "]"}], "<>", 
                 "\"\< \>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"g", ",", "0", ",", 
                  RowBox[{"G", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
            "\"\<;\\n\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
       "\"\<.\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"partition", "=", 
      RowBox[{"\"\<f=[\>\"", "<>", 
       RowBox[{"mkString", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mkString", "[", 
            RowBox[{"#", ",", "\"\<,\>\""}], "]"}], "&"}], "/@", 
          RowBox[{
          "ga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", "\"\<|\>\""}], "]"}], "<>", "\"\<]\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmd", "=", "\"\<x z\\n\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"return", "=", 
      RowBox[{"Run", "[", 
       RowBox[{"DreadnautPath", "<>", "\"\< <<STOP > /tmp/dreadnaut\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<.out\\n\>\"", 
        "<>", "preamble", "<>", "edges", "<>", "partition", "<>", "cmd", 
        "<>", "\"\<STOP\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"return", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Something went wrong while running dreadnaut. Please check you \
have a copy of dreadnaut, and modify \
FusionAtlas`ModularData`Private`DreadnautPath if necessary.\>\"", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\"\<[\>\"", "<>", 
      RowBox[{"StringJoin", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{"\"\</tmp/dreadnaut\>\"", "<>", 
                RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
                "\"\<.out\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "\"\< \>\""}],
           "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], 
        ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744917605198927`*^9, 3.674492110425222*^9}, {
   3.6744922032505503`*^9, 3.6744922358948717`*^9}, {3.6744923115743017`*^9, 
   3.674492334328155*^9}, {3.674492400172408*^9, 3.674492418768852*^9}, {
   3.6744924569797487`*^9, 3.674492592258102*^9}, {3.674493986001691*^9, 
   3.674493994668674*^9}, {3.674494058550083*^9, 3.674494109285931*^9}, {
   3.678934028310841*^9, 3.678934052552066*^9}, 3.67893416801877*^9, {
   3.680149361272994*^9, 3.6801494334283237`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "induction_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CompleteGaloisActions", "[", 
    RowBox[{"n", ",", "induction"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outputDirectory", ",", "filename", ",", "result"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"outputDirectory", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dataDirectory", ",", "\"\<completeGaloisActions\>\""}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"outputDirectory", ",", 
          RowBox[{
           RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
           RowBox[{"SHA1", "[", "induction", "]"}], "<>", "\"\<.m.gz\>\""}]}],
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"GroupBy", "[", 
             RowBox[{
              RowBox[{"CompletePartialGaloisAction", "[", 
               RowBox[{"n", ",", 
                RowBox[{"PartialGaloisAction", "[", 
                 RowBox[{"n", ",", "induction"}], "]"}]}], "]"}], ",", 
              "NautyHash"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"GZIP", "[", 
          RowBox[{"result", ",", "filename"}], "]"}], ";", 
         "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "induction_", ",", "eigenvalues_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CompleteGaloisActions", "[", 
    RowBox[{"n", ",", "induction", ",", "eigenvalues"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"GroupBy", "[", 
      RowBox[{
       RowBox[{"CompletePartialGaloisAction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"PartialGaloisAction", "[", 
          RowBox[{"n", ",", "induction", ",", "eigenvalues"}], "]"}]}], "]"}],
        ",", "NautyHash"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], 
    "\[RightDoubleBracket]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67449429545187*^9, 3.6744943748752327`*^9}, {
   3.674495210462825*^9, 3.674495234385457*^9}, {3.678866158753236*^9, 
   3.6788662015512323`*^9}, {3.67893417762175*^9, 3.6789341779815397`*^9}, {
   3.679870665678906*^9, 3.679870672177642*^9}, {3.67987075468302*^9, 
   3.679870756753233*^9}, 3.680150219003462*^9, {3.680152631346349*^9, 
   3.68015266656318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimplesAndCompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k_", ",", "induction_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", ",", "outputDirectory", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToSimplesAndCompleteGaloisActions\>\""}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "induction"}], "}"}], "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computing Galois actions for \>\"", ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", "\"\< \>\"", ",", 
          RowBox[{"MatrixForm", "[", "induction", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"ga", ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "ga"}], "}"}]}], "]"}], "/@", 
              RowBox[{"CompleteGaloisActions", "[", 
               RowBox[{"n", ",", "induction", ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "]"}]}], "&"}], ",", 
            RowBox[{
            "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", 
             "[", 
             RowBox[{"n", ",", "fusion", ",", "k", ",", "induction"}], 
             "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\< ... finished computing Galois actions.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", "result"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674495512562315*^9, 3.674495598183732*^9}, {
   3.678862006576638*^9, 3.678862049217985*^9}, {3.678862137694745*^9, 
   3.678862146659045*^9}, {3.6788663828843822`*^9, 3.678866384343978*^9}, {
   3.6789341829194727`*^9, 3.678934183249864*^9}, {3.6789603705784473`*^9, 
   3.678960371984145*^9}, {3.6792652922903023`*^9, 3.679265303122703*^9}, {
   3.6792653428074102`*^9, 3.6792653685451803`*^9}, {3.679352447177408*^9, 
   3.679352454826503*^9}, 3.679871089389841*^9, 3.680150220097311*^9, {
   3.6801526746489353`*^9, 3.680152691230196*^9}, {3.680185386710395*^9, 
   3.680185423988091*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalculateGaloisSigns", "[", 
   RowBox[{"n_Integer", ",", "inductionMatrix_", ",", "ga_GaloisAction"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", 
      RowBox[{"dims", "=", 
       RowBox[{"DimensionsFromInductionMatrix", "[", 
        RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ",", "signs"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"signs", "[", 
       RowBox[{"l_", "\[Rule]", "permutation_"}], "]"}], ":=", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"permutation", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "/@", 
             "S1"}], ")"}], "/", 
           RowBox[{
           "S1", "\[LeftDoubleBracket]", "permutation", 
            "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SignedGaloisAction", "[", 
      RowBox[{"signs", "/@", 
       RowBox[{"ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678939903310602*^9, 3.678939957648583*^9}, {
  3.6789400019993362`*^9, 3.678940009808017*^9}, {3.6789400643088713`*^9, 
  3.678940078146984*^9}, {3.678940118475532*^9, 3.678940247159832*^9}, {
  3.67894102426678*^9, 3.6789410811057167`*^9}, {3.678941779446899*^9, 
  3.678941790464007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SignedPermutationMatrix", "[", "signedPermutation_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"Length", "[", "signedPermutation", "]"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"Abs", "[", "signedPermutation", "]"}], "\[RightDoubleBracket]"}], 
   RowBox[{"Sign", "[", "signedPermutation", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67894265764573*^9, 3.678942700693161*^9}, {
  3.678942733226385*^9, 3.678942735858191*^9}, {3.678950318450117*^9, 
  3.6789503200270452`*^9}, {3.6789507281728687`*^9, 3.6789507304065437`*^9}, {
  3.678950891663517*^9, 3.678950909987877*^9}, {3.678951295360633*^9, 
  3.678951296652442*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving equations for Q and S", "Section",
 CellChangeTimes->{{3.68014963155259*^9, 3.680149637969672*^9}, {
  3.680149683916197*^9, 3.680149689663643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QLinearSolutions", "[", 
    RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Vs_", ",", "Ts_"}], "}"}], ",", "ga_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Q", ",", "q", ",", "sga", ",", "dims", ",", "S1", ",", "T", ",", 
      "tEquations", ",", "modularInvariantEquations", ",", "galoisEquations", 
      ",", "galoisOnSEquations", ",", "C", ",", "S2eqCEquations", ",", 
      "inductionEquations", ",", "equations", ",", "Tp", ",", "Sp", ",", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Q", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Preparing to solve linear equations for the change of basis \
matrix...\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tp", "=", 
      RowBox[{"TInRepresentation", "[", 
       RowBox[{"n", ",", 
        RowBox[{"Vs", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Sp", "=", 
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", 
        RowBox[{"Vs", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"\[Zeta]", "[", "n", "]"}], ",", 
         RowBox[{"n", " ", "Ts"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tp", ".", "Q"}], "-", 
        RowBox[{"Q", ".", "T"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<prepared tEquations\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"modularInvariantEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sp", ".", "Q", ".", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"Q", ".", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<prepared modularInvariantEquations\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ga", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sga", "=", 
         RowBox[{"CalculateGaloisSigns", "[", 
          RowBox[{"n", ",", "inductionMatrix", ",", "ga"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"galoisEquations", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"GaloisInRepresentation", "[", 
              RowBox[{"n", ",", 
               RowBox[{"Vs", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ".", "Q"}], "-", 
            RowBox[{"Q", ".", 
             RowBox[{"SignedPermutationMatrix", "[", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{
             "sga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<prepared galoisEquations\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dims", "=", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S1", "=", 
         RowBox[{
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"galoisOnSEquations", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sp", ".", "Q"}], ")"}], "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{"p", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
                "\[RightDoubleBracket]"}], "-", 
              RowBox[{"(", 
               RowBox[{"Q", ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{"p", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"GaloisAction", "[", "n", "]"}], "[", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "/@", "S1"}], ")"}]}], 
                 ")"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", 
               RowBox[{
               "sga", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", "_q"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<prepared galoisOnSEquations\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Flatten", "[", "galoisOnSEquations", "]"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Length", "[", 
            RowBox[{
            "inductionMatrix", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          
          RowBox[{
           RowBox[{"n", "-", "1"}], "/.", 
           RowBox[{
           "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"S2eqCEquations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sp", ".", "Sp", ".", "Q"}], "-", 
           RowBox[{"Q", ".", "C"}]}], "}"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"galoisEquations", "=", 
         RowBox[{"galoisOnSEquations", "=", 
          RowBox[{"S2eqCEquations", "=", 
           RowBox[{"{", "}"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"inductionEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sp", ".", "Q", ".", "T", ".", 
         RowBox[{"Transpose", "[", "inductionMatrix", "]"}]}], "-", 
        RowBox[{"Q", ".", 
         RowBox[{"Inverse", "[", "T", "]"}], ".", 
         RowBox[{"Transpose", "[", "inductionMatrix", "]"}]}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"LiftToCommonCyclotomicField", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
          "tEquations", "~", "Join", "~", "modularInvariantEquations", "~", 
           "Join", "~", "galoisEquations", "~", "Join", "~", 
           "galoisOnSEquations", "~", "Join", "~", "S2eqCEquations", "~", 
           "Join", "~", "inductionEquations"}], "]"}], "]"}], ",", "_q"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<prepared linear equations in Q\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"Q", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{"equations", "\[Equal]", "0"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Something went wrong: here are the equations.\>\"",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "tEquations", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "modularInvariantEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "galoisEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "galoisOnSEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "S2eqCEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<... finished solving linear equations in Q.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "q0", "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"result", "/.", 
         RowBox[{"q", "\[Rule]", "q0"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.67894186404058*^9, {3.678941928978838*^9, 3.678941994622015*^9}, {
   3.678942074005478*^9, 3.678942215092514*^9}, {3.678942251488912*^9, 
   3.678942255361971*^9}, {3.678942504890068*^9, 3.678942651535184*^9}, {
   3.6789427706361437`*^9, 3.678942773085697*^9}, {3.678943007357416*^9, 
   3.678943007924487*^9}, {3.678943599416913*^9, 3.678943607105076*^9}, {
   3.678943957312295*^9, 3.67894406378862*^9}, {3.678944097758643*^9, 
   3.6789440982801323`*^9}, {3.678944163349471*^9, 3.678944187737761*^9}, {
   3.678944259810041*^9, 3.6789442602413*^9}, {3.678944695784174*^9, 
   3.6789447140479383`*^9}, {3.678947854760441*^9, 3.6789478722407007`*^9}, {
   3.678947907325646*^9, 3.67894791260146*^9}, {3.6789480233386106`*^9, 
   3.678948112977208*^9}, {3.678948625581107*^9, 3.678948636086055*^9}, {
   3.6789486875984087`*^9, 3.678948713812855*^9}, {3.678948753368424*^9, 
   3.678948756523959*^9}, {3.6789499483287973`*^9, 3.678949954218809*^9}, 
   3.678950044954679*^9, 3.6789501555901403`*^9, 3.6789503278606653`*^9, 
   3.6789509631898823`*^9, {3.678951046202694*^9, 3.6789510499786263`*^9}, {
   3.678951090944414*^9, 3.6789511243788853`*^9}, {3.678951155250742*^9, 
   3.6789511586971617`*^9}, {3.678951224304226*^9, 3.67895122756946*^9}, 
   3.678951301961378*^9, 3.6789515522393427`*^9, 3.678951797763033*^9, {
   3.6789520953086443`*^9, 3.678952149459362*^9}, {3.6789545358753757`*^9, 
   3.678954553791794*^9}, {3.678954667971245*^9, 3.678954672737598*^9}, {
   3.678954714460308*^9, 3.678954789270318*^9}, {3.678957121496063*^9, 
   3.678957149647298*^9}, {3.678957355213553*^9, 3.678957357469453*^9}, {
   3.678957463700287*^9, 3.678957477923751*^9}, {3.679002367935965*^9, 
   3.679002399216765*^9}, {3.6790024305476103`*^9, 3.6790024990764637`*^9}, {
   3.6790034089793262`*^9, 3.67900344626924*^9}, 3.679016049577244*^9, {
   3.679102069274342*^9, 3.679102080676156*^9}, {3.6791037318673773`*^9, 
   3.679103820326961*^9}, {3.6791039963917637`*^9, 3.679104001555174*^9}, {
   3.679104365792437*^9, 3.679104372009053*^9}, {3.679104436953786*^9, 
   3.679104440672626*^9}, {3.6791167381910143`*^9, 3.679116755035877*^9}, {
   3.6793492001336823`*^9, 3.6793492861391573`*^9}, 3.679349407350236*^9, {
   3.679610997250989*^9, 3.679610998792426*^9}, {3.679611049011742*^9, 
   3.679611091927182*^9}, {3.679645875981351*^9, 3.6796458767493687`*^9}, {
   3.680185434190527*^9, 3.6801854711008167`*^9}, {3.680187601034563*^9, 
   3.680187611818983*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timesToList", "[", "X_Times", "]"}], ":=", 
  RowBox[{"List", "@@", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timesToList", "[", "X_", "]"}], ":=", 
  RowBox[{"{", "X", "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679027913463715*^9, 3.6790279241509953`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AlgebraicDegree", "[", 
   RowBox[{"eqn_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GroebnerBasis`DistributedTermsList", "[", 
       RowBox[{
        RowBox[{"eqn", "/.", 
         RowBox[{"Equal", "\[RuleDelayed]", "Subtract"}]}], ",", "vars"}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AlgebraicDegree", "[", "eqn_", "]"}], ":=", 
  RowBox[{"AlgebraicDegree", "[", 
   RowBox[{"eqn", ",", 
    RowBox[{"Variables", "[", "eqn", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679032294257174*^9, 3.679032296545602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SolveSEquations", "[", 
    RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], "[", 
   RowBox[{"Vs_", ",", "ga_", ",", "Q0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "S", ",", "Sp", ",", "Q", ",", "s", ",", "q", ",", "dims", ",", " ", 
      "S1", ",", "C", ",", "equations", ",", "det", ",", "det0", ",", 
      "variables", ",", "targets", ",", "target", ",", "\[Alpha]", ",", 
      "result", ",", "solutions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sp", "=", 
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", "Vs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "=", "S1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", "S1"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Sp", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"S", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Q0", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Q", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"det0", "=", 
      RowBox[{"Det", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"report", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"report", "[", "X_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "r", "}"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<factoring determinant ...\>\"", "]"}], 
         ";", 
         RowBox[{"r", "=", "X"}], ";", 
         RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], ";", "r"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"det", ":=", 
      RowBox[{"(", 
       RowBox[{"det0", "=", 
        RowBox[{"report", "[", 
         RowBox[{"Factor", "[", 
          RowBox[{"Collect", "[", 
           RowBox[{"det0", ",", "_q"}], "]"}], "]"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"variables", ":=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"timesToList", "[", "det", "]"}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"v", ":", 
            RowBox[{"q", "[", 
             RowBox[{"_", ",", "_"}], "]"}]}], ")"}], "_."], "\[RuleDelayed]",
          "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ga", "===", "Null"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sp", ".", "Q"}], "-", 
          RowBox[{"Q", ".", "S"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C", "=", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", 
             RowBox[{
             "inductionMatrix", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "-", "1"}], "/.", 
            RowBox[{
            "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sp", ".", "Q"}], "-", 
            RowBox[{"Q", ".", "S"}]}], ",", 
           RowBox[{
            RowBox[{"S", ".", "S"}], "-", "C"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"Factor", "[", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"LiftToCommonCyclotomicField", "[", 
          RowBox[{"Flatten", "[", "equations", "]"}], "]"}], ",", 
         RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<found equations\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"targets", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"e_", "/;", 
              RowBox[{
               RowBox[{"AlgebraicDegree", "[", "e", "]"}], "\[Equal]", 
               "1"}]}]}], "]"}], "~", "Join", "~", 
           RowBox[{"Cases", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Alternatives", "@@", "variables"}], ")"}], "X_"}], 
              "\[RuleDelayed]", "X"}]}], "]"}]}]}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<solving: \>\"", " ", ",", "targets"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"targets", "\[Equal]", "0"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"x", "=", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"equations", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Factor", "[", 
             RowBox[{"Collect", "[", 
              RowBox[{"equations", ",", 
               RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}], ",", "0"}], "]"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "variables", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"target", "=", 
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"variables", ",", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"equations", ",", "#", ",", "\[Infinity]"}], "]"}], 
             "&"}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Setting \>\"", ",", "target", ",", " ", "\"\< to 1\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"equations", "=", 
         RowBox[{"equations", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"target", "-", "1"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"targets", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"equations", ",", 
                RowBox[{"e_", "/;", 
                 RowBox[{
                  RowBox[{"AlgebraicDegree", "[", "e", "]"}], "\[Equal]", 
                  "1"}]}]}], "]"}], "~", "Join", "~", 
              RowBox[{"Cases", "[", 
               RowBox[{"equations", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Alternatives", "@@", "variables"}], ")"}], "X_"}],
                  "\[RuleDelayed]", "X"}]}], "]"}]}]}], "]"}], ">", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<solving: \>\"", " ", ",", "targets"}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{"targets", "\[Equal]", "0"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"x", "=", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"equations", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Factor", "[", 
                RowBox[{"Collect", "[", 
                 RowBox[{"equations", ",", 
                  RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}], ",", "0"}], 
              "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<S matrix after solving linear equations:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"S", "/.", 
         RowBox[{"s", "\[Rule]", "Global`s"}]}], ")"}], "//", "MatrixForm"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Q matrix after solving linear equations:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "/.", 
         RowBox[{"q", "\[Rule]", "Global`q"}]}], ")"}], "//", "MatrixForm"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"det", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "Global`s"}], ",", 
           RowBox[{"q", "\[Rule]", "Global`q"}]}], "}"}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"equations", "~", "Join", "~", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", " ", "det"}], " ", "-", "1"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"equations", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "Global`s"}], ",", 
           RowBox[{"q", "\[Rule]", "Global`q"}]}], "}"}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<About to start solving quadratic equations...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lastSEquations", "=", "equations"}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{"equations", "\[Equal]", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<... done!\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutions", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q0", ",", "s0"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"S", "/.", "solutions"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q0", ",", "s0"}], "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"result", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "q0"}], ",", 
              RowBox[{"s", "\[Rule]", "s0"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679026237463719*^9, 3.679026401061482*^9}, {
   3.679026532177328*^9, 3.6790265336414003`*^9}, {3.679026595434507*^9, 
   3.679026668558743*^9}, {3.6790267093723307`*^9, 3.67902671585257*^9}, {
   3.679026786997171*^9, 3.6790267915814257`*^9}, {3.679026837962565*^9, 
   3.67902684402677*^9}, {3.679027828294898*^9, 3.67902821160845*^9}, {
   3.679028506854056*^9, 3.679028512233839*^9}, {3.679029515385894*^9, 
   3.679029544537724*^9}, {3.679029601814136*^9, 3.679029650853195*^9}, {
   3.679029683641078*^9, 3.679029692188583*^9}, {3.679030049846499*^9, 
   3.679030059834921*^9}, {3.6790304870898333`*^9, 3.679030492433674*^9}, {
   3.6790311393768997`*^9, 3.679031146746657*^9}, {3.67903118760723*^9, 
   3.679031193351755*^9}, {3.679031807706992*^9, 3.679031866369025*^9}, {
   3.6790322827594357`*^9, 3.679032311452077*^9}, {3.679032492359161*^9, 
   3.6790325137713623`*^9}, {3.679032995661806*^9, 3.6790331008033133`*^9}, {
   3.679033140166047*^9, 3.679033200589802*^9}, 3.6790333359822617`*^9, {
   3.679033840165955*^9, 3.679033847065398*^9}, {3.679034788588993*^9, 
   3.6790348486978416`*^9}, {3.679034959528215*^9, 3.67903496798199*^9}, {
   3.679036278498267*^9, 3.679036326588046*^9}, {3.679109050095932*^9, 
   3.679109054598711*^9}, {3.679110809571063*^9, 3.679110810129339*^9}, {
   3.679111003574195*^9, 3.679111048938992*^9}, {3.679111278624571*^9, 
   3.679111299407061*^9}, {3.679617961749386*^9, 3.679618013273231*^9}, {
   3.6796187415940723`*^9, 3.6796188350565567`*^9}, {3.679645884647608*^9, 
   3.679645885830557*^9}, {3.680155713556593*^9, 3.6801557338026953`*^9}, {
   3.680185489046855*^9, 3.6801854942876472`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invertibleQ", "[", "m_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "2000"}], "}"}], "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Variables", "[", "m", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"m", "/.", "rules"}], "]"}], "\[NotEqual]", "0"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Factor", "[", 
         RowBox[{"Det", "[", "m", "]"}], "]"}], "=!=", "0"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6789559419708977`*^9, 3.678956006000286*^9}, 
   3.6789560968991528`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindQLinearSolutions", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k_", ",", "inductionMatrix_", ",", 
    RowBox[{"useGalois", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filename", ",", "outputDirectory", ",", "result", ",", "pairs", ",", 
      "triples", ",", "pMap"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<findQLinearSolutions\>\""}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "inductionMatrix"}], "}"}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{"useGalois", ",", "\"\<\>\"", ",", "\"\<-no-galois\>\""}], 
           "]"}], "<>", "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"allocations", ",", "q"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allocations", "=", 
             RowBox[{"If", "[", 
              RowBox[{"useGalois", ",", "\[IndentingNewLine]", 
               RowBox[{
               "AllocateEigenvaluesToSimplesAndCompleteGaloisActions", "[", 
                RowBox[{
                "n", ",", "fusion", ",", "k", ",", "inductionMatrix"}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "Null"}], "}"}], "&"}], "/@", 
                RowBox[{
                "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators"\
, "[", 
                 RowBox[{
                 "n", ",", "fusion", ",", "k", ",", "inductionMatrix"}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pMap", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"False", "\[And]", 
                RowBox[{"$KernelID", "\[Equal]", "0"}]}], ",", 
               RowBox[{
                RowBox[{"DistributeDefinitions", "[", 
                 RowBox[{"QLinearSolutions", ",", "invertibleQ"}], "]"}], ";",
                 "ParallelMap"}], ",", "Map"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pairs", "=", 
             RowBox[{"pMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"QLinearSolutions", "[", 
                    RowBox[{"n", ",", "inductionMatrix"}], "]"}], "[", "#", 
                   "]"}]}], "}"}], "&"}], ",", "allocations"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"triples", "=", 
             RowBox[{"pMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"invertibleQ", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "[", "q", "]"}], "]"}]}], 
                 "}"}], "&"}], ",", "pairs"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Cases", "[", 
             RowBox[{"triples", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r_", ",", "True"}], "}"}], "\[RuleDelayed]", "r"}]}],
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6789548287458363`*^9, 3.67895494887669*^9}, {
   3.678956011127274*^9, 3.678956013947281*^9}, {3.678960380239052*^9, 
   3.678960412308772*^9}, 3.678962486614418*^9, 3.67901605428677*^9, 
   3.679103856658284*^9, 3.679104942633149*^9, {3.679116784090499*^9, 
   3.679116881758724*^9}, {3.679170529961464*^9, 3.6791705577831182`*^9}, {
   3.6791736679847383`*^9, 3.6791736682452097`*^9}, {3.679174586845887*^9, 
   3.679174595168212*^9}, {3.679269018325342*^9, 3.6792690468797626`*^9}, {
   3.6793493170168867`*^9, 3.6793493298378572`*^9}, {3.679349751520211*^9, 
   3.6793497805013523`*^9}, {3.679611152740652*^9, 3.679611248906849*^9}, {
   3.679612165830312*^9, 3.6796121981045523`*^9}, {3.6796458211584787`*^9, 
   3.679645834287253*^9}, {3.6796459543415737`*^9, 3.679645958997917*^9}, {
   3.680149884166122*^9, 3.6801498865108957`*^9}, 3.680150220917371*^9, {
   3.680152700631695*^9, 3.6801527262020082`*^9}, {3.680515172634079*^9, 
   3.6805152128191957`*^9}, {3.680515277027689*^9, 3.680515280468511*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modular data", "Section",
 CellChangeTimes->{{3.680149701226727*^9, 3.680149704376717*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_", ",", 
    RowBox[{"k", ":", "_Integer", ":", "6"}], ",", 
    RowBox[{"useGalois", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qsols", "=", 
       RowBox[{"FindQLinearSolutions", "[", 
        RowBox[{
        "n", ",", "fusion", ",", "k", ",", "inductionMatrix", ",", 
         "useGalois"}], "]"}]}], ",", "q", ",", "s"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"S", ",", 
             RowBox[{"{", 
              RowBox[{"S", ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "2"}], 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], "/@", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SolveSEquations", "[", 
               RowBox[{"n", ",", "inductionMatrix"}], "]"}], "[", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "1", ",", "All", ",", "1"}], 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              "]"}], "[", 
             RowBox[{"q", ",", "s"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "qsols"}], "]"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6790282957389297`*^9, 3.679028339897011*^9}, {
   3.679028411370042*^9, 3.6790284871087017`*^9}, {3.679028568751039*^9, 
   3.679028572023054*^9}, {3.679028626797464*^9, 3.6790286534307623`*^9}, {
   3.679034589590927*^9, 3.6790345915032187`*^9}, {3.679034624829392*^9, 
   3.679034627901185*^9}, {3.679111104367234*^9, 3.679111106862561*^9}, {
   3.6791169463803988`*^9, 3.679116954923935*^9}, {3.679269138794573*^9, 
   3.679269149026675*^9}, 3.679349500216511*^9, 3.67934964139548*^9, {
   3.679617913182066*^9, 3.679617920508089*^9}, 3.680149890737238*^9, {
   3.6801499705119057`*^9, 3.680149983847745*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"permuteColumns", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Total", "[", "#", "]"}], ",", 
        RowBox[{"Reverse", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679003848562131*^9, 3.6790038766419353`*^9}, {
  3.6790039756221123`*^9, 3.679003976916894*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Beginning calculation of modular data for \>\"", ",", 
       RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", "\"\< \>\"", ",", 
       RowBox[{"MatrixForm", "[", "induction", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Considering conductors: \>\"", ",", 
       RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FindModularData", "[", 
         RowBox[{"n", ",", "fusion", ",", 
          RowBox[{"permuteColumns", "[", "induction", "]"}], ",", "6"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"inductions", ":", 
     RowBox[{"{", 
      RowBox[{"___", "?", "MatrixQ"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"FindModularData", "[", 
       RowBox[{"fusion", ",", "#"}], "]"}], "&"}], "/@", "inductions"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", "fusion_", "]"}], ":=", 
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion", ",", 
    RowBox[{"InductionMatrices", "[", "fusion", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"EvenPartFusionRules", "/@", 
        RowBox[{"FindFusionRules", "[", "g", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FindModularData", "@@", "#"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"InductionMatrices", "[", "g", "]"}], ",", 
          "CheckGaloisVerlinde"}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", " ", 
   RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"FindFusionRules", "[", "m", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{"FindModularData", "/@", 
        RowBox[{"FindFusionRules", "[", "m", "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"inductions", ":", 
     RowBox[{"{", 
      RowBox[{"___", "?", "MatrixQ"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DistributeDefinitions", "[", 
      RowBox[{
      "FindModularData", ",", "permuteColumns", ",", "PossibleConductors"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"FindModularData", "[", 
         RowBox[{"n", ",", "fusion", ",", 
          RowBox[{"permuteColumns", "[", "induction", "]"}], ",", "6"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"induction", ",", "inductions"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "}"}]}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", "fusion_", "]"}], ":=", 
  RowBox[{"ParallelFindModularData", "[", 
   RowBox[{"fusion", ",", 
    RowBox[{"InductionMatrices", "[", "fusion", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"EvenPartFusionRules", "/@", 
        RowBox[{"FindFusionRules", "[", "g", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ParallelFindModularData", "@@", "#"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"InductionMatrices", "[", "g", "]"}], ",", 
          "CheckGaloisVerlinde"}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelFindModularData", "[", " ", 
    RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"FindFusionRules", "[", "m", "]"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"ParallelFindModularData", "/@", 
         RowBox[{"FindFusionRules", "[", "m", "]"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679634407743799*^9, 3.679634441751905*^9}, {
  3.679639873553401*^9, 3.67963990881421*^9}, {3.680150235046617*^9, 
  3.68015024442994*^9}, {3.680150274678768*^9, 3.6801502985365763`*^9}, {
  3.6801512252260933`*^9, 3.6801512314913282`*^9}, {3.680151500205762*^9, 
  3.680151522411263*^9}, {3.6801518532022543`*^9, 3.6801518567582817`*^9}, {
  3.680155440446508*^9, 3.680155453845662*^9}, {3.680156117659947*^9, 
  3.680156149168626*^9}, {3.68015618458876*^9, 3.680156258123073*^9}, {
  3.680166244204167*^9, 3.680166269926814*^9}, {3.680189714146948*^9, 
  3.680189757474679*^9}, {3.680366160080352*^9, 3.680366176945516*^9}, {
  3.6803662322303133`*^9, 3.680366280009501*^9}, {3.680366323362644*^9, 
  3.680366342199327*^9}, {3.680366624609488*^9, 3.680366667594474*^9}, {
  3.680369651712243*^9, 3.680369666895648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291412978622007`*^9, 3.629141300184711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291413009800043`*^9, 3.629141302389662*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 751},
WindowMargins->{{Automatic, 88}, {Automatic, 18}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 479, 7, 51, "Subtitle",
 InitializationCell->True],
Cell[1062, 31, 514, 9, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1601, 44, 60, 1, 64, "Section",
 InitializationCell->True],
Cell[1664, 47, 247, 6, 28, "Input"],
Cell[1914, 55, 247, 6, 28, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2186, 65, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[2322, 69, 72, 1, 30, "Text",
 InitializationCell->True],
Cell[2397, 72, 1319, 24, 80, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3753, 101, 63, 1, 44, "Subsection",
 InitializationCell->True],
Cell[3819, 104, 629, 12, 97, "Input",
 InitializationCell->True],
Cell[4451, 118, 967, 16, 165, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5455, 139, 58, 1, 44, "Subsection",
 InitializationCell->True],
Cell[5516, 142, 119, 3, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5672, 150, 151, 2, 44, "Subsection",
 InitializationCell->True],
Cell[5826, 154, 1462, 40, 97, "Input",
 InitializationCell->True],
Cell[7291, 196, 325, 9, 32, "Input",
 InitializationCell->True],
Cell[7619, 207, 1086, 27, 80, "Input",
 InitializationCell->True],
Cell[8708, 236, 1202, 30, 148, "Input",
 InitializationCell->True],
Cell[9913, 268, 3491, 91, 315, "Input",
 InitializationCell->True],
Cell[13407, 361, 439, 11, 32, "Input",
 InitializationCell->True],
Cell[13849, 374, 1962, 51, 189, "Input",
 InitializationCell->True],
Cell[15814, 427, 417, 10, 46, "Input",
 InitializationCell->True],
Cell[16234, 439, 421, 12, 28, "Input",
 InitializationCell->True],
Cell[16658, 453, 976, 21, 65, "Input",
 InitializationCell->True],
Cell[17637, 476, 652, 18, 46, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18338, 500, 106, 1, 64, "Section"],
Cell[18447, 503, 570, 16, 46, "Input",
 InitializationCell->True],
Cell[19020, 521, 1103, 29, 80, "Input",
 InitializationCell->True],
Cell[20126, 552, 1598, 37, 182, "Input",
 InitializationCell->True],
Cell[21727, 591, 353, 10, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[22117, 606, 127, 2, 64, "Section",
 InitializationCell->True],
Cell[22247, 610, 395, 9, 52, "Input",
 InitializationCell->True],
Cell[22645, 621, 182, 4, 28, "Input",
 InitializationCell->True],
Cell[22830, 627, 2858, 63, 318, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25713, 694, 136, 2, 44, "Subsection",
 InitializationCell->True],
Cell[25852, 698, 543, 14, 46, "Input",
 InitializationCell->True],
Cell[26398, 714, 6935, 164, 654, "Input",
 InitializationCell->True],
Cell[33336, 880, 1530, 38, 165, "Input",
 InitializationCell->True],
Cell[34869, 920, 159, 3, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35065, 928, 131, 2, 44, "Subsection",
 InitializationCell->True],
Cell[35199, 932, 2441, 55, 250, "Input",
 InitializationCell->True],
Cell[37643, 989, 2151, 50, 148, "Input",
 InitializationCell->True],
Cell[39797, 1041, 2347, 56, 182, "Input",
 InitializationCell->True],
Cell[42147, 1099, 495, 12, 63, "Input",
 InitializationCell->True],
Cell[42645, 1113, 9289, 215, 743, "Input",
 InitializationCell->True],
Cell[51937, 1330, 1642, 39, 165, "Input",
 InitializationCell->True],
Cell[53582, 1371, 178, 4, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[53797, 1380, 132, 2, 44, "Subsection",
 InitializationCell->True],
Cell[53932, 1384, 2236, 49, 165, "Input",
 InitializationCell->True],
Cell[56171, 1435, 4730, 116, 454, "Input",
 InitializationCell->True],
Cell[60904, 1553, 2604, 59, 233, "Input",
 InitializationCell->True],
Cell[63511, 1614, 1667, 38, 165, "Input",
 InitializationCell->True],
Cell[65181, 1654, 161, 3, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65391, 1663, 117, 2, 64, "Section",
 InitializationCell->True],
Cell[65511, 1667, 2175, 66, 97, "Input",
 InitializationCell->True],
Cell[67689, 1735, 1647, 43, 114, "Input",
 InitializationCell->True],
Cell[69339, 1780, 803, 23, 63, "Input",
 InitializationCell->True],
Cell[70145, 1805, 2383, 62, 162, "Input",
 InitializationCell->True],
Cell[72531, 1869, 856, 23, 68, "Input",
 InitializationCell->True],
Cell[73390, 1894, 1991, 52, 97, "Input",
 InitializationCell->True],
Cell[75384, 1948, 526, 17, 28, "Input",
 InitializationCell->True],
Cell[75913, 1967, 1496, 43, 82, "Input",
 InitializationCell->True],
Cell[77412, 2012, 303, 8, 28, "Input",
 InitializationCell->True],
Cell[77718, 2022, 1133, 34, 71, "Input",
 InitializationCell->True],
Cell[78854, 2058, 3506, 87, 247, "Input",
 InitializationCell->True],
Cell[82363, 2147, 313, 7, 28, "Input",
 InitializationCell->True],
Cell[82679, 2156, 182, 3, 28, "Input",
 InitializationCell->True],
Cell[82864, 2161, 1653, 43, 156, "Input",
 InitializationCell->True],
Cell[84520, 2206, 391, 10, 46, "Input",
 InitializationCell->True],
Cell[84914, 2218, 1352, 37, 63, "Input",
 InitializationCell->True],
Cell[86269, 2257, 1660, 46, 125, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[87966, 2308, 138, 2, 64, "Section",
 InitializationCell->True],
Cell[88107, 2312, 1187, 29, 80, "Input",
 InitializationCell->True],
Cell[89297, 2343, 315, 7, 28, "Input",
 InitializationCell->True],
Cell[89615, 2352, 387, 10, 63, "Input",
 InitializationCell->True],
Cell[90005, 2364, 3650, 99, 274, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[93692, 2468, 171, 3, 64, "Section",
 InitializationCell->True],
Cell[93866, 2473, 582, 11, 46, "Input",
 InitializationCell->True],
Cell[94451, 2486, 1264, 32, 86, "Input",
 InitializationCell->True],
Cell[95718, 2520, 1623, 37, 97, "Input",
 InitializationCell->True],
Cell[97344, 2559, 1008, 25, 97, "Input",
 InitializationCell->True],
Cell[98355, 2586, 2873, 71, 215, "Input",
 InitializationCell->True],
Cell[101231, 2659, 1351, 32, 128, "Input",
 InitializationCell->True],
Cell[102585, 2693, 2109, 51, 216, "Input",
 InitializationCell->True],
Cell[104697, 2746, 168, 3, 28, "Input",
 InitializationCell->True],
Cell[104868, 2751, 734, 19, 80, "Input",
 InitializationCell->True],
Cell[105605, 2772, 1429, 32, 114, "Input",
 InitializationCell->True],
Cell[107037, 2806, 4253, 107, 329, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[111327, 2918, 98, 1, 64, "Section"],
Cell[111428, 2921, 1789, 49, 171, "Input",
 InitializationCell->True],
Cell[113220, 2972, 307, 7, 46, "Input",
 InitializationCell->True],
Cell[113530, 2981, 274, 6, 28, "Input",
 InitializationCell->True],
Cell[113807, 2989, 170, 3, 28, "Input",
 InitializationCell->True],
Cell[113980, 2994, 6575, 160, 430, "Input",
 InitializationCell->True],
Cell[120558, 3156, 292, 7, 28, "Input",
 InitializationCell->True],
Cell[120853, 3165, 2423, 67, 193, "Input",
 InitializationCell->True],
Cell[123279, 3234, 418, 10, 46, "Input",
 InitializationCell->True],
Cell[123700, 3246, 2322, 62, 191, "Input",
 InitializationCell->True],
Cell[126025, 3310, 3334, 91, 211, "Input",
 InitializationCell->True],
Cell[129362, 3403, 172, 3, 28, "Input",
 InitializationCell->True],
Cell[129537, 3408, 635, 17, 63, "Input",
 InitializationCell->True],
Cell[130175, 3427, 4054, 109, 233, "Input",
 InitializationCell->True],
Cell[134232, 3538, 2061, 53, 147, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[136330, 3596, 116, 1, 64, "Section"],
Cell[136449, 3599, 1868, 53, 101, "Input",
 InitializationCell->True],
Cell[138320, 3654, 300, 8, 28, "Input",
 InitializationCell->True],
Cell[138623, 3664, 2650, 64, 124, "Input",
 InitializationCell->True],
Cell[141276, 3730, 1824, 52, 100, "Input",
 InitializationCell->True],
Cell[143103, 3784, 2037, 46, 132, "Input",
 InitializationCell->True],
Cell[145143, 3832, 1308, 34, 113, "Input",
 InitializationCell->True],
Cell[146454, 3868, 1193, 30, 114, "Input",
 InitializationCell->True],
Cell[147650, 3900, 1350, 37, 97, "Input",
 InitializationCell->True],
Cell[149003, 3939, 1856, 53, 118, "Input",
 InitializationCell->True],
Cell[150862, 3994, 1269, 34, 80, "Input",
 InitializationCell->True],
Cell[152134, 4030, 179, 4, 28, "Input",
 InitializationCell->True],
Cell[152316, 4036, 204, 5, 28, "Input",
 InitializationCell->True],
Cell[152523, 4043, 21082, 497, 1423, "Input",
 InitializationCell->True],
Cell[173608, 4542, 2537, 59, 131, "Input",
 InitializationCell->True],
Cell[176148, 4603, 2328, 55, 182, "Input",
 InitializationCell->True],
Cell[178479, 4660, 1805, 46, 80, "Input",
 InitializationCell->True],
Cell[180287, 4708, 1889, 43, 165, "Input",
 InitializationCell->True],
Cell[182179, 4753, 7475, 169, 539, "Input",
 InitializationCell->True],
Cell[189657, 4924, 208, 5, 28, "Input",
 InitializationCell->True],
Cell[189868, 4931, 496, 11, 80, "Input",
 InitializationCell->True],
Cell[190367, 4944, 5237, 118, 363, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[195641, 5067, 107, 1, 64, "Section"],
Cell[195751, 5070, 453, 12, 46, "Input",
 InitializationCell->True],
Cell[196207, 5084, 613, 18, 46, "Input",
 InitializationCell->True],
Cell[196823, 5104, 12398, 271, 1097, "Input",
 InitializationCell->True],
Cell[209224, 5377, 886, 22, 63, "Input",
 InitializationCell->True],
Cell[210113, 5401, 907, 24, 63, "Input",
 InitializationCell->True],
Cell[211023, 5427, 206, 5, 28, "Input",
 InitializationCell->True],
Cell[211232, 5434, 3577, 85, 320, "Input",
 InitializationCell->True],
Cell[214812, 5521, 2746, 60, 220, "Input",
 InitializationCell->True],
Cell[217561, 5583, 6224, 139, 466, "Input",
 InitializationCell->True],
Cell[223788, 5724, 3452, 78, 318, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[227277, 5807, 113, 1, 64, "Section"],
Cell[227393, 5810, 1984, 51, 197, "Input",
 InitializationCell->True],
Cell[229380, 5863, 1003, 24, 114, "Input",
 InitializationCell->True],
Cell[230386, 5889, 985, 26, 46, "Input",
 InitializationCell->True],
Cell[231374, 5917, 3648, 92, 267, "Input",
 InitializationCell->True],
Cell[235025, 6011, 1907, 50, 148, "Input",
 InitializationCell->True],
Cell[236935, 6063, 659, 17, 114, "Input",
 InitializationCell->True],
Cell[237597, 6082, 11142, 244, 896, "Input",
 InitializationCell->True],
Cell[248742, 6328, 1045, 25, 63, "Input",
 InitializationCell->True],
Cell[249790, 6355, 1255, 33, 114, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[251082, 6393, 99, 1, 64, "Section"],
Cell[251184, 6396, 318, 6, 28, "Input"],
Cell[251505, 6404, 171, 3, 28, "Input",
 InitializationCell->True],
Cell[251679, 6409, 1907, 45, 165, "Input",
 InitializationCell->True],
Cell[253589, 6456, 1235, 33, 80, "Input",
 InitializationCell->True],
Cell[254827, 6491, 177, 3, 28, "Input",
 InitializationCell->True],
Cell[255007, 6496, 4018, 94, 250, "Input",
 InitializationCell->True],
Cell[259028, 6592, 2249, 55, 148, "Input",
 InitializationCell->True],
Cell[261280, 6649, 363, 10, 46, "Input",
 InitializationCell->True],
Cell[261646, 6661, 5876, 133, 420, "Input",
 InitializationCell->True],
Cell[267525, 6796, 5848, 145, 369, "Input",
 InitializationCell->True],
Cell[273376, 6943, 179, 3, 28, "Input",
 InitializationCell->True],
Cell[273558, 6948, 1044, 23, 97, "Input",
 InitializationCell->True],
Cell[274605, 6973, 634, 18, 46, "Input",
 InitializationCell->True],
Cell[275242, 6993, 194, 4, 28, "Input",
 InitializationCell->True],
Cell[275439, 6999, 6122, 146, 454, "Input",
 InitializationCell->True],
Cell[281564, 7147, 3368, 78, 335, "Input",
 InitializationCell->True],
Cell[284935, 7227, 3675, 83, 369, "Input",
 InitializationCell->True],
Cell[288613, 7312, 1846, 47, 131, "Input",
 InitializationCell->True],
Cell[290462, 7361, 739, 15, 63, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[291238, 7381, 162, 2, 64, "Section"],
Cell[291403, 7385, 12923, 293, 896, "Input",
 InitializationCell->True],
Cell[304329, 7680, 331, 8, 46, "Input",
 InitializationCell->True],
Cell[304663, 7690, 811, 22, 80, "Input",
 InitializationCell->True],
Cell[305477, 7714, 14835, 366, 1103, "Input",
 InitializationCell->True],
Cell[320315, 8082, 1073, 29, 131, "Input",
 InitializationCell->True],
Cell[321391, 8113, 5872, 131, 455, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[327300, 8249, 97, 1, 64, "Section"],
Cell[327400, 8252, 2547, 58, 166, "Input",
 InitializationCell->True],
Cell[329950, 8312, 558, 15, 46, "Input",
 InitializationCell->True],
Cell[330511, 8329, 7533, 191, 709, "Input",
 InitializationCell->True],
Cell[338047, 8522, 164, 4, 28, "Input",
 InitializationCell->True],
Cell[338214, 8528, 171, 4, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
