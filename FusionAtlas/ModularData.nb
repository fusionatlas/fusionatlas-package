(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    426208,      10674]
NotebookOptionsPosition[    400970,      10069]
NotebookOutlinePosition[    401357,      10086]
CellTagsIndexPosition[    401314,      10083]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ModularData package", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.420291647194886*^9, 3.420291647915923*^9}, {
  3.422317712155013*^9, 3.4223177168517666`*^9}, {3.4327775537006736`*^9, 
  3.4327775569353247`*^9}, {3.447362169800737*^9, 3.4473621701584797`*^9}, {
  3.62914181790036*^9, 3.629141821234551*^9}, {3.629142101447197*^9, 
  3.629142106581141*^9}, {3.6350177448740664`*^9, 3.63501774672686*^9}, {
  3.6801473554591312`*^9, 
  3.680147356663054*^9}},ExpressionUUID->"7cc412f1-5334-4d25-9b41-\
bc11a7d314d2"],

Cell["\<\
A subpackage for FusionAtlas.
August 14 2016, Scott Morrison, Terry Gannon, Corey Jones, and Henry Tucker\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291651250718*^9, 3.4202916677744784`*^9}, {
  3.432777559849515*^9, 3.432777570454765*^9}, {3.447362173061289*^9, 
  3.44736217826915*^9}, {3.62914182309914*^9, 3.6291418341933613`*^9}, {
  3.635017753846423*^9, 3.635017767128454*^9}, {3.6801473598840857`*^9, 
  3.680147367492038*^9}, {3.680147405694536*^9, 
  3.680147417632457*^9}},ExpressionUUID->"97f70b10-7dd0-42ab-afe5-\
9c0c2216adc9"],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->
  True,ExpressionUUID->"93b41240-4444-4dcd-9328-b0eac5b9efd9"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.629142254973199*^9, 
  3.629142254974373*^9}},ExpressionUUID->"b7e293bb-c0e9-4f1e-83e5-\
98ee07f8df87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"$RecursionLimit", ",", "4096"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680438328689768*^9, 
  3.680438335100368*^9}},ExpressionUUID->"f38c78b4-6552-4565-99fa-\
6696572c2d96"],

Cell[CellGroupData[{

Cell["Start of package", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.420295317242155*^9, 
  3.4202953180032496`*^9}},ExpressionUUID->"44d2577d-9df9-4d3b-a3fb-\
ffad9ea81017"],

Cell["Specify package dependencies:", "Text",
 InitializationCell->
  True,ExpressionUUID->"e853269f-d82f-4743-9964-dab5d60084c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`ModularData`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`TensorSolver`\>\"", ",", 
      "\"\<FusionAtlas`FormalCodegrees`\>\"", ",", 
      "\"\<FusionAtlas`InductionMatrix`\>\"", ",", 
      "\"\<FusionAtlas`DisplayGraphs`\>\""}], "}"}]}], "]"}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4202916841079645`*^9, 3.420291695754712*^9}, {
  3.420293246855085*^9, 3.420293279181568*^9}, {3.4223177805233216`*^9, 
  3.422317795274533*^9}, {3.422318235116995*^9, 3.4223182432486877`*^9}, {
  3.432777576673707*^9, 3.4327775869484816`*^9}, {3.4327796677505283`*^9, 
  3.432779670003768*^9}, {3.434561456512453*^9, 3.434561465345154*^9}, {
  3.441994559392016*^9, 3.441994566564913*^9}, {3.6291406512241707`*^9, 
  3.629140653980494*^9}, {3.629140727883437*^9, 3.629140728811976*^9}, {
  3.6291420738596573`*^9, 3.629142076889803*^9}, {3.635017772363525*^9, 
  3.635017782991023*^9}, {3.635018204317058*^9, 3.635018207740631*^9}, {
  3.635019535056429*^9, 3.635019543560801*^9}, {3.68014744113973*^9, 
  3.680147446258232*^9}, {3.680154679009303*^9, 
  3.68015468791164*^9}},ExpressionUUID->"559d07b0-340e-48b7-8521-\
5095db8c195c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage messages", "Subsection",
 InitializationCell->
  True,ExpressionUUID->"ffbe11af-c01d-4e6a-8d47-45cbcd4efa08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindModularData", "::", "usage"}], "=", 
   "\"\<FindModularData[X_] computes all possible modular data for the \
centre; the argument X may be a fusion ring and induction matrix, a fusion \
ring, the rank 3 tensor of fusion multiplicities, a matrix of fusion \
multiplicities for a single object, or a principal graph.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.635017899819322*^9, 3.635017925420052*^9}, {
  3.67549492437112*^9, 3.67549495301793*^9}, {3.675495043609414*^9, 
  3.675495046058992*^9}, {3.680147447909884*^9, 
  3.680147554092256*^9}},ExpressionUUID->"30d7be7c-b0b8-4050-87c3-\
e995701d0e59"],

Cell[BoxData[
 RowBox[{"ExplicitGenerators", ";", "CharacterTable", ";", "ExecuteGAP", ";", 
  "GaloisGroup", ";", "GaloisAction", ";", "GaloisGroupGenerators", ";", 
  "PossibleConductors", ";", "workOnRepresentations", ";", 
  "SInRepresentation", ";", "TInRepresentation", ";", 
  "DimensionsFromInductionMatrix", ";", "GaloisOrbitClumps", ";", 
  "PossibleGaloisImages", ";", "PossibleGaloisTraces", ";", 
  "RepresentationsForRank", ";", "RepresentationsForInductionMatrix", ";", 
  "SaveRepresentationsForRank", ";", "SaveCharacterTables", ";", 
  "SaveGenerators", ";", "SaveConjugacyClasses", ";", "SaveAllModularData", 
  ";", "ClearSavedModularData", ";", "AllocateEigenvaluesToGaloisOrbitClumps",
   ";", "AllocateEigenvaluesToSimples", ";", 
  "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", ";", 
  "AllocateEigenvaluesToSimplesAndCompleteGaloisActions", ";", 
  "FindQLinearSolutions", ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680606780808073*^9, 3.680606829217884*^9}, 
   3.680607074335917*^9, {3.682610307788196*^9, 3.682610315607421*^9}, {
   3.68757101104451*^9, 3.687571012073327*^9}, {3.687571051847343*^9, 
   3.6875710591101227`*^9}, 3.687571921022833*^9, {3.687574209665578*^9, 
   3.6875742132000637`*^9}},ExpressionUUID->"e6ad8797-8f9b-40e8-a040-\
3b8ec4e916da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internals", "Subsection",
 InitializationCell->
  True,ExpressionUUID->"27ee0248-1f4f-4742-925f-f4ce4849b3d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"060f4a19-f731-43b3-b8f3-8cf39c9bae26"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Handling GZIP files", "Section",
 CellChangeTimes->{{3.6801484911130877`*^9, 
  3.680148502575367*^9}},ExpressionUUID->"28e4e1ea-c203-425a-919d-\
84e22c15e137"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FusionAtlasDirectory", "[", "]"}], ",", 
      "\"\<modularData\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "dataDirectory", "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", "dataDirectory", "]"}]}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6801501325239477`*^9, 
  3.6801501843539886`*^9}},ExpressionUUID->"1750e3be-96a4-405d-8281-\
117bc6550761"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GZIP", "[", 
    RowBox[{"data_", ",", "filename_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}]}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Put", "[", 
       RowBox[{"data", ",", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"filename", ",", " ", 
          RowBox[{"-", "3"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<cd \>\"", "<>", 
        RowBox[{"DirectoryName", "[", "filename", "]"}], "<>", 
        "\"\< && gzip \>\"", "<>", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"filename", ",", " ", 
          RowBox[{"-", "3"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678845765804377*^9, 3.678845855071946*^9}, {
  3.67885726261788*^9, 
  3.678857272715775*^9}},ExpressionUUID->"475fe517-88d2-4664-aeb7-\
114767e7ddad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportGZIP", "[", "filename_", "]"}], "/;", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"filename", ",", 
      RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"unzipped", "=", 
       RowBox[{"\"\</tmp/unzipped\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<-\>\"", "<>", 
        
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"StringDrop", "[", 
           RowBox[{"filename", ",", " ", 
            RowBox[{"-", "3"}]}], "]"}], ",", 
          RowBox[{"StringLength", "[", 
           RowBox[{"DirectoryName", "[", "filename", "]"}], "]"}]}], 
         "]"}]}]}], ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Run", "[", 
      RowBox[{"\"\<cd \>\"", "<>", 
       RowBox[{"DirectoryName", "[", "filename", "]"}], "<>", 
       "\"\< && gzip -cd \>\"", "<>", "filename", "<>", "\"\< > \>\"", "<>", 
       "unzipped"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Get", "[", "unzipped", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DeleteFile", "[", "unzipped", "]"}], ";", "\[IndentingNewLine]",
      "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678934204124782*^9, 3.678934241514166*^9}, {
  3.6789343257586184`*^9, 3.67893447082731*^9}, {3.678934638089252*^9, 
  3.6789346510792227`*^9}, {3.67893472345182*^9, 
  3.678934723931559*^9}},ExpressionUUID->"8ef48fc0-bc0f-4dd8-ba65-\
c40564b4e82a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHA1", "[", "x_", "]"}], ":=", 
  RowBox[{"IntegerString", "[", 
   RowBox[{
    RowBox[{"Hash", "[", 
     RowBox[{"x", ",", "\"\<SHA1\>\""}], "]"}], ",", "16", ",", "32"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6788454156579933`*^9, 3.678845417513482*^9}, 
   3.678845481484509*^9},ExpressionUUID->"5f16753e-e092-460d-976b-\
d14d116f6934"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearSavedModularData", "[", 
   RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
  RowBox[{"DeleteFile", "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
         RowBox[{"\"\<*\>\"", "<>", 
          RowBox[{"SHA1", "[", "induction", "]"}], "<>", "\"\<*\>\""}]}], 
        "}"}], "]"}], "]"}], "~", "Join", "~", 
     RowBox[{"FileNames", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
         RowBox[{"\"\<*\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "induction"}], "}"}], "]"}], "<>", 
          "\"\<*\>\""}]}], "}"}], "]"}], "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6826077342342873`*^9, 3.682607784389347*^9}, {
  3.682607890023814*^9, 3.68260789562754*^9}, {3.682610321131942*^9, 
  3.6826103218275833`*^9}},ExpressionUUID->"8fbad9d2-adf2-4732-af6c-\
ae8be6aa4e54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["GAP interface", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321029314937*^9, 3.6743210380003643`*^9}, {
  3.6834887333545*^9, 
  3.68348873398418*^9}},ExpressionUUID->"dc4c6f99-cdbb-48c9-ad4b-\
c02a2417e5d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAP", "[", 
   RowBox[{"SL", "[", 
    RowBox[{"2", ",", 
     SubscriptBox["Z", "N_"]}], "]"}], "]"}], ":=", 
  RowBox[{"\"\<Group([[[0,-1],[1,0]],[[1,1],[0,1]]]*One(Integers mod \>\"", "<>", 
   RowBox[{"ToString", "[", "N", "]"}], "<>", "\"\<))\>\""}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673271184739356*^9, 3.673271213963241*^9}, {
  3.683445293640305*^9, 3.68344529521532*^9}, {3.6834890579885*^9, 
  3.683489063588133*^9}},ExpressionUUID->"5cd71731-01f9-47a0-bdf3-\
92ba738fd43e"],

Cell[BoxData[{
 RowBox[{"PossibleGAPPaths", ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "paths", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Run", "[", "\"\<mdfind -name gap4r8 > /tmp/out\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Run", "[", "\"\<locate gap4r8 >> /tmp/out\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"paths", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<>", "\"\</bin/gap.sh\>\""}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Import", "[", "\"\</tmp/out\>\"", "]"}], "}"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "paths", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<No copy of GAP was found. Please install gap4r8.\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "paths"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GAPPath", ":=", 
   RowBox[{"GAPPath", "=", 
    RowBox[{
    "PossibleGAPPaths", "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680148051245047*^9, 3.680148060845536*^9}, {
  3.687642821788334*^9, 3.687642856195436*^9}, {3.687643076815991*^9, 
  3.6876430883662977`*^9}, {3.6876440549523973`*^9, 3.687644074865615*^9}, {
  3.687644542566224*^9, 3.687644543249242*^9}, {3.687727145430162*^9, 
  3.687727148503261*^9}, {3.68772742471032*^9, 3.6877275356059723`*^9}, {
  3.6877276167109423`*^9, 3.687727623048649*^9}, {3.687727926677525*^9, 
  3.687728002765089*^9}, {3.687728042294998*^9, 3.6877280509481573`*^9}, {
  3.6877280952598248`*^9, 3.687728103779833*^9}, {3.6877281472794313`*^9, 
  3.687728161788682*^9}, {3.687728195430642*^9, 3.6877282007045603`*^9}, {
  3.687728248380324*^9, 3.687728266570043*^9}, {3.690667058941856*^9, 
  3.690667058978286*^9}, {3.690667117086378*^9, 3.6906671215275793`*^9}, {
  3.691199170106998*^9, 
  3.691199170898518*^9}},ExpressionUUID->"1ad203d0-018e-471e-bdb0-\
546c9fef56ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExecuteGAP", "[", "cmd_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lines", ",", "return"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Calling GAP:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "cmd", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"return", "=", 
      RowBox[{"Run", "[", 
       RowBox[{
       "\"\<echo '\>\"", "<>", "cmd", "<>", "\"\<' | \>\"", "<>", "GAPPath", 
        "<>", "\"\< -x 10000 -o 16g > /tmp/gap\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<-\>\"", "<>", 
        
        RowBox[{"ToString", "[", "$ProcessID", "]"}], "<>", "\"\<.out\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"\"\</tmp/gap\>\"", "<>", 
           RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<-\>\"", "<>", 
           RowBox[{"ToString", "[", "$ProcessID", "]"}], "<>", 
           "\"\<.out\>\""}], ",", "\"\<String\>\""}], "]"}], ",", 
        "\"\<\\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{
           RowBox[{
           "lines", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "11"}], "]"}], "=!=", "\"\< ********* \>\""}], "\[Or]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"lines", "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=!=", 
           "\"\<gap> \>\""}], "\[And]", 
          RowBox[{
           RowBox[{"lines", "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=!=", 
           "\"\<gap> gap> \>\""}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<It looks like something went wrong running GAP (error code \
\>\"", "<>", 
          RowBox[{"ToString", "[", "return", "]"}], "<>", 
          "\"\<). Please check that you have GAP installed, and modify \
FusionAtlas`ModularData`Private`GAPPath if necessary.\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "cmd", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "/@", "lines"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "lines"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6732752854541283`*^9, 3.6732753398729687`*^9}, {
   3.673275448613121*^9, 3.673275449881894*^9}, 3.6732763770593243`*^9, 
   3.673276722614603*^9, {3.673589132440914*^9, 3.673589141002243*^9}, {
   3.678934066547827*^9, 3.678934072260149*^9}, {3.6797754764261723`*^9, 
   3.679775477136386*^9}, {3.680147885876754*^9, 3.680147953256157*^9}, {
   3.680148065210949*^9, 3.680148080237525*^9}, {3.68015314884172*^9, 
   3.680153151280357*^9}, {3.680153182438315*^9, 3.680153194841539*^9}, {
   3.6801552632545633`*^9, 3.680155276890233*^9}, {3.6801555410490923`*^9, 
   3.680155629181378*^9}, {3.6834904013441963`*^9, 3.683490437611868*^9}, {
   3.685047197126289*^9, 3.6850472045625896`*^9}, {3.687574219482438*^9, 
   3.687574219753304*^9}, {3.692651127075734*^9, 3.692651130444469*^9}, {
   3.692661463697983*^9, 3.6926614849888153`*^9}, {3.6926624065987587`*^9, 
   3.6926624158935823`*^9}, {3.692662461705885*^9, 3.6926625090164413`*^9}, {
   3.7144429418002043`*^9, 3.714442944246595*^9}, 3.722557087122266*^9, {
   3.722560302838314*^9, 
   3.722560326889619*^9}},ExpressionUUID->"bbefe5d8-5ef9-4ecd-bea7-\
73bda49da69e"],

Cell[CellGroupData[{

Cell["Explicit generators", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321091240383*^9, 
  3.6743210976338663`*^9}},ExpressionUUID->"92ca296f-2bb2-4122-ba62-\
a50514ad01d5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "uses", " ", "Vahid", " ", 
    RowBox[{"Dabbaghian", "'"}], "s", " ", "RepSn", " ", "package", " ", 
    "for", " ", 
    RowBox[{"GAP", ":", " ", "http", ":"}]}], "//", 
   RowBox[{
    RowBox[{"www", ".", "gap"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"system", ".", "org"}], "/", "Packages"}], "/", 
     RowBox[{"repsn", ".", "html"}]}]}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673278901464404*^9, 
  3.6732789212562037`*^9}},ExpressionUUID->"9db8b26b-a3f3-4be3-a2db-\
44a91843ae1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q_", "]"}], "[", "k_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "S", ",", "T", ",", "N", ",", "i", ",", "Q", ",", "invQ"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"ExecuteGAP", "[", 
        RowBox[{
        "\"\<\nLoadPackage(\\\"repsn\\\");\nS:=[[0,-1],[1,0]]*One(Integers \
mod \>\"", "<>", 
         RowBox[{"ToString", "[", "q", "]"}], "<>", 
         "\"\<);;\nT:=[[1,1],[0,1]]*One(Integers mod \>\"", "<>", 
         RowBox[{"ToString", "[", "q", "]"}], "<>", 
         "\"\<);;\nG:=Group([S,T]);;\n\
rep:=IrreducibleAffordingRepresentation(Irr(G)[\>\"", "<>", 
         RowBox[{"ToString", "[", "k", "]"}], "<>", 
         "\"\<]);;\nPrint(\\\"+++++++\\\");\nS^rep;\nPrint(\\\"+++++++\\\");\n\
T^rep;\nPrint(\\\"+++++++\\\");\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"ToExpression", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StringJoin", "@@", "out"}], ")"}], ",", 
              "\"\<+++++++\>\""}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], "/.", 
           
           RowBox[{"s_String", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"StringReplace", "[", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<gap> \>\"", "\[RuleDelayed]", "\"\<\>\""}], ",", 
                 RowBox[{"\"\<[\>\"", "\[RuleDelayed]", "\"\<{\>\""}], ",", 
                 RowBox[{"\"\<]\>\"", "\[RuleDelayed]", "\"\<}\>\""}], ",", 
                 RowBox[{
                  RowBox[{"\"\<E(\>\"", "~~", 
                   RowBox[{"n", ":", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", 
                   "\"\<)\>\""}], "\[RuleDelayed]", 
                  RowBox[{
                  "\"\<FusionAtlas`\[Zeta][\>\"", "<>", "n", "<>", 
                   "\"\<]\>\""}]}]}], "}"}]}], "]"}], ")"}]}]}], ")"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"LCM", "[", 
        RowBox[{"q", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"IdentifyRootOfUnity", "/@", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", ",", "T"}], "}"}], ",", 
               RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
                RowBox[{
                "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ",", "\[Infinity]"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Lifting to Q[\[Zeta][\>\"", "<>", 
        RowBox[{"ToString", "[", "N", "]"}], "<>", "\"\<]]\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"S", ",", "T"}], "}"}], "/.", 
        RowBox[{
         RowBox[{"a", ":", 
          RowBox[{"AlgebraicNumber", "[", 
           RowBox[{"z_", ",", "_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"AlgebraicNumberPolynomial", "[", 
          RowBox[{"a", ",", 
           SuperscriptBox[
            RowBox[{"\[Zeta]", "[", "N", "]"}], 
            RowBox[{"N", "/", 
             RowBox[{"IdentifyRootOfUnity", "[", "z", "]"}]}]]}], "]"}]}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastS", ",", "lastT"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Computing eigenspaces...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigenspaces", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
        RowBox[{
         RowBox[{"NullSpace", "[", 
          RowBox[{
           RowBox[{"T", "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"\[Zeta]", "[", "N", "]"}], 
              RowBox[{"i", " ", 
               RowBox[{"N", "/", "q"}]}]], 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "T", "]"}], "]"}]}]}], ",", 
           RowBox[{
           "\"\<Method\>\"", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"q", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "@@", "eigenspaces"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Inverting change of basis...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"lastQ", "=", "Q"}], ";", "\[IndentingNewLine]", 
      RowBox[{"invQ", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Q", ",", 
         RowBox[{
         "\"\<Method\>\"", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Done!\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"invQ", ".", "S", ".", "Q"}], ",", 
        RowBox[{"invQ", ".", "T", ".", "Q"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673275785723749*^9, 3.673275875231045*^9}, {
   3.673275993887827*^9, 3.673276008483047*^9}, {3.673276040341206*^9, 
   3.6732761406762238`*^9}, {3.6732761734166613`*^9, 3.673276174058674*^9}, {
   3.6732763428227577`*^9, 3.67327634441643*^9}, {3.673276414219142*^9, 
   3.673276427152121*^9}, 3.673276567595786*^9, {3.673276657094429*^9, 
   3.673276665671742*^9}, {3.67327670225669*^9, 3.6732767139981413`*^9}, {
   3.673276755181868*^9, 3.67327681510819*^9}, {3.673278617669506*^9, 
   3.673278703485704*^9}, 3.67358960357768*^9, {3.6735897503078327`*^9, 
   3.673589754867977*^9}, {3.673590854416176*^9, 3.6735909465265617`*^9}, {
   3.673591285952467*^9, 3.67359129376431*^9}, {3.673591582373382*^9, 
   3.6735915826388893`*^9}, {3.6735923961560287`*^9, 3.673592398293146*^9}, {
   3.673592441357317*^9, 3.673592441469851*^9}, 3.680152202828776*^9, 
   3.680153308064568*^9, {3.6834453038415537`*^9, 3.683445305232717*^9}, {
   3.6834890723758183`*^9, 3.68348907679216*^9}, {3.6875717747702627`*^9, 
   3.687571778216874*^9}, {3.687573118899428*^9, 3.687573120337479*^9}, 
   3.6875732109003897`*^9, {3.68757422325037*^9, 
   3.6875742235300627`*^9}},ExpressionUUID->"d32fb644-f3b1-4e08-afc8-\
f87060f9171d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveGenerators", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}], ",", 
       RowBox[{"r_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"r", ",", 
          RowBox[{"Verbatim", "[", 
           RowBox[{"Blank", "[", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<explicitGenerators.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadGenerators", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<explicitGenerators.m\>\""}], "}"}],
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
          RowBox[{"SubValues", "[", "ExplicitGenerators", "]"}]}]}], ";"}], 
       ")"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
   3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673629474711771*^9, 
   3.673629475815337*^9}, {3.680150194141305*^9, 3.6801501961832037`*^9}, {
   3.680342277640565*^9, 3.6803423020055847`*^9}, 3.6875724698533*^9, {
   3.687572554494206*^9, 
   3.687572554978327*^9}},ExpressionUUID->"dadf55f3-5071-4289-b956-\
e834ae979572"],

Cell[BoxData[
 RowBox[{"LoadGenerators", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6802657964064093`*^9, 
  3.6802657984280663`*^9}},ExpressionUUID->"c91df157-9b06-4789-b2c7-\
4e1ac2302b41"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Character tables", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321105609541*^9, 
  3.674321108877654*^9}},ExpressionUUID->"8fd8cd89-b1cf-42bc-865f-\
09beb392f720"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ReadCharacterTable", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", "gapName_List", "]"}], ":=", 
  RowBox[{"ReadCharacterTable", "@@", "gapName"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", "gapName_", "]"}], ":=", 
  RowBox[{"ReadCharacterTable", "[", 
   RowBox[{"\"\<\>\"", ",", "gapName"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadCharacterTable", "[", 
   RowBox[{"stuff_", ",", "gapName_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ReadCharacterTable", "[", 
    RowBox[{"stuff", ",", "gapName"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "lines", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lines", "=", 
       RowBox[{"ExecuteGAP", "[", 
        RowBox[{
        "stuff", "<>", "\"\<Display(CharacterTable(\>\"", "<>", "gapName", 
         "<>", "\"\<));\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Calculated the character table for \>\"", "<>", "gapName", "<>", 
        "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"TableForm", "[", "lines", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"lines", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"-", "1"}]}], "}"}], "+", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"lines", ",", 
             RowBox[{"s_", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"s", ",", 
                RowBox[{"\"\<gap>\>\"", "~~", "___"}]}], "]"}]}], ",", 
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "lines"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6265963325923357`*^9, 3.626596366210232*^9}, {
  3.673244751955676*^9, 3.6732447519986753`*^9}, {3.673589084476933*^9, 
  3.673589090257818*^9}, {3.6735891579602013`*^9, 3.673589181232705*^9}, {
  3.673589248877458*^9, 3.673589250299822*^9}, {3.680148125200514*^9, 
  3.680148140867038*^9}, {3.680545657363784*^9, 3.680545749898059*^9}, {
  3.6805457806702633`*^9, 3.6805458677450027`*^9}, {3.687574224708324*^9, 
  3.687574224977495*^9}},ExpressionUUID->"b3b50534-0e8a-4993-bfcc-\
7a1ad5f98c13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyUnitarity", "[", "table_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"table1", ",", "M", ",", "conjugacyClassSizes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table1", "=", 
      RowBox[{"ToCyclotomicField", "[", "table", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"AlgebraicConjugate", "[", 
        RowBox[{"Transpose", "[", "table1", "]"}], "]"}], ".", "table1"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{
       RowBox[{
       "conjugacyClassSizes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "/", "conjugacyClassSizes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"table1", ".", 
        RowBox[{"AlgebraicConjugate", "[", 
         RowBox[{"conjugacyClassSizes", " ", 
          RowBox[{"Transpose", "[", "table1", "]"}]}], "]"}]}], "/", 
       RowBox[{"(", 
        RowBox[{"Plus", "@@", "conjugacyClassSizes"}], ")"}]}], "===", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "M", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626681169399117*^9, 3.626681236064234*^9}, {
  3.626681463930812*^9, 3.626681464600976*^9}, {3.6266814947222633`*^9, 
  3.626681538015633*^9}, {3.626681570857834*^9, 3.626681608259412*^9}, {
  3.62668417570864*^9, 3.626684188137061*^9}, {3.6268184698549013`*^9, 
  3.626818472407775*^9}, {3.626834112275057*^9, 3.6268341574031563`*^9}, {
  3.626834922946801*^9, 3.6268349388200073`*^9}, {3.626835549256691*^9, 
  3.626835553249207*^9}, {3.674319222083482*^9, 
  3.6743192229505167`*^9}},ExpressionUUID->"7399558b-a655-452c-8ce6-\
16b05516016e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyUnitarityNumerically", "[", "table_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"table1", ",", "M", ",", "conjugacyClassSizes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table1", "=", 
      RowBox[{"N", "[", 
       RowBox[{"table", ",", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"Transpose", "[", "table1", "]"}], "]"}], ".", "table1"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjugacyClassSizes", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
        "conjugacyClassSizes", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "/", "conjugacyClassSizes"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"table1", ".", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"conjugacyClassSizes", " ", 
              RowBox[{"Transpose", "[", "table1", "]"}]}], "]"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"Plus", "@@", "conjugacyClassSizes"}], ")"}]}], "-", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Length", "[", "M", "]"}], "]"}]}], "]"}], "]"}], "]"}], "===", 
      RowBox[{"{", "0", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.626681169399117*^9, 3.626681236064234*^9}, {
  3.626681463930812*^9, 3.626681464600976*^9}, {3.6266814947222633`*^9, 
  3.626681538015633*^9}, {3.626681570857834*^9, 3.626681608259412*^9}, {
  3.62668417570864*^9, 3.626684188137061*^9}, {3.6268184698549013`*^9, 
  3.626818472407775*^9}, {3.626834112275057*^9, 3.6268341574031563`*^9}, {
  3.626834922946801*^9, 3.6268349388200073`*^9}, {3.626835447620901*^9, 
  3.626835579945406*^9}},ExpressionUUID->"82df8788-1598-4bf1-88f2-\
807fd97b0f41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", "[", "CharacterTable", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CharacterTable", "[", "n_Integer", "]"}], ":=", 
    RowBox[{"CharacterTable", "[", 
     RowBox[{"GAP", "[", 
      RowBox[{"SL", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["Z", "n"]}], "]"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CharacterTable", "[", "gapName__", "]"}], ":=", 
    RowBox[{
     StyleBox[
      RowBox[{"CharacterTable", "[", "gapName", "]"}], "Input"], 
     StyleBox["=", "Input"], 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lines", ",", "Xpos", ",", "conjugacyClasses", ",", "representations",
          ",", "values", ",", "numberOfConjugacyClasses", ",", 
         "parseRepresentation", ",", "result"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lines", "=", 
         RowBox[{"ReadCharacterTable", "[", "gapName", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Xpos", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"lines", ",", 
            RowBox[{"s_String", "/;", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{"s", ",", 
               RowBox[{"\"\<X.\>\"", "~~", "___"}]}], "]"}]}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"conjugacyClasses", "=", 
         RowBox[{"lines", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"Min", "[", "Xpos", "]"}], "-", "2"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"representations", "=", 
         RowBox[{
         "lines", "\[LeftDoubleBracket]", "Xpos", "\[RightDoubleBracket]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"values", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", "Xpos", "]"}], "+", "1"}], ">", 
            RowBox[{"Length", "[", "lines", "]"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"lines", ",", 
               RowBox[{
                RowBox[{"Max", "[", "Xpos", "]"}], "+", "1"}]}], "]"}], ",", 
             RowBox[{"s_String", "/;", 
              RowBox[{"!", 
               RowBox[{"StringMatchQ", "[", 
                RowBox[{"s", ",", 
                 RowBox[{"Whitespace", "~~", "\"\<= \>\"", "~~", "___"}]}], 
                "]"}]}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numberOfConjugacyClasses", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"conjugacyClasses", ",", "Whitespace"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"values", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\< = \>\""}], "]"}], "/.", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n_", ",", "v_"}], "}"}], "\[RuleDelayed]", 
             RowBox[{"n", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{"v", ",", 
                  RowBox[{
                   RowBox[{"\"\<E(\>\"", "~~", 
                    RowBox[{"k", ":", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", 
                    "\"\<)\>\""}], "\[RuleDelayed]", 
                   RowBox[{
                   "\"\<FusionAtlas`\[Zeta][\>\"", "<>", "k", "<>", 
                    "\"\<]\>\""}]}]}], "]"}], "]"}], ")"}]}]}]}], "&"}], "/@",
           "values"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"parseRepresentation", "[", "line_", "]"}], ":=", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"Rest", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"line", ",", "Whitespace"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<.\>\"", "\[Rule]", "\"\<0\>\""}], "}"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", "NumberString"}], "]"}]}], "\[RuleDelayed]", 
             
             RowBox[{"ToExpression", "[", "n", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"\"\<-\>\"", "~~", 
                 RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"\"\<\\\\*\>\"", "~~", 
                 RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"UniqueGaloisConjugate", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"\"\<-\\\\*\>\"", "~~", 
                 RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"-", 
              RowBox[{"UniqueGaloisConjugate", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"StringDrop", "[", 
                  RowBox[{"n", ",", "2"}], "]"}], "/.", "values"}], ")"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"\"\</\>\"", "~~", 
                 RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"AlgebraicConjugate", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "/.", "values"}], ")"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"\"\<-/\>\"", "~~", 
                 RowBox[{"LetterCharacter", ".."}]}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"-", 
              RowBox[{"AlgebraicConjugate", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"StringDrop", "[", 
                  RowBox[{"n", ",", "2"}], "]"}], "/.", "values"}], ")"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n_String", "/;", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"n", ",", 
                RowBox[{"LetterCharacter", ".."}]}], "]"}]}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"n", "/.", "values"}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"parseRepresentation", "/@", "representations"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"VerifyUnitarityNumerically", "[", "result", "]"}]}], ",", 
          
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Something went wrong; the character table doesn't look \
right: \>\"", "]"}], ";", 
           RowBox[{"Print", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"Print", "[", 
            RowBox[{"TableForm", "[", "lines", "]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "result"}]}], "\[IndentingNewLine]", "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626596234236416*^9, 3.626596276017675*^9}, {
   3.6265963069033813`*^9, 3.626596310420295*^9}, {3.626596360126576*^9, 
   3.6265963750628633`*^9}, {3.626596424222068*^9, 3.626596581962577*^9}, {
   3.626597678741082*^9, 3.6265978229686737`*^9}, {3.6265979151464443`*^9, 
   3.626598107357348*^9}, {3.626598148858068*^9, 3.626598154988405*^9}, {
   3.626598215619999*^9, 3.62659822502139*^9}, {3.6265982566885757`*^9, 
   3.626598257583007*^9}, {3.626598287676174*^9, 3.6265983776860323`*^9}, {
   3.626667039761416*^9, 3.626667064639202*^9}, {3.626680350533383*^9, 
   3.626680407546751*^9}, {3.626680476033584*^9, 3.6266804857850733`*^9}, {
   3.626681616352686*^9, 3.626681651898209*^9}, 3.6266816887039347`*^9, {
   3.626818476095702*^9, 3.62681847857191*^9}, {3.62683552998414*^9, 
   3.626835531094002*^9}, {3.626835627235353*^9, 3.6268356380877132`*^9}, {
   3.67358902604956*^9, 3.673589039759945*^9}, {3.68015216892763*^9, 
   3.680152171206592*^9}, 3.680187666203034*^9, 3.680545651853711*^9, {
   3.6810740352302732`*^9, 3.681074046391386*^9}, {3.681074112367317*^9, 
   3.6810741208842688`*^9}, {3.687573165383789*^9, 
   3.687573184009832*^9}},ExpressionUUID->"3fe2da9e-0ad0-4b73-b7eb-\
eaf50bdaafce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveCharacterTables", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"DownValues", "[", "CharacterTable", "]"}], ",", 
       RowBox[{"r_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"r", ",", 
          RowBox[{"Blank", "|", "BlankSequence", "|", "BlankNullSequence"}]}],
          "]"}]}]}], "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<characterTables.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadCharacterTables", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<characterTables.m\>\""}], "}"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "CharacterTable", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "CharacterTable", "]"}]}]}], ";"}], 
       ")"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.673623871088582*^9, 3.673623903004717*^9}, {
  3.6736294556006107`*^9, 3.673629456476226*^9}, {3.680150197835127*^9, 
  3.680150198910924*^9}, {3.6803423154091473`*^9, 3.680342343444729*^9}, {
  3.681074319579503*^9, 
  3.681074351230137*^9}},ExpressionUUID->"a2294c7e-e2ef-41a4-8ee6-\
de70bfd04584"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadCharacterTables", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680266165463256*^9, 
  3.680266168051859*^9}},ExpressionUUID->"3e0b6c8f-f853-4a1b-b988-\
65ec11b3b3d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conjugacy classes", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.674321114221084*^9, 
  3.674321119728623*^9}},ExpressionUUID->"fe4f0400-aeed-41a6-af54-\
165b3b185f00"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConjugacyClassOf", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassOf", "[", "q_", "]"}], "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjugacyClassOf", "[", "q", "]"}], "[", "m", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cmd", ",", "lines"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cmd", "=", 
       RowBox[{"\"\<Position(ConjugacyClasses(\>\"", "<>", 
        RowBox[{"GAP", "[", 
         RowBox[{"SL", "[", 
          RowBox[{"2", ",", 
           SubscriptBox["Z", "q"]}], "]"}], "]"}], "<>", 
        "\"\<),ConjugacyClass(\>\"", "<>", 
        RowBox[{"GAP", "[", 
         RowBox[{"SL", "[", 
          RowBox[{"2", ",", 
           SubscriptBox["Z", "q"]}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "m", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
            RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}], 
        "<>", "\"\<*One(Integers mod \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<)));\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"ExecuteGAP", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"lines", "\[LeftDoubleBracket]", 
          RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673249299683311*^9, 3.6732494002702703`*^9}, {
  3.6732496734177427`*^9, 3.673249706656019*^9}, {3.673249743824984*^9, 
  3.67324975443012*^9}, {3.673249849385849*^9, 3.673249931347777*^9}, {
  3.673262992079442*^9, 3.6732630551772757`*^9}, {3.673271348369938*^9, 
  3.673271402645377*^9}, {3.673271444079761*^9, 3.673271454151167*^9}, {
  3.673271505632031*^9, 3.67327155836096*^9}, {3.673271836746817*^9, 
  3.673271848041964*^9}, {3.6735893766065187`*^9, 3.6735893876177273`*^9}, {
  3.687574226162076*^9, 
  3.687574226425865*^9}},ExpressionUUID->"db2adfbb-2334-4f88-b609-\
161225ddb95e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveConjugacyClasses", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}], ",", 
          RowBox[{"r_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"r", ",", 
             RowBox[{"Verbatim", "[", 
              RowBox[{"Blank", "[", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], "}"}],
          "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}], 
          ",", 
          RowBox[{"r_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"r", ",", "Blank"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
          "}"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortProtect", "[", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}], ",", 
          RowBox[{"r_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"r", ",", "Blank"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], "}"}],
          "]"}]}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadConjugacyClasses", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], "}"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"dataDirectory", ",", "\"\<conjugacyClasses.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"SubValues", "[", "ConjugacyClassOf", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
          "}"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
             "dataDirectory", ",", "\"\<conjugacyClassesOfPowersOfT.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "ConjugacyClassesOfPowersOfT", "]"}]}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], "}"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}], "=", 
         RowBox[{
          RowBox[{"Get", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
             "dataDirectory", ",", "\"\<conjugacyClassesOfGalois.m\>\""}], 
             "}"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"DownValues", "[", "ConjugacyClassesOfGalois", "]"}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
  3.67977563314568*^9, 3.679775710344492*^9}, {3.680150200069454*^9, 
  3.68015020359295*^9}, {3.680154615081362*^9, 3.680154637487946*^9}, {
  3.680342363319174*^9, 3.680342392829647*^9}, {3.687572959516539*^9, 
  3.6875729692356663`*^9}},ExpressionUUID->"6d6136f8-2896-43f9-8c8d-\
4bd69d6525dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassesOfGalois", "[", "q_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"ConjugacyClassesOfGalois", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"galois", ",", "cmd", ",", "lines"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"galois", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"GaloisGroup", "[", "q", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
           RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{"\"\<m := \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], " ", "<>", 
        "\"\<;; G := Group([[[0,-1],[1,0]],[[1,1],[0,1]]]*One(Integers mod \
m));; cc := ConjugacyClasses(G);; List(\>\"", "<>", "galois", "<>", 
        "\"\<, n -> Position(cc,ConjugacyClass(G,[[n, 0], [0, \
n^(-1)]]*One(Integers mod m))));\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"ExecuteGAP", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GaloisGroup", "[", "q", "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"lines", "\[LeftDoubleBracket]", 
                RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
               RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], 
            "]"}], "]"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679774791057385*^9, 3.679774811247024*^9}, {
   3.679774954208333*^9, 3.679775046641527*^9}, {3.679775487884172*^9, 
   3.6797755087709723`*^9}, 3.6797755423582582`*^9, {3.679775591220932*^9, 
   3.679775608446178*^9}, {3.680154215003539*^9, 3.680154219380002*^9}, {
   3.680154261259097*^9, 3.6801543065778646`*^9}, {3.6801544244547*^9, 
   3.680154466123228*^9}, {3.680154532658349*^9, 3.6801545738499613`*^9}, {
   3.683445320037795*^9, 3.68344532143543*^9}, {3.6834895086690817`*^9, 
   3.683489514757874*^9}, {3.6875742274500217`*^9, 
   3.68757422773015*^9}},ExpressionUUID->"66ce75ee-1099-4254-9adb-\
8bd26ccdf70c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q_", "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cmd", ",", "lines"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{"\"\<m := \>\"", "<>", 
        RowBox[{"ToString", "[", "q", "]"}], " ", "<>", 
        "\"\<;; G := Group([[[0,-1],[1,0]],[[1,1],[0,1]]]*One(Integers mod \
m));; cc := ConjugacyClasses(G);; List([0..(m-1)], n -> \
Position(cc,ConjugacyClass(G,[[1, n], [0, 1]]*One(Integers mod \
m))));\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"ExecuteGAP", "[", "cmd", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"lines", "\[LeftDoubleBracket]", 
            RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], ",", "5"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
           RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679774791057385*^9, 3.679774811247024*^9}, {
   3.679774954208333*^9, 3.679775046641527*^9}, {3.679775487884172*^9, 
   3.6797755087709723`*^9}, 3.6797755423582582`*^9, {3.679775591220932*^9, 
   3.679775608446178*^9}, {3.683445445221257*^9, 3.6834454470739326`*^9}, {
   3.683446033282728*^9, 3.6834460355744877`*^9}, {3.683489529599483*^9, 
   3.683489541415831*^9}, {3.6875742287782383`*^9, 
   3.687574229034214*^9}},ExpressionUUID->"f200fa6d-40e5-4ff4-a484-\
d9b3436aa292"],

Cell[BoxData[
 RowBox[{"LoadConjugacyClasses", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680266178294631*^9, 
  3.680266181814823*^9}},ExpressionUUID->"50dfc6b7-3550-4f8c-a1b4-\
5423fb7df9a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321141515586*^9, 
  3.67432114502276*^9}},ExpressionUUID->"2b7e588a-c16e-4ce9-8412-\
6de09bd0efee"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"GaloisMatrix", "[", 
    RowBox[{"n_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GaloisMatrix", "[", 
     RowBox[{"n", ",", "l"}], "]"}], "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"s", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"t", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], "}"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"c", ".", "s", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"PowerMod", "[", 
              RowBox[{"l", ",", 
               RowBox[{"-", "1"}], ",", "n"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "s", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "l"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "s", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"PowerMod", "[", 
              RowBox[{"l", ",", 
               RowBox[{"-", "1"}], ",", "n"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "n"}], "]"}]}], 
     "]"}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590189650071*^9, 3.673590261909614*^9}, {
  3.6790269233476963`*^9, 3.679026939436719*^9}, {3.679037657462017*^9, 
  3.679037660370302*^9}, {3.683445332881604*^9, 
  3.683445334218217*^9}},ExpressionUUID->"415701b2-ee0f-4324-927d-\
36a84c1294c4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "GaloisInRepresentation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"which", " ", "irrep"}], " ", "*)"}], ",", "l_"}], 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisInRepresentation", "[", 
    RowBox[{"q", ",", "k", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "T"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", "T"}], "}"}], "=", 
       RowBox[{
        RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{"S", ",", "3"}], "]"}], ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "q"}], "]"}]}], "]"}], ".", "S", ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"l", ",", "1", ",", "q"}], "]"}]}], "]"}], ".", "S", ".", 
       RowBox[{"MatrixPower", "[", 
        RowBox[{"T", ",", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"l", ",", 
           RowBox[{"-", "1"}], ",", "q"}], "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590374432272*^9, 3.6735903953073177`*^9}, {
  3.673590427913817*^9, 3.673590509080974*^9}, {3.673591042404852*^9, 
  3.6735910476763487`*^9}, {3.683445801369323*^9, 3.683445805865415*^9}, {
  3.6834458782358017`*^9, 3.683445879959095*^9}, {3.683489573236064*^9, 
  3.683489576995452*^9}},ExpressionUUID->"b4eb117b-6c94-4b75-9326-\
8c675a9e623a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockDiagonalMatrix", "=", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "\[Rule]", "#"}], "&"}], ",", 
          "#", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray`SparseBlockMatrix", "[", "r", "]"}], "]"}]}], 
     "]"}], "&"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736109859435673`*^9, 3.6736109902959347`*^9}, {
  3.6736110795350637`*^9, 
  3.6736110826049*^9}},ExpressionUUID->"d5122c5d-fb75-44d2-8326-4eef094ff34b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
      " ", "prime", " ", "powers"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"KroneckerProduct", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GaloisInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"l", ",", 
          RowBox[{
          "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], "]"}], "/.", 
      RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
       RowBox[{"AlgebraicNumberPolynomial", "[", 
        RowBox[{"a", ",", 
         SuperscriptBox[
          RowBox[{"\[Zeta]", "[", "n", "]"}], 
          RowBox[{"n", "/", 
           RowBox[{"IdentifyRootOfUnity", "[", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}]]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], "]"}]}],
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}], ",", "l_"}], "]"}], ":=", 
  RowBox[{"BlockDiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GaloisInRepresentation", "[", 
      RowBox[{"n", ",", "V", ",", "l"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673610854191732*^9, 3.673610899977078*^9}, {
   3.673610997061048*^9, 3.6736110009117203`*^9}, {3.6736110567513*^9, 
   3.673611057801929*^9}, {3.678951495635023*^9, 3.678951509784313*^9}, 
   3.6875717808968697`*^9},ExpressionUUID->"448d9a6d-04fa-4c18-9df6-\
ac5d91793228"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer", 
    RowBox[{"(*", " ", 
     RowBox[{"which", " ", "irrep"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CharacterTable", "[", 
    RowBox[{"GAP", "[", 
     RowBox[{"SL", "[", 
      RowBox[{"2", ",", 
       SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
   
   RowBox[{"k", ",", 
    RowBox[{"l", "/.", 
     RowBox[{"ConjugacyClassesOfGalois", "[", "q", "]"}]}]}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6735905891227837`*^9, 3.673590649937274*^9}, {
  3.673590718235251*^9, 
  3.673590732550767*^9}},ExpressionUUID->"42718b6e-b84b-4e85-a541-\
e3fc43dfd23d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
      " ", "prime", " ", "powers"}], " ", "*)"}], ",", "l_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "Galois", " ", "element"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"TraceOfGalois", "[", 
    RowBox[{"n", ",", "ks", ",", "l"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"TraceOfGalois", "[", 
      RowBox[{
       RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Mod", "[", 
        RowBox[{"l", ",", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], "]"}]}],
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceOfGalois", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}], ",", "l_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"TraceOfGalois", "[", 
     RowBox[{"n", ",", "V", ",", "l"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673591682869156*^9, 3.673591799206078*^9}, 
   3.673597380355487*^9, {3.673597414805829*^9, 3.6735975302214127`*^9}, {
   3.673597762764237*^9, 3.6735977640125837`*^9}, {3.673598245540802*^9, 
   3.673598245737605*^9}, {3.67426847515958*^9, 
   3.67426848169601*^9}},ExpressionUUID->"e267b1cb-c686-42b3-bd1c-\
ee77ba9ba7de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisGroup", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisGroup", "[", "n", "]"}], "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"i_", "/;", 
      RowBox[{
       RowBox[{"GCD", "[", 
        RowBox[{"i", ",", "n"}], "]"}], "\[Equal]", "1"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"85496efd-2c42-42e1-86a8-5803f73e1463"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaloisConjugates", "[", "n_", "]"}], "[", 
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"s_", ",", "a_"}], "]"}], "]"}], "/;", 
   RowBox[{"s", "\[Equal]", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"AlgebraicNumber", "[", 
     RowBox[{"s", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "~", "Join", "~", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"m", "-", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "a", "]"}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaloisConjugates", "[", "n_", "]"}], "[", 
   RowBox[{"k", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"k", ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.624232558998745*^9, 3.624232565589562*^9}, {
   3.624233352200313*^9, 3.624233357314949*^9}, 
   3.673598837839374*^9},ExpressionUUID->"75f24e73-484f-4c15-904a-\
351543198ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GaloisInverse", "[", "n_", "]"}], "[", "l_", "]"}], ":=", 
  RowBox[{"PowerMod", "[", 
   RowBox[{"l", ",", 
    RowBox[{"-", "1"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674449370104599*^9, 
  3.674449389615471*^9}},ExpressionUUID->"e426d0a7-b205-42d4-899e-\
3641914ddf10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
    RowBox[{"a", ":", 
     RowBox[{"AlgebraicNumber", "[", 
      RowBox[{"r_", ",", "x_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"r", "\[Equal]", 
    RowBox[{
     RowBox[{"\[Zeta]", "[", "n", "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "a", 
    "]"}], "=", 
   RowBox[{"AlgebraicNumberPolynomial", "[", 
    RowBox[{"a", ",", 
     SuperscriptBox[
      RowBox[{"\[Zeta]", "[", "n", "]"}], "l"]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaloisAction", "[", "n_", "]"}], "[", "l_", "]"}], "[", 
   RowBox[{"a", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "a"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.607038844019298*^9, 3.60703891506844*^9}, {
  3.624233495702753*^9, 3.624233503532878*^9}, {3.67360296017706*^9, 
  3.6736029642130413`*^9}},ExpressionUUID->"572a7e5a-bec3-40da-a524-\
00ccbff336ec"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "GaloisGroupRepresentatives", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaloisGroupRepresentatives", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisGroupRepresentatives", "[", "n", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"iterators", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iterators", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], ",", "0", ",", 
           RowBox[{
            RowBox[{"MultiplicativeOrder", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], 
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
              "n"}], "]"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "\[Rule]", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "&"}],
        "/@", 
       RowBox[{
        RowBox[{"Tally", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}],
                    "}"}]}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"Product", "[", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    RowBox[{"a", "[", "i", "]"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}]}],
                     "}"}]}], "]"}], ",", "n"}], "]"}]}], "}"}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "iterators"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], "]"}], "-", 
             "1"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Equal]", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626391341296324*^9, 3.6263913586984*^9}, {
  3.626391630342885*^9, 
  3.626391869471766*^9}},ExpressionUUID->"34d23afe-ea42-406a-9ae3-\
1b1a2b8d6471"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisGroupElementAsProductOfGenerators", "[", 
   RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"k", "/.", 
   RowBox[{"GaloisGroupRepresentatives", "[", "n", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626391871883709*^9, 
  3.626391888054914*^9}},ExpressionUUID->"5f8ec897-db5d-44ac-8d1f-\
9a40acb83202"],

Cell[BoxData[
 RowBox[{"Clear", "[", "GeneratorsOfUnitsModPrimePower", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679868630069418*^9, 
  3.6798686309090567`*^9}},ExpressionUUID->"d9e08a38-526f-44b5-aa89-\
2fe68a801769"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q_", "]"}], "/;", 
   RowBox[{
    RowBox[{"PrimePowerQ", "[", "q", "]"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
     "2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"n", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CoprimeQ", "[", 
           RowBox[{"n", ",", "q"}], "]"}]}], "\[Or]", 
         RowBox[{
          RowBox[{"MultiplicativeOrder", "[", 
           RowBox[{"n", ",", "q"}], "]"}], "\[NotEqual]", 
          RowBox[{
           FractionBox["q", "p"], 
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}]}]}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "n", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.679868197202182*^9, 3.679868199683977*^9}, {
  3.679868229981814*^9, 3.679868406540401*^9}, {3.679868492678746*^9, 
  3.6798685015264397`*^9}, {3.6798685713993883`*^9, 
  3.679868637789536*^9}},ExpressionUUID->"2f4e1e00-2815-408b-a1cf-\
58bdca1a79b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "2", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "4", "]"}], "=", 
   RowBox[{"{", "3", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679869303431965*^9, 
  3.6798693212406683`*^9}},ExpressionUUID->"f1370946-686c-4008-bcd6-\
505f641fa3da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q_", "]"}], "/;", 
    RowBox[{
     RowBox[{"PrimePowerQ", "[", "q", "]"}], "\[And]", 
     RowBox[{
      RowBox[{
       RowBox[{"FactorInteger", "[", "q", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "==", "2"}]}]}], "/;", 
   RowBox[{"q", "\[GreaterEqual]", "8"}]}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GeneratorsOfUnitsModPrimePower", "[", "q", "]"}], "="}], "*)"}], 
  
  RowBox[{
   RowBox[{"{", "3", "}"}], "~", "Join", "~", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "/", "2"}], "-", "1"}], ",", 
         RowBox[{
          RowBox[{"q", "/", "2"}], "+", "1"}], ",", 
         RowBox[{"q", "-", "1"}]}], "}"}], ",", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"3", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"q", "-", "1"}], "]"}], ",", "q"}], "]"}]}], "]"}], ",", 
     "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67986888940781*^9, 3.679868983561346*^9}, {
  3.6798690194879837`*^9, 3.6798690477549343`*^9}, {3.6798691321177273`*^9, 
  3.679869186249852*^9}, {3.679869273133142*^9, 
  3.6798692963107557`*^9}},ExpressionUUID->"bcc147c6-8797-49ad-a991-\
aeaaeb2c5bf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GaloisGroupGenerators", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"factors", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
          "&"}], "/@", 
         RowBox[{"FactorInteger", "[", "n", "]"}]}]}], ",", "m"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "factors", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ChineseRemainder", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], 
             RowBox[{"UnitVector", "[", 
              RowBox[{"m", ",", "i"}], "]"}]}], "+", "1"}], ",", "factors"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"g", ",", 
           RowBox[{"GeneratorsOfUnitsModPrimePower", "[", 
            RowBox[{
            "factors", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679869453867043*^9, 3.679869456928082*^9}, {
  3.679869494007004*^9, 
  3.679869753942749*^9}},ExpressionUUID->"e83ca764-3fb5-4b05-ae91-\
2c600fd97b0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explicit representations", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321165053524*^9, 
  3.6743211700533333`*^9}},ExpressionUUID->"d2bdefe4-4546-43c4-8969-\
cb22bec254ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "irrep"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], 
   "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{
    RowBox[{"q_", "/;", 
     RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ",", "k_Integer"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"which", " ", "irrep"}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExplicitGenerators", "[", "q", "]"}], "[", "k", "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673590374432272*^9, 3.6735903953073177`*^9}, {
  3.673590427913817*^9, 3.673590509080974*^9}, {3.673591042404852*^9, 
  3.6735910476763487`*^9}, {3.6736272438275137`*^9, 3.673627269125494*^9}, {
  3.67362731226824*^9, 3.673627315932251*^9}, {3.673627400895301*^9, 
  3.673627408330306*^9}},ExpressionUUID->"31c0f4fc-a5b4-40bd-8c55-\
c007942e4cf0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Sometimes", " ", "S", " ", "will", " ", "lie", " ", "in", " ", "an", " ", 
   "even", " ", "larger", " ", "number", " ", 
   RowBox[{"field", "."}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678953240185952*^9, 
  3.678953253624498*^9}},ExpressionUUID->"e0f51b09-1455-4a4f-85cd-\
28eecb0391b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "KroneckerProduct", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KroneckerProduct", "[", "X_", "]"}], ":=", 
  "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "KroneckerProduct", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680654556952324*^9, 
  3.6806545845225353`*^9}},ExpressionUUID->"808275c6-650a-4388-bd75-\
e8369e980a9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
     " ", "prime", " ", "powers"}], " ", "*)"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"LiftToCommonCyclotomicField", "[", 
   RowBox[{"KroneckerProduct", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], 
         "]"}]}], "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"LiftToCommonCyclotomicField", "[", 
   RowBox[{"BlockDiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", "V"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "a", " ", "product", " ", "of", " ", "irreps", " ", "for", " ", "the", 
     " ", "prime", " ", "powers"}], " ", "*)"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KroneckerProduct", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"TInRepresentation", "[", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ks"}], "}"}], 
         "]"}]}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
    RowBox[{"AlgebraicNumberPolynomial", "[", 
     RowBox[{"a", ",", 
      SuperscriptBox[
       RowBox[{"\[Zeta]", "[", "n", "]"}], 
       RowBox[{"n", "/", 
        RowBox[{"IdentifyRootOfUnity", "[", 
         RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TInRepresentation", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"Vs", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"BlockDiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"TInRepresentation", "[", 
      RowBox[{"n", ",", "V"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ",", "Vs"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673627218103772*^9, 3.673627234370151*^9}, {
   3.673627321188748*^9, 3.673627389199526*^9}, {3.6736275035486383`*^9, 
   3.673627522065069*^9}, {3.673627555335623*^9, 3.673627587665968*^9}, {
   3.673627623289214*^9, 3.673627625562292*^9}, {3.67895402661269*^9, 
   3.678954048612468*^9}, 
   3.6875717831870747`*^9},ExpressionUUID->"13161ede-336f-4389-a4d0-\
758413818826"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dimensions", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.674321270562765*^9, 3.674321274248431*^9}, {
  3.680148334483891*^9, 
  3.680148335318214*^9}},ExpressionUUID->"d2383120-e822-4504-90bf-\
40586cc1d38c"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "FPDimensions", ",", "GlobalDimension", ",", "DimensionsFromFusionRules", 
   ",", "DimensionsFromInductionMatrix", ",", 
   "DimensionsFromFusionRulesAndInductionMatrix"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638332140675*^9, 3.679638342505928*^9}, {
  3.679638462415886*^9, 3.679638473728271*^9}, {3.679638672586975*^9, 
  3.6796386789853067`*^9}, {3.679638737650552*^9, 3.679638749821282*^9}, {
  3.679639587897571*^9, 3.679639590474908*^9}, {3.6797159388415337`*^9, 
  3.6797159400950193`*^9}},ExpressionUUID->"3913179f-95e5-43ca-9625-\
e515c525b381"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FPDimensions", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{
   RowBox[{"FPDimensions", "[", "fr", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", "#", "]"}], ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Im", "[", "x", "]"}], "\[Equal]", "0"}]}]}], "]"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"fr", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1", ",", "2"}], 
     "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlobalDimension", "[", "fr_FusionRules", "]"}], ":=", 
  RowBox[{
   RowBox[{"GlobalDimension", "[", "fr", "]"}], "=", 
   RowBox[{
    RowBox[{"ToCyclotomicField", "[", 
     SuperscriptBox[
      RowBox[{"Norm", "[", 
       RowBox[{"FPDimensions", "[", "fr", "]"}], "]"}], "2"], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638332140675*^9, 3.679638342505928*^9}, {
  3.679638462415886*^9, 3.679638473728271*^9}, {3.679638672586975*^9, 
  3.6796386789853067`*^9}, {3.679638737650552*^9, 3.679638749821282*^9}, {
  3.679639587897571*^9, 
  3.679639590474908*^9}},ExpressionUUID->"9df43dd8-4b26-40b6-bd26-\
66fa3ee4c621"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromFusionRules", "[", "fusion_", "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromFusionRules", "[", "fusion", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", "N"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{"GlobalDimension", "[", "fusion", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"\[ScriptCapitalD]", ",", "_AlgebraicNumber", ",", 
         RowBox[{"IdentifyRootOfUnity", "[", 
          RowBox[{
          "\[ScriptCapitalD]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "_", ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"cachedToNumberField", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\[Zeta]", "[", "N", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"FPDimensions", "[", "fusion", "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679638202659284*^9, 3.679638219310869*^9}, {
   3.6796383500375443`*^9, 3.679638446369623*^9}, {3.679638483605053*^9, 
   3.679638500966988*^9}, {3.679638573942164*^9, 3.679638577441923*^9}, {
   3.6796387231846857`*^9, 3.679638723533449*^9}, {3.679638759618478*^9, 
   3.679638771443263*^9}, {3.679638819816077*^9, 3.67963886996809*^9}, {
   3.679638905589645*^9, 3.679638917482868*^9}, 
   3.687571786193101*^9},ExpressionUUID->"4c5c1a73-b462-4bd9-a949-\
61d105d446ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
   RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
    RowBox[{"fusion", ",", " ", "induction"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], "=", 
       RowBox[{"DimensionsFromFusionRules", "[", "fusion", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "induction", "]"}], ".", "dims"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796389319558764`*^9, 3.679639018656682*^9}, {
  3.679639578047474*^9, 
  3.6796395788755198`*^9}},ExpressionUUID->"6db0daa5-02ed-4839-95b2-\
81524ce9176a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromInductionMatrix", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}], 
   "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dimensions", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimensions", "=", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ".", 
           "inductionMatrix"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"RootReduce", "[", 
            RowBox[{"#", "/", 
             RowBox[{"Norm", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"dimensions", ",", 
            RowBox[{"d_", "/;", 
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{"NonNegative", "[", "d", "]"}], ")"}]}]}]}], "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"dimensions", "/", 
         RowBox[{"Min", "[", "dimensions", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{"ToCyclotomicField", "[", "dimensions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"dimensions", ",", 
            RowBox[{"a_AlgebraicNumber", "\[RuleDelayed]", 
             RowBox[{"IdentifyRootOfUnity", "[", 
              RowBox[{
              "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}]}], ",", "1"}], "]"}], "~", "Join", "~", 
          RowBox[{"{", "1", "}"}]}], ")"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cachedToNumberField", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sum", "[", 
              RowBox[{
               SuperscriptBox["d", "2"], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "dimensions"}], "}"}]}], "]"}], 
             RowBox[{"1", "/", "2"}]], ",", 
            RowBox[{"\[Zeta]", "[", "n", "]"}]}], "]"}], ",", "dimensions"}], 
         "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744026172470083`*^9, 3.674402703755024*^9}, {
   3.679714132087799*^9, 3.679714172151655*^9}, {3.679715528483037*^9, 
   3.67971554975563*^9}, {3.679715979892489*^9, 3.679716009464252*^9}, {
   3.679716117084673*^9, 3.6797161174351587`*^9}, {3.6834913255309143`*^9, 
   3.683491331747943*^9}, 
   3.687571788385449*^9},ExpressionUUID->"2ad50104-006a-45b1-86c1-\
a377a7eb30f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DimensionsFromInductionMatrix", "[", 
   RowBox[{"N_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DimensionsFromInductionMatrix", "[", 
    RowBox[{"N", ",", "inductionMatrix"}], "]"}], "=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "dims"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "dims"}], "}"}], "=", 
       RowBox[{
       "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dims", "/.", 
       RowBox[{"x_AlgebraicNumber", "\[RuleDelayed]", 
        RowBox[{"AlgebraicNumberPolynomial", "[", 
         RowBox[{"x", ",", 
          SuperscriptBox[
           RowBox[{"\[Zeta]", "[", "N", "]"}], 
           RowBox[{"N", "/", "n"}]]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673608023923111*^9, 3.67360809867362*^9}, {
  3.673609065365941*^9, 3.673609067483259*^9}, {3.673609112157552*^9, 
  3.6736091145168667`*^9}, {3.6736091529678164`*^9, 3.673609180792027*^9}, {
  3.673609217664603*^9, 3.673609233739463*^9}, {3.679609224236594*^9, 
  3.679609285778534*^9}, {3.679609373755597*^9, 
  3.679609384248747*^9}},ExpressionUUID->"20ae4e6e-cea3-4dee-b154-\
66beb4b48e7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveDimensionsFromInductionMatrix", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], ";", 
    RowBox[{"AbortProtect", "[", 
     RowBox[{"Put", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"DownValues", "[", "DimensionsFromInductionMatrix", "]"}], 
         ",", 
         RowBox[{"r_", "/;", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"r", ",", "Blank"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "dataDirectory", ",", "\"\<dimensionsFromInductionMatrix.m\>\""}], 
         "}"}], "]"}]}], "]"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], ":=", 
  RowBox[{
   RowBox[{"LoadDimensionsFromInductionMatrixOnce", "[", "]"}], "=", 
   RowBox[{
   "LoadDimensionsFromInductionMatrix", "[", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadDimensionsFromInductionMatrix", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", "\"\<dimensionsFromInductionMatrix.m\>\""}], 
        "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DownValues", "[", "DimensionsFromInductionMatrix", "]"}], 
        "=", 
        RowBox[{
         RowBox[{"Get", "[", "filename", "]"}], "~", "Join", "~", 
         RowBox[{
         "DownValues", "[", "DimensionsFromInductionMatrix", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.673623871088582*^9, 3.673623903004717*^9}, {
  3.6736294556006107`*^9, 3.673629456476226*^9}, {3.679635020090423*^9, 
  3.6796351797175913`*^9}, {3.6801502048713207`*^9, 3.6801502064871063`*^9}, {
  3.687572983853428*^9, 
  3.6875729960207367`*^9}},ExpressionUUID->"264d8c14-38eb-45ed-8099-\
dc8f53a84fa7"],

Cell[BoxData[
 RowBox[{"Clear", "[", "CheckGaloisVerlinde", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67963946385703*^9, 
  3.679639466995453*^9}},ExpressionUUID->"6293e526-eaef-4bce-a41d-\
ca57e036214c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "dimensions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "dimensions"}], "}"}], "=", 
      RowBox[{
      "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CheckGaloisVerlinde", "[", 
      RowBox[{"n", ",", "dimensions"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674402536323017*^9, 3.674402545026346*^9}, {
  3.6744027193598633`*^9, 
  3.6744027394071493`*^9}},ExpressionUUID->"a9e994ae-efea-42b5-b79e-\
6bd969299472"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", 
   RowBox[{"fusion_FusionRules", ",", 
    RowBox[{"inductionMatrix_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", ",", "dimensions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dimensions", "=", 
      RowBox[{"DimensionsFromFusionRulesAndInductionMatrix", "[", 
       RowBox[{"fusion", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "_AlgebraicNumber", ",", 
        RowBox[{"IdentifyRootOfUnity", "[", 
         RowBox[{"dimensions", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", "_",
         ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CheckGaloisVerlinde", "[", 
      RowBox[{"N", ",", "dimensions"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674402536323017*^9, 3.674402545026346*^9}, {
   3.6744027193598633`*^9, 3.6744027394071493`*^9}, {3.679639093482317*^9, 
   3.679639218255072*^9}, {3.67963938705122*^9, 3.6796393917223787`*^9}, {
   3.6796394397293158`*^9, 3.679639446194785*^9}, {3.6796394819179792`*^9, 
   3.679639483818695*^9}, 
   3.687571790153181*^9},ExpressionUUID->"2929a67c-b4fa-40ba-b950-\
00dc09cb996c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckGaloisVerlinde", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"dimensions", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"{", 
        RowBox[{"___", "?", "NumericQ"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CheckGaloisVerlinde", "[", 
    RowBox[{"n", ",", "dimensions"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "galoisElements"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "1", "]"}], "=", 
       RowBox[{
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "/", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", "l_", "]"}], ":=", 
       RowBox[{
        RowBox[{"S", "[", "l", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "/@", 
         RowBox[{"S", "[", "1", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"galoisElements", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"GroupBy", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"S", "[", "l", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "&"}]}], "]"}], "]"}]}], ")"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NonNegative", "[", "#", "]"}], "\[And]", 
           RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"S", "[", "x", "]"}], "\[LeftDoubleBracket]", "w", 
                 "\[RightDoubleBracket]"}], 
                RowBox[{
                 RowBox[{"S", "[", "y", "]"}], "\[LeftDoubleBracket]", "w", 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"AlgebraicConjugate", "[", 
                 RowBox[{
                  RowBox[{"S", "[", "z", "]"}], "\[LeftDoubleBracket]", "w", 
                  "\[RightDoubleBracket]"}], "]"}]}], 
               RowBox[{
                RowBox[{"S", "[", "1", "]"}], "\[LeftDoubleBracket]", "w", 
                "\[RightDoubleBracket]"}]], ",", 
              RowBox[{"{", 
               RowBox[{"w", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "dimensions", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "galoisElements"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "galoisElements"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "galoisElements"}], "}"}]}], "]"}], "]"}]}], 
        ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674401832147462*^9, 3.674401972442823*^9}, {
  3.674402075082011*^9, 3.67440213459937*^9}, {3.674403333984891*^9, 
  3.6744034791195908`*^9}, {3.674403548058298*^9, 3.674403561062214*^9}, {
  3.6796390752959423`*^9, 3.679639085514188*^9}, {3.679639452419858*^9, 
  3.679639457980597*^9}},ExpressionUUID->"c279d5ae-ba00-4530-bcd2-\
c3029de77f54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois orbits", "Section",
 CellChangeTimes->{{3.680148343494872*^9, 
  3.680148347669621*^9}},ExpressionUUID->"500e4e92-1dc8-4880-845a-\
50b9f1716e5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisOrbitClumps", "[", 
   RowBox[{"n_", ",", "dimension_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisOrbitClumps", "[", 
    RowBox[{"n", ",", "dimension"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "clumps", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"clumps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"#", "~", "Join", "~", 
           RowBox[{"(", 
            RowBox[{"-", "#"}], ")"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "#2", "]"}], "[", 
             
             FractionBox["#1", 
              RowBox[{
              "dimension", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]], "]"}], 
            RowBox[{
            "dimension", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "&"}], ",", 
          RowBox[{
          "dimension", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"GaloisGroup", "[", "n", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"clumps", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Union", "[", "clumps", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736032941688004`*^9, 3.673603304991187*^9}, {
  3.6736033501877737`*^9, 3.673603415699252*^9}, {3.673850440514183*^9, 
  3.673850443281953*^9}},ExpressionUUID->"3bf648b1-c81b-41f4-9cd5-\
755119c4e81d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisOrbitClumps", "[", "induction_", "]"}], ":=", 
  RowBox[{"GaloisOrbitClumps", "@@", 
   RowBox[{
   "DimensionsFromInductionMatrix", "[", "induction", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679609667887207*^9, 
  3.6796097131728497`*^9}},ExpressionUUID->"cf542cf2-72e0-4bec-8d53-\
0dffd0c2f0a7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "TODO", " ", "this", " ", "could", " ", "be", " ", "tightened", " ", "in", 
   " ", "many", " ", "ways"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744029946276283`*^9, 
  3.6744030063258247`*^9}},ExpressionUUID->"0ba97c94-b63e-4c09-bbee-\
e4e6747987df"],

Cell[BoxData[
 RowBox[{"Clear", "[", "PossibleConductors", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679271857713122*^9, 
  3.6792718591959476`*^9}},ExpressionUUID->"02ec01d3-e2a8-4cd7-8315-\
58c050ab6737"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PossibleConductors", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleConductors", "[", "inductionMatrix", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dimensionConductor", ",", "rank", ",", "inductionsFromOne", ",", 
       "dimensions", ",", "\[ScriptCapitalD]", ",", "n", ",", "primes", ",", 
       "powers", ",", 
       RowBox[{"l", "=", "3"}], ",", "largestClump"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimensionConductor", "=", 
       RowBox[{
        RowBox[{
        "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimensions", "=", 
       RowBox[{
        RowBox[{
        "DimensionsFromInductionMatrix", "[", "inductionMatrix", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "dimensions", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rank", "=", 
       RowBox[{"Length", "[", "dimensions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inductionsFromOne", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"largestClump", "=", 
       RowBox[{"Max", "@@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", 
          RowBox[{"GaloisOrbitClumps", "[", "inductionMatrix", "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         SuperscriptBox["d", "2"], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "dimensions"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"\[ScriptCapitalD]", ",", "_AlgebraicNumber", ",", 
         RowBox[{"IdentifyRootOfUnity", "[", 
          RowBox[{
          "\[ScriptCapitalD]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "_", ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"primes", "=", 
       RowBox[{
        RowBox[{"FactorInteger", "[", 
         RowBox[{"AlgebraicNumberNorm", "[", "\[ScriptCapitalD]", "]"}], 
         "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sizeOfOrbit", "[", 
        RowBox[{"p_", ",", "k_"}], "]"}], ":=", 
       RowBox[{
        SuperscriptBox["p", 
         RowBox[{"k", "-", "1"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sizeOfOrbit", "[", 
        RowBox[{"2", ",", "k_"}], "]"}], ":=", 
       RowBox[{"Max", "[", 
        RowBox[{"1", ",", 
         SuperscriptBox["2", 
          RowBox[{"k", "-", "3"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"powers", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"\[Infinity]", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "primes", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Max", "@@", "powers"}], ")"}], "\[GreaterEqual]", "l"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"l", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"powers", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"Length", "[", "primes", "]"}], "}"}]}], "]"}], "]"}],
             ",", 
            RowBox[{"t_", "/;", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"sizeOfOrbit", "[", 
                    RowBox[{
                    RowBox[{
                    "primes", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "primes", "]"}]}], "}"}]}], 
                  "]"}]}], "\[LessEqual]", "largestClump"}], ")"}], "\[And]", 
              
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"sizeOfOrbit", "[", 
                   RowBox[{
                    RowBox[{
                    "primes", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "primes", "]"}]}], "}"}]}], "]"}], 
                "\[LessEqual]", 
                RowBox[{"rank", "-", "inductionsFromOne"}]}], ")"}]}]}]}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            SuperscriptBox["primes", "#"], ")"}]}], "&"}], "/@", "powers"}], 
        ",", 
        RowBox[{"N_", "/;", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"N", ",", "dimensionConductor"}], "]"}], "\[Equal]", 
          "0"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743188814669943`*^9, 3.674318969796857*^9}, {
   3.67431901242109*^9, 3.674319043968659*^9}, {3.6743190873402147`*^9, 
   3.674319171038666*^9}, {3.6743192400273037`*^9, 3.6743192861735497`*^9}, {
   3.6743194582404222`*^9, 3.674319465357841*^9}, {3.674319896207004*^9, 
   3.674319938566409*^9}, {3.6743199769371843`*^9, 3.674320143366035*^9}, {
   3.67432017950727*^9, 3.674320228605503*^9}, {3.6743202666537313`*^9, 
   3.674320292496298*^9}, {3.6743203626986027`*^9, 3.6743204978411427`*^9}, {
   3.6743205385036*^9, 3.674320605651841*^9}, {3.674320652505465*^9, 
   3.674320702737761*^9}, {3.674320748074478*^9, 3.6743207747924643`*^9}, {
   3.679271784284289*^9, 3.679271843077331*^9}, {3.679609772864616*^9, 
   3.679609796385971*^9}, {3.679609849792782*^9, 3.679609888684486*^9}, {
   3.679716244490705*^9, 3.6797162539136667`*^9}, {3.6797168328095217`*^9, 
   3.6797168668970737`*^9}, {3.683491692059689*^9, 3.683491718398616*^9}, {
   3.683492963622813*^9, 3.6834930128423023`*^9}, 
   3.687571792853772*^9},ExpressionUUID->"ef23b7c2-6654-4d3f-a0e3-\
fa2b6d365335"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"PossibleGaloisImages", ",", "PossibleGaloisImagesWithSigns"}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267667275382*^9, 3.674267668516333*^9}, {
  3.67428078441434*^9, 
  3.674280784564576*^9}},ExpressionUUID->"7a6d2fa8-17e5-4b71-8571-\
77f118963337"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n_", ",", "dimensions_", ",", "1"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
           FractionBox["#", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]], "]"}], 
          RowBox[{
          "dimensions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "&"}], "/@", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"#", "|", 
            RowBox[{"(", 
             RowBox[{"-", "#"}], ")"}]}], ",", "1"}], "]"}], "]"}], "&"}], "/@",
        "images"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"PossibleGaloisImages", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673855727505419*^9, 3.673855927276881*^9}, {
  3.6742807393971786`*^9, 
  3.6742807584666*^9}},ExpressionUUID->"1541d995-acef-45ee-b60b-7fed79754331"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{"n", ",", 
    RowBox[{"DimensionsFromInductionMatrix", "[", 
     RowBox[{"n", ",", "induction"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680368473627098*^9, 
  3.680368503625592*^9}},ExpressionUUID->"871a78a6-03c1-4647-a3f3-\
2abea384b9f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PossibleGaloisImagesWithSigns", "[", 
    RowBox[{"n_", ",", "dimensions_", ",", "1"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImagesWithSigns", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImagesWithSigns", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
           FractionBox["#", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]], "]"}], 
          RowBox[{
          "dimensions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "&"}], "/@", 
        RowBox[{
        "dimensions", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "#", ",", "1"}], "]"}], "~", 
          "Join", "~", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"-", "#"}], ",", "1"}], "]"}]}], ")"}]}], "]"}], "&"}], 
       "/@", "images"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267042641481*^9, 3.6742670649916067`*^9}, 
   3.674267661924692*^9, {3.674280768700495*^9, 
   3.674280776575099*^9}},ExpressionUUID->"1e75cf75-9d17-4957-8fc1-\
b74b9f944263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{
   "n_Integer", ",", "dimensions_List", ",", "eigenvalues_List", ",", "1"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "i", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisImages", "[", 
   RowBox[{
   "n_Integer", ",", "dimensions_List", ",", "eigenvalues_List", ",", 
    "l_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisImages", "[", 
    RowBox[{"n", ",", "dimensions", ",", "eigenvalues", ",", "l"}], "]"}], 
   "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
             FractionBox[
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]], "]"}], 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l", "2"], 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "eigenvalues"}], "}"}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "dimensions", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", "eigenvalues"}], "}"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "|", 
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ")"}]}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], ",", "1"}], "]"}], "]"}], "&"}], "/@", "images"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673855727505419*^9, 3.673855927276881*^9}, {
  3.673887255877717*^9, 3.673887375446603*^9}, {3.673888831339181*^9, 
  3.67388883180464*^9}, {3.67439846941578*^9, 3.674398480192709*^9}, {
  3.674448455099105*^9, 
  3.6744485060729113`*^9}},ExpressionUUID->"6c171d11-3d5e-4eae-b048-\
67db0b024036"],

Cell[BoxData[
 RowBox[{"Clear", "[", "PossibleGaloisTraces", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742687944821653`*^9, 
  3.674268795506605*^9}},ExpressionUUID->"5134923f-3878-4cb9-a6ec-\
d2c9bf34cc5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", "x_List", "}"}], "]"}], ":=", "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", 
    RowBox[{"x_List", ",", "y_List", ",", "z___List"}], "}"}], "]"}], ":=", 
  RowBox[{"possibleSums", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"Plus", ",", "x", ",", "y", ",", "1"}], "]"}], "]"}], "]"}], 
     ",", "z"}], "}"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680525981651346*^9, 
  3.680526046109359*^9}},ExpressionUUID->"f8166685-fafa-4acd-92a9-\
aa81b9bd29d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PossibleGaloisTraces", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PossibleGaloisTraces", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"images", ",", "contributions"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", 
            RowBox[{
            "dimensions", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
          RowBox[{"PossibleGaloisImagesWithSigns", "[", 
           RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", "k"}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], ">", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "k"}]}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], ">", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", "k"}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "==", "1"}]}]}], ":=", 
       RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "k"}]}], "]"}], "\[And]", 
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "==", "1"}]}]}], ":=", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"contributions", "[", 
         RowBox[{"{", 
          RowBox[{"k_", ",", "i_"}], "}"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"i", ",", "k"}], "]"}]}], "\[And]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"i", ",", 
            RowBox[{"-", "k"}]}], "]"}]}]}]}], ":=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"possibleSums", "[", 
       RowBox[{"contributions", "/@", "images"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PossibleGaloisTraces", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"PossibleGaloisTraces", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674267099521884*^9, 3.674267338967619*^9}, {
  3.674267390681664*^9, 3.6742674321482*^9}, {3.674267647867557*^9, 
  3.674267652962418*^9}, {3.674267824736973*^9, 3.674267840595292*^9}, {
  3.6742688274630213`*^9, 3.6742688658937187`*^9}, {3.674269046589498*^9, 
  3.674269050949356*^9}},ExpressionUUID->"ae0ab09d-1906-4e61-9608-\
a50e75dc1970"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MaximumGaloisFixedPoints", "[", 
   RowBox[{"n_", ",", "dimensions_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MaximumGaloisFixedPoints", "[", 
    RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalD]", "=", 
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "}"}], ",", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{
       "dimensions", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"d_", "/;", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ga", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", 
              
              FractionBox["d", "\[ScriptCapitalD]"], "]"}], 
             "\[ScriptCapitalD]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"ga", "\[Equal]", "d"}], "||", 
           RowBox[{"ga", "\[Equal]", 
            RowBox[{"-", "d"}]}]}]}], "]"}]}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MaximumGaloisFixedPoints", "[", 
   RowBox[{"n_", ",", "dimensions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"MaximumGaloisFixedPoints", "[", 
      RowBox[{"n", ",", "dimensions", ",", "l"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673598452031055*^9, 3.673598548901844*^9}, {
  3.67359862857131*^9, 3.6735986349487057`*^9}, {3.673598721337178*^9, 
  3.673598813895955*^9}, {3.673599092986308*^9, 3.673599129159224*^9}, {
  3.6735992620608997`*^9, 3.67359931667159*^9}, {3.673599405086472*^9, 
  3.673599426907958*^9}, {3.6735995374593897`*^9, 3.673599567194325*^9}, {
  3.673603311031201*^9, 
  3.6736033196752462`*^9}},ExpressionUUID->"3c4e2861-05c8-4614-98ff-\
bf80c97a40a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Representations of SL(2, Z)", "Section",
 CellChangeTimes->{{3.6801484516644583`*^9, 
  3.6801484627752934`*^9}},ExpressionUUID->"e295b6c6-0bad-4201-8731-\
47815c635b1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RepresentationSign", "[", 
    RowBox[{"q_", ",", "k_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"RepresentationSign", "[", 
    RowBox[{"q", ",", "k"}], "]"}], "=", 
   RowBox[{"Sign", "[", 
    RowBox[{
     RowBox[{"CharacterTable", "[", 
      RowBox[{"GAP", "[", 
       RowBox[{"SL", "[", 
        RowBox[{"2", ",", 
         SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"ConjugacyClassOf", "[", "q", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], 
     "\[RightDoubleBracket]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationSign", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"RepresentationSign", "[", 
     RowBox[{
      RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PrimePowers", "[", "n", "]"}], ",", "ts"}], "}"}], "]"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6732717781129017`*^9, 3.673271805239646*^9}, {
  3.6732718544660397`*^9, 3.673271897463438*^9}, {3.673272383959339*^9, 
  3.673272386489653*^9}, {3.674228163706032*^9, 3.674228226867364*^9}, {
  3.674302977413322*^9, 
  3.674302982155661*^9}},ExpressionUUID->"36473b2a-c27e-4c97-ac07-\
1d8a4f71c823"],

Cell[BoxData[
 RowBox[{
  RowBox[{"totalModOne", "[", "x___", "]"}], ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"{", "x", "}"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674315127331531*^9, 
  3.6743151423848457`*^9}},ExpressionUUID->"a8a8564b-6856-4976-8620-\
40e7381330b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TEigenvalues", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"N", ",", "t"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"primePowers", "=", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], "&"}],
         "/@", 
        RowBox[{"FactorInteger", "[", "N", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{"totalModOne", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TEigenvalues", "[", 
            RowBox[{
             RowBox[{
             "primePowers", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "primePowers", "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TEigenvalues", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"TEigenvalues", "[", 
     RowBox[{"N", ",", "#"}], "]"}], "&"}], "/@", "ts"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673258489574758*^9, 3.673258720265759*^9}, {
   3.673258756066778*^9, 3.673258763827278*^9}, {3.673258795803809*^9, 
   3.673258798313781*^9}, {3.673258909827633*^9, 3.673258925835452*^9}, {
   3.673259070058572*^9, 3.673259073612702*^9}, {3.673259328898554*^9, 
   3.673259336138247*^9}, {3.6732597430403337`*^9, 3.673259749264928*^9}, {
   3.673271731067898*^9, 3.673271733484187*^9}, {3.673271961448656*^9, 
   3.6732719950497828`*^9}, {3.673273492456805*^9, 3.6732735520355463`*^9}, 
   3.673273804345687*^9, {3.673273847949361*^9, 3.673273862768269*^9}, {
   3.673274049268762*^9, 3.6732740656218357`*^9}, {3.673864002946683*^9, 
   3.673864024751486*^9}, {3.6742236284195127`*^9, 3.674223641977296*^9}, {
   3.674225993421636*^9, 3.674226005055986*^9}, {3.6743151486517687`*^9, 
   3.6743151612258263`*^9}, {3.678846505297694*^9, 
   3.678846509321157*^9}},ExpressionUUID->"be13fc02-651e-47f6-8b43-\
d4a126cd114e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "\[Chi]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"tr", 
        RowBox[{"(", 
         RowBox[{"M", "^", "r"}], ")"}]}], " ", ")"}], "_", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "0"}], "}"}], "^", 
       RowBox[{"{", 
        RowBox[{"n", "-", "1"}], "}"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "lists", " ", "all", " ", "the", " ", "eigenvalues", " ", 
      "of", " ", "M", " ", "which", " ", "are", " ", "n"}], "-", 
     RowBox[{"th", " ", "roots", " ", "of", " ", 
      RowBox[{"unity", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NewtonsIdentity", "[", 
    RowBox[{"n_", ",", "\[Chi]_"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox["m", "n"], ",", 
        RowBox[{"{", 
         RowBox[{"RootReduce", "[", 
          RowBox[{
           FractionBox["1", "n"], 
           RowBox[{"\[Chi]", ".", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"\[Zeta]", "[", "n", "]"}], 
               RowBox[{
                RowBox[{"-", "m"}], " ", "l"}]], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "0", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "}"}]}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791996413000803`*^9, 3.679199755796049*^9}, {
  3.679200491652883*^9, 3.679200496733272*^9}, {3.679201095830701*^9, 
  3.6792010989896927`*^9}},ExpressionUUID->"d44680d4-6536-4191-8891-\
8fb74dce249b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"q_", ",", "k_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"TEigenvalues", "[", 
    RowBox[{"q", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Chi]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lastTEigenvalues", "=", 
       RowBox[{"{", 
        RowBox[{"q", ",", "k"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{
        RowBox[{"liftCyclotomicNumber", "[", "q", "]"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CharacterTable", "[", 
            RowBox[{"GAP", "[", 
             RowBox[{"SL", "[", 
              RowBox[{"2", ",", 
               SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", 
            RowBox[{"ConjugacyClassesOfPowersOfT", "[", "q", "]"}]}], "}"}]}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NewtonsIdentity", "[", 
       RowBox[{"q", ",", "\[Chi]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674222987365498*^9, 3.6742230157499638`*^9}, {
  3.6742230618338203`*^9, 3.674223088470738*^9}, {3.67422323360533*^9, 
  3.674223399122788*^9}, {3.674223603275249*^9, 3.674223604068536*^9}, {
  3.674224263192213*^9, 3.674224294170306*^9}, {3.674224448588017*^9, 
  3.674224451400116*^9}, {3.6742245145082273`*^9, 3.674224516461429*^9}, {
  3.674228791771707*^9, 3.674228792962185*^9}, {3.674294369672274*^9, 
  3.674294373681929*^9}, {3.674294405165576*^9, 3.674294412489703*^9}, {
  3.674315179133437*^9, 3.674315183663919*^9}, {3.678846394546916*^9, 
  3.678846397576939*^9}, {3.678847927370228*^9, 3.678847927683766*^9}, {
  3.679199765932877*^9, 
  3.679199772574225*^9}},ExpressionUUID->"e034f21f-1a97-482d-9a67-\
d6efbf512f5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"liftCyclotomicNumber", "[", "N_", "]"}], "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{"_Integer", "|", "_Rational"}], ")"}]}], "]"}], ":=", 
  "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"liftCyclotomicNumber", "[", "N_", "]"}], "[", "a_AlgebraicNumber",
    "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"liftCyclotomicNumber", "[", "N", "]"}], "[", "a", "]"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"LCM", "[", 
        RowBox[{"N", ",", 
         RowBox[{"IdentifyRootOfUnity", "[", 
          RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AlgebraicNumberPolynomial", "[", 
      RowBox[{"a", ",", 
       SuperscriptBox[
        RowBox[{"\[Zeta]", "[", "n", "]"}], 
        RowBox[{"n", "/", 
         RowBox[{"IdentifyRootOfUnity", "[", 
          RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}]]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673863891547611*^9, 3.673863967979216*^9}, 
   3.6742244547998323`*^9, {3.674224541749132*^9, 3.674224545780651*^9}, {
   3.687571795458496*^9, 
   3.6875717981465387`*^9}},ExpressionUUID->"1490d3ce-9219-4474-8a6b-\
7cef1f2bd94e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SaveTEigenvalues", "[", "]"}], ":=", 
  RowBox[{"AbortProtect", "[", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"DownValues", "[", "TEigenvalues", "]"}], ",", 
       RowBox[{"r_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"r", ",", 
          RowBox[{"Verbatim", "[", 
           RowBox[{"Blank", "[", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<tEigenvalues.m\>\""}], "}"}], 
      "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadTEigenvalues", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", "TEigenvalues", "]"}], "=", 
     RowBox[{
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dataDirectory", ",", "\"\<tEigenvalues.m\>\""}], "}"}], 
        "]"}], "]"}], "~", "Join", "~", 
      RowBox[{"DownValues", "[", "TEigenvalues", "]"}]}]}], ";"}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
  3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
  3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
  3.674225166648288*^9, 3.674225199974859*^9}, {3.680150207668816*^9, 
  3.680150208728025*^9}, {3.687572653910927*^9, 
  3.687572665782381*^9}},ExpressionUUID->"d23f30f8-9a63-4db2-a2be-\
c7ba0dcd2107"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationConductor", "[", 
    RowBox[{"N", ",", "t"}], "]"}], "=", 
   RowBox[{"LCM", "@@", 
    RowBox[{"(", 
     RowBox[{"Denominator", "/@", 
      RowBox[{"TEigenvalues", "[", 
       RowBox[{"N", ",", "t"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationConductor", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"LCM", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"RepresentationConductor", "[", 
       RowBox[{"N", ",", "#"}], "]"}], "&"}], "/@", "ts"}], 
    ")"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674223936228441*^9, 3.674223964582719*^9}, {
  3.674224015932994*^9, 3.674224027937842*^9}, {3.67423044054665*^9, 
  3.674230461980967*^9}, {3.674230501524974*^9, 3.674230507862986*^9}, {
  3.674235069291807*^9, 3.674235076259884*^9}, {3.6743152316598167`*^9, 
  3.674315233373547*^9}},ExpressionUUID->"d22fa309-eec7-4984-ab99-\
a7beb5bfb2c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RepresentationDimension", "[", 
    RowBox[{"q_", ",", "t_Integer"}], "]"}], "/;", 
   RowBox[{"PrimePowerQ", "[", "q", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"RepresentationDimension", "[", 
    RowBox[{"q", ",", "t"}], "]"}], "=", 
   RowBox[{
    RowBox[{"CharacterTable", "[", 
     RowBox[{"GAP", "[", 
      RowBox[{"SL", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["Z", "q"]}], "]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"t", ",", "1"}], 
    "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationDimension", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"RepresentationDimension", "[", 
     RowBox[{
      RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PrimePowers", "[", "n", "]"}], ",", "t"}], "}"}], "]"}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RepresentationDimension", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"ts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"RepresentationDimension", "[", 
     RowBox[{"n", ",", "t"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "ts"}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674224704501307*^9, 3.674224839506255*^9}, {
  3.6742256904203253`*^9, 3.6742256906469507`*^9}, {3.6742944668567343`*^9, 
  3.674294472005439*^9}},ExpressionUUID->"3c981719-5497-46c0-8875-\
3be2235ba30b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addMaps", "[", 
   RowBox[{"m1_", ",", "m2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "keys", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keys", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"m1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "~", "Join", 
        "~", 
        RowBox[{"m2", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"m1", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}], "+", 
         RowBox[{"Replace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"m2", "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}]}]}], "&"}], "/@",
       "keys"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674228348363014*^9, 3.674228392788529*^9}, {
  3.67422844424015*^9, 
  3.674228477669386*^9}},ExpressionUUID->"5ab60a7a-31de-42d4-9492-\
b990dbc3598c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", "4000"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743187590681257`*^9, 
  3.674318759105624*^9}},ExpressionUUID->"4e90dc21-6d93-4591-b3db-\
cf13822804ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankDirty", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674448017847733*^9, 
  3.67444802434074*^9}},ExpressionUUID->"89e42e5f-b706-4ca7-b021-\
659deccb7583"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRank", "[", 
   RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationsForRank", "[", 
    RowBox[{"n", ",", "r"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "characterTables", ",", "tuples", ",", "PartialRepresentation", ",", 
       "addRepresentation", ",", "addRepresentations", ",", "representations",
        ",", "factors", ",", "trivial"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Enumerating allowed representation types for conductor \>\"", ",",
         "n", ",", " ", "\"\< and rank \>\"", " ", ",", "r", ",", 
        "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"characterTables", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"CharacterTable", "[", 
          RowBox[{"GAP", "[", 
           RowBox[{"SL", "[", 
            RowBox[{"2", ",", 
             SubscriptBox["Z", "#"]}], "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"PrimePowers", "[", "n", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"characterTables0", "=", "characterTables"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{"List", ",", 
             RowBox[{"Sequence", "@@", " ", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "/@", "characterTables"}], "]"}]}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"PrimePowers", "[", "n", "]"}], "]"}], "-", "1"}]}], 
          "]"}], ",", 
         RowBox[{"t_", "/;", 
          RowBox[{
           RowBox[{"RepresentationDimension", "[", 
            RowBox[{"n", ",", "t"}], "]"}], "\[LessEqual]", "r"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"GroupBy", "[", 
           RowBox[{"tuples", ",", 
            RowBox[{
             RowBox[{"RepresentationConductor", "[", 
              RowBox[{"n", ",", "#"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{"Function", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"!", 
                RowBox[{"Divisible", "[", 
                 RowBox[{
                  RowBox[{
                  "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "#"}], "]"}]}], "&"}], "/@", 
              RowBox[{"Reverse", "[", 
               RowBox[{"PrimePowers", "[", "n", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Rule]", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"Function", "[", 
             RowBox[{"ts", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "ts"}], "]"}], ",", "0"}], "]"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"RepresentationSign", "[", 
                  RowBox[{"n", ",", "ts"}], "]"}]}]}], "}"}]}], "]"}]}], 
           "]"}]}], "&"}], "/@", "tuples"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tuples0", "=", "tuples"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentation", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "conductor_Integer"}], "]"}], "[", 
        "pr_PartialRepresentation", "]"}], ":=", 
       RowBox[{"{", "pr", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", ":", 
             RowBox[{"{", "__Integer", "}"}]}], ",", "others___"}], "}"}], 
          ",", "conductor_Integer"}], "]"}], "[", 
        RowBox[{"pr", ":", 
         RowBox[{"PartialRepresentation", "[", 
          RowBox[{
           RowBox[{"ts", ":", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ",", 
           "remainingDimension_Integer", ",", "open_List", ",", 
           "signedMultiplicities_List"}], "]"}]}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"max", ",", "min"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"pr0", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"pr", ",", "2"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"max", "=", 
           RowBox[{"Floor", "[", 
            RowBox[{"remainingDimension", "/", 
             RowBox[{"RepresentationDimension", "[", 
              RowBox[{"n", ",", "t"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "check", " ", "that", " ", "either", " ", "this", " ", 
             "representation", " ", "has", " ", "1"}], ",", " ", 
            RowBox[{
            "or", " ", "all", " ", "eigenvalues", " ", "have", " ", 
             "appeared", " ", "previously"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"max", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"max", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"TEigenvalues", "[", 
                   RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}], "\[Or]", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], ",", "open"}], "]"}], 
                  "]"}], "\[Equal]", "0"}]}], ",", "\[Infinity]", ",", "0"}], 
              "]"}]}], "]"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"TEigenvalues", "[", 
                 RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}]}], 
             "\[And]", 
             RowBox[{"Negative", "[", 
              RowBox[{"RepresentationSign", "[", 
               RowBox[{"n", ",", "t"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "look", " ", "at", " ", "the", " ", "signed", " ", 
              "multiplicities"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"min", "=", 
              RowBox[{"Min", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"signedMultiplicities", "~", "Join", "~", 
                    RowBox[{"{", 
                    RowBox[{"_", "\[Rule]", "0"}], "}"}]}]}], "]"}], "/", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}], "/@", 
                 RowBox[{"Tally", "[", 
                  RowBox[{"TEigenvalues", "[", 
                   RowBox[{"n", ",", "t"}], "]"}], "]"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"max", "=", 
              RowBox[{"Min", "[", 
               RowBox[{"max", ",", "min"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"addRepresentation", "[", 
              RowBox[{
               RowBox[{"{", "others", "}"}], ",", "conductor"}], "]"}], "/@", 
             
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"k", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
                 "pr", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "PartialRepresentation", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ts", "~", "Join", "~", 
                    RowBox[{"Table", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"{", "k", "}"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"remainingDimension", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"RepresentationDimension", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], ",", "0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Union", "[", 
                    RowBox[{"open", ",", 
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "open"}], "\[IndentingNewLine]", 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"addMaps", "[", 
                    RowBox[{"signedMultiplicities", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Rule", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", " ", 
                    RowBox[{"RepresentationSign", "[", 
                    RowBox[{"n", ",", "t"}], "]"}]}]}], "}"}], "#"}], ")"}]}],
                     "&"}], "/@", 
                    RowBox[{"Tally", "[", 
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "t"}], "]"}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "max"}], "}"}]}], "]"}]}], 
            ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentations", "[", 
         RowBox[{"{", "}"}], "]"}], "[", "pr_PartialRepresentation", "]"}], ":=", 
       RowBox[{"{", "pr", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"addRepresentations", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"conductor_Integer", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"ts", ":", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ")"}]}], 
           ",", "others___"}], "}"}], "]"}], "[", "pr_PartialRepresentation", 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{
            RowBox[{"addRepresentation", "[", 
             RowBox[{"ts", ",", "conductor"}], "]"}], "[", "pr", "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Length", "[", "result", "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "if", " ", "the", " ", "conductor", " ", "is", " ", "a", " ", 
             "prime", " ", "power"}], ",", " ", 
            RowBox[{
            "make", " ", "sure", " ", "that", " ", "by", " ", "now", " ", 
             RowBox[{"we", "'"}], "ve", " ", "actually", " ", "used", " ", 
             "something", " ", "with", " ", "large", " ", "enough", " ", 
             "conductor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"PrimePowers", "[", "n", "]"}], ",", "conductor"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RepresentationConductor", "[", 
                  RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"result", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"result", ",", 
                RowBox[{
                 RowBox[{"PartialRepresentation", "[", 
                  RowBox[{
                   RowBox[{"Ts", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "__Integer", "}"}], "..."}], "}"}]}], ",", 
                   "___"}], "]"}], "/;", 
                 RowBox[{"Divisible", "[", 
                  RowBox[{
                   RowBox[{"RepresentationConductor", "[", 
                    RowBox[{"n", ",", "Ts"}], "]"}], ",", "conductor"}], 
                  "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Length", "[", "result", "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"addRepresentations", "[", 
              RowBox[{"{", "others", "}"}], "]"}], "/@", "result"}], 
            ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"addRepresentations", "[", 
          RowBox[{"Most", "[", "tuples", "]"}], "]"}], "[", 
         RowBox[{"PartialRepresentation", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"r", "-", "1"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trivial", "=", 
       RowBox[{"tuples", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", "1"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"RepresentationDimension", "[", 
             RowBox[{"n", ",", "#"}], "]"}]}], "}"}], "&"}], ",", 
         "representations", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "~", "Join", "~", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"trivial", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"r", "-", 
              RowBox[{"Total", "[", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}],
              "}"}]}], "]"}]}], "&"}], "/@", "representations"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"TEigenvalues", "[", 
            RowBox[{"n", ",", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}],
           "}"}], "&"}], "/@", "representations"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"representations", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"representations", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"V_", ",", "Ts_"}], "}"}], "/;", 
          RowBox[{"And", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RepresentationSign", "[", 
                   RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                  ")"}]}], ")"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Count", "[", 
                   RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "Ts"}], 
                ")"}]}], "\[GreaterEqual]", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", "Ts", "]"}], "]"}]}], "}"}]}], 
            "]"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RepresentationsForRankDirty", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"RepresentationsForRankDirty", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Found \>\"", ",", 
        RowBox[{"Length", "[", "representations", "]"}], ",", 
        "\"\< allowed representation types for conductor \>\"", ",", "n", ",",
         " ", "\"\< and rank \>\"", " ", ",", "r", ",", "\"\<.\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "representations"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674230832416952*^9, 3.67423097617251*^9}, {
   3.6742312886123543`*^9, 3.674231381281761*^9}, {3.674231472859879*^9, 
   3.674231510649126*^9}, {3.674231796961651*^9, 3.6742318248550177`*^9}, {
   3.674232037030352*^9, 3.674232040503496*^9}, {3.674232155963846*^9, 
   3.674232197568727*^9}, {3.674232298235715*^9, 3.674232358973792*^9}, {
   3.674233808511428*^9, 3.67423380906094*^9}, {3.674234153498393*^9, 
   3.674234154515156*^9}, {3.674269145338408*^9, 3.6742691493895597`*^9}, {
   3.67426918602917*^9, 3.674269189281974*^9}, {3.67429378669037*^9, 
   3.674293788666318*^9}, {3.674293846618498*^9, 3.6742938492114143`*^9}, {
   3.674294514517082*^9, 3.674294522489119*^9}, 3.6742945785774403`*^9, {
   3.674296942094186*^9, 3.674296945895481*^9}, {3.674302526221505*^9, 
   3.674302788567927*^9}, {3.674302860916792*^9, 3.674302864075162*^9}, {
   3.674302929516963*^9, 3.6743029396658087`*^9}, {3.674303131426222*^9, 
   3.674303133435749*^9}, {3.6743038594312687`*^9, 3.674303860523182*^9}, {
   3.674303990807996*^9, 3.674304012182138*^9}, {3.67430414688848*^9, 
   3.674304157139578*^9}, {3.674304204022972*^9, 3.674304208503298*^9}, {
   3.674304241951063*^9, 3.674304242269184*^9}, {3.674315307379437*^9, 
   3.674315330152927*^9}, {3.674441912079411*^9, 3.674441912237359*^9}, {
   3.6744480387819223`*^9, 3.674448061397019*^9}, {3.678846747510187*^9, 
   3.678846757726787*^9}, {3.678846902438807*^9, 3.6788469056719*^9}, {
   3.678846975109734*^9, 3.678847018544424*^9}, {3.678847932814382*^9, 
   3.678847933155014*^9}, {3.680154965297255*^9, 3.6801550059865913`*^9}, {
   3.6801660497767887`*^9, 3.680166070192688*^9}, 
   3.68259647047896*^9},ExpressionUUID->"37043a9a-9ea9-46b0-a859-\
352487387762"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForDimensions", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"dimensions", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalD]_", "?", "NumericQ"}], ",", 
       RowBox[{"{", 
        RowBox[{"__", "?", "NumericQ"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"RepresentationsForDimensions", "[", 
    RowBox[{"N", ",", "dimensions"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RepresentationsForRankLoaded", ",", "N"}], "]"}]}], ",", 
        RowBox[{"LoadRepresentationsForRank", "[", "N", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"RepresentationsForRank", "[", 
         RowBox[{"N", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "dimensions", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V_", ",", "_"}], "}"}], "/;", "\[IndentingNewLine]", 
         RowBox[{"And", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"PossibleGaloisTraces", "[", 
               RowBox[{"N", ",", "dimensions", ",", "l"}], "]"}], ",", 
              RowBox[{"TraceOfGalois", "[", 
               RowBox[{"N", ",", 
                RowBox[{"V", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "l"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"GaloisGroup", "[", "N", "]"}]}], "}"}]}], "]"}]}]}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673599701496853*^9, 3.673599755282938*^9}, {
   3.6735997992787437`*^9, 3.673599894208951*^9}, {3.673599999721713*^9, 
   3.673600001713118*^9}, {3.673600197801176*^9, 3.673600202256765*^9}, {
   3.673604605175838*^9, 3.6736046524432707`*^9}, {3.6736093862036057`*^9, 
   3.673609398020556*^9}, {3.6742677253035316`*^9, 3.6742677462227*^9}, 
   3.6742678589276943`*^9, 3.674268557739408*^9, {3.6742690773237534`*^9, 
   3.6742690882612553`*^9}, {3.674269177188816*^9, 3.674269201387014*^9}, {
   3.6806883828513393`*^9, 
   3.68068841897427*^9}},ExpressionUUID->"07976f02-9885-4f3c-aab3-\
e4936e008470"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForInductionMatrix", "[", 
   RowBox[{"N_", ",", 
    RowBox[{"inductionMatrix", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "__Integer", "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dimensions", ",", "numberOfObjectsInInductionOfOne", ",", "result"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dimensions", "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"N", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numberOfObjectsInInductionOfOne", "=", 
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
        "inductionMatrix", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"RepresentationsForDimensions", "[", 
         RowBox[{"N", ",", "dimensions"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V_", ",", "Ts_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "Ts", "]"}], ",", "0"}], "]"}], 
          "\[GreaterEqual]", "numberOfObjectsInInductionOfOne"}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Found \>\"", ",", 
       RowBox[{"Length", "[", "result", "]"}], ",", 
       "\"\< allowed representation types for conductor \>\"", ",", "N", ",", 
       " ", "\"\< and induction matrix \>\"", " ", ",", 
       RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}], ",", 
       "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673607852003065*^9, 3.67360798616073*^9}, {
   3.673608028127212*^9, 3.673608028994296*^9}, 3.673608106872764*^9, {
   3.673609323387515*^9, 3.673609329691607*^9}, {3.674269203823463*^9, 
   3.674269213064312*^9}, {3.6742694649269753`*^9, 3.674269465213312*^9}, 
   3.674315419121025*^9, {3.680156653342833*^9, 3.6801566877605753`*^9}, {
   3.680185229079178*^9, 
   3.680185230059222*^9}},ExpressionUUID->"618ee53d-179e-46e5-9d9b-\
7c28ef07aeef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankProgress", "[", "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"Max", "@@", 
         RowBox[{"(", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}], 
          ")"}]}]}], ")"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"DownValues", "[", "RepresentationsForRank", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p_", "\[RuleDelayed]", "_"}], ")"}], "/;", 
            RowBox[{"IntegerQ", "[", 
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}]}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}]}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "&"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674353276938614*^9, 3.674353414978703*^9}, {
  3.674353896676588*^9, 3.674353971188244*^9}, {3.6743547909740458`*^9, 
  3.6743547960154543`*^9}},ExpressionUUID->"7a71975d-2c42-4303-b456-\
e21fc1538dcb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SaveRepresentationsForRank", "[", "]"}], ":=", 
   RowBox[{
   "SaveRepresentationsForRank", "/@", "RepresentationsForRankDirty"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadRepresentationsForRank", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadRepresentationsForRank", "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"___", "~~", "\"\<-\>\"", "~~", 
             RowBox[{"(", 
              RowBox[{"n", ":", 
               RowBox[{"(", 
                RowBox[{"DigitCharacter", ".."}], ")"}]}], ")"}], "~~", 
             "\"\<.m.gz\>\""}], "\[RuleDelayed]", 
            RowBox[{"ToExpression", "[", "n", "]"}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"FileNames", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
           "dataDirectory", ",", "\"\<representationsForRank-*.m.gz\>\""}], 
           "}"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673589616582726*^9, 3.673589681556571*^9}, {
   3.6735938883662987`*^9, 3.6735938954775553`*^9}, {3.673600428169718*^9, 
   3.67360045110505*^9}, {3.67362946110876*^9, 3.6736294621118183`*^9}, {
   3.674225166648288*^9, 3.674225199974859*^9}, {3.67423591077455*^9, 
   3.674235935569606*^9}, {3.674269218981852*^9, 3.67426924013776*^9}, {
   3.674314656672751*^9, 3.674314771720552*^9}, 3.674314886128626*^9, {
   3.674354843245688*^9, 3.674354884523196*^9}, {3.674354919825839*^9, 
   3.6743550052990513`*^9}, {3.67435503713531*^9, 3.674355080570799*^9}, 
   3.674448111915172*^9, 
   3.680150209968822*^9},ExpressionUUID->"fbfb659d-93ed-47cc-9ea8-\
b69141703e67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SaveRepresentationsForRank", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "outputDirectory", ",", "timing"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RepresentationsForRankLoaded", ",", "n"}], "]"}]}], ",", 
        RowBox[{"LoadRepresentationsForRank", "[", "n", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"DownValues", "[", "RepresentationsForRank", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p_", "\[RuleDelayed]", "v_"}], ")"}], "/;", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
              "n"}], "\[And]", 
             RowBox[{"IntegerQ", "[", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
           ")"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
            "\[Rule]", 
            RowBox[{"v", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1", ",", "All", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "data", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Nothing to do.\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Exporting data for conductor \>\"", ",", "n", ",", 
           "\"\<. Raw bytes: \>\"", ",", 
           RowBox[{"ByteCount", "[", "data", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outputDirectory", "=", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"dataDirectory", ",", "\"\<representationsForRank\>\""}], 
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
           RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"timing", "=", 
          RowBox[{
           RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
            RowBox[{"GZIP", "[", 
             RowBox[{"data", ",", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"outputDirectory", ",", 
                 RowBox[{"\"\<representationsForRank-\>\"", "<>", 
                  RowBox[{"ToString", "[", "n", "]"}], "<>", 
                  "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<... completed in \>\"", ",", "timing", ",", " ", 
           "\"\< seconds.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"RepresentationsForRankDirty", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"RepresentationsForRankDirty", ",", "n"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadRepresentationsForRank", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"file", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"file", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<representationsForRank\>\"", ",", 
         RowBox[{"\"\<representationsForRank-\>\"", "<>", 
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.m.gz\>\""}]}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "file", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"ImportGZIP", "[", "file", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Cases", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n", ",", "k_"}], "}"}], "\[Rule]", "Vs_"}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"RepresentationsForRank", "[", 
              RowBox[{"n", ",", "k"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"ts", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"RepresentationDimension", "[", 
                    RowBox[{"n", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
                    "ts"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"TEigenvalues", "[", 
                    RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", "ts"}]}], 
                  "}"}]}], "]"}], "/@", "Vs"}], ")"}]}], ")"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepresentationsForRankLoaded", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"RepresentationsForRankLoaded", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674354260163171*^9, 3.674354404099144*^9}, {
   3.674354436476481*^9, 3.674354443681622*^9}, {3.6743545871387167`*^9, 
   3.67435458859577*^9}, {3.674354618706223*^9, 3.6743546449714327`*^9}, {
   3.674354760015973*^9, 3.6743547673032*^9}, {3.674355793246188*^9, 
   3.6743558054783688`*^9}, {3.67435689163768*^9, 3.674356909120037*^9}, {
   3.67435697801904*^9, 3.6743570378173437`*^9}, {3.674448075666171*^9, 
   3.674448096365569*^9}, {3.674483826516465*^9, 3.6744838607585583`*^9}, {
   3.674488731007412*^9, 3.67448873253117*^9}, {3.674488831838587*^9, 
   3.674488859603511*^9}, 3.674490639025166*^9, {3.67449067764618*^9, 
   3.67449071880405*^9}, {3.6744908457838383`*^9, 3.674490878533125*^9}, {
   3.678844687830817*^9, 3.678844730770919*^9}, {3.678845372657634*^9, 
   3.678845375850752*^9}, {3.678845903797264*^9, 3.678845922561534*^9}, {
   3.678855052692078*^9, 3.6788550564379787`*^9}, {3.678857257251955*^9, 
   3.678857259518745*^9}, {3.678934149826137*^9, 3.678934150253211*^9}, {
   3.680150210950354*^9, 3.6801502120133333`*^9}, {3.6801527695450172`*^9, 
   3.680152814773881*^9}},ExpressionUUID->"cd671782-dabf-4213-96a3-\
078c8e121d30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepresentationsForRankLoaded", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744906686851187`*^9, 
  3.674490673064184*^9}},ExpressionUUID->"b35f6928-c50f-40df-aabe-\
33678def5004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SaveAllModularData", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"SaveRepresentationsForRank", "[", "]"}], ";", 
    RowBox[{"SaveTEigenvalues", "[", "]"}], ";", 
    RowBox[{"SaveConjugacyClasses", "[", "]"}], ";", 
    RowBox[{"SaveCharacterTables", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"SaveGenerators", "[", "]"}], ";"}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6743023871034803`*^9, 3.6743024327250957`*^9}, {
  3.682610331217517*^9, 
  3.6826103324255466`*^9}},ExpressionUUID->"26a6265f-ec7c-4b66-a68b-\
0e388119c00e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"workOnRepresentations", "[", 
   RowBox[{"conductors_", ",", 
    RowBox[{"rank_:", "\[Infinity]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "status", ",", "min", ",", "i", ",", "timing", ",", "length", ",", 
      RowBox[{"counter", "=", "0"}], ",", 
      RowBox[{"cells", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadRepresentationsForRank", "/@", "conductors"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"status", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "0.0", ",", "0", ",", "0"}], "}"}], "&"}], "/@", 
       "conductors"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Min", "@@", 
          RowBox[{"status", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], ")"}], "<",
         "rank"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"min", "=", 
         RowBox[{"Min", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"status", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
            RowBox[{
             SuperscriptBox["10.", 
              RowBox[{"-", "4"}]], 
             RowBox[{"status", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"status", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_", ",", "m_", ",", "_", ",", "l_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"m", "+", 
               RowBox[{
                SuperscriptBox["10.", 
                 RowBox[{"-", "4"}]], "l"}]}], "\[LessEqual]", 
              RowBox[{"min", "+", 
               SuperscriptBox["10.", 
                RowBox[{"-", "6"}]]}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"cells", ",", 
          RowBox[{"PrintTemporary", "[", 
           RowBox[{"\"\<Running RepresentationsForRank[\>\"", ",", 
            RowBox[{"status", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            "\"\<,\>\"", ",", 
            RowBox[{
             RowBox[{"status", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", "1"}], 
            ",", " ", "\"\<] ...\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"timing", ",", "length"}], "}"}], "=", 
         RowBox[{"AbsoluteTiming", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"RepresentationsForRank", "[", 
            RowBox[{
             RowBox[{"status", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"status", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
              "1"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"cells", ",", 
          RowBox[{"PrintTemporary", "[", 
           RowBox[{"\"\<Took \>\"", ",", "timing", ",", "\"\< seconds.\>\""}],
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"cells", ",", 
          RowBox[{"PrintTemporary", "[", 
           RowBox[{
           "\"\<Found \>\"", ",", "length", ",", "\"\< decompositions.\>\""}],
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "cells", "]"}], ">", "9"}], ",", 
          RowBox[{
           RowBox[{"NotebookDelete", "/@", 
            RowBox[{"Drop", "[", 
             RowBox[{"cells", ",", 
              RowBox[{"-", "9"}]}], "]"}]}], ";", 
           RowBox[{"cells", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"cells", ",", 
              RowBox[{"-", "9"}]}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "status", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"status", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "timing",
            ",", 
           RowBox[{
            RowBox[{"status", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "+", "1"}], 
           ",", "length"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"status", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"status", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "rank", ",", "_"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Finished ... saving results.\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"SaveRepresentationsForRank", "/@", "conductors"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674235251575635*^9, 3.674235528107317*^9}, {
   3.6742356344376*^9, 3.674235739506126*^9}, 3.674269550050127*^9, {
   3.674304371057325*^9, 3.6743044075105953`*^9}, {3.674304591763979*^9, 
   3.674304606874475*^9}, {3.674305919377289*^9, 3.674305922317007*^9}, {
   3.674356583449444*^9, 3.67435664329037*^9}, {3.6743679364542522`*^9, 
   3.674367951776993*^9}, {3.674367990851894*^9, 3.674367999455201*^9}, {
   3.674467197297576*^9, 3.674467205159286*^9}, {3.679276235641449*^9, 
   3.6792762367121363`*^9}, {3.680688348549494*^9, 3.680688366495412*^9}, {
   3.683576712380003*^9, 
   3.683576797739471*^9}},ExpressionUUID->"5a793e55-bc69-41d5-ae92-\
37aa2e1752ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Allocating eigenvalues", "Section",
 CellChangeTimes->{{3.680148587893887*^9, 
  3.680148592652047*^9}},ExpressionUUID->"09f9c2a5-514d-4ccc-98d9-\
e4cfe09b798f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LiftsOf1", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}], ",", "1"}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6738498530548143`*^9, 
  3.6738498586415358`*^9}},ExpressionUUID->"3decf1fc-219e-47eb-aa2d-\
fc0bf94400ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListDifference", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a___", ",", "b_", ",", "c___"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b_", ",", "d___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"ListDifference", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "c"}], "}"}], ",", 
    RowBox[{"{", "d", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListDifference", "[", 
   RowBox[{"L_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "L"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673851012734758*^9, 
  3.6738510449309998`*^9}},ExpressionUUID->"c038c6b6-418e-47b6-a6dc-\
3393a9f57d63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToGaloisOrbitClumps", "[", 
   RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outputDirectory", ",", "filename", ",", "liftsOf1", ",", "result", ",", 
      "EigenvalueClumps", ",", "allocations", ",", 
      "AllocateEigenvaluesToGaloisOrbitClumpsImpl", ",", 
      "AllocateEigenvaluesToGaloisOrbitClumpsImpl0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToGaloisOrbitClumps\>\""}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", "inductionMatrix", "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Allocating T-eigenvalues to Galois orbit clumps for \>\"", ",", 
          
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", "X___", "]"}], ":=", 
         RowBox[{
          RowBox[{
          "AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", "X", "]"}], "=", 
          RowBox[{
          "AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", "X", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", "}"}]}], "]"}], ":=", 
         RowBox[{"{", "allocations", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eigenvalues_", ",", "0", ",", 
               RowBox[{"minimumAllowedClump_:", "1"}]}], "}"}], ",", 
             "otherEigenvalues___"}], "}"}]}], "]"}], ":=", 
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations", ",", 
           RowBox[{"{", "otherEigenvalues", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
          RowBox[{"allocations_", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eigenvalues_", ",", "multiplicity_", ",", 
               RowBox[{"minimumAllowedClump_:", "1"}]}], "}"}], ",", 
             "otherEigenvalues___"}], "}"}]}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "positions", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "decide", " ", "which", " ", "clumps", " ", "have", " ", "enough",
              " ", "room"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"positions", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"allocations", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"simples_", ",", "allocatedEigenvalues_"}], "}"}],
                    "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "simples", "]"}], "-", 
                    RowBox[{"Length", "[", "allocatedEigenvalues", "]"}], "-", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"simples", ",", 
                    RowBox[{"Alternatives", "@@", "liftsOf1"}]}], "]"}], "-", 
                    
                    RowBox[{"Count", "[", 
                    RowBox[{"allocatedEigenvalues", ",", "0"}], "]"}], "-", 
                    RowBox[{"Count", "[", 
                    RowBox[{"eigenvalues", ",", "0"}], "]"}]}], ")"}], ",", 
                    "0"}], "]"}]}], "\[GreaterEqual]", 
                    RowBox[{"Length", "[", "eigenvalues", "]"}]}], ")"}]}], 
                  ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"p_", "/;", 
                RowBox[{"p", "\[GreaterEqual]", "minimumAllowedClump"}]}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", "p", "}"}], ",", 
                 RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl", "[", 
                  RowBox[{
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"allocations", ",", 
                    RowBox[{"p", "\[Rule]", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{
                    "allocations", "\[LeftDoubleBracket]", "p", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"2", "\[Rule]", 
                    RowBox[{
                    RowBox[{"allocations", "\[LeftDoubleBracket]", 
                    RowBox[{"p", ",", "2"}], "\[RightDoubleBracket]"}], "~", 
                    "Join", "~", "eigenvalues"}]}]}], "]"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"eigenvalues", ",", 
                    RowBox[{"multiplicity", "-", "1"}], ",", "p"}], "}"}], 
                    ",", "otherEigenvalues"}], "}"}]}], "]"}]}], "]"}], "/@", 
               "positions"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"{", "}"}], "]"}], ":=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"eigenvalues", ":", 
           RowBox[{"{", 
            RowBox[{"__", "?", "NumericQ"}], "}"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"EigenvalueClumps", "[", "eigenvalues", "]"}], "=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "clump", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"clump", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["l", "2"], 
                    RowBox[{
                    "eigenvalues", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "clump", "}"}], "~", "Join", "~", 
              RowBox[{"EigenvalueClumps", "[", 
               RowBox[{"ListDifference", "[", 
                RowBox[{"eigenvalues", ",", "clump"}], "]"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EigenvalueClumps", "[", 
          RowBox[{"eigenvalueLists", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"__", "?", "NumericQ"}], "}"}], ".."}], "}"}]}], "]"}], 
         ":=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"EigenvalueClumps", "[", "#", "]"}], "&"}], "/@", 
            "eigenvalueLists"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"liftsOf1", "=", 
         RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allocations", "=", 
         RowBox[{"RepresentationsForInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"representation", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"representation", "~", "Join", "~", 
                 RowBox[{"{", "#", "}"}]}], "&"}], "/@", 
               RowBox[{"AllocateEigenvaluesToGaloisOrbitClumpsImpl0", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"GaloisOrbitClumps", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"DimensionsFromInductionMatrix", "[", 
                    RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}]}], 
                 ",", 
                 RowBox[{"Tally", "[", 
                  RowBox[{"EigenvalueClumps", "[", 
                   RowBox[{
                   "representation", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}], "]"}]}]}], 
             "]"}], ",", "allocations"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< ways to allocate T-eigenvalues to the Galois orbit clumps for \
\>\"", ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673848999883732*^9, 3.6738492522886953`*^9}, {
   3.6738498702135344`*^9, 3.673849875961112*^9}, {3.6738512769057302`*^9, 
   3.673851286172144*^9}, {3.6738521787570047`*^9, 3.673852181244804*^9}, 
   3.673852317118577*^9, {3.673856240120695*^9, 3.673856244351918*^9}, 
   3.6738628527322493`*^9, {3.674269575781764*^9, 3.6742695772550163`*^9}, {
   3.678845276978421*^9, 3.678845360259757*^9}, {3.6788454025516567`*^9, 
   3.678845411584402*^9}, {3.678845486864637*^9, 3.678845490220063*^9}, {
   3.6788572347041817`*^9, 3.678857239599328*^9}, {3.678857702275263*^9, 
   3.678857716581044*^9}, {3.678934154942212*^9, 3.678934155826182*^9}, {
   3.67927518382932*^9, 3.679275269077188*^9}, {3.679275319077376*^9, 
   3.6792753471448183`*^9}, {3.6792753838286*^9, 3.679275434621409*^9}, {
   3.679352376490192*^9, 3.679352381492366*^9}, {3.679353282294774*^9, 
   3.679353282462228*^9}, {3.679368373128183*^9, 3.6793683734023237`*^9}, {
   3.679368416970613*^9, 3.679368418131886*^9}, 3.680148569578554*^9, 
   3.680150213116271*^9, {3.680152468620266*^9, 3.6801525207273617`*^9}, {
   3.680156600171886*^9, 3.6801566245536537`*^9}, {3.680166011429926*^9, 
   3.680166033264419*^9}, {3.680166676105117*^9, 3.680166683123006*^9}, {
   3.680177026718829*^9, 3.6801770390569143`*^9}, {3.680184987693706*^9, 
   3.680184994427549*^9}, {3.680302027991516*^9, 
   3.680302032277274*^9}},ExpressionUUID->"9fc393a6-4c3f-409d-b84a-\
cc5201897aaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{
   RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix", "]"}], "=", 
   
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"GroupBy", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"inductionMatrix", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "#"}], "\[RightDoubleBracket]"}], "&"}]}], "]"}],
      "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673852569995378*^9, 3.6738526492423897`*^9}, {
  3.673852968204924*^9, 
  3.673852974146366*^9}},ExpressionUUID->"abe579ce-5235-4675-8bd8-\
d8ddcc9e0b96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EquivalenceClassesOfSimples", "[", 
   RowBox[{"induction_", ",", "eigenvalues_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"GroupBy", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", 
        RowBox[{
        "induction", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"induction", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "#1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "eigenvalues", "\[LeftDoubleBracket]", "#1", 
          "\[RightDoubleBracket]"}]}], "}"}], "&"}]}], "]"}], "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67445019381915*^9, 
  3.674450259987748*^9}},ExpressionUUID->"740a23a7-9601-4894-933d-\
08add46f3141"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "[", "AllocateEigenvaluesToSimples", "]"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673888999655917*^9, 
  3.673889000942994*^9}},ExpressionUUID->"40d08055-1144-4303-a380-\
140a196bac58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AllocateEigenvaluesToSimples", "[", 
     RowBox[{"n", ",", "inductionMatrix", ",", "clumps"}], "]"}], "="}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toAssign", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toAssign", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"EquivalenceClassesOfSimples", "[", "inductionMatrix", "]"}], 
        ",", 
        RowBox[{"Function", "[", 
         RowBox[{"class", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"class", ",", 
                RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}]}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"DimensionsFromInductionMatrix", "[", 
               RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{
               "class", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"AllocateEigenvaluesToSimples", "[", 
       RowBox[{
       "n", ",", "inductionMatrix", ",", "clumps", ",", "toAssign", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"DimensionsFromInductionMatrix", "[", 
              RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}], ",", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           SuperscriptBox[
            RowBox[{
             RowBox[{"DimensionsFromInductionMatrix", "[", 
              RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "2"], 
           "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"result", ",", 
       RowBox[{"r_", "/;", 
        RowBox[{"And", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "@@", 
             RowBox[{"(", 
              RowBox[{"Length", "/@", 
               RowBox[{"PossibleGaloisImages", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"DimensionsFromInductionMatrix", "[", 
                  RowBox[{"n", ",", "inductionMatrix"}], "]"}], ",", "r", ",",
                  "l"}], "]"}]}], ")"}]}], "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"GaloisGroupGenerators", "[", "n", "]"}]}], "}"}]}], 
          "]"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673853325922226*^9, 3.673853349737873*^9}, {
   3.6738573048556623`*^9, 3.673857400886141*^9}, {3.673857498569078*^9, 
   3.673857530740897*^9}, {3.673857657556403*^9, 3.673857694211245*^9}, {
   3.673858138463969*^9, 3.673858144938106*^9}, {3.673858714655789*^9, 
   3.673858719844413*^9}, {3.673888885699607*^9, 3.673888988366816*^9}, 
   3.680148617442622*^9, {3.722557406885041*^9, 
   3.722557420301779*^9}},ExpressionUUID->"9df6e62b-4d67-4aa1-9339-\
6166490f2d56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_", ",", 
    RowBox[{"{", "}"}], ",", "assigned_", ",", "_", ",", "_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "T", ",", "\[ScriptCapitalD]", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "now", " ", "we", " ", "check", " ", "the", " ", "top", " ", "left", 
       " ", "entry", " ", "of", " ", "STSTST"}], "=", 
      RowBox[{"C", " ", "exactly"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"Sort", "[", "assigned", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      SuperscriptBox[
       RowBox[{"\[Zeta]", "[", "n", "]"}], 
       RowBox[{"n", " ", "t"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"counter", "++"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", "d"}], "}"}], "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           SuperscriptBox["d", "2"], ")"}], ".", "T"}], "-", 
         "\[ScriptCapitalD]"}], "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "t", "}"}], ",", 
       RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67385289565*^9, 3.673852959640892*^9}, {
   3.673853005497538*^9, 3.673853015670753*^9}, {3.673853289612453*^9, 
   3.673853324352941*^9}, {3.673853359437171*^9, 3.673853367168154*^9}, {
   3.673853516438046*^9, 3.6738535183186483`*^9}, {3.6738539320618277`*^9, 
   3.673853936449142*^9}, {3.6738539927568493`*^9, 3.6738540135919037`*^9}, {
   3.673854196853718*^9, 3.673854200443177*^9}, {3.67385434483575*^9, 
   3.673854411869487*^9}, {3.673856091369698*^9, 3.673856093609171*^9}, {
   3.673856916052457*^9, 3.6738569168296213`*^9}, {3.6738569901476097`*^9, 
   3.673856991989357*^9}, {3.6738570509373417`*^9, 3.673857055827697*^9}, {
   3.6738571779761753`*^9, 3.67385720507815*^9}, {3.6738572430318317`*^9, 
   3.673857245463071*^9}, {3.673857677716651*^9, 3.673857678893882*^9}, {
   3.6743159477201242`*^9, 3.674315968601039*^9}, {3.674318719012391*^9, 
   3.674318719063364*^9}, 3.680148654121207*^9, {3.68348979686827*^9, 
   3.683489799099556*^9}},ExpressionUUID->"8e872577-b01e-4265-8695-\
7f256f9a5d5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_", ",", "clumps_", ",", 
    RowBox[{"{", 
     RowBox[{"toAssign_", ",", "others___"}], "}"}], ",", "assigned_", ",", 
    "partialSum_", ",", "totalRemainingDimension_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "subsets", ",", "dims"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"clumps", ",", 
         RowBox[{"{", 
          RowBox[{"toAssign", ",", "others"}], "}"}], ",", "assigned", ",", 
         "partialSum", ",", "totalRemainingDimension"}], "}"}], "]"}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"N", "[", "partialSum", "]"}], "]"}], "\[GreaterEqual]", 
       RowBox[{"totalRemainingDimension", "+", "1"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"stoppedEarly", "++"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dims", "=", 
        RowBox[{
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "toAssign"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"clumps", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"simples_", ",", "_"}], "}"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"simples", ",", "toAssign"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"Length", "[", "toAssign", "]"}]}]}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subsets", "=", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"LiftsOf1", "[", "inductionMatrix", "]"}], ",", 
              "toAssign"}], "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "toAssign", "]"}], "}"}]}], "]"}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Union", "[", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"clumps", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "toAssign", "]"}], "}"}]}], "]"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "could", " ", "try", " ", "to", " ", "filter", " ", "the",
           " ", "subsets", " ", "early"}], ",", " ", 
         RowBox[{
         "checking", " ", "compatibility", " ", "with", " ", "possible", " ", 
          "Galois", " ", 
          RowBox[{"actions", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"for", " ", "now"}], ",", " ", 
         RowBox[{
         "we", " ", "just", " ", "check", " ", "after", " ", "all", " ", 
          "have", " ", "been", " ", "allocated"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"subset", ",", 
            RowBox[{"AllocateEigenvaluesToSimples", "[", 
             RowBox[{"n", ",", "inductionMatrix", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"clumps", ",", 
                RowBox[{"i", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ListDifference", "[", 
                    RowBox[{
                    RowBox[{"clumps", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "toAssign"}], "]"}], ",", 
                   RowBox[{"ListDifference", "[", 
                    RowBox[{
                    RowBox[{"clumps", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    "subset"}], "]"}]}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", "others", "}"}], ",", 
              RowBox[{"assigned", "~", "Join", "~", 
               RowBox[{"Thread", "[", 
                RowBox[{"toAssign", "\[Rule]", "subset"}], "]"}]}], ",", 
              RowBox[{"partialSum", "+", 
               RowBox[{
                RowBox[{"(", 
                 SuperscriptBox["dims", "2"], ")"}], ".", 
                RowBox[{"(", 
                 SuperscriptBox[
                  RowBox[{"\[Zeta]", "[", "n", "]"}], 
                  RowBox[{"n", " ", "subset"}]], ")"}]}]}], ",", 
              RowBox[{"Chop", "[", 
               RowBox[{"totalRemainingDimension", "-", 
                RowBox[{"dims", ".", "dims"}]}], "]"}]}], "]"}]}], "]"}], "/@",
           "subsets"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6738533731159763`*^9, 3.673853500092545*^9}, {
   3.673853555194577*^9, 3.6738536558648853`*^9}, {3.67385371611808*^9, 
   3.673853717760006*^9}, {3.673853814749874*^9, 3.673853872557906*^9}, {
   3.673855347020949*^9, 3.67385536798491*^9}, 3.6738572971195087`*^9, {
   3.673857458586851*^9, 3.673857465644885*^9}, {3.67385770029081*^9, 
   3.673857736735579*^9}, {3.673857800509128*^9, 3.673857808429364*^9}, {
   3.673857887404862*^9, 3.673858060745614*^9}, {3.673858181796905*^9, 
   3.6738581946953487`*^9}, {3.6738585483598757`*^9, 3.673858551534693*^9}, {
   3.6738609747566633`*^9, 3.6738609765947733`*^9}, {3.6738617846703253`*^9, 
   3.6738617850644693`*^9}, {3.674316006974701*^9, 3.6743160070319433`*^9}, {
   3.674316044935124*^9, 3.674316056240445*^9}, {3.6744476352814083`*^9, 
   3.6744476486008787`*^9}, 3.680148633096621*^9, {3.680918803411569*^9, 
   3.680918829852827*^9}, 
   3.680920269239715*^9},ExpressionUUID->"1f33843b-ae30-4082-830c-\
26b43a02cde0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimples", "[", 
   RowBox[{"n_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"outputDirectory", ",", "filename", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", "\"\<allocateEigenvaluesToSimples\>\""}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", "inductionMatrix", "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"(*", 
       RowBox[{"False", "\[And]"}], "*)"}], 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "A", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "}"}], "&"}], "/@", 
                RowBox[{"AllocateEigenvaluesToSimples", "[", 
                 RowBox[{"n", ",", "inductionMatrix", ",", 
                  RowBox[{
                  "A", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", 
             RowBox[{"AllocateEigenvaluesToGaloisOrbitClumps", "[", 
              RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< candidate T-matrices for \>\"", ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.673854443958605*^9, 3.673854536919653*^9}, {
   3.6788455129293823`*^9, 3.678845542755239*^9}, {3.6788572161951723`*^9, 
   3.678857221016027*^9}, {3.678857669248413*^9, 3.678857682998412*^9}, {
   3.678857827230777*^9, 3.678857828265324*^9}, {3.6789341602448177`*^9, 
   3.678934160613752*^9}, {3.679352347976351*^9, 3.679352356108346*^9}, 
   3.679608132128227*^9, 3.680150214294475*^9, {3.680152543129846*^9, 
   3.6801525701085997`*^9}, {3.680156500498102*^9, 3.680156552770372*^9}, {
   3.680165875353547*^9, 3.680165894309963*^9}, {3.680418023772415*^9, 
   3.6804180240657663`*^9}, {3.681082007225245*^9, 3.681082011728353*^9}, 
   3.6834466026812677`*^9},ExpressionUUID->"c4f6c82d-d788-4c39-b53a-\
f512f8d59c35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frobenius-Schur indicators", "Section",
 CellChangeTimes->{{3.680148669394021*^9, 
  3.6801486788050756`*^9}},ExpressionUUID->"9e26f7a3-68d6-4bcd-9174-\
9680298059a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", "k_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dims", ",", "\[ScriptCapitalD]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[ScriptCapitalD]"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "1"}], 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Zeta]", "[", "n", "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", " ", 
              RowBox[{
              "Ts", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
             ")"}], "k"}]], 
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          RowBox[{"inductionMatrix", "\[LeftDoubleBracket]", 
           RowBox[{"m", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679194232652401*^9, 3.679194256513378*^9}, {
  3.6791943555572567`*^9, 3.67919456399506*^9}, {3.679194639766917*^9, 
  3.679194655358815*^9}, {3.679195357226183*^9, 
  3.6791953590487947`*^9}},ExpressionUUID->"b6e3624e-2aad-4581-abd5-\
430261fe9f3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators1", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AllocateEigenvaluesToSimples", "[", 
     RowBox[{"n", ",", "inductionMatrix"}], "]"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"a_", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FrobeniusSchurIndicators", "[", 
         RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "[", "1", "]"}], "\[Equal]", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "inductionMatrix", "]"}], ",", "1"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791979365055313`*^9, 3.679197975579067*^9}, 
   3.679202872497254*^9},ExpressionUUID->"2ef7a00e-e1b1-438d-a93c-\
99b3af5cc6bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FusionPower", "[", "fusion_", "]"}], "[", 
   RowBox[{"i_", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"i", "-", 
      RowBox[{"th", " ", "object"}]}], " ", "*)"}], ",", "k_"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"raised", " ", "to", " ", "the", " ", "k"}], "-", 
     RowBox[{"th", " ", "power"}]}], " ", "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"fusion", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1", ",", "2", ",", "i"}], "\[RightDoubleBracket]"}], 
     ",", "k"}], "]"}], ".", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"fusion", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
     ",", "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679196408602461*^9, 3.67919643060382*^9}, {
  3.679196462144663*^9, 
  3.67919651638107*^9}},ExpressionUUID->"819ed44a-d3b3-4137-94b8-\
d818d3ff95bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FrobeniusSchurIndicators", "[", 
      RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
     "Ts_", "]"}], "[", 
    RowBox[{"k_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"GCD", "[", 
     RowBox[{"k", ",", "l"}], "]"}], "\[Equal]", "1"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsind", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"FrobeniusSchurIndicators", "[", 
           RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
          "Ts", "]"}], "[", "k", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GaloisAction", "[", "k", "]"}], "[", "l", "]"}], "[", 
           RowBox[{"ToNumberField", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\[Zeta]", "[", "k", "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "$Failed", ",", 
          RowBox[{"{", 
           StyleBox[
            RowBox[{"ToNumberField", "::", "nnfel"}], "MessageName"], "}"}]}],
          "]"}], "&"}], "/@", "fsind"}]}], "\[IndentingNewLine]", "]"}], ",", 
    
    StyleBox[
     RowBox[{"ToNumberField", "::", "nnfel"}], "MessageName"]}], 
   StyleBox["]", "MessageName"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", 
   RowBox[{"k_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"GCD", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
          RowBox[{"m", ",", "g"}], "]"}], ".", 
         RowBox[{
          RowBox[{
           RowBox[{"FrobeniusSchurIndicators", "[", 
            RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], "[", 
           "Ts", "]"}], "[", 
          RowBox[{
           RowBox[{"k", "/", "g"}], ",", 
           RowBox[{"l", "/", "g"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"result", ",", "$Failed"}], "]"}], ",", "result", ",", 
         "$Failed"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791948828602953`*^9, 3.679194915840851*^9}, {
  3.679195189727335*^9, 3.6791952980819902`*^9}, {3.679195362545627*^9, 
  3.6791953688264008`*^9}, {3.679196387593473*^9, 3.679196388791944*^9}, {
  3.679196554153584*^9, 3.67919657562857*^9}, {3.679196610665079*^9, 
  3.679196673630838*^9}, {3.679196707515403*^9, 3.679196707682146*^9}, {
  3.6791983515584106`*^9, 3.6791984100745783`*^9}, {3.6791985688925743`*^9, 
  3.679198623939399*^9}, {3.6806095433965282`*^9, 3.680609625054883*^9}, {
  3.680610343828656*^9, 3.680610354016274*^9}, {3.680610458138578*^9, 
  3.6806105303991337`*^9}, {3.680610609942226*^9, 
  3.680610619627862*^9}},ExpressionUUID->"d72dadb1-98f4-4b87-9b9a-\
842d763ddaba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerifyFrobeniusSchurIndicators", "[", 
     RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_"}], "]"}], "[", 
    "Ts_", "]"}], "[", "k_", "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"traces", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FrobeniusSchurIndicators", "[", "Ts", "]"}], "[", 
              RowBox[{"k", ",", "l"}], "]"}], "\[LeftDoubleBracket]", "m", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "0", ",", 
              RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"traces", ",", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Length", "[", 
           RowBox[{"NewtonsIdentity", "[", 
            RowBox[{"k", ",", "traces"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"-", "\[Infinity]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
        RowBox[{"m", ",", "k"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"m", ",", "1", ",", 
      RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679200152398218*^9, 3.679200297271719*^9}, {
  3.679200421917721*^9, 3.679200427543573*^9}, {3.680609936244033*^9, 
  3.680609951766721*^9}},ExpressionUUID->"f09e727b-565d-49c7-9b28-\
4ebad7e5d891"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reportedOnce", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reportFPIndicatorsInBadField", "[", "stuff___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "reportedOnce"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Found a Frobenius-Schur indicator that isn't even in the correct \
field: \>\"", ",", 
        RowBox[{"{", "stuff", "}"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"reportedOnce", "=", "True"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680610074707345*^9, 
  3.6806101277337627`*^9}},ExpressionUUID->"6bdeafa2-459f-4c14-a967-\
3b484be5f0d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k0_", ",", "inductionMatrix_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outputDirectory", ",", "filename", ",", "result", ",", "allocated"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators\>\"\
"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k0", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "inductionMatrix"}], "}"}], "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Looking for T-matrices for \>\"", ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", " ", "\"\< \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allocated", "=", 
         RowBox[{"AllocateEigenvaluesToSimples", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<... checking Frobenius-Schur indicators\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pairs", ",", "cachedFrobeniusSchurIndicators", ",", 
             "verifyFrobeniusSchurIndicators"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cachedFrobeniusSchurIndicators", "[", "Ts_", "]"}], 
              "[", "X___", "]"}], ":=", 
             RowBox[{
              RowBox[{
               RowBox[{"cachedFrobeniusSchurIndicators", "[", "Ts", "]"}], 
               "[", "X", "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"FrobeniusSchurIndicators", "[", 
                 RowBox[{"n", ",", "fusion", ",", "inductionMatrix"}], "]"}], 
                "[", "Ts", "]"}], "[", "X", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"verifyFrobeniusSchurIndicators", "[", "Ts_", "]"}], 
              "[", "k_", "]"}], ":=", 
             RowBox[{
              RowBox[{
               RowBox[{"verifyFrobeniusSchurIndicators", "[", "Ts", "]"}], 
               "[", "k", "]"}], "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"traces", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "cachedFrobeniusSchurIndicators", "[", "Ts", "]"}], "[", 
                    RowBox[{"k", ",", "l"}], "]"}], "\[LeftDoubleBracket]", 
                    "m", "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "0", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"traces", ",", "$Failed"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Length", "[", 
                    RowBox[{"NewtonsIdentity", "[", 
                    RowBox[{"k", ",", "traces"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"reportFPIndicatorsInBadField", "[", 
                    RowBox[{
                    "n", ",", "fusion", ",", "inductionMatrix", ",", 
                    "traces"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"-", "\[Infinity]"}]}]}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FusionPower", "[", "fusion", "]"}], "[", 
                    RowBox[{"m", ",", "k"}], "]"}], "\[LeftDoubleBracket]", 
                   "1", "\[RightDoubleBracket]"}]}], "}"}], 
                "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "1", ",", 
                  RowBox[{"Length", "[", "inductionMatrix", "]"}]}], "}"}]}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"AllocateEigenvaluesToSimples", "[", 
                RowBox[{"n", ",", "inductionMatrix"}], "]"}], "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"cachedFrobeniusSchurIndicators", "[", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "1", "]"}], "&"}], 
                "/@", 
                RowBox[{"AllocateEigenvaluesToSimples", "[", 
                 RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], "]"}], ";"}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"pairs", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"verifyFrobeniusSchurIndicators", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "k", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "k0"}], "}"}]}], "]"}]}], 
                 "}"}], "&"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                RowBox[{"allocated", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"a_", "/;", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"cachedFrobeniusSchurIndicators", "[", 
                    RowBox[{
                    "a", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "[", "1", "]"}], 
                   "\[Equal]", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "inductionMatrix", "]"}], ",", 
                    "1"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "pairs", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Cases", "[", 
             RowBox[{"pairs", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x_", ",", "v_"}], "}"}], "/;", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "&"}], "/@", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"v", ",", "1"}], "]"}]}], "]"}], "===", 
                 RowBox[{"{", "0", "}"}]}]}], "\[RuleDelayed]", "x"}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Found \>\"", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", " ", 
          "\"\< T-matrices with good Frobenius-Schur indicators for \>\"", 
          ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", " ", "\"\< \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", "inductionMatrix", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"TableForm", "[", "#", "]"}], "]"}], "&"}], "/@", 
           "result"}], ";"}], "*)"}], "\[IndentingNewLine]", "result"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6791979365055313`*^9, 3.679197975579067*^9}, {
   3.679202175908864*^9, 3.679202323227816*^9}, {3.679202355632428*^9, 
   3.679202359073326*^9}, {3.679202394132509*^9, 3.6792024159502707`*^9}, 
   3.679202526878684*^9, {3.679202584179028*^9, 3.679202633646234*^9}, {
   3.6792026849092283`*^9, 3.679202710766276*^9}, {3.679203329782155*^9, 
   3.679203345365027*^9}, {3.679203411516075*^9, 3.679203416318056*^9}, 
   3.679255852443926*^9, {3.679265409215827*^9, 3.6792654334490967`*^9}, {
   3.679275830500469*^9, 3.67927599788645*^9}, {3.679276053317904*^9, 
   3.679276083063861*^9}, {3.679711299172565*^9, 3.679711308448831*^9}, {
   3.679711339045067*^9, 3.6797113542372303`*^9}, {3.6797114788758373`*^9, 
   3.6797115099430227`*^9}, {3.679711573062524*^9, 3.679711620491478*^9}, 
   3.6801502152098*^9, {3.6801525797872257`*^9, 3.6801526172948008`*^9}, {
   3.680153335858597*^9, 3.6801534059329977`*^9}, {3.680153456733128*^9, 
   3.6801534699982967`*^9}, {3.6801565324610777`*^9, 3.680156543636347*^9}, {
   3.680165918147871*^9, 3.6801659949181232`*^9}, 3.680418035859128*^9, {
   3.68060986329237*^9, 3.6806099134685297`*^9}, {3.680609991339525*^9, 
   3.6806100653050547`*^9}, 
   3.6806106522170563`*^9},ExpressionUUID->"0dbe25d2-7d6e-45d7-a5c7-\
d6426ddc55b9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Progress", "[", 
    RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FileNames", "[", 
     RowBox[{"ToFileName", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
        RowBox[{"\"\<*\>\"", "<>", 
         RowBox[{"SHA1", "[", "induction", "]"}], "<>", "\"\<*\>\""}]}], 
       "}"}], "]"}], "]"}], "~", "Join", "~", 
    RowBox[{"FileNames", "[", 
     RowBox[{"ToFileName", "[", 
      RowBox[{"{", 
       RowBox[{"dataDirectory", ",", "\"\<*\>\"", ",", 
        RowBox[{"\"\<*\>\"", "<>", 
         RowBox[{"SHA1", "[", 
          RowBox[{"{", 
           RowBox[{"fusion", ",", "induction"}], "}"}], "]"}], "<>", 
         "\"\<*\>\""}]}], "}"}], "]"}], "]"}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796031873527403`*^9, 3.679603226591681*^9}, {
  3.679603540878314*^9, 3.679603570609726*^9}, {3.679603622847403*^9, 
  3.679603634184362*^9}, {3.680150217154623*^9, 
  3.680150218268345*^9}},ExpressionUUID->"f3ec3a52-b90a-4746-bebc-\
3e710b83444f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"StillTodo", "[", 
    RowBox[{"fusion_", ",", "induction_"}], "]"}], ":=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"PossibleConductors", "[", "induction", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\</\>\""}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "\"\<,\>\""}],
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Progress", "[", 
         RowBox[{"fusion", ",", "induction"}], "]"}], ",", 
        RowBox[{"s_", "/;", 
         RowBox[{"!", 
          RowBox[{"StringFreeQ", "[", 
           RowBox[{
           "s", ",", 
            "\"\<allocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators\
\>\""}], "]"}]}]}]}], "]"}]}]}], "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6796038612976503`*^9, 3.679603978789209*^9}, {
  3.679604013609014*^9, 
  3.679604071223462*^9}},ExpressionUUID->"d93da676-fb35-4337-83e3-\
14b8079df9e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Galois actions", "Section",
 CellChangeTimes->{{3.680148720878458*^9, 
  3.680148724414571*^9}},ExpressionUUID->"7ecbac2a-dcb7-4e9a-954d-\
d619ef8f7e33"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "disaster"}], ";", " ", 
   RowBox[{
   "it", " ", "has", " ", "been", " ", "rewritten", " ", "from", " ", 
    RowBox[{"scratch", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.680260493476913*^9, 3.680260505605186*^9}, {
  3.6834898225447206`*^9, 
  3.6834898256159067`*^9}},ExpressionUUID->"addd14bd-c94a-478a-8657-\
11a67f584fb8"],

Cell[BoxData[
 RowBox[{"Clear", "[", "PartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674450299905356*^9, 
  3.6744503007512493`*^9}},ExpressionUUID->"e43b4536-f23c-4969-bf6e-\
bd46b2ee5b07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"l", "\[Rule]", 
       RowBox[{"PossibleGaloisImages", "[", 
        RowBox[{"n", ",", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "induction"}], "]"}], ",", "l"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"EquivalenceClassesOfSimples", "[", "induction", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{"n_Integer", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}], ",", "eigenvalues_List"}], "]"}], 
  ":=", 
  RowBox[{"PartialGaloisAction", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"l", "\[Rule]", 
       RowBox[{"PossibleGaloisImages", "[", 
        RowBox[{"n", ",", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "induction"}], "]"}], ",", "eigenvalues", ",", 
         "l"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"EquivalenceClassesOfSimples", "[", 
     RowBox[{"induction", ",", "eigenvalues"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742806499139*^9, 3.674280682433951*^9}, {
  3.67428083402915*^9, 3.674280834697342*^9}, {3.67428086533123*^9, 
  3.674280867527556*^9}, {3.674448323893629*^9, 3.6744483326234426`*^9}, {
  3.674450128998858*^9, 3.674450187659689*^9}, {3.6744503210646048`*^9, 
  3.6744503282133217`*^9}, {3.674450378684196*^9, 3.674450390939302*^9}, {
  3.674450594326188*^9, 
  3.674450596797525*^9}},ExpressionUUID->"216aa8ae-8a85-4235-a0dd-\
bdc067f04c84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitSymmetries", "[", 
   RowBox[{"pga_PartialGaloisAction", ",", 
    RowBox[{"ks", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"pga", ",", 
    RowBox[{"2", "\[Rule]", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{"#", ",", "ks"}], "]"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{"#", ",", "ks"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "&"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674450711506619*^9, 3.674450775983185*^9}, {
  3.6744509616120377`*^9, 3.674451047096899*^9}, {3.674451162778809*^9, 
  3.674451210312386*^9}},ExpressionUUID->"c957d659-b4cb-403e-a18a-\
bf7a72e9acc1"],

Cell[BoxData[
 RowBox[{"Clear", "[", "RefinePartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6788652728767843`*^9, 
  3.678865276005679*^9}},ExpressionUUID->"11e8c52b-e23c-424e-81ac-\
8edb02bafd53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{"n_", ",", "pga_PartialGaloisAction"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"targets", ",", "l", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "look", " ", "for", " ", "a", " ", "Galois", " ", "element", " ", 
      "which", " ", 
      RowBox[{"isn", "'"}], "t", " ", "determined", " ", 
      RowBox[{"yet", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"targets", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{"images_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "images", "]"}], ">", "1"}]}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targets", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"targets", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"GaloisGroupGenerators", "[", "n", "]"}], ",", 
            RowBox[{
             RowBox[{"GaloisGroup", "[", "n", "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}]}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "targets", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"we", "'"}], "re", " ", 
         RowBox[{"done", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GaloisAction", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
           RowBox[{
            RowBox[{"list", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "_Integer", "}"}], ".."}], "}"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"Flatten", "[", "list", "]"}]}]}], ",", 
          RowBox[{
          "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{
          RowBox[{"GaloisGroup", "[", "n", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"targets", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"targets", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lastPartialGaloisAction", "=", 
         RowBox[{"RefinePartialGaloisAction", "[", 
          RowBox[{"n", ",", 
           RowBox[{"SplitSymmetries", "[", 
            RowBox[{"pga", ",", 
             RowBox[{"{", "k", "}"}]}], "]"}], ",", "l", ",", "k"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674280498419908*^9, 3.674280641297702*^9}, {
   3.674280845502523*^9, 3.674280974218174*^9}, {3.674281205796764*^9, 
   3.6742812121068068`*^9}, {3.6744506998143063`*^9, 
   3.6744507085775213`*^9}, {3.6744509541634207`*^9, 
   3.6744509549199944`*^9}, {3.674451060655278*^9, 3.674451064939274*^9}, {
   3.678940325809029*^9, 3.678940353949073*^9}, {3.678940428203903*^9, 
   3.678940458244357*^9}, {3.6789406152337427`*^9, 3.6789406204814653`*^9}, {
   3.679870284125452*^9, 3.679870351611068*^9}, 3.67987047617235*^9, 
   3.6798706186546097`*^9, {3.67987069815661*^9, 3.679870727812195*^9}, {
   3.6798709677211113`*^9, 3.679870974256556*^9}, {3.680260286907276*^9, 
   3.68026031822917*^9}},ExpressionUUID->"a9be628e-2f00-4414-ac06-\
4b7b63dff9c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "images", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"okay", ",", " ", 
      RowBox[{"decide", " ", "where", " ", "l", " ", "sends", " ", "k"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "/.", 
         RowBox[{
         "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"make", " ", "use", " ", "of", " ", 
       RowBox[{"symmetries", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"images", "=", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"images", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{
          "pga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"RefinePartialGaloisAction", "[", 
          RowBox[{"n", ",", 
           RowBox[{"SplitSymmetries", "[", 
            RowBox[{"pga", ",", 
             RowBox[{"{", "#", "}"}]}], "]"}], ",", "l", ",", "k", ",", 
           RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", "images"}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674280989695241*^9, 3.674281010614181*^9}, {
  3.67428106266956*^9, 3.674281075238667*^9}, {3.6742811671860847`*^9, 
  3.6742812210962667`*^9}, {3.674281425867353*^9, 3.674281426843789*^9}, {
  3.674282386444347*^9, 3.674282389345723*^9}, {3.674450820745191*^9, 
  3.674450902456018*^9}, {3.674450957496279*^9, 
  3.674450958208515*^9}},ExpressionUUID->"e41e7fc7-585d-4f5f-94ff-\
4a72683cd688"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer", 
    ",", 
    RowBox[{"ms0", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678865354725484*^9, 
  3.678865361104784*^9}},ExpressionUUID->"63ac7eb2-cb1d-4b84-8875-\
71fbb230e1d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinePartialGaloisAction", "[", 
   RowBox[{
   "n_", ",", "pga_PartialGaloisAction", ",", "l_Integer", ",", "k_Integer", 
    ",", 
    RowBox[{"ms0", ":", 
     RowBox[{"{", "__Integer", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ms", ",", "result", ",", "updateResult", ",", "rank"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          ",", "ms0"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"No", " ", "new", " ", "information"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", "pga", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ms", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{"ms0", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ms", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "=", 
           RowBox[{"pga", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "\[Rule]", "images_"}], ")"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"l", "\[Rule]", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "ms", "]"}], "\[Equal]", "1"}], 
                   ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"#", ",", "ms"}], "]"}], "&"}], "/@", "images"}], 
                   ",", "images"}], "]"}], ",", 
                 RowBox[{"k", "\[Rule]", "ms"}]}], "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "And", " ", "now", " ", "we", " ", "should", " ", "propagate", " ",
             "information", " ", "to", " ", "all", " ", "other", " ", 
            "Galois", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"EnforcePartialGaloisActionInverses", "[", 
            RowBox[{"n", ",", "result", ",", "l", ",", "k"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rank", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"pga", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"Fold", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
                 RowBox[{"n", ",", "#1", ",", 
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "l", ",", 
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}], "&"}], ",", 
               RowBox[{"{", "result", "}"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{"List", ",", 
                   RowBox[{"GaloisGroup", "[", "n", "]"}], ",", 
                   RowBox[{"Range", "[", "rank", "]"}]}], "]"}], ",", "1"}], 
                "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"updateResult", "[", "r_", "]"}], ":=", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
               RowBox[{"n", ",", "#1", ",", "#2", ",", "l", ",", "k"}], "]"}],
               "&"}], ",", "r", ",", 
             RowBox[{"GaloisGroup", "[", "n", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"FixedPoint", "[", 
            RowBox[{"updateResult", ",", "result"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742812435042973`*^9, 3.674281332362499*^9}, {
   3.674281376860539*^9, 3.674281572174304*^9}, {3.674281640139617*^9, 
   3.6742817667155037`*^9}, {3.6742818896378927`*^9, 3.674281901599978*^9}, {
   3.674281937539963*^9, 3.674281960507712*^9}, {3.6742820157367887`*^9, 
   3.674282016976523*^9}, {3.674282345958955*^9, 3.674282347566839*^9}, {
   3.6742826025275717`*^9, 3.674282620576961*^9}, {3.674448659566967*^9, 
   3.674448708631042*^9}, {3.6744487585277348`*^9, 3.6744487814134502`*^9}, {
   3.674448945780901*^9, 3.6744489619858418`*^9}, {3.674449066800475*^9, 
   3.6744490754919043`*^9}, {3.674449424217626*^9, 3.6744494542275047`*^9}, 
   3.678864951972045*^9, 3.6788652661204023`*^9, {3.679871671982317*^9, 
   3.6798717068341703`*^9}},ExpressionUUID->"f27c0806-44c8-4464-b0d2-\
a88d10511f5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"if", " ", "we", " ", "know", " ", "a", 
     RowBox[{"(", "k", ")"}], " ", "exactly"}], ",", " ", 
    RowBox[{"we", " ", "know", " ", 
     RowBox[{"a", "^", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], 
     RowBox[{"(", 
      RowBox[{"a", 
       RowBox[{"(", "k", ")"}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionInverses", "[", 
     RowBox[{"n_", ",", "pgas_List", ",", "a_Integer", ",", "k_Integer"}], 
     "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"EnforcePartialGaloisActionInverses", "[", 
         RowBox[{"n", ",", "#", ",", "a", ",", "k"}], "]"}], "&"}], "/@", 
       "pgas"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionInverses", "[", 
     RowBox[{
     "n_", ",", "pga_PartialGaloisAction", ",", "a_Integer", ",", 
      "k_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"RefinePartialGaloisAction", "[", 
         RowBox[{"n", ",", "pga", ",", 
          RowBox[{
           RowBox[{"GaloisInverse", "[", "n", "]"}], "[", "a", "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "/.", 
             RowBox[{
             "pga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", "k", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "pga", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", "ab", ")"}], 
     RowBox[{"(", "k", ")"}], " ", "must", " ", "be", " ", "a", " ", "subset",
      " ", "of", " ", "a", 
     RowBox[{"(", 
      RowBox[{"b", 
       RowBox[{"(", "k", ")"}]}], ")"}]}], " ", "*)"}], 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
     RowBox[{
     "n_", ",", "pgas_List", ",", "a_Integer", ",", "b_Integer", ",", 
      "k_Integer"}], "]"}], ":=", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
         RowBox[{"n", ",", "#", ",", "a", ",", "b", ",", "k"}], "]"}], "&"}], 
       "/@", "pgas"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnforcePartialGaloisActionConsistency", "[", 
     RowBox[{
     "n_", ",", "pga_PartialGaloisAction", ",", "a_Integer", ",", "b_Integer",
       ",", "k_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "targets", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"targets", "=", 
        RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "#", "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "k", "\[RightDoubleBracket]"}], ")"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "#", "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "/.", 
                 RowBox[{
                 "pga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
               "k", "\[RightDoubleBracket]"}], ")"}]}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RefinePartialGaloisAction", "[", 
        RowBox[{"n", ",", "pga", ",", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"a", " ", "b"}], ",", "n"}], "]"}], ",", "k", ",", 
         "targets"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6742817767620707`*^9, 3.674281851207006*^9}, 
   3.674281910236332*^9, {3.67428194061932*^9, 3.674281985604301*^9}, {
   3.674282022615158*^9, 3.674282115891198*^9}, {3.674282288210284*^9, 
   3.6742822903758087`*^9}, {3.6744490262935743`*^9, 3.67444903684886*^9}, {
   3.6744490817318296`*^9, 3.6744492731716557`*^9}, {3.674449410666972*^9, 
   3.6744494143560143`*^9}, {3.674485149865754*^9, 3.674485157147599*^9}, {
   3.680149289753045*^9, 
   3.6801493112412853`*^9}},ExpressionUUID->"c425fa16-7c4c-4b1a-9518-\
e12d06108ade"],

Cell[BoxData[
 RowBox[{"Clear", "[", "CompletePartialGaloisAction", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742826771450443`*^9, 
  3.674282681250811*^9}},ExpressionUUID->"ac9f3770-1314-42c3-882c-\
559c34770367"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompletePartialGaloisAction", "[", 
   RowBox[{"n_", ",", "pga_PartialGaloisAction"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "p_PartialGaloisAction", "]"}], ":=", 
      RowBox[{"f", "/@", 
       RowBox[{"RefinePartialGaloisAction", "[", 
        RowBox[{"n", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "ga_GaloisAction", "]"}], ":=", 
      RowBox[{"{", "ga", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"f", "[", "pga", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6742824471048183`*^9, 3.674282534918243*^9}, {
   3.674282565141623*^9, 3.674282567295121*^9}, {3.674282635435296*^9, 
   3.674282636795899*^9}, {3.674449597528517*^9, 3.674449599895773*^9}, {
   3.674449818594322*^9, 3.6744499120281343`*^9}, 
   3.678865018538331*^9},ExpressionUUID->"32569ad9-9663-4ac7-ba10-\
f6c9fe89e2c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mkString", "[", 
   RowBox[{"x_List", ",", "sep_"}], "]"}], ":=", 
  RowBox[{"StringJoin", "@@", 
   RowBox[{"(", 
    RowBox[{"ToString", "/@", 
     RowBox[{"Most", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"sep", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "x", "]"}], "}"}]}], "]"}]}], "}"}], 
        "]"}], "]"}], "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744939985828342`*^9, 
  3.674494044551668*^9}},ExpressionUUID->"517f753c-719a-4a2b-97fc-\
c90cf08a2747"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DreadnautPath", "=", "\"\<~/bin/dreadnaut\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680149438588757*^9, 
  3.680149441131399*^9}},ExpressionUUID->"1ae5da5e-26c7-4245-9fe6-\
f88229227cdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NautyHash", "[", "ga_GaloisAction", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "G", ",", "X", ",", "preamble", ",", "edges", ",", "partition", ",", 
      "cmd", ",", "return"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"1", "/.", 
        RowBox[{
        "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preamble", "=", 
      RowBox[{"\"\<c\\nn=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", "+", "2"}], ")"}], "X"}], "]"}], "<>", 
       "\"\< g\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"x", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"g", "+", "1"}], ")"}], "X"}]}], "]"}], "<>", 
                 "\"\< \>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"g", ",", "0", ",", 
                  RowBox[{"G", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
            "\"\<;\\n\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\< \>\"", "<>", 
            RowBox[{"(", 
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ga", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"g", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "/.", 
                    RowBox[{
                    "ga", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"x", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
                   "1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"g", "+", "1"}], ")"}], "X"}]}], "]"}], "<>", 
                 "\"\< \>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"g", ",", "0", ",", 
                  RowBox[{"G", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
            "\"\<;\\n\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "<>", 
       "\"\<.\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"partition", "=", 
      RowBox[{"\"\<f=[\>\"", "<>", 
       RowBox[{"mkString", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mkString", "[", 
            RowBox[{"#", ",", "\"\<,\>\""}], "]"}], "&"}], "/@", 
          RowBox[{
          "ga", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", "\"\<|\>\""}], "]"}], "<>", "\"\<]\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmd", "=", "\"\<x z\\n\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"return", "=", 
      RowBox[{"Run", "[", 
       RowBox[{"DreadnautPath", "<>", "\"\< <<STOP > /tmp/dreadnaut\>\"", "<>", 
        RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", "\"\<.out\\n\>\"", 
        "<>", "preamble", "<>", "edges", "<>", "partition", "<>", "cmd", 
        "<>", "\"\<STOP\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"return", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Something went wrong while running dreadnaut. Please check you \
have a copy of dreadnaut, and modify \
FusionAtlas`ModularData`Private`DreadnautPath if necessary.\>\"", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\"\<[\>\"", "<>", 
      RowBox[{"StringJoin", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{"\"\</tmp/dreadnaut\>\"", "<>", 
                RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
                "\"\<.out\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "\"\< \>\""}],
           "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], 
        ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6744917605198927`*^9, 3.674492110425222*^9}, {
   3.6744922032505503`*^9, 3.6744922358948717`*^9}, {3.6744923115743017`*^9, 
   3.674492334328155*^9}, {3.674492400172408*^9, 3.674492418768852*^9}, {
   3.6744924569797487`*^9, 3.674492592258102*^9}, {3.674493986001691*^9, 
   3.674493994668674*^9}, {3.674494058550083*^9, 3.674494109285931*^9}, {
   3.678934028310841*^9, 3.678934052552066*^9}, 3.67893416801877*^9, {
   3.680149361272994*^9, 
   3.6801494334283237`*^9}},ExpressionUUID->"1e030ef5-c4b4-4aa9-9e74-\
421cb07d5544"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "induction_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CompleteGaloisActions", "[", 
    RowBox[{"n", ",", "induction"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"outputDirectory", ",", "filename", ",", "result"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"outputDirectory", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dataDirectory", ",", "\"\<completeGaloisActions\>\""}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"outputDirectory", ",", 
          RowBox[{
           RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
           RowBox[{"SHA1", "[", "induction", "]"}], "<>", "\"\<.m.gz\>\""}]}],
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"GroupBy", "[", 
             RowBox[{
              RowBox[{"CompletePartialGaloisAction", "[", 
               RowBox[{"n", ",", 
                RowBox[{"PartialGaloisAction", "[", 
                 RowBox[{"n", ",", "induction"}], "]"}]}], "]"}], ",", 
              "NautyHash"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"GZIP", "[", 
          RowBox[{"result", ",", "filename"}], "]"}], ";", 
         "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "induction_", ",", "eigenvalues_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CompleteGaloisActions", "[", 
    RowBox[{"n", ",", "induction", ",", "eigenvalues"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"GroupBy", "[", 
      RowBox[{
       RowBox[{"CompletePartialGaloisAction", "[", 
        RowBox[{"n", ",", 
         RowBox[{"PartialGaloisAction", "[", 
          RowBox[{"n", ",", "induction", ",", "eigenvalues"}], "]"}]}], "]"}],
        ",", "NautyHash"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], 
    "\[RightDoubleBracket]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67449429545187*^9, 3.6744943748752327`*^9}, {
   3.674495210462825*^9, 3.674495234385457*^9}, {3.678866158753236*^9, 
   3.6788662015512323`*^9}, {3.67893417762175*^9, 3.6789341779815397`*^9}, {
   3.679870665678906*^9, 3.679870672177642*^9}, {3.67987075468302*^9, 
   3.679870756753233*^9}, 3.680150219003462*^9, {3.680152631346349*^9, 
   3.68015266656318*^9}},ExpressionUUID->"a3ef42cf-3a19-4090-be0b-\
d7e7c5024042"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisSubgroups", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisSubgroups", "[", "n", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"oneStepClosure", ",", "closure", ",", "extensions"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"oneStepClosure", "[", "elements_List", "]"}], ":=", 
       RowBox[{"Union", "@@", 
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"#1", " ", "#2"}], ",", "n"}], "]"}], "&"}], ",", 
          "elements", ",", "elements"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"closure", "[", "elements_List", "]"}], ":=", 
       RowBox[{"FixedPoint", "[", 
        RowBox[{"oneStepClosure", ",", "elements"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extensions", "[", "elements_List", "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "elements", "}"}], "~", "Join", "~", 
         RowBox[{"(", 
          RowBox[{"closure", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"elements", "~", "Join", "~", 
               RowBox[{"{", "#", "}"}]}], "&"}], "/@", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"GaloisGroup", "[", "n", "]"}], ",", "elements"}], 
              "]"}]}], ")"}]}], ")"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"FixedPoint", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "@@", 
          RowBox[{"(", 
           RowBox[{"extensions", "/@", "#"}], ")"}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682390917036442*^9, 3.682391013935687*^9}, {
   3.682391049149241*^9, 3.6823911812435913`*^9}, {3.6823912271617002`*^9, 
   3.682391232507532*^9}, 3.682391409607162*^9, {3.682391454139282*^9, 
   3.682391458851039*^9}},ExpressionUUID->"b996c825-c9e2-49eb-9f9a-\
76c129a7695b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisSubgroups", "[", 
   RowBox[{"n_", ",", "subgroup_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"GaloisSubgroups", "[", "n", "]"}], ",", 
    RowBox[{"G_", "/;", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{"G", ",", "subgroup"}], "]"}], "]"}], "\[Equal]", "0"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823914803479443`*^9, 
  3.682391512785987*^9}},ExpressionUUID->"0d525527-6d1c-4843-a456-\
f81d90599f0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisEigenvalueStabilizer", "[", 
   RowBox[{"n_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"GaloisGroup", "[", "n", "]"}], ",", 
    RowBox[{"l_", "/;", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["l", "2"], "-", "1"}], ")"}], "t"}], ",", "1"}], 
       "]"}], "\[Equal]", "0"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682391950970447*^9, 
  3.6823920002657747`*^9}},ExpressionUUID->"dead9e73-8f64-4055-9b2b-\
d4653cb9a3e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisDimensionStabilizer", "[", 
   RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"GaloisGroup", "[", "n", "]"}], ",", 
    RowBox[{"l_", "/;", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "d", 
        "]"}], "]"}], "\[Equal]", "d"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682392014616345*^9, 3.6823920492926064`*^9}, {
  3.682594525356615*^9, 
  3.6825945295563593`*^9}},ExpressionUUID->"0f729fe5-0ac0-43a3-9d6f-\
d0d006562600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisStabilizer", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "t_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisStabilizer", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "t"}], "}"}]}], "]"}], "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"GaloisGroup", "[", "n", "]"}], ",", 
     RowBox[{"l_", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["l", "2"], "-", "1"}], ")"}], "t"}], ",", "1"}], 
         "]"}], "\[Equal]", "0"}], "\[And]", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "d",
           "]"}], "]"}], "\[Equal]", "d"}]}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682392204006165*^9, 3.6823922257841177`*^9}, 
   3.682392552372527*^9, {3.682402508234873*^9, 3.682402510017414*^9}, {
   3.682594532049282*^9, 3.682594534901905*^9}, {3.6825947520220327`*^9, 
   3.682594755231543*^9}},ExpressionUUID->"0e6b574e-7bcf-4c40-b8fb-\
a9ca3858d81c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StabilizerSubgroupMultiplicities", "[", 
   RowBox[{"n_", ",", "subgroup_", ",", "totalSize_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"StabilizerSubgroupMultiplicities", "[", 
    RowBox[{"n", ",", "subgroup", ",", "totalSize"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"subgroups", "=", 
        RowBox[{"GaloisSubgroups", "[", 
         RowBox[{"n", ",", "subgroup"}], "]"}]}], ",", "max"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "subgroups", "]"}]}], "}"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"max", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"totalSize", "-", 
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", "[", "j", "]"}], 
                    RowBox[{
                    RowBox[{"Length", "[", "subgroup", "]"}], "/", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "subgroups", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "subgroups", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}], "/", 
                  RowBox[{"Length", "[", "subgroup", "]"}]}]}]}], ";", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", "\[Equal]", 
                    RowBox[{"Length", "[", "subgroups", "]"}]}], ",", 
                   RowBox[{"Ceiling", "[", "max", "]"}], ",", "0"}], "]"}], 
                 ",", "max"}], "}"}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "subgroups", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{
        RowBox[{"Length", "[", "subgroups", "]"}], "-", "1"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682392667970147*^9, 3.682392974218443*^9}, {
  3.682594736692564*^9, 
  3.682594742536215*^9}},ExpressionUUID->"84860e52-1885-48da-aae2-\
960e70e370f8"],

Cell[TextData[{
 StyleBox["BallsInUrns[urns, balls]",
  FontWeight->"Bold"],
 " enumerates all ways to arrange coloured balls into coloured urns. All urns \
of the same colour are of the same size. (The colours of the urns and the \
balls are not related.)\n\n * ",
 StyleBox["urns",
  FontWeight->"Bold"],
 " should be a list of pairs, corresponding to the colours; each pair denotes \
the urn size for that colour, and the number of urns of that colour.\n * ",
 StyleBox["balls",
  FontWeight->"Bold"],
 " should be a list of numbers, specifying the numbers of balls of each \
colour.\n \n * The result is a list of matrices, with each matrix indicating \
an arrangement: the rows are indexed by the colours of the balls, and the \
columns are indexed by the urns."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.6824029001810923`*^9, 3.682402942429448*^9}, {
   3.682402977414469*^9, 3.6824032215598803`*^9}, 3.682403330997404*^9, {
   3.6824033942456284`*^9, 3.682403396780439*^9}, {3.6824034843403397`*^9, 
   3.682403563331649*^9}, {3.682404317943593*^9, 
   3.68240431870485*^9}},ExpressionUUID->"ab7434bd-ddcf-43cb-aadf-\
a5025a98d5a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BallsInUrns", "[", 
   RowBox[{"urns_", ",", 
    RowBox[{"{", 
     RowBox[{"redBalls_", ",", "otherBalls___"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "totalUrns", ",", "iterators", ",", "max", ",", "redDistributions", ",", 
      "newUrns"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalUrns", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"urns", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iterators", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"max", "=", 
             RowBox[{"redBalls", "-", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"i0", ",", "j0"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j0", ",", "1", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i0", "\[Equal]", "i"}], ",", 
                    RowBox[{"j", "-", "1"}], ",", 
                    RowBox[{"urns", "\[LeftDoubleBracket]", 
                    RowBox[{"i0", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i0", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], ";", 
            
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "\[Equal]", 
                  RowBox[{"Length", "[", "urns", "]"}]}], "\[And]", 
                 RowBox[{"j", "\[Equal]", 
                  RowBox[{"urns", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
                ",", "max", ",", "0"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"max", ",", 
                RowBox[{"urns", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"j", ">", "1"}], ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", "\[Infinity]"}], 
                 "]"}]}], "]"}]}], "}"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "urns", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"urns", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
         "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "iterators", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"redDistributions", "=", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "urns", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"urns", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}],
             "]"}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Sequence", "@@", "iterators"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"totalUrns", "-", "1"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "redDistributions", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newUrns", "[", "distribution_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"Length", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Split", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"urns", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"urns", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "urns", "]"}]}], "}"}]}], "]"}], ",", 
             "1"}], "]"}], ",", "distribution"}], "}"}], "]"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"redDistribution", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "redDistribution", "}"}], "~", "Join", "~", "#"}], 
            "&"}], "/@", 
           RowBox[{"BallsInUrns", "[", 
            RowBox[{
             RowBox[{"newUrns", "[", "redDistribution", "]"}], ",", 
             RowBox[{"{", "otherBalls", "}"}]}], "]"}]}]}], "]"}], "/@", 
        "redDistributions"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682403256517933*^9, 3.6824032953210163`*^9}, {
  3.682403640413713*^9, 3.6824039323731623`*^9}, {3.68240402061092*^9, 
  3.6824040337148314`*^9}, {3.68240408009899*^9, 3.682404168508131*^9}, {
  3.682404201789082*^9, 3.682404249125518*^9}, {3.682404418312899*^9, 
  3.682404418539262*^9}, {3.682404460980812*^9, 3.682404471383453*^9}, {
  3.682404525865362*^9, 3.6824045765589647`*^9}, {3.6824048671303883`*^9, 
  3.682404868177145*^9}, {3.682405012094872*^9, 3.68240501523442*^9}, {
  3.682405110291266*^9, 
  3.682405121772559*^9}},ExpressionUUID->"c023a3b6-b39a-4269-af98-\
29fddd00d1ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BallsInUrns", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "_"}], "}"}], "..."}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BallsInUrns", "[", 
   RowBox[{"urnSizes_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682393475204342*^9, 3.682393503639529*^9}, {
  3.682393580264474*^9, 3.682393598526927*^9}, {3.6824043042331142`*^9, 
  3.6824043116363688`*^9}},ExpressionUUID->"33f257d4-2244-4ed7-a407-\
59ac9ae0e288"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisOrbitOfInvariant", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "t_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "[", "d", 
         "]"}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["l", "2"], "t"}], ",", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823944989842663`*^9, 3.682394560538851*^9}, {
  3.682395235206148*^9, 3.6823952368903503`*^9}, {3.682395626688608*^9, 
  3.682395632155912*^9}},ExpressionUUID->"719d95c4-00fd-4689-b239-\
d7c9c651d659"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "Abs", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Abs", "[", "x_AlgebraicNumber", "]"}], "/;", 
   RowBox[{
    RowBox[{"cachedRootReduce", "[", 
     RowBox[{"Im", "[", "x", "]"}], "]"}], "===", "0"}]}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"N", "[", "x", "]"}], "]"}], "\[GreaterEqual]", "0"}], ",", "x",
     ",", 
    RowBox[{"-", "x"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Abs", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682395645683672*^9, 3.682395702637849*^9}, {
  3.682395742571701*^9, 3.6823957494968767`*^9}, {3.682609574796028*^9, 
  3.6826095753222437`*^9}},ExpressionUUID->"071b1e87-cb40-4acd-b32b-\
a8dc8b5496e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartitionObjectsByInvariants", "[", 
   RowBox[{"n_", ",", "induction_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[ScriptCapitalD]", ",", "dims", ",", "pairs", ",", "indices"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[ScriptCapitalD]", ",", "dims"}], "}"}], "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "induction"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dims", "/", "\[ScriptCapitalD]"}], ",", "T"}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "[", 
       RowBox[{"{", 
        RowBox[{"d_", ",", "t_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", "t"}], "}"}], "\[Rule]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"pairs", ",", 
               RowBox[{"Transpose", "[", "induction", "]"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"d", ",", "t"}], "}"}], ",", "c"}], "}"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"Union", "[", 
            RowBox[{"Transpose", "[", "induction", "]"}], "]"}]}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"indices", ",", 
       RowBox[{"Union", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GaloisOrbitOfInvariant", "[", 
            RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", "pairs"}], ")"}], 
        "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823945696681137`*^9, 3.68239462044702*^9}, {
  3.6823946605606613`*^9, 3.682394661963757*^9}, {3.682395117616631*^9, 
  3.682395122979473*^9}, {3.6823951756569653`*^9, 3.68239522208805*^9}, {
  3.682395254904524*^9, 3.682395277992607*^9}, {3.682395309705769*^9, 
  3.682395367406143*^9}, {3.6823954125991592`*^9, 3.68239546138272*^9}, {
  3.682395526218652*^9, 3.68239560277772*^9}, {3.6823958722496567`*^9, 
  3.682395924951055*^9}},ExpressionUUID->"78683012-fb7e-4bca-b327-\
61d01107ed69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StabilizerActions", "[", 
   RowBox[{"n_", ",", "induction_", ",", 
    RowBox[{"orbit", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d_", ",", "t_"}], "}"}], "\[Rule]", "objects1_"}], ",", 
       "others___"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "subgroups", ",", "cosetSizes", ",", "multiplicities", ",", 
      "howManyInEachCoset", ",", "objectsInCosets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subgroups", "=", 
      RowBox[{"GaloisSubgroups", "[", 
       RowBox[{"n", ",", 
        RowBox[{"GaloisStabilizer", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "t"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cosetSizes", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"GaloisStabilizer", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "t"}], "}"}]}], "]"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"Length", "/@", "subgroups"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"multiplicities", "=", 
      RowBox[{"StabilizerSubgroupMultiplicities", "[", 
       RowBox[{"n", ",", 
        RowBox[{"GaloisStabilizer", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "t"}], "}"}]}], "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", "objects1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"howManyInEachCoset", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "#"}], "}"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Outer", "[", 
               RowBox[{"List", ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"BallsInUrns", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"cosetSizes", ",", "m"}], "}"}], "]"}], ",", 
                    RowBox[{"Length", "/@", "objects"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"objects", ",", 
                    RowBox[{"orbit", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], ",", "1"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Length", "[", "orbit", "]"}], "-", "1"}]}], "]"}]}]}],
           "]"}], "/@", "multiplicities"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"objectsInCosets", "[", 
       RowBox[{"{", 
        RowBox[{"multiplicities_", ",", "ballsInUrnsMatrices_"}], "}"}], 
       "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
              "subgroups", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "multiplicities", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "multiplicities", "]"}]}], "}"}]}], 
           "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"orbit", "\[LeftDoubleBracket]", 
            RowBox[{"l", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Join", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"orbit", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "2", ",", "i", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"ballsInUrnsMatrices", "\[LeftDoubleBracket]", 
                    RowBox[{"l", ",", "i", ",", 
                    RowBox[{"1", ";;", 
                    RowBox[{"j", "-", "1"}]}]}], "\[RightDoubleBracket]"}], 
                    "]"}], "+", "1"}], ")"}], ";;", 
                   RowBox[{"Total", "[", 
                    RowBox[{"ballsInUrnsMatrices", "\[LeftDoubleBracket]", 
                    RowBox[{"l", ",", "i", ",", 
                    RowBox[{"1", ";;", "j"}]}], "\[RightDoubleBracket]"}], 
                    "]"}]}]}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "ballsInUrnsMatrices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"ballsInUrnsMatrices", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"Length", "[", "orbit", "]"}]}], "}"}]}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"objectsInCosets", "/@", "howManyInEachCoset"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ/V7AhGtB/mtH28IUcRD9ImePNIgWlD4uD6JX/Lpi
CKJ37b5qDqIr3n2uXgikq/6faQbRQuJavSD6zYz1YPqHaclxEM24P+MEiC4Q
W38eRD+IybsCoqU2+3wA0f+WaX4D0Xlc2b9A9AyvXDB9pUBNdRGQ3hZ2SA1E
X2HQ0QPRH5Zwm4BosddLrEC0g/wtaxDd8OCgI4j2ed3nDqIf3WDKXgmkX2tG
gOlzLsvrQbSN/OY2EH2G/0o3iK5J+DQFREc8Xj0TRHs0rFsLouds0NgJor8F
qO8D0Vrxv0+BaPMgyTMgWknn0n0QvSfg0UOwuLnQNxBtKvX2O4guZcliXwWk
Zzma8IFo0bnGciBa12i1Lohm0CucAKJfCT+dCKIBHMLLTA==
  
  "],ExpressionUUID->"3d584a88-7a64-4ea5-9553-6343681c3dcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StabilizerActions", "[", 
   RowBox[{"n_", ",", "induction_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "orbits", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orbits", "=", 
      RowBox[{"PartitionObjectsByInvariants", "[", 
       RowBox[{"n", ",", "induction", ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"List", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StabilizerActions", "[", 
              RowBox[{"n", ",", "induction", ",", "#"}], "]"}], "&"}], "/@", 
            "orbits"}], ")"}]}], ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Length", "[", "orbits", "]"}], "-", "1"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6824055747768793`*^9, 3.682405587822208*^9}, {
  3.682424032117042*^9, 
  3.68242411099898*^9}},ExpressionUUID->"3111622e-ad63-4904-95c9-\
f48702f400a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisSubgroupSplittings", "[", 
   RowBox[{"n_", ",", "subgroup_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GaloisSubgroupSplittings", "[", 
    RowBox[{"n", ",", "subgroup"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"GaloisSubgroups", "[", "n", "]"}], ",", 
       RowBox[{
        RowBox[{"G_", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "G", "]"}], 
           RowBox[{"Length", "[", "subgroup", "]"}]}], "\[Equal]", 
          RowBox[{"Length", "[", 
           RowBox[{"GaloisGroup", "[", "n", "]"}], "]"}]}]}], 
        "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"G", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "subgroup", ",", "G"}], "]"}], ",", "n"}], 
           "]"}]}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"G_", ",", "products_"}], "}"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", "products", "]"}], "]"}], "\[Equal]", 
          RowBox[{"GaloisGroup", "[", "n", "]"}]}], ")"}]}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"l", "\[Rule]", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"products", ",", 
            RowBox[{
             RowBox[{"p_", "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"p", ",", "l"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{"p", ",", "subgroup"}], "]"}], "\[LeftDoubleBracket]", 
              "1", "\[RightDoubleBracket]"}]}], ",", "1", ",", "1"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", 
          RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6825306441669407`*^9, 3.682530647585784*^9}, {
   3.6825307124920053`*^9, 3.682530713997732*^9}, {3.682530885472766*^9, 
   3.682531121112866*^9}, {3.6825311599392*^9, 3.682531160807714*^9}, {
   3.6825311937474127`*^9, 3.682531193829185*^9}, {3.682531399227947*^9, 
   3.682531435709887*^9}, {3.682532958683769*^9, 3.6825329612324753`*^9}, 
   3.682534983054287*^9, {3.6825353984647503`*^9, 3.682535414445858*^9}, {
   3.682594690156353*^9, 
   3.682594694218952*^9}},ExpressionUUID->"72e3eb89-ea97-4b6e-a55b-\
ee611ccfebe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisSubgroupSplittings", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"GaloisSubgroupSplittings", "[", 
     RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"GaloisSubgroups", "[", "n", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682531445291337*^9, 3.6825314634977837`*^9}, 
   3.682535113686571*^9},ExpressionUUID->"14d43de3-3994-49fb-9bc2-\
80704dd69e14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "H", " ", "a", " ", "subgroup", " ", "of", " ", "K", " ", "a", " ", 
    "subgroup", " ", "of", " ", "Gal", 
    RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GaloisCosets", "[", 
    RowBox[{"n_", ",", "H_", ",", "K_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GaloisCosets", "[", 
     RowBox[{"n", ",", "H", ",", "K"}], "]"}], "=", 
    RowBox[{"Union", "[", 
     RowBox[{"Union", "/@", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"H", "#"}], "&"}], "/@", "K"}], ",", "n"}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682534635458942*^9, 3.6825346616171722`*^9}, {
  3.6825347504731607`*^9, 3.6825347674701*^9}, {3.68259470731927*^9, 
  3.6825947113941803`*^9}},ExpressionUUID->"a69d091a-dc67-4819-b908-\
34b65b9e92f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaloisActionFromStabilizerAction", "[", 
   RowBox[{"n_", ",", "induction_", ",", "action_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", "l", "]"}], ";"}], "*)"}], 
   RowBox[{
    RowBox[{"l", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "orbit", ",", "indexInOrbit", ",", "coset", ",", "indexInCoset", 
           ",", "imageIndexInOrbit", ",", "imageIndexInCoset", ",", 
           "stabilizer", ",", "splitting", ",", "imageInStabilizer", ",", 
           "cosets"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "orbit", ",", "indexInOrbit", ",", "coset", ",", "indexInCoset"}],
             "}"}], "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"action", ",", "i", ",", 
              RowBox[{"{", "6", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "5", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"imageIndexInOrbit", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"action", "\[LeftDoubleBracket]", 
               RowBox[{"orbit", ",", "2", ",", "All", ",", "1"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], 
                  "[", 
                  RowBox[{"action", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "orbit", ",", "2", ",", "indexInOrbit", ",", "1", ",", 
                    "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["l", "2"], " ", 
                   RowBox[{"action", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "orbit", ",", "2", ",", "indexInOrbit", ",", "1", ",", 
                    "2"}], "\[RightDoubleBracket]"}]}], ",", "1"}], "]"}]}], 
               "}"}]}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<{orbit,indexInOrbit,coset,indexInCoset},imageIndexInOrbit=\>\
\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "orbit", ",", "indexInOrbit", ",", "coset", ",", 
                "indexInCoset"}], "}"}], ",", "imageIndexInOrbit"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"stabilizer", "=", 
           RowBox[{"GaloisStabilizer", "[", 
            RowBox[{"n", ",", 
             RowBox[{"action", "\[LeftDoubleBracket]", 
              RowBox[{"orbit", ",", "2", ",", "1", ",", "1"}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"GaloisSubgroupSplittings", "[", 
                 RowBox[{"n", ",", "stabilizer"}], "]"}], "]"}], "\[Equal]", 
               "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<Stabilizer subgroup of \>\"", ",", 
                 RowBox[{"action", "\[LeftDoubleBracket]", 
                  RowBox[{"orbit", ",", "2", ",", "1", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "\"\< (with conductor \>\"",
                  ",", "n", ",", 
                 "\"\<) isn't complemented! Tell Scott about this example, \
and ask him to write a better algorithm.\>\""}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"splitting", "=", 
             RowBox[{
              RowBox[{"GaloisSubgroupSplittings", "[", 
               RowBox[{"n", ",", "stabilizer"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"imageInStabilizer", "=", 
             RowBox[{"l", "/.", "splitting"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<splitting=\>\"", ",", "splitting"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"cosets", "=", 
           RowBox[{"GaloisCosets", "[", 
            RowBox[{"n", ",", 
             RowBox[{"action", "\[LeftDoubleBracket]", 
              RowBox[{"orbit", ",", "1", ",", "coset"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Union", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"l", " ", "stabilizer"}], ",", "n"}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<imageInStabilizer=\>\"", ",", "imageInStabilizer"}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<stabilizer=\>\"", ",", "stabilizer"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<cosets=\>\"", ",", "cosets"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"imageInStabilizer", " ", 
                 RowBox[{
                 "cosets", "\[LeftDoubleBracket]", "indexInCoset", 
                  "\[RightDoubleBracket]"}]}], ",", "n"}], "]"}], "]"}], 
             "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"imageIndexInCoset", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"cosets", ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"l", " ", 
                  RowBox[{
                   RowBox[{"GaloisCosets", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"action", "\[LeftDoubleBracket]", 
                    RowBox[{"orbit", ",", "1", ",", "coset"}], 
                    "\[RightDoubleBracket]"}], ",", "stabilizer"}], "]"}], 
                   "\[LeftDoubleBracket]", "indexInCoset", 
                   "\[RightDoubleBracket]"}]}], ",", "n"}], "]"}], "]"}], ",",
               "1", ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"action", "\[LeftDoubleBracket]", 
           RowBox[{
           "orbit", ",", "2", ",", "imageIndexInOrbit", ",", "2", ",", 
            "coset", ",", "imageIndexInCoset"}], 
           "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "induction", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682424205862013*^9, 3.6824242251487093`*^9}, {
   3.682424455838442*^9, 3.682424502638587*^9}, {3.682424732841436*^9, 
   3.6824248510964403`*^9}, {3.6824249167166433`*^9, 3.682424945819099*^9}, {
   3.682424993594981*^9, 3.682425092001315*^9}, {3.682529779618023*^9, 
   3.682529830769004*^9}, {3.6825340927791777`*^9, 3.682534096782894*^9}, {
   3.682534155742175*^9, 3.682534192993943*^9}, {3.682534229062366*^9, 
   3.682534300224614*^9}, {3.682534368948346*^9, 3.682534515782872*^9}, {
   3.6825345805006104`*^9, 3.682534632361532*^9}, {3.682534789399939*^9, 
   3.682534907041972*^9}, {3.682535148700163*^9, 3.682535171479849*^9}, {
   3.682535203946123*^9, 3.682535258564039*^9}, {3.6825353108216343`*^9, 
   3.682535312796152*^9}, {3.6825354903862953`*^9, 3.682535497590934*^9}, {
   3.682535545873228*^9, 3.6825355587855043`*^9}, {3.682535596353983*^9, 
   3.6825356059110203`*^9}, {3.682594174175171*^9, 3.682594186940152*^9}, {
   3.682594218586771*^9, 3.682594246695306*^9}, {3.682594283864091*^9, 
   3.682594315282796*^9}, {3.682594618076242*^9, 3.6825946339122*^9}, {
   3.6826068654177933`*^9, 3.682606870709612*^9}, {3.682607063224058*^9, 
   3.682607067595125*^9}, {3.682607139973589*^9, 3.682607221663578*^9}, {
   3.682607401839039*^9, 3.682607416755867*^9}, {3.6826074513593493`*^9, 
   3.6826074535095797`*^9}, 3.682609109691876*^9, {3.682610200417831*^9, 
   3.682610210816525*^9}, {3.68378438016572*^9, 3.683784397728539*^9}, {
   3.683785617076736*^9, 3.6837856185833187`*^9}, {3.683787097194466*^9, 
   3.683787114935865*^9}},ExpressionUUID->"c669eacb-f5fa-49d0-b965-\
59a3687bd001"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CompleteGaloisActions2", "[", 
   RowBox[{"n_", ",", "induction_", ",", "eigenvalues_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"verifyGaloisAction", "[", 
      RowBox[{"n", ",", "induction", ",", "eigenvalues"}], "]"}], "[", 
     RowBox[{"GaloisAction", "[", 
      RowBox[{"GaloisActionFromStabilizerAction", "[", 
       RowBox[{"n", ",", "induction", ",", "#"}], "]"}], "]"}], "]"}], "&"}], 
   "/@", 
   RowBox[{"StabilizerActions", "[", 
    RowBox[{"n", ",", "induction", ",", "eigenvalues"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"verifyGaloisAction", "[", 
    RowBox[{"n_", ",", "induction_", ",", "eigenvalues_"}], "]"}], "[", 
   RowBox[{"GaloisAction", "[", "ga_", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dims", ",", "S1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dims", "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "induction"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox["l", "2"], " ", "eigenvalues"}], ",", "1"}], 
            "]"}], "=!=", 
           RowBox[{"eigenvalues", "\[LeftDoubleBracket]", 
            RowBox[{"l", "/.", "ga"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Bad Galois action on eigenvalues for l = \>\"", ",", "l"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<eigenvalues = \>\"", ",", "eigenvalues"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["l", "2"], " ", "eigenvalues"}], ",", "1"}], 
             "]"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"eigenvalues", "\[LeftDoubleBracket]", 
             RowBox[{"InversePermutation", "[", 
              RowBox[{"l", "/.", "ga"}], "]"}], "\[RightDoubleBracket]"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "ga", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "/@", 
             "S1"}], "]"}], "=!=", 
           RowBox[{"S1", "\[LeftDoubleBracket]", 
            RowBox[{"l", "/.", "ga"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Bad Galois action on dimensions for l = \>\"", ",", "l"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<S1 = \>\"", ",", 
             RowBox[{"Chop", "[", 
              RowBox[{"N", "[", "S1", "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<eigenvalues = \>\"", ",", "eigenvalues"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "ga", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"GaloisGroup", "[", "n", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GaloisAction", "[", "ga", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682536095274129*^9, 3.6825361477476597`*^9}, {
  3.683787368713789*^9, 3.683787593601836*^9}, {3.683787648895485*^9, 
  3.683787668247303*^9}, {3.683787815303158*^9, 3.683787827352744*^9}, {
  3.683787977497959*^9, 3.683787980716888*^9}, {3.6837883707257032`*^9, 
  3.683788372875791*^9}},ExpressionUUID->"a5ecb5f7-87dc-4212-9d6f-\
5e3c0428d35b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllocateEigenvaluesToSimplesAndCompleteGaloisActions", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k_", ",", "induction_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filename", ",", "outputDirectory", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "dataDirectory", ",", 
         "\"\<allocateEigenvaluesToSimplesAndCompleteGaloisActions\>\""}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "induction"}], "}"}], "]"}], "<>", 
          "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"(*", 
       RowBox[{"False", "\[And]"}], "*)"}], 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computing Galois actions for \>\"", ",", 
          RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", "\"\< \>\"", ",", 
          RowBox[{"MatrixForm", "[", "induction", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"ga", ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "ga"}], "}"}]}], "]"}], "/@", 
              RowBox[{"CompleteGaloisActions2", "[", 
               RowBox[{"n", ",", "induction", ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "]"}]}], "&"}], ",", 
            RowBox[{
            "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators", 
             "[", 
             RowBox[{"n", ",", "fusion", ",", "k", ",", "induction"}], 
             "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\< ... finished computing Galois actions.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", "result"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674495512562315*^9, 3.674495598183732*^9}, {
   3.678862006576638*^9, 3.678862049217985*^9}, {3.678862137694745*^9, 
   3.678862146659045*^9}, {3.6788663828843822`*^9, 3.678866384343978*^9}, {
   3.6789341829194727`*^9, 3.678934183249864*^9}, {3.6789603705784473`*^9, 
   3.678960371984145*^9}, {3.6792652922903023`*^9, 3.679265303122703*^9}, {
   3.6792653428074102`*^9, 3.6792653685451803`*^9}, {3.679352447177408*^9, 
   3.679352454826503*^9}, 3.679871089389841*^9, 3.680150220097311*^9, {
   3.6801526746489353`*^9, 3.680152691230196*^9}, {3.680185386710395*^9, 
   3.680185423988091*^9}, {3.682536258726755*^9, 3.682536271454379*^9}, 
   3.682566756981317*^9, {3.683428414589364*^9, 3.68342842585116*^9}, 
   3.6834284637866907`*^9, {3.683446609546872*^9, 
   3.683446612823865*^9}},ExpressionUUID->"8140dd22-363f-43ba-8097-\
99e4b7053367"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CalculateGaloisSigns", "[", 
   RowBox[{"n_Integer", ",", "inductionMatrix_", ",", "ga_GaloisAction"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1", ",", 
      RowBox[{"dims", "=", 
       RowBox[{"DimensionsFromInductionMatrix", "[", 
        RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ",", "signs"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"signs", "[", 
       RowBox[{"l_", "\[Rule]", "permutation_"}], "]"}], ":=", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"permutation", " ", 
         RowBox[{"verifySigns", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"GaloisAction", "[", "n", "]"}], "[", "l", "]"}], "/@",
                "S1"}], ")"}], "/", 
             RowBox[{
             "S1", "\[LeftDoubleBracket]", "permutation", 
              "\[RightDoubleBracket]"}]}], ")"}], ",", "ga"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SignedGaloisAction", "[", 
      RowBox[{"signs", "/@", 
       RowBox[{"ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verifySigns", "[", 
   RowBox[{"stuff_", ",", "ga_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Something went wrong calculating Galois signs for: \>\"", ",", 
         " ", "ga"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "stuff"}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.678939903310602*^9, 3.678939957648583*^9}, {
  3.6789400019993362`*^9, 3.678940009808017*^9}, {3.6789400643088713`*^9, 
  3.678940078146984*^9}, {3.678940118475532*^9, 3.678940247159832*^9}, {
  3.67894102426678*^9, 3.6789410811057167`*^9}, {3.678941779446899*^9, 
  3.678941790464007*^9}, {3.683429077980523*^9, 3.683429084773047*^9}, {
  3.6837767334692183`*^9, 3.683776799327052*^9}, {3.6837847839970293`*^9, 
  3.683784786239161*^9}, {3.6837880893161488`*^9, 
  3.683788091798008*^9}},ExpressionUUID->"6feb6c48-c325-4439-b771-\
372ad80508d2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SignedPermutationMatrix", "[", "signedPermutation_", "]"}], ":=", 
   
   RowBox[{
    RowBox[{
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"Length", "[", "signedPermutation", "]"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"Abs", "[", "signedPermutation", "]"}], 
     "\[RightDoubleBracket]"}], 
    RowBox[{"Sign", "[", "signedPermutation", "]"}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67894265764573*^9, 3.678942700693161*^9}, {
  3.678942733226385*^9, 3.678942735858191*^9}, {3.678950318450117*^9, 
  3.6789503200270452`*^9}, {3.6789507281728687`*^9, 3.6789507304065437`*^9}, {
  3.678950891663517*^9, 3.678950909987877*^9}, {3.678951295360633*^9, 
  3.678951296652442*^9}},ExpressionUUID->"267b8d1f-49d8-471a-8a64-\
13ec30ee062a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SignedPermutationMatrix", "[", "signedPermutation_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sign", "[", 
      RowBox[{
      "signedPermutation", "\[LeftDoubleBracket]", "i", 
       "\[RightDoubleBracket]"}], "]"}], 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
        "signedPermutation", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "signedPermutation", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"Length", "[", "signedPermutation", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67894265764573*^9, 3.678942700693161*^9}, {
  3.678942733226385*^9, 3.678942735858191*^9}, {3.678950318450117*^9, 
  3.6789503200270452`*^9}, {3.6789507281728687`*^9, 3.6789507304065437`*^9}, {
  3.678950891663517*^9, 3.678950909987877*^9}, {3.678951295360633*^9, 
  3.678951296652442*^9}, {3.683429151543723*^9, 3.683429243783133*^9}, {
  3.683444514363244*^9, 
  3.683444516922587*^9}},ExpressionUUID->"cdf23c4c-74a0-42d2-ad82-\
855aff8088ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving equations for Q and S", "Section",
 CellChangeTimes->{{3.68014963155259*^9, 3.680149637969672*^9}, {
  3.680149683916197*^9, 
  3.680149689663643*^9}},ExpressionUUID->"a3a92891-3319-411f-98d5-\
23d21784c662"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QLinearSolutions", "[", 
    RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Vs_", ",", "Ts_"}], "}"}], ",", "ga_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Q", ",", "q", ",", "sga", ",", "dims", ",", "S1", ",", "T", ",", 
      "tEquations", ",", "modularInvariantEquations", ",", "galoisEquations", 
      ",", "galoisOnSEquations", ",", "C", ",", "S2eqCEquations", ",", 
      "inductionEquations", ",", "equations", ",", "Tp", ",", "Sp", ",", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Preparing the linear equations for the change of basis matrix...\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tp", "=", 
      RowBox[{"TInRepresentation", "[", 
       RowBox[{"n", ",", 
        RowBox[{"Vs", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Sp", "=", 
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", 
        RowBox[{"Vs", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"\[Zeta]", "[", "n", "]"}], ",", 
         RowBox[{"n", " ", "Ts"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tp", ".", "Q"}], "-", 
        RowBox[{"Q", ".", "T"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<prepared tEquations\>\"", "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"modularInvariantEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sp", ".", "Q", ".", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"Q", ".", 
         RowBox[{
         "inductionMatrix", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<prepared modularInvariantEquations\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ga", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sga", "=", 
         RowBox[{"CalculateGaloisSigns", "[", 
          RowBox[{"n", ",", "inductionMatrix", ",", "ga"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"galoisEquations", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"GaloisInRepresentation", "[", 
              RowBox[{"n", ",", 
               RowBox[{"Vs", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ".", "Q"}], "-", 
            RowBox[{"Q", ".", 
             RowBox[{"SignedPermutationMatrix", "[", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{
             "sga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<prepared galoisEquations\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dims", "=", 
         RowBox[{"DimensionsFromInductionMatrix", "[", 
          RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S1", "=", 
         RowBox[{
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
          RowBox[{
          "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "TODO", " ", "try", " ", "uncommenting", " ", "the", " ", "second", 
          " ", "half", " ", "of", " ", "this", " ", 
          RowBox[{"one", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"galoisOnSEquations", "=", 
         RowBox[{"Collect", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sp", ".", "Q"}], ")"}], "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{"p", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
                "\[RightDoubleBracket]"}], "-", 
              RowBox[{"(", 
               RowBox[{"Q", ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{"p", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"GaloisAction", "[", "n", "]"}], "[", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "/@", "S1"}], ")"}]}], 
                 ")"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", 
               RowBox[{
               "sga", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"~", "Join", "~", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Sp", ".", "Q"}], ")"}], "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"(", 
                 RowBox[{"Q", ".", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GaloisAction", "[", "n", "]"}], "[", 
                    RowBox[{"PowerMod", "[", 
                    RowBox[{
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"-", "1"}], ",", "n"}], "]"}], "]"}], "/@", 
                    RowBox[{"S1", "\[LeftDoubleBracket]", 
                    RowBox[{"InversePermutation", "[", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}], ")"}]}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", 
                 RowBox[{
                 "sga", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "*)"}], ",", 
           "_q"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<prepared galoisOnSEquations\>\"", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Flatten", "[", "galoisOnSEquations", "]"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Length", "[", 
            RowBox[{
            "inductionMatrix", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          
          RowBox[{
           RowBox[{"n", "-", "1"}], "/.", 
           RowBox[{
           "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"S2eqCEquations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sp", ".", "Sp", ".", "Q"}], "-", 
           RowBox[{"Q", ".", "C"}]}], "}"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"galoisEquations", "=", 
         RowBox[{"galoisOnSEquations", "=", 
          RowBox[{"S2eqCEquations", "=", 
           RowBox[{"{", "}"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"A", "^", "t"}], "=", 
       RowBox[{
        RowBox[{"TS", "^", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "T", " ", 
        RowBox[{"A", "^", 
         RowBox[{"{", "t", "}"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"S", " ", 
        RowBox[{"T", "^", 
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}]}], " ", 
        RowBox[{"A", "^", "t"}]}], " ", "=", " ", 
       RowBox[{"T", " ", 
        RowBox[{"A", "^", "t"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "'"}], " ", "Q", " ", 
        RowBox[{"T", "^", 
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}]}], " ", 
        RowBox[{"A", "^", "t"}]}], " ", "=", " ", 
       RowBox[{"Q", " ", "T", " ", 
        RowBox[{"A", "^", "t"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"inductionEquations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sp", ".", "Q", ".", "T", ".", 
         RowBox[{"Transpose", "[", "inductionMatrix", "]"}]}], "-", 
        RowBox[{"Q", ".", 
         RowBox[{"Inverse", "[", "T", "]"}], ".", 
         RowBox[{"Transpose", "[", "inductionMatrix", "]"}]}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"lastLinearEquations", "=", 
      RowBox[{"{", 
       RowBox[{
       "tEquations", ",", "modularInvariantEquations", ",", "galoisEquations",
         ",", "galoisOnSEquations", ",", "S2eqCEquations", ",", 
        "inductionEquations"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"LiftToCommonCyclotomicField", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
          "tEquations", "~", "Join", "~", "modularInvariantEquations", "~", 
           "Join", "~", "galoisEquations", "~", "Join", "~", 
           "galoisOnSEquations", "~", "Join", "~", "S2eqCEquations", "~", 
           "Join", "~", "inductionEquations"}], "]"}], "]"}], ",", "_q"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<prepared linear equations in Q\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Preparing to solve linear equations for the change of basis \
matrix...\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"Q", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{"equations", "\[Equal]", "0"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Something went wrong: here are the equations.\>\"",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "tEquations", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "modularInvariantEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "galoisEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "galoisOnSEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "S2eqCEquations", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<... finished solving linear equations in Q.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "q0", "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"result", "/.", 
         RowBox[{"q", "\[Rule]", "q0"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.67894186404058*^9, {3.678941928978838*^9, 3.678941994622015*^9}, {
   3.678942074005478*^9, 3.678942215092514*^9}, {3.678942251488912*^9, 
   3.678942255361971*^9}, {3.678942504890068*^9, 3.678942651535184*^9}, {
   3.6789427706361437`*^9, 3.678942773085697*^9}, {3.678943007357416*^9, 
   3.678943007924487*^9}, {3.678943599416913*^9, 3.678943607105076*^9}, {
   3.678943957312295*^9, 3.67894406378862*^9}, {3.678944097758643*^9, 
   3.6789440982801323`*^9}, {3.678944163349471*^9, 3.678944187737761*^9}, {
   3.678944259810041*^9, 3.6789442602413*^9}, {3.678944695784174*^9, 
   3.6789447140479383`*^9}, {3.678947854760441*^9, 3.6789478722407007`*^9}, {
   3.678947907325646*^9, 3.67894791260146*^9}, {3.6789480233386106`*^9, 
   3.678948112977208*^9}, {3.678948625581107*^9, 3.678948636086055*^9}, {
   3.6789486875984087`*^9, 3.678948713812855*^9}, {3.678948753368424*^9, 
   3.678948756523959*^9}, {3.6789499483287973`*^9, 3.678949954218809*^9}, 
   3.678950044954679*^9, 3.6789501555901403`*^9, 3.6789503278606653`*^9, 
   3.6789509631898823`*^9, {3.678951046202694*^9, 3.6789510499786263`*^9}, {
   3.678951090944414*^9, 3.6789511243788853`*^9}, {3.678951155250742*^9, 
   3.6789511586971617`*^9}, {3.678951224304226*^9, 3.67895122756946*^9}, 
   3.678951301961378*^9, 3.6789515522393427`*^9, 3.678951797763033*^9, {
   3.6789520953086443`*^9, 3.678952149459362*^9}, {3.6789545358753757`*^9, 
   3.678954553791794*^9}, {3.678954667971245*^9, 3.678954672737598*^9}, {
   3.678954714460308*^9, 3.678954789270318*^9}, {3.678957121496063*^9, 
   3.678957149647298*^9}, {3.678957355213553*^9, 3.678957357469453*^9}, {
   3.678957463700287*^9, 3.678957477923751*^9}, {3.679002367935965*^9, 
   3.679002399216765*^9}, {3.6790024305476103`*^9, 3.6790024990764637`*^9}, {
   3.6790034089793262`*^9, 3.67900344626924*^9}, 3.679016049577244*^9, {
   3.679102069274342*^9, 3.679102080676156*^9}, {3.6791037318673773`*^9, 
   3.679103820326961*^9}, {3.6791039963917637`*^9, 3.679104001555174*^9}, {
   3.679104365792437*^9, 3.679104372009053*^9}, {3.679104436953786*^9, 
   3.679104440672626*^9}, {3.6791167381910143`*^9, 3.679116755035877*^9}, {
   3.6793492001336823`*^9, 3.6793492861391573`*^9}, 3.679349407350236*^9, {
   3.679610997250989*^9, 3.679610998792426*^9}, {3.679611049011742*^9, 
   3.679611091927182*^9}, {3.679645875981351*^9, 3.6796458767493687`*^9}, {
   3.680185434190527*^9, 3.6801854711008167`*^9}, {3.680187601034563*^9, 
   3.680187611818983*^9}, {3.68342516650113*^9, 3.683425170314659*^9}, {
   3.6834252184896593`*^9, 3.683425279628436*^9}, {3.6834303758629208`*^9, 
   3.683430396664835*^9}, {3.683430445932032*^9, 3.683430446078075*^9}, {
   3.683430486442656*^9, 3.683430539137519*^9}, {3.683430576611486*^9, 
   3.6834305908564167`*^9}, 3.683430649730541*^9, {3.6834309714554243`*^9, 
   3.683431018651243*^9}, {3.6834441717501*^9, 3.683444174923348*^9}, {
   3.683444208086253*^9, 3.6834442793988543`*^9}, {3.683444395085155*^9, 
   3.6834444277947702`*^9}, 3.6834445619986553`*^9, 3.683489872124044*^9, {
   3.683788156337263*^9, 
   3.6837881600836163`*^9}},ExpressionUUID->"70f9b835-0f41-442d-a1b4-\
647fb85c0436"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timesToList", "[", "X_Times", "]"}], ":=", 
  RowBox[{"List", "@@", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timesToList", "[", "X_", "]"}], ":=", 
  RowBox[{"{", "X", "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679027913463715*^9, 
  3.6790279241509953`*^9}},ExpressionUUID->"37145589-7d0e-4487-a50d-\
84bc34009e96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AlgebraicDegree", "[", 
   RowBox[{"eqn_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GroebnerBasis`DistributedTermsList", "[", 
       RowBox[{
        RowBox[{"eqn", "/.", 
         RowBox[{"Equal", "\[RuleDelayed]", "Subtract"}]}], ",", "vars"}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AlgebraicDegree", "[", "eqn_", "]"}], ":=", 
  RowBox[{"AlgebraicDegree", "[", 
   RowBox[{"eqn", ",", 
    RowBox[{"Variables", "[", "eqn", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679032294257174*^9, 
  3.679032296545602*^9}},ExpressionUUID->"b9f3d1b3-83d5-4968-bf3b-\
bd837c944b51"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SolveSEquations", "[", 
    RowBox[{"n_Integer", ",", "inductionMatrix_"}], "]"}], "[", 
   RowBox[{"Vs_", ",", "ga_", ",", "Q0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "S", ",", "Sp", ",", "Q", ",", "s", ",", "q", ",", "dims", ",", " ", 
      "S1", ",", "C", ",", "equations", ",", "det", ",", "det0", ",", 
      "variables", ",", "targets", ",", "target", ",", "\[Alpha]", ",", 
      "result", ",", "solutions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sp", "=", 
      RowBox[{"SInRepresentation", "[", 
       RowBox[{"n", ",", "Vs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "inductionMatrix", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"DimensionsFromInductionMatrix", "[", 
       RowBox[{"n", ",", "inductionMatrix"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S1", "=", 
      RowBox[{
       RowBox[{"dims", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "/", 
       RowBox[{
       "dims", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "=", "S1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", "S1"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Sp", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"S", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Q0", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Q", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"det0", "=", 
      RowBox[{"Det", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"report", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"report", "[", "X_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "r", "}"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<factoring determinant ...\>\"", "]"}], 
         ";", 
         RowBox[{"r", "=", "X"}], ";", 
         RowBox[{"Print", "[", "\"\<done!\>\"", "]"}], ";", "r"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"det", ":=", 
      RowBox[{"(", 
       RowBox[{"det0", "=", 
        RowBox[{"report", "[", 
         RowBox[{"Factor", "[", 
          RowBox[{"Collect", "[", 
           RowBox[{"det0", ",", "_q"}], "]"}], "]"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"variables", ":=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"timesToList", "[", "det", "]"}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"v", ":", 
            RowBox[{"q", "[", 
             RowBox[{"_", ",", "_"}], "]"}]}], ")"}], "_."], "\[RuleDelayed]",
          "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ga", "===", "Null"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sp", ".", "Q"}], "-", 
          RowBox[{"Q", ".", "S"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C", "=", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", 
             RowBox[{
             "inductionMatrix", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "-", "1"}], "/.", 
            RowBox[{
            "ga", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sp", ".", "Q"}], "-", 
            RowBox[{"Q", ".", "S"}]}], ",", 
           RowBox[{
            RowBox[{"S", ".", "S"}], "-", "C"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"Factor", "[", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"LiftToCommonCyclotomicField", "[", 
          RowBox[{"Flatten", "[", "equations", "]"}], "]"}], ",", 
         RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<found equations\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"targets", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"e_", "/;", 
              RowBox[{
               RowBox[{"AlgebraicDegree", "[", "e", "]"}], "\[Equal]", 
               "1"}]}]}], "]"}], "~", "Join", "~", 
           RowBox[{"Cases", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Alternatives", "@@", "variables"}], ")"}], "X_"}], 
              "\[RuleDelayed]", "X"}]}], "]"}]}]}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<solving: \>\"", " ", ",", "targets"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"targets", "\[Equal]", "0"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"x", "=", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"equations", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Factor", "[", 
             RowBox[{"Collect", "[", 
              RowBox[{"equations", ",", 
               RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}], ",", "0"}], "]"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "variables", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"target", "=", 
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"variables", ",", 
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"equations", ",", "#", ",", "\[Infinity]"}], "]"}], 
             "&"}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Setting \>\"", ",", "target", ",", " ", "\"\< to 1\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"equations", "=", 
         RowBox[{"equations", "~", "Join", "~", 
          RowBox[{"{", 
           RowBox[{"target", "-", "1"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"targets", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"equations", ",", 
                RowBox[{"e_", "/;", 
                 RowBox[{
                  RowBox[{"AlgebraicDegree", "[", "e", "]"}], "\[Equal]", 
                  "1"}]}]}], "]"}], "~", "Join", "~", 
              RowBox[{"Cases", "[", 
               RowBox[{"equations", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Alternatives", "@@", "variables"}], ")"}], "X_"}],
                  "\[RuleDelayed]", "X"}]}], "]"}]}]}], "]"}], ">", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<solving: \>\"", " ", ",", "targets"}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{"targets", "\[Equal]", "0"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"x", "=", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"equations", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Factor", "[", 
                RowBox[{"Collect", "[", 
                 RowBox[{"equations", ",", 
                  RowBox[{"_q", "|", "_s"}]}], "]"}], "]"}], ",", "0"}], 
              "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<S matrix after solving linear equations:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"S", "/.", 
         RowBox[{"s", "\[Rule]", "Global`s"}]}], ")"}], "//", "MatrixForm"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Q matrix after solving linear equations:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q", "/.", 
         RowBox[{"q", "\[Rule]", "Global`q"}]}], ")"}], "//", "MatrixForm"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"det", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "Global`s"}], ",", 
           RowBox[{"q", "\[Rule]", "Global`q"}]}], "}"}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"equations", "~", "Join", "~", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", " ", "det"}], " ", "-", "1"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"equations", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "Global`s"}], ",", 
           RowBox[{"q", "\[Rule]", "Global`q"}]}], "}"}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<About to start solving quadratic equations...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lastSEquations", "=", "equations"}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{"equations", "\[Equal]", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<... done!\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutions", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q0", ",", "s0"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"S", "/.", "solutions"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q0", ",", "s0"}], "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"result", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "q0"}], ",", 
              RowBox[{"s", "\[Rule]", "s0"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679026237463719*^9, 3.679026401061482*^9}, {
   3.679026532177328*^9, 3.6790265336414003`*^9}, {3.679026595434507*^9, 
   3.679026668558743*^9}, {3.6790267093723307`*^9, 3.67902671585257*^9}, {
   3.679026786997171*^9, 3.6790267915814257`*^9}, {3.679026837962565*^9, 
   3.67902684402677*^9}, {3.679027828294898*^9, 3.67902821160845*^9}, {
   3.679028506854056*^9, 3.679028512233839*^9}, {3.679029515385894*^9, 
   3.679029544537724*^9}, {3.679029601814136*^9, 3.679029650853195*^9}, {
   3.679029683641078*^9, 3.679029692188583*^9}, {3.679030049846499*^9, 
   3.679030059834921*^9}, {3.6790304870898333`*^9, 3.679030492433674*^9}, {
   3.6790311393768997`*^9, 3.679031146746657*^9}, {3.67903118760723*^9, 
   3.679031193351755*^9}, {3.679031807706992*^9, 3.679031866369025*^9}, {
   3.6790322827594357`*^9, 3.679032311452077*^9}, {3.679032492359161*^9, 
   3.6790325137713623`*^9}, {3.679032995661806*^9, 3.6790331008033133`*^9}, {
   3.679033140166047*^9, 3.679033200589802*^9}, 3.6790333359822617`*^9, {
   3.679033840165955*^9, 3.679033847065398*^9}, {3.679034788588993*^9, 
   3.6790348486978416`*^9}, {3.679034959528215*^9, 3.67903496798199*^9}, {
   3.679036278498267*^9, 3.679036326588046*^9}, {3.679109050095932*^9, 
   3.679109054598711*^9}, {3.679110809571063*^9, 3.679110810129339*^9}, {
   3.679111003574195*^9, 3.679111048938992*^9}, {3.679111278624571*^9, 
   3.679111299407061*^9}, {3.679617961749386*^9, 3.679618013273231*^9}, {
   3.6796187415940723`*^9, 3.6796188350565567`*^9}, {3.679645884647608*^9, 
   3.679645885830557*^9}, {3.680155713556593*^9, 3.6801557338026953`*^9}, {
   3.680185489046855*^9, 
   3.6801854942876472`*^9}},ExpressionUUID->"a53bdd7c-0bd8-40c7-8673-\
32ee18b7ed1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"invertibleQ", "[", "m_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "2000"}], "}"}], "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Variables", "[", "m", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"m", "/.", "rules"}], "]"}], "\[NotEqual]", "0"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Factor", "[", 
         RowBox[{"Det", "[", "m", "]"}], "]"}], "=!=", "0"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6789559419708977`*^9, 3.678956006000286*^9}, 
   3.6789560968991528`*^9},ExpressionUUID->"9c2892ac-37e4-4878-9bd6-\
228ca0856c49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindQLinearSolutions", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "k_", ",", "inductionMatrix_", ",", 
    RowBox[{"useGalois", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filename", ",", "outputDirectory", ",", "result", ",", "pairs", ",", 
      "triples", ",", "pMap"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputDirectory", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dataDirectory", ",", "\"\<findQLinearSolutions\>\""}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "outputDirectory", "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", "outputDirectory", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"outputDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"SHA1", "[", 
           RowBox[{"{", 
            RowBox[{"fusion", ",", "inductionMatrix"}], "}"}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{"useGalois", ",", "\"\<\>\"", ",", "\"\<-no-galois\>\""}], 
           "]"}], "<>", "\"\<.m.gz\>\""}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"(*", 
       RowBox[{"False", "\[And]"}], "*)"}], 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImportGZIP", "[", "filename", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"allocations", ",", "q"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allocations", "=", 
             RowBox[{"If", "[", 
              RowBox[{"useGalois", ",", "\[IndentingNewLine]", 
               RowBox[{
               "AllocateEigenvaluesToSimplesAndCompleteGaloisActions", "[", 
                RowBox[{
                "n", ",", "fusion", ",", "k", ",", "inductionMatrix"}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "Null"}], "}"}], "&"}], "/@", 
                RowBox[{
                "AllocateEigenvaluesToSimplesAndCheckFrobeniusSchurIndicators"\
, "[", 
                 RowBox[{
                 "n", ",", "fusion", ",", "k", ",", "inductionMatrix"}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pMap", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"False", "\[And]", 
                RowBox[{"$KernelID", "\[Equal]", "0"}]}], ",", 
               RowBox[{
                RowBox[{"DistributeDefinitions", "[", 
                 RowBox[{"QLinearSolutions", ",", "invertibleQ"}], "]"}], ";",
                 "ParallelMap"}], ",", "Map"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pairs", "=", 
             RowBox[{"pMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"QLinearSolutions", "[", 
                    RowBox[{"n", ",", "inductionMatrix"}], "]"}], "[", "#", 
                   "]"}]}], "}"}], "&"}], ",", "allocations"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"triples", "=", 
             RowBox[{"pMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"invertibleQ", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "[", "q", "]"}], "]"}]}], 
                 "}"}], "&"}], ",", "pairs"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Cases", "[", 
             RowBox[{"triples", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r_", ",", "True"}], "}"}], "\[RuleDelayed]", "r"}]}],
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GZIP", "[", 
         RowBox[{"result", ",", "filename"}], "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6789548287458363`*^9, 3.67895494887669*^9}, {
   3.678956011127274*^9, 3.678956013947281*^9}, {3.678960380239052*^9, 
   3.678960412308772*^9}, 3.678962486614418*^9, 3.67901605428677*^9, 
   3.679103856658284*^9, 3.679104942633149*^9, {3.679116784090499*^9, 
   3.679116881758724*^9}, {3.679170529961464*^9, 3.6791705577831182`*^9}, {
   3.6791736679847383`*^9, 3.6791736682452097`*^9}, {3.679174586845887*^9, 
   3.679174595168212*^9}, {3.679269018325342*^9, 3.6792690468797626`*^9}, {
   3.6793493170168867`*^9, 3.6793493298378572`*^9}, {3.679349751520211*^9, 
   3.6793497805013523`*^9}, {3.679611152740652*^9, 3.679611248906849*^9}, {
   3.679612165830312*^9, 3.6796121981045523`*^9}, {3.6796458211584787`*^9, 
   3.679645834287253*^9}, {3.6796459543415737`*^9, 3.679645958997917*^9}, {
   3.680149884166122*^9, 3.6801498865108957`*^9}, 3.680150220917371*^9, {
   3.680152700631695*^9, 3.6801527262020082`*^9}, {3.680515172634079*^9, 
   3.6805152128191957`*^9}, {3.680515277027689*^9, 3.680515280468511*^9}, {
   3.682536443351116*^9, 3.6825364463844767`*^9}, {3.6825667617868023`*^9, 
   3.6825667734385366`*^9}, 3.683425184528482*^9, 
   3.683446619398785*^9},ExpressionUUID->"1c63828e-2080-4074-894d-\
1caa997f89ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modular data", "Section",
 CellChangeTimes->{{3.680149701226727*^9, 
  3.680149704376717*^9}},ExpressionUUID->"6a9942e2-d5b5-4292-9029-\
16691b2c97ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"n_", ",", "fusion_", ",", "inductionMatrix_", ",", 
    RowBox[{"k", ":", "_Integer", ":", "6"}], ",", 
    RowBox[{"useGalois", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"qsols", "=", 
       RowBox[{"FindQLinearSolutions", "[", 
        RowBox[{
        "n", ",", "fusion", ",", "k", ",", "inductionMatrix", ",", 
         "useGalois"}], "]"}]}], ",", "q", ",", "s"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"S", ",", 
             RowBox[{"{", 
              RowBox[{"S", ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "2"}], 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], "/@", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SolveSEquations", "[", 
               RowBox[{"n", ",", "inductionMatrix"}], "]"}], "[", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1", ",", "1", ",", "All", ",", "1"}], 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              "]"}], "[", 
             RowBox[{"q", ",", "s"}], "]"}], "]"}]}], ")"}], "&"}], ",", 
        "qsols"}], "]"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6790282957389297`*^9, 3.679028339897011*^9}, {
   3.679028411370042*^9, 3.6790284871087017`*^9}, {3.679028568751039*^9, 
   3.679028572023054*^9}, {3.679028626797464*^9, 3.6790286534307623`*^9}, {
   3.679034589590927*^9, 3.6790345915032187`*^9}, {3.679034624829392*^9, 
   3.679034627901185*^9}, {3.679111104367234*^9, 3.679111106862561*^9}, {
   3.6791169463803988`*^9, 3.679116954923935*^9}, {3.679269138794573*^9, 
   3.679269149026675*^9}, 3.679349500216511*^9, 3.67934964139548*^9, {
   3.679617913182066*^9, 3.679617920508089*^9}, 3.680149890737238*^9, {
   3.6801499705119057`*^9, 
   3.680149983847745*^9}},ExpressionUUID->"f38b487a-70e9-4498-8075-\
361f8f9ee919"],

Cell[BoxData[
 RowBox[{
  RowBox[{"permuteColumns", "[", "inductionMatrix_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "inductionMatrix", "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Total", "[", "#", "]"}], ",", 
        RowBox[{"Reverse", "[", "#", "]"}]}], "}"}], "&"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679003848562131*^9, 3.6790038766419353`*^9}, {
  3.6790039756221123`*^9, 
  3.679003976916894*^9}},ExpressionUUID->"4d1d14bc-78f1-4645-a9a7-\
347cfdf98904"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"induction_", "?", "MatrixQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Beginning calculation of modular data for \>\"", ",", 
       RowBox[{"DisplayGraph", "[", "fusion", "]"}], ",", "\"\< \>\"", ",", 
       RowBox[{"MatrixForm", "[", "induction", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Considering conductors: \>\"", ",", 
       RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FindModularData", "[", 
         RowBox[{"n", ",", "fusion", ",", 
          RowBox[{"permuteColumns", "[", "induction", "]"}], ",", "6"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "}"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"inductions", ":", 
     RowBox[{"{", 
      RowBox[{"___", "?", "MatrixQ"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"FindModularData", "[", 
       RowBox[{"fusion", ",", "#"}], "]"}], "&"}], "/@", "inductions"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", "fusion_", "]"}], ":=", 
  RowBox[{"FindModularData", "[", 
   RowBox[{"fusion", ",", 
    RowBox[{"InductionMatrices", "[", "fusion", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"EvenPartFusionRules", "/@", 
        RowBox[{"FindFusionRules", "[", "g", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FindModularData", "@@", "#"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"InductionMatrices", "[", "g", "]"}], ",", 
          "CheckGaloisVerlinde"}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindModularData", "[", " ", 
   RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"FindFusionRules", "[", "m", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{"FindModularData", "/@", 
        RowBox[{"FindFusionRules", "[", "m", "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", 
   RowBox[{"fusion_", ",", 
    RowBox[{"inductions", ":", 
     RowBox[{"{", 
      RowBox[{"___", "?", "MatrixQ"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DistributeDefinitions", "[", 
      RowBox[{
      "FindModularData", ",", "permuteColumns", ",", "PossibleConductors"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"FindModularData", "[", 
         RowBox[{"n", ",", "fusion", ",", 
          RowBox[{"permuteColumns", "[", "induction", "]"}], ",", "6"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"induction", ",", "inductions"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"PossibleConductors", "[", "induction", "]"}]}], "}"}]}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", "fusion_", "]"}], ":=", 
  RowBox[{"ParallelFindModularData", "[", 
   RowBox[{"fusion", ",", 
    RowBox[{"InductionMatrices", "[", "fusion", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelFindModularData", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"EvenPartFusionRules", "/@", 
        RowBox[{"FindFusionRules", "[", "g", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ParallelFindModularData", "@@", "#"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"InductionMatrices", "[", "g", "]"}], ",", 
          "CheckGaloisVerlinde"}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelFindModularData", "[", " ", 
    RowBox[{"m_", "?", "MatrixQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Considering fusion rings: \>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"DisplayGraph", "[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"FindFusionRules", "[", "m", "]"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"ParallelFindModularData", "/@", 
         RowBox[{"FindFusionRules", "[", "m", "]"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.679634407743799*^9, 3.679634441751905*^9}, {
  3.679639873553401*^9, 3.67963990881421*^9}, {3.680150235046617*^9, 
  3.68015024442994*^9}, {3.680150274678768*^9, 3.6801502985365763`*^9}, {
  3.6801512252260933`*^9, 3.6801512314913282`*^9}, {3.680151500205762*^9, 
  3.680151522411263*^9}, {3.6801518532022543`*^9, 3.6801518567582817`*^9}, {
  3.680155440446508*^9, 3.680155453845662*^9}, {3.680156117659947*^9, 
  3.680156149168626*^9}, {3.68015618458876*^9, 3.680156258123073*^9}, {
  3.680166244204167*^9, 3.680166269926814*^9}, {3.680189714146948*^9, 
  3.680189757474679*^9}, {3.680366160080352*^9, 3.680366176945516*^9}, {
  3.6803662322303133`*^9, 3.680366280009501*^9}, {3.680366323362644*^9, 
  3.680366342199327*^9}, {3.680366624609488*^9, 3.680366667594474*^9}, {
  3.680369651712243*^9, 
  3.680369666895648*^9}},ExpressionUUID->"6d4e43c8-3781-4c21-833d-\
ce11d0a82e7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291412978622007`*^9, 
  3.629141300184711*^9}},ExpressionUUID->"07725e51-cc34-4c0b-a556-\
848bf1405f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291413009800043`*^9, 
  3.629141302389662*^9}},ExpressionUUID->"8d8ec492-17f9-468e-ae36-\
ad1d14be8038"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1037, 851},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 539, 9, 51, "Subtitle", "ExpressionUUID" -> \
"7cc412f1-5334-4d25-9b41-bc11a7d314d2",
 InitializationCell->True],
Cell[1122, 33, 574, 11, 49, "Text", "ExpressionUUID" -> \
"97f70b10-7dd0-42ab-afe5-9c0c2216adc9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1721, 48, 118, 2, 64, "Section", "ExpressionUUID" -> \
"93b41240-4444-4dcd-9328-b0eac5b9efd9",
 InitializationCell->True],
Cell[1842, 52, 307, 8, 32, "Input", "ExpressionUUID" -> \
"b7e293bb-c0e9-4f1e-83e5-98ee07f8df87"],
Cell[2152, 62, 307, 8, 48, "Input", "ExpressionUUID" -> \
"f38c78b4-6552-4565-99fa-6696572c2d96",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2484, 74, 193, 4, 44, "Subsection", "ExpressionUUID" -> \
"44d2577d-9df9-4d3b-a3fb-ffad9ea81017",
 InitializationCell->True],
Cell[2680, 80, 130, 2, 30, "Text", "ExpressionUUID" -> \
"e853269f-d82f-4743-9964-dab5d60084c0",
 InitializationCell->True],
Cell[2813, 84, 1379, 26, 91, "Input", "ExpressionUUID" -> \
"559d07b0-340e-48b7-8521-5095db8c195c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4229, 115, 121, 2, 44, "Subsection", "ExpressionUUID" -> \
"ffbe11af-c01d-4e6a-8d47-45cbcd4efa08",
 InitializationCell->True],
Cell[4353, 119, 689, 14, 112, "Input", "ExpressionUUID" -> \
"30d7be7c-b0b8-4050-87c3-e995701d0e59",
 InitializationCell->True],
Cell[5045, 135, 1329, 21, 595, "Input", "ExpressionUUID" -> \
"e6ad8797-8f9b-40e8-a040-3b8ec4e916da",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6411, 161, 116, 2, 44, "Subsection", "ExpressionUUID" -> \
"27ee0248-1f4f-4742-925f-f4ce4849b3d7",
 InitializationCell->True],
Cell[6530, 165, 177, 4, 48, "Input", "ExpressionUUID" -> \
"060f4a19-f731-43b3-b8f3-8cf39c9bae26",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6756, 175, 166, 3, 64, "Section", "ExpressionUUID" -> \
"28e4e1ea-c203-425a-919d-84e22c15e137"],
Cell[6925, 180, 630, 18, 70, "Input", "ExpressionUUID" -> \
"1750e3be-96a4-405d-8281-117bc6550761",
 InitializationCell->True],
Cell[7558, 200, 1163, 31, 112, "Input", "ExpressionUUID" -> \
"475fe517-88d2-4664-aeb7-114767e7ddad",
 InitializationCell->True],
Cell[8724, 233, 1658, 39, 217, "Input", "ExpressionUUID" -> \
"8ef48fc0-bc0f-4dd8-ba65-c40564b4e82a",
 InitializationCell->True],
Cell[10385, 274, 410, 11, 48, "Input", "ExpressionUUID" -> \
"5f16753e-e092-460d-976b-d14d116f6934",
 InitializationCell->True],
Cell[10798, 287, 1121, 27, 91, "Input", "ExpressionUUID" -> \
"8fbad9d2-adf2-4732-af6c-ae8be6aa4e54",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11956, 319, 233, 5, 64, "Section", "ExpressionUUID" -> \
"dc4c6f99-cdbb-48c9-ad4b-c02a2417e5d3",
 InitializationCell->True],
Cell[12192, 326, 547, 12, 51, "Input", "ExpressionUUID" -> \
"5cd71731-01f9-47a0-bdf3-92ba738fd43e",
 InitializationCell->True],
Cell[12742, 340, 2371, 52, 280, "Input", "ExpressionUUID" -> \
"1ad203d0-018e-471e-bdb0-546c9fef56ba",
 InitializationCell->True],
Cell[15116, 394, 3899, 81, 406, "Input", "ExpressionUUID" -> \
"bbefe5d8-5ef9-4ecd-bea7-73bda49da69e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[19040, 479, 196, 4, 44, "Subsection", "ExpressionUUID" -> \
"92ca296f-2bb2-4122-ba62-a50514ad01d5",
 InitializationCell->True],
Cell[19239, 485, 603, 16, 48, "Input", "ExpressionUUID" -> \
"9db8b26b-a3f3-4be3-a2db-44a91843ae1b",
 InitializationCell->True],
Cell[19845, 503, 7289, 169, 689, "Input", "ExpressionUUID" -> \
"d32fb644-f3b1-4e08-afc8-f87060f9171d",
 InitializationCell->True],
Cell[27137, 674, 1905, 48, 196, "Input", "ExpressionUUID" -> \
"dadf55f3-5071-4289-b956-e834ae979572",
 InitializationCell->True],
Cell[29045, 724, 219, 5, 48, "Input", "ExpressionUUID" -> \
"c91df157-9b06-4789-b2c7-4e1ac2302b41",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[29301, 734, 191, 4, 44, "Subsection", "ExpressionUUID" -> \
"8fd8cd89-b1cf-42bc-865f-09beb392f720",
 InitializationCell->True],
Cell[29495, 740, 2550, 57, 238, "Input", "ExpressionUUID" -> \
"b3b50534-0e8a-4993-bfcc-7a1ad5f98c13",
 InitializationCell->True],
Cell[32048, 799, 2211, 52, 196, "Input", "ExpressionUUID" -> \
"7399558b-a655-452c-8ce6-16b05516016e",
 InitializationCell->True],
Cell[34262, 853, 2404, 57, 217, "Input", "ExpressionUUID" -> \
"82df8788-1598-4bf1-88f2-807fd97b0f41",
 InitializationCell->True],
Cell[36669, 912, 10033, 232, 847, "Input", "ExpressionUUID" -> \
"3fe2da9e-0ad0-4b73-b7eb-eaf50bdaafce",
 InitializationCell->True],
Cell[46705, 1146, 1996, 49, 217, "Input", "ExpressionUUID" -> \
"a2294c7e-e2ef-41a4-8ee6-de70bfd04584",
 InitializationCell->True],
Cell[48704, 1197, 238, 6, 48, "Input", "ExpressionUUID" -> \
"3e0b6c8f-f853-4a1b-b988-65ec11b3b3d6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[48979, 1208, 192, 4, 44, "Subsection", "ExpressionUUID" -> \
"fe4f0400-aeed-41a6-af54-165b3b185f00",
 InitializationCell->True],
Cell[49174, 1214, 2355, 53, 181, "Input", "ExpressionUUID" -> \
"db2adfbb-2334-4f88-b609-161225ddb95e",
 InitializationCell->True],
Cell[51532, 1269, 5100, 125, 511, "Input", "ExpressionUUID" -> \
"6d6136f8-2896-43f9-8c8d-4bd69d6525dc",
 InitializationCell->True],
Cell[56635, 1396, 2823, 64, 217, "Input", "ExpressionUUID" -> \
"66ce75ee-1099-4254-9adb-8bd26ccdf70c",
 InitializationCell->True],
Cell[59461, 1462, 1936, 43, 175, "Input", "ExpressionUUID" -> \
"f200fa6d-40e5-4ff4-a484-d9b3436aa292",
 InitializationCell->True],
Cell[61400, 1507, 221, 5, 48, "Input", "ExpressionUUID" -> \
"50dfc6b7-3550-4f8c-a1b4-5423fb7df9a1",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61670, 1518, 177, 4, 64, "Section", "ExpressionUUID" -> \
"2b7e588a-c16e-4ce9-8412-6de09bd0efee",
 InitializationCell->True],
Cell[61850, 1524, 2367, 69, 91, "Input", "ExpressionUUID" -> \
"415701b2-ee0f-4324-927d-36a84c1294c4",
 InitializationCell->True],
Cell[64220, 1595, 2015, 49, 175, "Input", "ExpressionUUID" -> \
"b4eb117b-6c94-4b75-9326-8c675a9e623a",
 InitializationCell->True],
Cell[66238, 1646, 861, 24, 48, "Input", "ExpressionUUID" -> \
"d5122c5d-fb75-44d2-8326-4eef094ff34b",
 InitializationCell->True],
Cell[67102, 1672, 2474, 64, 202, "Input", "ExpressionUUID" -> \
"448d9a6d-04fa-4c18-9df6-ac5d91793228",
 InitializationCell->True],
Cell[69579, 1738, 916, 25, 72, "Input", "ExpressionUUID" -> \
"42718b6e-b84b-4e85-a541-e3fc43dfd23d",
 InitializationCell->True],
Cell[70498, 1765, 2052, 54, 112, "Input", "ExpressionUUID" -> \
"e267b1cb-c686-42b3-bd1c-ee77ba9ba7de",
 InitializationCell->True],
Cell[72553, 1821, 584, 18, 48, "Input", "ExpressionUUID" -> \
"85496efd-2c42-42e1-86a8-5803f73e1463",
 InitializationCell->True],
Cell[73140, 1841, 1557, 45, 92, "Input", "ExpressionUUID" -> \
"75f24e73-484f-4c15-904a-351543198ddf",
 InitializationCell->True],
Cell[74700, 1888, 363, 10, 48, "Input", "ExpressionUUID" -> \
"e426d0a7-b205-42d4-899e-3641914ddf10",
 InitializationCell->True],
Cell[75066, 1900, 1190, 35, 94, "Input", "ExpressionUUID" -> \
"572a7e5a-bec3-40da-a524-00ccbff336ec",
 InitializationCell->True],
Cell[76259, 1937, 3566, 89, 227, "Input", "ExpressionUUID" -> \
"34d23afe-ea42-406a-9ae3-1b1a2b8d6471",
 InitializationCell->True],
Cell[79828, 2028, 373, 9, 48, "Input", "ExpressionUUID" -> \
"5f8ec897-db5d-44ac-8d1f-9a40acb83202",
 InitializationCell->True],
Cell[80204, 2039, 242, 5, 48, "Input", "ExpressionUUID" -> \
"d9e08a38-526f-44b5-aa89-2fe68a801769",
 InitializationCell->True],
Cell[80449, 2046, 1713, 45, 186, "Input", "ExpressionUUID" -> \
"2f4e1e00-2815-408b-a1cf-58bdca1a79b0",
 InitializationCell->True],
Cell[82165, 2093, 451, 12, 46, "Input", "ExpressionUUID" -> \
"f1370946-686c-4008-bcd6-505f641fa3da",
 InitializationCell->True],
Cell[82619, 2107, 1412, 39, 46, "Input", "ExpressionUUID" -> \
"bcc147c6-8797-49ad-a991-aeaaeb2c5bf4",
 InitializationCell->True],
Cell[84034, 2148, 1720, 48, 108, "Input", "ExpressionUUID" -> \
"e83ca764-3fb5-4b05-ae91-2c600fd97b0c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[85791, 2201, 198, 4, 64, "Section", "ExpressionUUID" -> \
"d2bdefe4-4546-43c4-8969-cb22bec254ee",
 InitializationCell->True],
Cell[85992, 2207, 1244, 30, 46, "Input", "ExpressionUUID" -> \
"31c0f4fc-a5b4-40bd-8c55-c007942e4cf0",
 InitializationCell->True],
Cell[87239, 2239, 375, 9, 48, "Input", "ExpressionUUID" -> \
"e0f51b09-1455-4a4f-85cd-28eecb0391b2",
 InitializationCell->True],
Cell[87617, 2250, 447, 12, 91, "Input", "ExpressionUUID" -> \
"808275c6-650a-4388-bd75-e8369e980a9a",
 InitializationCell->True],
Cell[88067, 2264, 3743, 101, 219, "Input", "ExpressionUUID" -> \
"13161ede-336f-4389-a4d0-758413818826",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[91847, 2370, 231, 5, 64, "Section", "ExpressionUUID" -> \
"d2383120-e822-4504-90bf-40586cc1d38c",
 InitializationCell->True],
Cell[92081, 2377, 639, 12, 70, "Input", "ExpressionUUID" -> \
"3913179f-95e5-43ca-9625-e515c525b381",
 InitializationCell->True],
Cell[92723, 2391, 1324, 34, 72, "Input", "ExpressionUUID" -> \
"9df43dd8-4b26-40b6-bd26-66fa3ee4c621",
 InitializationCell->True],
Cell[94050, 2427, 1715, 39, 133, "Input", "ExpressionUUID" -> \
"4c5c1a73-b462-4bd9-a949-61d105d446ab",
 InitializationCell->True],
Cell[95768, 2468, 1068, 27, 133, "Input", "ExpressionUUID" -> \
"6db0daa5-02ed-4839-95b2-81524ce9176a",
 InitializationCell->True],
Cell[96839, 2497, 3132, 77, 224, "Input", "ExpressionUUID" -> \
"2ad50104-006a-45b1-86c1-a377a7eb30f6",
 InitializationCell->True],
Cell[99974, 2576, 1411, 34, 139, "Input", "ExpressionUUID" -> \
"20ae4e6e-cea3-4dee-b154-66beb4b48e7e",
 InitializationCell->True],
Cell[101388, 2612, 2406, 60, 259, "Input", "ExpressionUUID" -> \
"264d8c14-38eb-45ed-8099-dc8f53a84fa7",
 InitializationCell->True],
Cell[103797, 2674, 228, 5, 48, "Input", "ExpressionUUID" -> \
"6293e526-eaef-4bce-a41d-ca57e036214c",
 InitializationCell->True],
Cell[104028, 2681, 794, 21, 112, "Input", "ExpressionUUID" -> \
"a9e994ae-efea-42b5-b79e-6bd969299472",
 InitializationCell->True],
Cell[104825, 2704, 1520, 34, 133, "Input", "ExpressionUUID" -> \
"2929a67c-b4fa-40ba-b950-00dc09cb996c",
 InitializationCell->True],
Cell[106348, 2740, 4310, 108, 213, "Input", "ExpressionUUID" -> \
"c279d5ae-ba00-4530-bcd2-c3029de77f54",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[110695, 2853, 158, 3, 64, "Section", "ExpressionUUID" -> \
"500e4e92-1dc8-4880-845a-50b9f1716e5c"],
Cell[110856, 2858, 1846, 50, 174, "Input", "ExpressionUUID" -> \
"3bf648b1-c81b-41f4-9cd5-755119c4e81d",
 InitializationCell->True],
Cell[112705, 2910, 367, 9, 48, "Input", "ExpressionUUID" -> \
"cf542cf2-72e0-4bec-8d53-0dffd0c2f0a7",
 InitializationCell->True],
Cell[113075, 2921, 334, 8, 48, "Input", "ExpressionUUID" -> \
"0ba97c94-b63e-4c09-bbee-e4e6747987df",
 InitializationCell->True],
Cell[113412, 2931, 230, 5, 48, "Input", "ExpressionUUID" -> \
"02ec01d3-e2a8-4cd7-8315-58c050ab6737",
 InitializationCell->True],
Cell[113645, 2938, 7444, 180, 521, "Input", "ExpressionUUID" -> \
"ef23b7c2-6654-4d3f-a0e3-fa2b6d365335",
 InitializationCell->True],
Cell[121092, 3120, 352, 9, 48, "Input", "ExpressionUUID" -> \
"7a6d2fa8-17e5-4b71-8571-77f118963337",
 InitializationCell->True],
Cell[121447, 3131, 2481, 68, 188, "Input", "ExpressionUUID" -> \
"1541d995-acef-45ee-b60b-7fed79754331",
 InitializationCell->True],
Cell[123931, 3201, 478, 12, 48, "Input", "ExpressionUUID" -> \
"871a78a6-03c1-4647-a3f3-2abea384b9f5",
 InitializationCell->True],
Cell[124412, 3215, 2383, 64, 187, "Input", "ExpressionUUID" -> \
"1e75cf75-9d17-4957-8fc1-b74b9f944263",
 InitializationCell->True],
Cell[126798, 3281, 3394, 93, 209, "Input", "ExpressionUUID" -> \
"6c171d11-3d5e-4eae-b048-67db0b024036",
 InitializationCell->True],
Cell[130195, 3376, 232, 5, 48, "Input", "ExpressionUUID" -> \
"5134923f-3878-4cb9-a6ec-d2c9bf34cc5e",
 InitializationCell->True],
Cell[130430, 3383, 695, 19, 70, "Input", "ExpressionUUID" -> \
"f8166685-fafa-4acd-92a9-aa81b9bd29d4",
 InitializationCell->True],
Cell[131128, 3404, 4111, 110, 238, "Input", "ExpressionUUID" -> \
"ae0ab09d-1906-4e61-9608-a50e75dc1970",
 InitializationCell->True],
Cell[135242, 3516, 2121, 55, 153, "Input", "ExpressionUUID" -> \
"3c4e2861-05c8-4614-98ff-bf80c97a40a0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[137400, 3576, 176, 3, 64, "Section", "ExpressionUUID" -> \
"e295b6c6-0bad-4201-8731-47815c635b1d"],
Cell[137579, 3581, 1928, 55, 114, "Input", "ExpressionUUID" -> \
"36473b2a-c27e-4c97-ac07-1d8a4f71c823",
 InitializationCell->True],
Cell[139510, 3638, 360, 10, 48, "Input", "ExpressionUUID" -> \
"a8a8564b-6856-4976-8620-40e7381330b6",
 InitializationCell->True],
Cell[139873, 3650, 2711, 66, 116, "Input", "ExpressionUUID" -> \
"be13fc02-651e-47f6-8b43-d4a126cd114e",
 InitializationCell->True],
Cell[142587, 3718, 1881, 53, 86, "Input", "ExpressionUUID" -> \
"d44680d4-6536-4191-8891-8fb74dce249b",
 InitializationCell->True],
Cell[144471, 3773, 2097, 48, 139, "Input", "ExpressionUUID" -> \
"e034f21f-1a97-482d-9a67-d6efbf512f5d",
 InitializationCell->True],
Cell[146571, 3823, 1429, 37, 139, "Input", "ExpressionUUID" -> \
"1490d3ce-9219-4474-8a6b-7cef1f2bd94e",
 InitializationCell->True],
Cell[148003, 3862, 1540, 39, 133, "Input", "ExpressionUUID" -> \
"d23f30f8-9a63-4db2-a2be-c7ba0dcd2107",
 InitializationCell->True],
Cell[149546, 3903, 1407, 38, 112, "Input", "ExpressionUUID" -> \
"d22fa309-eec7-4984-ab99-a7beb5bfb2c4",
 InitializationCell->True],
Cell[150956, 3943, 1913, 54, 135, "Input", "ExpressionUUID" -> \
"3c981719-5497-46c0-8875-3be2235ba30b",
 InitializationCell->True],
Cell[152872, 3999, 1329, 36, 112, "Input", "ExpressionUUID" -> \
"5ab60a7a-31de-42d4-9492-b990dbc3598c",
 InitializationCell->True],
Cell[154204, 4037, 239, 6, 48, "Input", "ExpressionUUID" -> \
"4e90dc21-6d93-4591-b3db-cf13822804ce",
 InitializationCell->True],
Cell[154446, 4045, 264, 7, 48, "Input", "ExpressionUUID" -> \
"89e42e5f-b706-4ca7-b021-659deccb7583",
 InitializationCell->True],
Cell[154713, 4054, 21169, 499, 1561, "Input", "ExpressionUUID" -> \
"37043a9a-9ea9-46b0-a859-352487387762",
 InitializationCell->True],
Cell[175885, 4555, 2598, 61, 175, "Input", "ExpressionUUID" -> \
"07976f02-9885-4f3c-aab3-e4936e008470",
 InitializationCell->True],
Cell[178486, 4618, 2389, 57, 238, "Input", "ExpressionUUID" -> \
"618ee53d-179e-46e5-9d9b-7c28ef07aeef",
 InitializationCell->True],
Cell[180878, 4677, 1862, 47, 112, "Input", "ExpressionUUID" -> \
"7a71975d-2c42-4303-b456-e21fc1538dcb",
 InitializationCell->True],
Cell[182743, 4726, 1950, 45, 154, "Input", "ExpressionUUID" -> \
"fbfb659d-93ed-47cc-9ea8-b69141703e67",
 InitializationCell->True],
Cell[184696, 4773, 7532, 170, 616, "Input", "ExpressionUUID" -> \
"cd671782-dabf-4213-96a3-078c8e121d30",
 InitializationCell->True],
Cell[192231, 4945, 268, 7, 48, "Input", "ExpressionUUID" -> \
"b35f6928-c50f-40df-aabe-33678def5004",
 InitializationCell->True],
Cell[192502, 4954, 618, 14, 112, "Input", "ExpressionUUID" -> \
"26a6265f-ec7c-4b66-a68b-0e388119c00e",
 InitializationCell->True],
Cell[193123, 4970, 6220, 144, 418, "Input", "ExpressionUUID" -> \
"5a793e55-bc69-41d5-ae92-37aa2e1752ee",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[199380, 5119, 167, 3, 64, "Section", "ExpressionUUID" -> \
"09f9c2a5-514d-4ccc-98d9-e4cfe09b798f"],
Cell[199550, 5124, 513, 14, 48, "Input", "ExpressionUUID" -> \
"3decf1fc-219e-47eb-aa2d-fc0bf94400ce",
 InitializationCell->True],
Cell[200066, 5140, 673, 20, 70, "Input", "ExpressionUUID" -> \
"c038c6b6-418e-47b6-a6dc-3393a9f57d63",
 InitializationCell->True],
Cell[200742, 5162, 12459, 273, 1071, "Input", "ExpressionUUID" -> \
"9fc393a6-4c3f-409d-b84a-cc5201897aaa",
 InitializationCell->True],
Cell[213204, 5437, 946, 24, 91, "Input", "ExpressionUUID" -> \
"abe579ce-5235-4675-8bd8-d8ddcc9e0b96",
 InitializationCell->True],
Cell[214153, 5463, 967, 26, 70, "Input", "ExpressionUUID" -> \
"740a23a7-9601-4894-933d-08add46f3141",
 InitializationCell->True],
Cell[215123, 5491, 266, 7, 48, "Input", "ExpressionUUID" -> \
"40d08055-1144-4303-a380-140a196bac58",
 InitializationCell->True],
Cell[215392, 5500, 3884, 94, 332, "Input", "ExpressionUUID" -> \
"9df6e62b-4d67-4aa1-9339-6166490f2d56",
 InitializationCell->True],
Cell[219279, 5596, 2853, 62, 267, "Input", "ExpressionUUID" -> \
"8e872577-b01e-4265-8695-7f256f9a5d5a",
 InitializationCell->True],
Cell[222135, 5660, 6688, 151, 504, "Input", "ExpressionUUID" -> \
"1f33843b-ae30-4082-830c-26b43a02cde0",
 InitializationCell->True],
Cell[228826, 5813, 3649, 82, 301, "Input", "ExpressionUUID" -> \
"c4f6c82d-d788-4c39-b53a-f512f8d59c35",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[232512, 5900, 173, 3, 64, "Section", "ExpressionUUID" -> \
"9e26f7a3-68d6-4bcd-9174-9680298059a4"],
Cell[232688, 5905, 2044, 53, 218, "Input", "ExpressionUUID" -> \
"b6e3624e-2aad-4581-abd5-430261fe9f3f",
 InitializationCell->True],
Cell[234735, 5960, 1060, 25, 112, "Input", "ExpressionUUID" -> \
"2ef7a00e-e1b1-438d-a93c-99b3af5cc6bc",
 InitializationCell->True],
Cell[235798, 5987, 1045, 28, 70, "Input", "ExpressionUUID" -> \
"819ed44a-d3b3-4137-94b8-d818d3ff95bf",
 InitializationCell->True],
Cell[236846, 6017, 3708, 94, 301, "Input", "ExpressionUUID" -> \
"d72dadb1-98f4-4b87-9b9a-842d763ddaba",
 InitializationCell->True],
Cell[240557, 6113, 1964, 51, 148, "Input", "ExpressionUUID" -> \
"f09e727b-565d-49c7-9b28-4ebad7e5d891",
 InitializationCell->True],
Cell[242524, 6166, 719, 19, 63, "Input", "ExpressionUUID" -> \
"6bdeafa2-459f-4c14-a967-3b484be5f0d1",
 InitializationCell->True],
Cell[243246, 6187, 11203, 246, 641, "Input", "ExpressionUUID" -> \
"0dbe25d2-7d6e-45d7-a5c7-d6426ddc55b9",
 InitializationCell->True],
Cell[254452, 6435, 1105, 27, 46, "Input", "ExpressionUUID" -> \
"f3ec3a52-b90a-4746-bebc-3e710b83444f",
 InitializationCell->True],
Cell[255560, 6464, 1315, 35, 63, "Input", "ExpressionUUID" -> \
"d93da676-fb35-4337-83e3-14b8079df9e3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[256912, 6504, 159, 3, 64, "Section", "ExpressionUUID" -> \
"7ecbac2a-dcb7-4e9a-954d-d619ef8f7e33"],
Cell[257074, 6509, 434, 10, 28, "Input", "ExpressionUUID" -> \
"addd14bd-c94a-478a-8657-11a67f584fb8"],
Cell[257511, 6521, 231, 5, 28, "Input", "ExpressionUUID" -> \
"e43b4536-f23c-4969-bf6e-bd46b2ee5b07",
 InitializationCell->True],
Cell[257745, 6528, 1967, 47, 97, "Input", "ExpressionUUID" -> \
"216aa8ae-8a85-4235-a0dd-bdc067f04c84",
 InitializationCell->True],
Cell[259715, 6577, 1292, 34, 46, "Input", "ExpressionUUID" -> \
"c957d659-b4cb-403e-a18a-bf7a72e9acc1",
 InitializationCell->True],
Cell[261010, 6613, 237, 5, 28, "Input", "ExpressionUUID" -> \
"11e8c52b-e23c-424e-81ac-8edb02bafd53",
 InitializationCell->True],
Cell[261250, 6620, 4075, 95, 216, "Input", "ExpressionUUID" -> \
"a9be628e-2f00-4414-ac06-4b7b63dff9c0",
 InitializationCell->True],
Cell[265328, 6717, 2309, 57, 131, "Input", "ExpressionUUID" -> \
"e41e7fc7-585d-4f5f-94ff-4a72683cd688",
 InitializationCell->True],
Cell[267640, 6776, 423, 12, 28, "Input", "ExpressionUUID" -> \
"63ac7eb2-cb1d-4b84-8875-71fbb230e1d1",
 InitializationCell->True],
Cell[268066, 6790, 5933, 134, 318, "Input", "ExpressionUUID" -> \
"f27c0806-44c8-4464-b0d2-a88d10511f5f",
 InitializationCell->True],
Cell[274002, 6926, 5909, 147, 312, "Input", "ExpressionUUID" -> \
"c425fa16-7c4c-4b1a-9518-e12d06108ade",
 InitializationCell->True],
Cell[279914, 7075, 239, 5, 39, "Input", "ExpressionUUID" -> \
"ac9f3770-1314-42c3-882c-559c34770367",
 InitializationCell->True],
Cell[280156, 7082, 1105, 25, 108, "Input", "ExpressionUUID" -> \
"32569ad9-9663-4ac7-ba10-f6c9fe89e2c9",
 InitializationCell->True],
Cell[281264, 7109, 694, 20, 39, "Input", "ExpressionUUID" -> \
"517f753c-719a-4a2b-97fc-c90cf08a2747",
 InitializationCell->True],
Cell[281961, 7131, 254, 6, 39, "Input", "ExpressionUUID" -> \
"1ae5da5e-26c7-4245-9fe6-f88229227cdd",
 InitializationCell->True],
Cell[282218, 7139, 6183, 148, 295, "Input", "ExpressionUUID" -> \
"1e030ef5-c4b4-4aa9-9e74-421cb07d5544",
 InitializationCell->True],
Cell[288404, 7289, 3425, 79, 244, "Input", "ExpressionUUID" -> \
"a3ef42cf-3a19-4090-be0b-d7e7c5024042",
 InitializationCell->True],
Cell[291832, 7370, 2213, 58, 125, "Input", "ExpressionUUID" -> \
"b996c825-c9e2-49eb-9f9a-76c129a7695b",
 InitializationCell->True],
Cell[294048, 7430, 559, 16, 39, "Input", "ExpressionUUID" -> \
"0d525527-6d1c-4843-a456-f81d90599f0b",
 InitializationCell->True],
Cell[294610, 7448, 628, 19, 46, "Input", "ExpressionUUID" -> \
"dead9e73-8f64-4055-9b2b-d4653cb9a3e0",
 InitializationCell->True],
Cell[295241, 7469, 646, 18, 39, "Input", "ExpressionUUID" -> \
"0f729fe5-0ac0-43a3-9d6f-d0d006562600",
 InitializationCell->True],
Cell[295890, 7489, 1239, 35, 50, "Input", "ExpressionUUID" -> \
"0e6b574e-7bcf-4c40-b8fb-a9ca3858d81c",
 InitializationCell->True],
Cell[297132, 7526, 3068, 75, 142, "Input", "ExpressionUUID" -> \
"84860e52-1885-48da-aae2-960e70e370f8",
 InitializationCell->True],
Cell[300203, 7603, 1158, 23, 125, "Text", "ExpressionUUID" -> \
"ab7434bd-ddcf-43cb-aadf-a5025a98d5a8",
 InitializationCell->True],
Cell[301364, 7628, 7045, 170, 261, "Input", "ExpressionUUID" -> \
"c023a3b6-b39a-4269-af98-29fddd00d1ca",
 InitializationCell->True],
Cell[308412, 7800, 690, 20, 57, "Input", "ExpressionUUID" -> \
"33f257d4-2244-4ed7-a407-59ac9ae0e288",
 InitializationCell->True],
Cell[309105, 7822, 954, 28, 46, "Input", "ExpressionUUID" -> \
"719d95c4-00fd-4689-b239-d7c9c651d659",
 InitializationCell->True],
Cell[310062, 7852, 835, 22, 74, "Input", "ExpressionUUID" -> \
"071b1e87-cb40-4acd-b32b-a8dc8b5496e5",
 InitializationCell->True],
Cell[310900, 7876, 2629, 67, 125, "Input", "ExpressionUUID" -> \
"78683012-fb7e-4bca-b327-61d01107ed69",
 InitializationCell->True],
Cell[313532, 7945, 6430, 157, 278, "Input", "ExpressionUUID" -> \
"3d584a88-7a64-4ea5-9553-6343681c3dcf",
 InitializationCell->True],
Cell[319965, 8104, 1140, 30, 91, "Input", "ExpressionUUID" -> \
"3111622e-ad63-4904-95c9-f48702f400a8",
 InitializationCell->True],
Cell[321108, 8136, 2730, 67, 108, "Input", "ExpressionUUID" -> \
"72e3eb89-ea97-4b6e-a55b-ee611ccfebe6",
 InitializationCell->True],
Cell[323841, 8205, 445, 11, 39, "Input", "ExpressionUUID" -> \
"14d43de3-3994-49fb-9bc2-80704dd69e14",
 InitializationCell->True],
Cell[324289, 8218, 921, 25, 57, "Input", "ExpressionUUID" -> \
"a69d091a-dc67-4819-b908-34b65b9e92f0",
 InitializationCell->True],
Cell[325213, 8245, 9886, 211, 510, "Input", "ExpressionUUID" -> \
"c669eacb-f5fa-49d0-b965-59a3687bd001",
 InitializationCell->True],
Cell[335102, 8458, 4702, 111, 464, "Input", "ExpressionUUID" -> \
"a5ecb5f7-87dc-4212-9d6f-5e3c0428d35b",
 InitializationCell->True],
Cell[339807, 8571, 3994, 89, 244, "Input", "ExpressionUUID" -> \
"8140dd22-363f-43ba-8097-99e4b7053367",
 InitializationCell->True],
Cell[343804, 8662, 2859, 74, 159, "Input", "ExpressionUUID" -> \
"6feb6c48-c325-4439-b771-372ad80508d2",
 InitializationCell->True],
Cell[346666, 8738, 839, 19, 39, "Input", "ExpressionUUID" -> \
"267b8d1f-49d8-471a-8a64-13ec30ee062a",
 InitializationCell->True],
Cell[347508, 8759, 1280, 31, 57, "Input", "ExpressionUUID" -> \
"cdf23c4c-74a0-42d2-ad82-855aff8088ac",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[348825, 8795, 222, 4, 64, "Section", "ExpressionUUID" -> \
"a3a92891-3319-411f-98d5-23d21784c662"],
Cell[349050, 8801, 16957, 385, 890, "Input", "ExpressionUUID" -> \
"70f9b835-0f41-442d-a1b4-647fb85c0436",
 InitializationCell->True],
Cell[366010, 9188, 391, 10, 57, "Input", "ExpressionUUID" -> \
"37145589-7d0e-4487-a50d-84bc34009e96",
 InitializationCell->True],
Cell[366404, 9200, 871, 24, 57, "Input", "ExpressionUUID" -> \
"b9f3d1b3-83d5-4968-bf3b-bd837c944b51",
 InitializationCell->True],
Cell[367278, 9226, 14896, 368, 961, "Input", "ExpressionUUID" -> \
"a53bdd7c-0bd8-40c7-8673-32ee18b7ed1a",
 InitializationCell->True],
Cell[382177, 9596, 1130, 30, 142, "Input", "ExpressionUUID" -> \
"9c2892ac-37e4-4878-9bd6-228ca0856c49",
 InitializationCell->True],
Cell[383310, 9628, 6149, 137, 347, "Input", "ExpressionUUID" -> \
"1c63828e-2080-4074-894d-1caa997f89ce",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[389496, 9770, 157, 3, 64, "Section", "ExpressionUUID" -> \
"6a9942e2-d5b5-4292-9029-16691b2c97ee"],
Cell[389656, 9775, 2608, 60, 92, "Input", "ExpressionUUID" -> \
"f38b487a-70e9-4498-8075-361f8f9ee919",
 InitializationCell->True],
Cell[392267, 9837, 618, 17, 39, "Input", "ExpressionUUID" -> \
"4d1d14bc-78f1-4645-a9a7-347cfdf98904",
 InitializationCell->True],
Cell[392888, 9856, 7593, 193, 618, "Input", "ExpressionUUID" -> \
"6d4e43c8-3781-4c21-833d-ce11d0a82e7b",
 InitializationCell->True],
Cell[400484, 10051, 224, 6, 39, "Input", "ExpressionUUID" -> \
"07725e51-cc34-4c0b-a556-848bf1405f89",
 InitializationCell->True],
Cell[400711, 10059, 231, 6, 39, "Input", "ExpressionUUID" -> \
"8d8ec492-17f9-468e-ae36-ad1d14be8038",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

