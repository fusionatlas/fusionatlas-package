(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30274,        801]
NotebookOptionsPosition[     27780,        711]
NotebookOutlinePosition[     28170,        728]
CellTagsIndexPosition[     28127,        725]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Enumerator2014 package", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.420291647194886*^9, 3.420291647915923*^9}, {
  3.422317712155013*^9, 3.4223177168517666`*^9}, {3.4327775537006736`*^9, 
  3.4327775569353247`*^9}, {3.447362169800737*^9, 3.4473621701584797`*^9}, {
  3.62914181790036*^9, 3.629141821234551*^9}, {3.629142101447197*^9, 
  3.629142106581141*^9}}],

Cell["\<\
A subpackage for FusionAtlas v0.
January 2 2015, Scott Morrison and David Penneys\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291651250718*^9, 3.4202916677744784`*^9}, {
  3.432777559849515*^9, 3.432777570454765*^9}, {3.447362173061289*^9, 
  3.44736217826915*^9}, {3.62914182309914*^9, 3.6291418341933613`*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 InitializationCell->True],

Cell["---text goes here---", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.420291674724472*^9, 3.420291680042118*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.629142254973199*^9, 3.629142254974373*^9}}],

Cell[CellGroupData[{

Cell["Start of package", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.420295317242155*^9, 3.4202953180032496`*^9}}],

Cell["Specify package dependencies:", "Text",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`Enumerator2014`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`Debugging`\>\"", ",", 
      "\"\<FusionAtlas`RemoteInterface`\>\"", ",", 
      "\"\<FusionAtlas`Java`\>\"", ",", "\"\<JLink`\>\""}], "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4202916841079645`*^9, 3.420291695754712*^9}, {
  3.420293246855085*^9, 3.420293279181568*^9}, {3.4223177805233216`*^9, 
  3.422317795274533*^9}, {3.422318235116995*^9, 3.4223182432486877`*^9}, {
  3.432777576673707*^9, 3.4327775869484816`*^9}, {3.4327796677505283`*^9, 
  3.432779670003768*^9}, {3.434561456512453*^9, 3.434561465345154*^9}, {
  3.441994559392016*^9, 3.441994566564913*^9}, {3.6291406512241707`*^9, 
  3.629140653980494*^9}, {3.629140727883437*^9, 3.629140728811976*^9}, {
  3.6291420738596573`*^9, 3.629142076889803*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage messages", "Subsection",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DescendantsTree", "::", "usage"}], "=", 
  "\"\<DescendantsTree[G, L, k, D, R, ignoring] tries to enumerate all \
principal graphs starting as G, subject to limits described by L, k, D, R. \
\\n\\nAny branches of the tree starting as a graph in ignoring are pruned \
off. \\n\\nThe parameter L is the maximum allowed index. Of the parameters k, \
D, R, any tail sequence may be omitted, corresponding to no restrictions on \
those parameters. The parameter k, if specified, limits the maximum \
supertransitivity. The parameter D, if specified, limits the maximum graph \
depth. The parameter R, if specified, limits the maximum rank.\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.629141037686935*^9, 3.629141256357873*^9}}],

Cell[BoxData["\<\"DescendantsTree[G, L, k, D, R, ignoring] tries to enumerate \
all principal graphs starting as G, subject to limits described by L, k, D, \
R. \\n\\nAny branches of the tree starting as a graph in ignoring are pruned \
off. \\n\\nThe parameter L is the maximum allowed index. Of the parameters k, \
D, R, any tail sequence may be omitted, corresponding to no restrictions on \
those parameters. The parameter k, if specified, limits the maximum \
supertransitivity. The parameter D, if specified, limits the maximum graph \
depth. The parameter R, if specified, limits the maximum rank.\"\>"], "Output",\

 CellChangeTimes->{3.629142625678452*^9, 3.629142694245323*^9, 
  3.629143300166032*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGraphPartners2", "::", "usage"}], "=", 
  "\"\<FindGraphPartners[g], where g is a GradedBigraph, returns a list of \
possible pairs of BigraphWithDuals, where g is the underlying GradedBigraph \
of one element of the pair.\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291418609051647`*^9, 3.629141908073636*^9}, 
   3.62914197701224*^9}],

Cell[BoxData["\<\"FindGraphPartners[g], where g is a GradedBigraph, returns a \
list of possible pairs of BigraphWithDuals, where g is the underlying \
GradedBigraph of one element of the pair.\"\>"], "Output",
 CellChangeTimes->{3.629142625694191*^9, 3.629142694260696*^9, 
  3.629143300187131*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internals", "Subsection",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "LoadJavaClass", "[", 
   "\"\<net.tqft.toolkit.algebra.principalgraphs.BigraphWithDuals$\>\"", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "LoadJavaClass", "[", 
   "\"\<net.tqft.toolkit.algebra.principalgraphs.PairOfBigraphsWithDuals$\>\"\
", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "LoadJavaClass", "[", 
   "\"\<net.tqft.toolkit.algebra.principalgraphs.SubfactorWeed$\>\"", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616791906985394*^9, 3.616791942310511*^9}, {
   3.617064113990758*^9, 3.617064128377297*^9}, 3.617064168587717*^9, {
   3.61706440015351*^9, 3.617064403705556*^9}, {3.617064876877872*^9, 
   3.617064878292521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubfactorWeed", "[", "a___", "]"}], ":=", 
  RowBox[{
  "net`tqft`toolkit`algebra`principalgraphs`SubfactorWeed$`MODULE$", "[", 
   RowBox[{"apply", "[", "a", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6170641780356827`*^9, 3.617064212462038*^9}, {
  3.6170643403863077`*^9, 3.617064348929392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AsScalaObject", "[", 
   RowBox[{"S_String", "/;", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"S", ",", "3"}], "]"}], "\[Equal]", "\"\<bwd\>\""}]}], "]"}], ":=", 
  RowBox[{
  "net`tqft`toolkit`algebra`principalgraphs`BigraphWithDuals$`MODULE$", "[", 
   RowBox[{"apply", "[", "S", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61706437082176*^9, 3.617064389686928*^9}, {
  3.6199929739706984`*^9, 3.619992988555241*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AsScalaObject", "[", "G_BigraphWithDuals", "]"}], ":=", 
  RowBox[{
  "net`tqft`toolkit`algebra`principalgraphs`BigraphWithDuals$`MODULE$", "[", 
   RowBox[{"apply", "[", 
    RowBox[{"GraphToString", "[", "G", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6199930539008703`*^9, 3.619993077587721*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AsScalaObject", "[", 
   RowBox[{"{", 
    RowBox[{"X_BigraphWithDuals", ",", "Y_BigraphWithDuals"}], "}"}], "]"}], ":=", 
  RowBox[{"AsScalaObject", "[", 
   RowBox[{"AsScalaObject", "/@", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AsScalaObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X_String", ",", "Y_String"}], "}"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"X", ",", "3"}], "]"}], "\[Equal]", "\"\<bwd\>\""}], "\[And]", 
     
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"Y", ",", "3"}], "]"}], "\[Equal]", "\"\<bwd\>\""}]}]}], "]"}],
   ":=", 
  RowBox[{"AsScalaObject", "[", 
   RowBox[{"AsScalaObject", "/@", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AsScalaObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X_", "?", "JavaObjectQ"}], ",", 
      RowBox[{"Y_", "?", "JavaObjectQ"}]}], "}"}], "/;", 
    RowBox[{
     RowBox[{"InstanceOf", "[", 
      RowBox[{
      "X", ",", 
       "\"\<net.tqft.toolkit.algebra.principalgraphs.BigraphWithDuals\>\""}], 
      "]"}], "\[And]", 
     RowBox[{"InstanceOf", "[", 
      RowBox[{
      "Y", ",", 
       "\"\<net.tqft.toolkit.algebra.principalgraphs.BigraphWithDuals\>\""}], 
      "]"}]}]}], "]"}], ":=", 
  RowBox[{
  "net`tqft`toolkit`algebra`principalgraphs`PairOfBigraphsWithDuals$`MODULE$",
    "[", 
   RowBox[{"apply", "[", 
    RowBox[{"X", ",", "Y"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.617064417106151*^9, 3.617064462486277*^9}, {
  3.619987132506682*^9, 3.619987141307817*^9}, {3.61999288252971*^9, 
  3.619992912286875*^9}, {3.619992996318451*^9, 3.61999304720286*^9}, {
  3.619993084941771*^9, 3.619993127591501*^9}, {3.6199931663906193`*^9, 
  3.619993206691678*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "RemoveDuplicates", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveDuplicates", "[", "graphs_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"AsScalaObject", "[", "#", "]"}], "@", 
             RowBox[{
              RowBox[{"canonicalNautyGraph", "[", "]"}], "@", 
              RowBox[{"toString", "[", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"AsScalaObject", "[", 
              RowBox[{"Reverse", "[", "#", "]"}], "]"}], "@", 
             RowBox[{
              RowBox[{"canonicalNautyGraph", "[", "]"}], "@", 
              RowBox[{"toString", "[", "]"}]}]}]}], "}"}], "]"}], ",", "#"}], 
        "}"}], "&"}], "/@", "graphs"}], ",", 
     RowBox[{"SameTest", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "===", 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}], ")"}]}]}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.619987090788329*^9, 3.61998711414048*^9}, {
   3.619987180590897*^9, 3.6199872928835497`*^9}, {3.61999279937945*^9, 
   3.619992829188785*^9}, 3.619992868353816*^9, {3.619993211705741*^9, 
   3.619993217107403*^9}, {3.619993282647976*^9, 3.6199932863404617`*^9}, {
   3.623100928081767*^9, 3.6231009287482357`*^9}, {3.6231012378004217`*^9, 
   3.6231012407010517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unpackWeed", "[", "weed_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"weed", "@", 
     RowBox[{
      RowBox[{"pair", "[", "]"}], "@", 
      RowBox[{
       RowBox[{"graph", "[", "0", "]"}], "@", 
       RowBox[{"toString", "[", "]"}]}]}]}], ",", 
    RowBox[{"weed", "@", 
     RowBox[{
      RowBox[{"pair", "[", "]"}], "@", 
      RowBox[{
       RowBox[{"graph", "[", "1", "]"}], "@", 
       RowBox[{"toString", "[", "]"}]}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.617065056032879*^9, 3.617065071770948*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DescendantsTree", "::", "usage"}], "=", 
  "\"\<DescendantsTree[G, L, k, D, R, ignoring] tries to enumerate all \
principal graphs starting as G, subject to limits described by L, k, D, R. \
\\n\\nAny branches of the tree starting as a graph in ignoring are pruned \
off. \\n\\nThe parameter L is the maximum allowed index. Of the parameters k, \
D, R, any tail sequence may be omitted, corresponding to no restrictions on \
those parameters. The parameter k, if specified, limits the maximum \
supertransitivity. The parameter D, if specified, limits the maximum graph \
depth. The parameter R, if specified, limits the maximum rank.\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.629141037686935*^9, 3.629141256357873*^9}}],

Cell[BoxData["\<\"DescendantsTree[G, L, k, D, R, ignoring] tries to enumerate \
all principal graphs starting as G, subject to limits described by L, k, D, \
R. \\n\\nAny branches of the tree starting as a graph in ignoring are pruned \
off. \\n\\nThe parameter L is the maximum allowed index. Of the parameters k, \
D, R, any tail sequence may be omitted, corresponding to no restrictions on \
those parameters. The parameter k, if specified, limits the maximum \
supertransitivity. The parameter D, if specified, limits the maximum graph \
depth. The parameter R, if specified, limits the maximum rank.\"\>"], "Output",\

 CellChangeTimes->{3.629142625768188*^9, 3.629142694367839*^9, 
  3.6291433002843943`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "DescendantsTree", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DescendantsTree", "[", 
   RowBox[{"G_", ",", "L_", ",", 
    RowBox[{"k", ":", "_Integer", ":", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], ",", 
    RowBox[{"D", ":", "_Integer", ":", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], ",", 
    RowBox[{"R", ":", "_Integer", ":", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], ",", 
    RowBox[{"ignoring", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}], ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DescendantsTree", "[", 
     RowBox[{"G", ",", "L", ",", "k", ",", "D", ",", "R", ",", "ignoring"}], 
     "]"}], "="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ignoring0", ",", "ignoringArray", ",", "partClass", ",", "i", ",", 
      "nextGraphFromIterator", ",", "extractTree", ",", "vines", ",", 
      "cylinders", ",", "result", ",", "cell1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cell1", "=", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{
       "\"\<Running DescendantsTree[\>\"", ",", "G", ",", "\"\<, ...]\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nextGraphFromIterator", "[", "w_", "]"}], ":=", 
      RowBox[{"JavaBlock", "[", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"g", "=", 
            RowBox[{"w", "@", 
             RowBox[{"next", "[", "]"}]}]}], ",", "h"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"h", "=", 
           RowBox[{"unpackWeed", "[", 
            RowBox[{"g", "@", 
             RowBox[{"U1", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"g", "@", 
             RowBox[{
              RowBox[{"U1", "[", "]"}], "@", 
              RowBox[{
               RowBox[{"pair", "[", "]"}], "@", 
               RowBox[{"persistentlyCylindricalU$qmark", "[", "]"}]}]}]}], 
            ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"cylinders", ",", "h"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FullOcneanuTest", "[", "h", "]"}], "\[And]", 
             RowBox[{"ScalaTriplePointObstruction", "[", 
              RowBox[{"GraphFromString", "/@", "h"}], "]"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"vines", ",", "h"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"h", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"unpackWeed", "/@", 
             RowBox[{
              RowBox[{"scala`collection`JavaConversions`seqAsJavaList", "[", 
               RowBox[{"g", "@", 
                RowBox[{"U2", "[", "]"}]}], "]"}], "@", 
              RowBox[{"toArray", "[", "]"}]}]}], ")"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extractTree", "[", "w_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"counter", "=", "0"}], ",", "cell0", ",", "graph", ",", 
          "result2", ",", "H"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cell0", "=", 
          RowBox[{"PrintTemporary", "[", 
           RowBox[{"Dynamic", "[", 
            RowBox[{"\"\<Found \>\"", "<>", 
             RowBox[{"ToString", "[", "counter", "]"}], "<>", 
             "\"\< graphs...\>\""}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cylinders", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vines", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"result2", "=", 
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"w", "@", 
               RowBox[{"hasNext", "[", "]"}]}], ",", 
              RowBox[{
               RowBox[{"counter", "++"}], ";", 
               RowBox[{"H", "=", 
                RowBox[{"nextGraphFromIterator", "[", "w", "]"}]}], ";", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"lastGraph", "=", 
                  RowBox[{
                  "H", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ";"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Sow", "[", "H", "]"}]}]}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"NotebookDelete", "[", "cell0", "]"}], ";", 
         "\[IndentingNewLine]", "result2"}]}], "\[IndentingNewLine]", "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ignoring0", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"ignoring", ",", 
        RowBox[{"Reverse", "/@", "ignoring"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "LoadJavaClass", "[", "\"\<com.wolfram.jlink.JLinkClassLoader\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"partClass", "=", 
      RowBox[{
      "JLinkClassLoader`classFromName", "[", 
       "\"\<net.tqft.toolkit.algebra.principalgraphs.PairOfBigraphsWithDuals\>\
\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"LoadJavaClass", "[", "\"\<java.lang.reflect.Array\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ignoringArray", "=", 
      RowBox[{"ReturnAsJavaObject", "@", 
       RowBox[{"Array`newInstance", "[", 
        RowBox[{"partClass", ",", 
         RowBox[{"Length", "[", "ignoring0", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "[", "ignoring0", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Array`set", "[", 
        RowBox[{"ignoringArray", ",", "i", ",", 
         RowBox[{"AsScalaObject", "[", 
          RowBox[{"GraphToString", "/@", 
           RowBox[{"ignoring0", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"extractTree", "[", 
         RowBox[{
          RowBox[{"SubfactorWeed", "[", 
           RowBox[{"L", ",", 
            RowBox[{"AsScalaObject", "[", "G", "]"}]}], "]"}], "@", 
          RowBox[{"descendantsTreeFiltered", "[", 
           RowBox[{"k", ",", "D", ",", "R", ",", 
            RowBox[{
             RowBox[{"scala`collection`JavaConversions`asScalaBuffer", "[", 
              RowBox[{"java`util`Arrays`asList", "[", "ignoringArray", "]"}], 
              "]"}], "@", 
             RowBox[{"toList", "[", "]"}]}], ",", "True"}], "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", "vines", ",", "\[IndentingNewLine]", 
        "cylinders"}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookDelete", "[", "cell1", "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6173937478581877`*^9, 3.617393787896512*^9}, {
   3.6173938192762413`*^9, 3.617393827791624*^9}, {3.617394065598168*^9, 
   3.61739406927214*^9}, {3.617568075434464*^9, 3.617568189948929*^9}, {
   3.6175682364500227`*^9, 3.617568239312907*^9}, {3.617568283278596*^9, 
   3.617568285336116*^9}, {3.617579578496318*^9, 3.617579604838621*^9}, {
   3.617581965072912*^9, 3.6175819660964613`*^9}, 3.6175819992047586`*^9, {
   3.6176086405089607`*^9, 3.617608796903289*^9}, 3.6176088311682587`*^9, {
   3.617608922838066*^9, 3.617608956631117*^9}, {3.619129683197003*^9, 
   3.619129684041418*^9}, {3.619817832610096*^9, 3.619817842433051*^9}, {
   3.619993259361679*^9, 3.619993270264575*^9}, {3.623092240579113*^9, 
   3.6230922454499083`*^9}, {3.623092324650722*^9, 3.623092337643141*^9}, {
   3.623092681787703*^9, 3.6230926880274677`*^9}, {3.623096085928342*^9, 
   3.623096095847165*^9}, {3.6291408101598473`*^9, 3.629140843384012*^9}, {
   3.6291408794267893`*^9, 3.629140891203903*^9}, {3.629140927411634*^9, 
   3.629140978155347*^9}, {3.629141009221279*^9, 3.629141026615286*^9}, {
   3.629142357346032*^9, 3.62914236864111*^9}, {3.6291424836713047`*^9, 
   3.629142527172185*^9}, {3.629142557897331*^9, 3.629142599528792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"double", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"G", "=", 
      RowBox[{"BigraphWithDuals", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DualData", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"RankAtDepth", "[", 
             RowBox[{"g", ",", "d"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", "0", ",", 
             RowBox[{"GraphDepth", "[", "g", "]"}], ",", "2"}], "}"}]}], 
          "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"G", ",", "G"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.629143072870656*^9, 3.629143126781556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"isomorphicQ", "[", 
   RowBox[{"g_GradedBigraph", ",", "h_GradedBigraph"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"RemoveDuplicates", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"double", "[", "g", "]"}], ",", 
       RowBox[{"double", "[", "h", "]"}]}], "}"}], "]"}], "]"}], "\[Equal]", 
   "1"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.629143225516217*^9, 3.6291432468821583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGraphPartners2", "[", "g_GradedBigraph", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"gs", ",", "\[IndentingNewLine]", 
      RowBox[{"D", "=", "2"}], ",", "\[IndentingNewLine]", 
      RowBox[{"graphs", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<bwd1vduals1v\>\"", ",", "\"\<bwd1vduals1v\>\""}], "}"}],
         "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"DimensionOfGenerator", "[", "g", "]"}], "2"], "+", 
        "0.0001"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"D", "\[LessEqual]", 
        RowBox[{"GraphDepth", "[", "g", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gs", "=", 
         RowBox[{"Truncate", "[", 
          RowBox[{"g", ",", "D"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "G", "}"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "G", "]"}], ";"}], "*)"}], 
            RowBox[{"DescendantsTree", "[", 
             RowBox[{"G", ",", "L", ",", 
              RowBox[{"DepthOfBranchPoint", "[", "g", "]"}], ",", "D"}], 
             "]"}]}], "]"}], "/@", "graphs"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"graphs", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"graphs", ",", 
            RowBox[{
             RowBox[{"h", ":", 
              RowBox[{"{", 
               RowBox[{"h1_String", ",", "h2_String"}], "}"}]}], "/;", 
             RowBox[{
              RowBox[{
               RowBox[{"GraphDepth", "[", "h", "]"}], "\[Equal]", "D"}], 
              "\[And]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"isomorphicQ", "[", 
                 RowBox[{"gs", ",", 
                  RowBox[{
                   RowBox[{"GraphFromString", "[", "h1", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 "]"}], "||", 
                RowBox[{"isomorphicQ", "[", 
                 RowBox[{"gs", ",", 
                  RowBox[{
                   RowBox[{"GraphFromString", "[", "h2", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 "]"}]}], ")"}]}]}], ",", "\[Infinity]"}], 
           "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"D", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cases", "[", 
      RowBox[{"graphs", ",", 
       RowBox[{"h_", "/;", 
        RowBox[{"FullOcneanuTest", "@@", "h"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.62914048777805*^9, 3.629140493655756*^9}, {
   3.629141328720213*^9, 3.629141526914358*^9}, {3.629141566629175*^9, 
   3.629141778840683*^9}, {3.6291419802937527`*^9, 3.629141981356698*^9}, {
   3.6291426175959177`*^9, 3.629142620574977*^9}, {3.6291426913135567`*^9, 
   3.629142724641264*^9}, 3.629142775770891*^9, {3.629143176391877*^9, 
   3.6291432875956087`*^9}, {3.629143373005147*^9, 3.629143378218235*^9}, {
   3.629143417153864*^9, 3.629143417561479*^9}, {3.629143523091896*^9, 
   3.6291435247324667`*^9}, {3.629143583069805*^9, 3.6291435873992357`*^9}, {
   3.629143805227015*^9, 3.629143805499691*^9}, {3.6294910674926643`*^9, 
   3.62949108567556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291412978622007`*^9, 3.629141300184711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6291413009800043`*^9, 3.629141302389662*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1221, 778},
WindowMargins->{{Automatic, 52}, {Automatic, 25}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 384, 6, 51, "Subtitle",
 InitializationCell->True],
Cell[967, 30, 344, 7, 49, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1336, 41, 58, 1, 80, "Section",
 InitializationCell->True],
Cell[1397, 44, 129, 2, 30, "Text",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1563, 51, 60, 1, 80, "Section",
 InitializationCell->True],
Cell[1626, 54, 247, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[1898, 64, 133, 2, 44, "Subsection",
 InitializationCell->True],
Cell[2034, 68, 72, 1, 30, "Text",
 InitializationCell->True],
Cell[2109, 71, 1045, 20, 46, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3191, 96, 63, 1, 44, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3279, 101, 782, 13, 114, "Input",
 InitializationCell->True],
Cell[4064, 116, 712, 10, 148, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4813, 131, 399, 8, 63, "Input",
 InitializationCell->True],
Cell[5215, 141, 299, 4, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5563, 151, 58, 1, 44, "Subsection",
 InitializationCell->True],
Cell[5624, 154, 119, 3, 28, "Input",
 InitializationCell->True],
Cell[5746, 159, 732, 20, 63, "Input",
 InitializationCell->True],
Cell[6481, 181, 365, 8, 28, "Input",
 InitializationCell->True],
Cell[6849, 191, 503, 12, 28, "Input",
 InitializationCell->True],
Cell[7355, 205, 373, 8, 28, "Input",
 InitializationCell->True],
Cell[7731, 215, 1954, 55, 114, "Input",
 InitializationCell->True],
Cell[9688, 272, 1737, 42, 80, "Input",
 InitializationCell->True],
Cell[11428, 316, 597, 18, 28, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[12050, 338, 782, 13, 114, "Input",
 InitializationCell->True],
Cell[12835, 353, 714, 10, 148, "Output"]
}, Open  ]],
Cell[13564, 366, 8853, 203, 641, "Input",
 InitializationCell->True],
Cell[22420, 571, 821, 22, 46, "Input",
 InitializationCell->True],
Cell[23244, 595, 477, 13, 28, "Input",
 InitializationCell->True],
Cell[23724, 610, 3675, 84, 317, "Input",
 InitializationCell->True],
Cell[27402, 696, 164, 4, 28, "Input",
 InitializationCell->True],
Cell[27569, 702, 171, 4, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
