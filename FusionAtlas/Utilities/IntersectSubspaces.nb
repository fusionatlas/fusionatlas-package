(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[      5656,        192]
NotebookOptionsPosition[      4599,        152]
NotebookOutlinePosition[      4991,        169]
CellTagsIndexPosition[      4948,        166]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
A simple implementation of intersecting subspaces specified by a basis\
\>", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", 
  "\"\<FusionAtlas`Utilities`IntersectSubspaces`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.483185550277555*^9, 3.4831855516492767`*^9}}],

Cell[BoxData["\<\"FusionAtlas`Utilities`IntersectSubspaces`\"\>"], "Output",
 CellChangeTimes->{{3.483185592765564*^9, 3.4831855933782988`*^9}, 
   3.48318620576267*^9, {3.633042253903388*^9, 3.633042254053054*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntersectSubspaces", "::", "usage"}], "=", 
   "\"\<IntersectSubspaces[n,\!\(\*SubscriptBox[\(\[Beta]\), \
\(1\)]\),\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\),...] gives a basis for the \
intersection of the subspaces of \!\(\*SuperscriptBox[\(A\), \(\(n\)\(\\\ \
\)\)]\)spanned by the \!\(\*SubscriptBox[\(\[Beta]\), \(i\)]\).\>\""}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"IdentityMatrix", "[", "n", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", "basis_", "}"}]}], "]"}], ":=", "basis"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"_", ",", 
      RowBox[{"{", "}"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"basis1_", ",", "basis2_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<intersecting: \>\"", "]"}], ";", 
      RowBox[{"Print", "[", "basis1", "]"}], ";", 
      RowBox[{"Print", "[", "basis2", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"NullSpace", "/@", 
         RowBox[{"{", 
          RowBox[{"basis1", ",", "basis2"}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "V", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"NullSpace", "[", "V", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4831861361256332`*^9, 3.483186202852621*^9}, {
  3.633042239317059*^9, 3.633042251796702*^9}, {3.6330426823071423`*^9, 
  3.633042692585383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"basis1_", ",", "basis2_", ",", "bases__"}], "}"}]}], "]"}], ":=", 
  RowBox[{"IntersectSubspaces", "[", 
   RowBox[{"n", ",", 
    RowBox[{"{", 
     RowBox[{"basis1", ",", 
      RowBox[{"IntersectSubspaces", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", 
         RowBox[{"basis2", ",", "bases"}], "}"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{776, 789},
WindowMargins->{{Automatic, 303}, {Automatic, 21}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 103, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[695, 28, 211, 4, 28, "Input",
 InitializationCell->True],
Cell[909, 34, 215, 2, 28, "Output"]
}, Open  ]],
Cell[1139, 39, 427, 9, 64, "Input",
 InitializationCell->True],
Cell[1569, 50, 119, 3, 28, "Input",
 InitializationCell->True],
Cell[1691, 55, 208, 6, 28, "Input",
 InitializationCell->True],
Cell[1902, 63, 181, 5, 28, "Input",
 InitializationCell->True],
Cell[2086, 70, 452, 15, 46, "Input",
 InitializationCell->True],
Cell[2541, 87, 1334, 35, 165, "Input",
 InitializationCell->True],
Cell[3878, 124, 500, 15, 46, "Input",
 InitializationCell->True],
Cell[4381, 141, 96, 3, 28, "Input",
 InitializationCell->True],
Cell[4480, 146, 103, 3, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
