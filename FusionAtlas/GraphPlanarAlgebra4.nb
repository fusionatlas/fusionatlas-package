(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    411028,      10324]
NotebookOptionsPosition[    386943,       9755]
NotebookOutlinePosition[    387358,       9773]
CellTagsIndexPosition[    387315,       9770]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`GraphPlanarAlgebra4`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`PackageData`\>\"", ",", 
      "\"\<FusionAtlas`Debugging`\>\""}], "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411791124354661*^9, 3.411791125936936*^9}, {
   3.421197918237237*^9, 3.4211979460372114`*^9}, {3.432428044175173*^9, 
   3.432428050664504*^9}, {3.432608057742691*^9, 3.4326080604165363`*^9}, {
   3.4328634732132688`*^9, 3.432863479131779*^9}, {3.4328641929682255`*^9, 
   3.432864198966851*^9}, {3.4468456261699753`*^9, 3.446845633325498*^9}, {
   3.446847319782378*^9, 3.446847325859624*^9}, {3.446847404675356*^9, 
   3.4468474092485123`*^9}, {3.524158355512816*^9, 3.524158358938444*^9}, {
   3.543324971561059*^9, 3.543324980477037*^9}, 
   3.54332636949778*^9},ExpressionUUID->"fd63c85c-1b81-4fb9-8546-\
85e839d566fa"],

Cell[BoxData[{
 RowBox[{"NumberFieldGenerator", ";", "EnlargeNumberField", ";", 
  "RedefineLopsidedDimension", ";", "LopsidedDimension", ";", 
  "SphericalDimension", ";", "CriticalPointCoefficient", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GPA4Element", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LargeGPA4Element", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteLargeGPA4Element", ";"}], "\[IndentingNewLine]", 
 RowBox[{"EmptyGPA4Element", ";", "CapTopLeft", ";", "PartialTrace", ";", 
  "GPA4Trace", ";", "GPA4TraceEvaluation", ";", "TurnUpBottomRightCorner", 
  ";", "TurnDownTopRightCorner", ";", "TurnUpBottomLeftCorner", ";", 
  "TurnDownTopLeftCorner", ";", "RotateOneClick", ";", "RotateTwoClicks", ";",
   "GPAFourierTransform", ";", "GPAFourierTransformTwice", ";", 
  "AddStrandOnRight", ";", "AddStrandOnLeft", ";", "AddStrandsOnLeft", ";", 
  "GPAMultiply", ";", "GPAConjugate", ";", "GPACoefficients", ";", 
  "GPACoefficientsAtStar", ";", "VariableGPA4Element", ";", "GPA4Matrix", ";",
   "GPATensor", ";", "GPAInverse", ";", "Rotate\[Pi]Clockwise", ";", 
  "Rotate\[Pi]Counterclockwise", ";", "GPAMultiplyWithOffset", ";", 
  "PivotalStructure", ";", "ConnectionGrid", ";", "StrandCrossingAbove", ";", 
  "StrandCrossingBelow", ";", "TwoStrandFlatness", ";", "OneStrandFlatness", 
  ";", "FusionRulesFromConnection", ";", "LowestWeightEigenvectorConditions", 
  ";", "LowestWeightConditions", ";", "CollectGPA4Matrix", ";", 
  "CollectGPA4Element", ";", "LowestWeightEigenspace", ";", 
  "LowestWeightSpace", ";", "LoadLowestWeightEigenspaces", ";", 
  "ChangePivotalStructure", ";", "NumberFieldGauge", ";", 
  "FindEquationsForFlatGenerators", ";", "FindFlatGenerators", ";", 
  "FindFlatLowestWeightVectors", ";", "qInteger\[Delta]", ";", 
  "JonesWenzlIdempotent", ";", "LoadIdempotents", ";", "S2Equation", ";", 
  "RowReducedS2Equation", ";", "S2Solutions", ";", "IdentityTL", ";", 
  "OneCupTL", ";", "OneCupJonesWenzl", ";", "SomeOneCupJonesWenzl", ";", 
  "AnnularConsequences", ";", "GPACirc", ";", "GPAStar", ";", 
  "GaugeTransform", ";", " ", "GaugeAction", ";", " ", "VariableGaugeElement",
   ";", " ", "FindGaugeElementRelating", ";", "WenzlRecursion", 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433288905738363`*^9, 3.543328890822812*^9}, 
   3.543329878914299*^9, {3.555793352707879*^9, 3.555793352858045*^9}, {
   3.55622206560997*^9, 3.5562220978329573`*^9}, {3.556487231999084*^9, 
   3.5564872335582247`*^9}, {3.568348747913727*^9, 3.568348748488269*^9}, {
   3.569006177494961*^9, 3.569006179052012*^9}, {3.5690204951149473`*^9, 
   3.569020495469895*^9}, {3.713404102468542*^9, 3.7134041071874*^9}, {
   3.7219391962604427`*^9, 
   3.721939200650741*^9}},ExpressionUUID->"454c88e6-25a4-43ca-bf25-\
3df16372f672"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"progressiveRootReduce", "[", "x_GPA4Element", "]"}], ":=", " ", 
  RowBox[{"MapAt", "[", 
   RowBox[{"progressiveRootReduce", ",", "x", ",", 
    RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parallelRootReduce", "[", "x_GPA4Element", "]"}], ":=", " ", 
  RowBox[{"MapAt", "[", 
   RowBox[{"parallelRootReduce", ",", "x", ",", 
    RowBox[{"-", "1"}]}], "]"}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"4328e29b-8320-4ea9-81b2-faf2b36528cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2046164-4fc2-433c-873c-ecd2ab09f798"],

Cell[CellGroupData[{

Cell["Number fields", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526058761497238*^9, 
  3.526058762634798*^9}},ExpressionUUID->"b6e28ace-c0a9-424a-9cad-\
93463549e74e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumberFieldGenerator", "[", 
   RowBox[{"g", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"NumberFieldGenerator", "[", "g", "]"}], "=", 
   RowBox[{"RootReduce", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", "-", 
      SuperscriptBox[
       RowBox[{"ReducedDimensionOfGenerator", "[", 
        RowBox[{"g", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "2"]}], 
     "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445965366306158*^9, 3.445965400956201*^9}, {
  3.49503058040851*^9, 3.495030585155127*^9}, {3.498258800289007*^9, 
  3.498258800359996*^9}},ExpressionUUID->"342ba11b-aa79-4689-886f-\
10d4aa0f982a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToNumberField0", "[", 
   RowBox[{
    RowBox[{"x_", "?", "NumericQ"}], ",", 
    RowBox[{"y_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"ToNumberField", "[", 
    RowBox[{
     RowBox[{"RootReduce", "[", "x", "]"}], ",", "y"}], "]"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToNumberField0", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "x"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.481811346821521*^9, 3.48181138323132*^9}, {
   3.488680422568572*^9, 3.488680435006353*^9}, 3.488680596773786*^9, {
   3.4886806798697443`*^9, 3.488680683126719*^9}, {3.526068543406829*^9, 
   3.5260685515921583`*^9}, 3.5263057308256617`*^9, {3.552697444853833*^9, 
   3.5526974935934057`*^9}, {3.556223816758473*^9, 
   3.5562238181103*^9}},ExpressionUUID->"c5a7dbf9-2da0-43c9-ba77-\
9624c07840a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnlargeNumberField", "[", 
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}],
    "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"ToNumberField", "::", "\"\<nnfel\>\""}], "]"}], ";"}], "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"ToNumberField0", "[", 
        RowBox[{"x", ",", 
         RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "_ToNumberField", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NumberFieldGenerator", "[", "g", "]"}], "=", 
         RowBox[{
          RowBox[{"ToNumberField", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RootReduce", "[", "x", "]"}], ",", 
             RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "}"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<Enlarging number field for \>\"", ",", 
          RowBox[{"GraphToString", "[", "g", "]"}], ",", "\"\<: \>\"", ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "_", ",", "0"}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"On", "[", 
        RowBox[{"ToNumberField", "::", "\"\<nnfel\>\""}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RedefineLopsidedDimension", "[", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446909171476357*^9, 3.446909419044162*^9}, {
   3.446909604994635*^9, 3.44690962015508*^9}, {3.46913831521391*^9, 
   3.469138316497611*^9}, 3.4818114029629097`*^9, {3.483274958990704*^9, 
   3.483274961229281*^9}, 3.495030619451597*^9, {3.529846305860358*^9, 
   3.52984630786747*^9}},ExpressionUUID->"f5f2b95f-637e-48d2-a7d4-\
368d82a5936f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lopsided dimensions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965437139605*^9, 
  3.445965439155334*^9}},ExpressionUUID->"ae2e5282-d80a-429a-9cc2-\
d03aa98f8900"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RedefineLopsidedDimension", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "LopsidedDimension", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LopsidedDimension", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"Vertex", "[", 
        RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LopsidedDimension", "[", 
       RowBox[{"g", ",", 
        RowBox[{"Vertex", "[", 
         RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}], "=", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Delta]", "=", 
          RowBox[{"ReducedDimensionOfGenerator", "[", 
           RowBox[{"g", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ToNumberField0", "[", 
         RowBox[{
          RowBox[{"RootReduce", "[", 
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              FractionBox["1", "\[Delta]"], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", "1", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "\[Delta]"}], "]"}], 
            RowBox[{
             RowBox[{"ReducedDimensionsByDepth", "[", 
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "1"}], 
               "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"d", "+", "1"}], ",", "k"}], 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459049633267612`*^9, 3.445905128930409*^9}, {
   3.445958825594243*^9, 3.445958828084826*^9}, {3.445965384944689*^9, 
   3.445965427534886*^9}, {3.446845751126251*^9, 3.4468457520777893`*^9}, {
   3.446846233452298*^9, 3.446846234057397*^9}, 3.481811413376189*^9, {
   3.495030653705083*^9, 3.495030683096169*^9}, {3.495030807026062*^9, 
   3.495030839505031*^9}, {3.49504246928113*^9, 3.495042498630651*^9}, {
   3.4950440774990273`*^9, 3.4950440775686483`*^9}, {3.5284624322085733`*^9, 
   3.528462436208699*^9}, {3.529846261549897*^9, 
   3.529846292098892*^9}},ExpressionUUID->"ee311e44-3769-440d-a7b0-\
01395a5d140f"],

Cell[BoxData[
 RowBox[{"RedefineLopsidedDimension", "[", "]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ce6f90a1-71c3-4e35-befe-ae64b60c6a47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spherical dimensions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965437139605*^9, 3.445965439155334*^9}, {
  3.526058745507452*^9, 
  3.526058746183351*^9}},ExpressionUUID->"65f530f9-8b13-4299-b42f-\
6a05b199facb"],

Cell[BoxData[
 RowBox[{"Clear", "[", "SphericalDimension", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526068588959951*^9, 
  3.526068592472829*^9}},ExpressionUUID->"23d8a144-d687-496c-9eb4-\
5ef0b9db5d0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDimension", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"Vertex", "[", 
      RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SphericalDimension", "[", 
     RowBox[{"g", ",", 
      RowBox[{"Vertex", "[", 
       RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{"ReducedDimensionsByDepth", "[", 
      RowBox[{"g", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
      "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"d", "+", "1"}], ",", "k"}], "\[RightDoubleBracket]"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459049633267612`*^9, 3.445905128930409*^9}, {
   3.445958825594243*^9, 3.445958828084826*^9}, {3.445965384944689*^9, 
   3.445965427534886*^9}, {3.446845751126251*^9, 3.4468457520777893`*^9}, {
   3.446846233452298*^9, 3.446846234057397*^9}, 3.481811413376189*^9, {
   3.495030653705083*^9, 3.495030683096169*^9}, {3.495030807026062*^9, 
   3.495030839505031*^9}, {3.49504246928113*^9, 3.495042498630651*^9}, {
   3.4950440774990273`*^9, 3.4950440775686483`*^9}, {3.526058768750132*^9, 
   3.526058789292197*^9}, {3.526068792019594*^9, 3.52606879273617*^9}, {
   3.526069089700481*^9, 3.526069093381184*^9}, {3.5293428726721*^9, 
   3.529342876477837*^9}},ExpressionUUID->"3f921052-0994-4b75-907e-\
a992e61f7c38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Critical point coefficients", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526058797350629*^9, 
  3.5260588015089817`*^9}},ExpressionUUID->"ae8f8704-97ef-46f0-92b6-\
c8fee13c0960"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CriticalPointCoefficient", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "sign_", ",", "above_Vertex", ",", "below_Vertex", ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "pivotalStructure", ",", "\[IndentingNewLine]", "\"\<Spherical\>\"", ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox[
        RowBox[{"SphericalDimension", "[", 
         RowBox[{"G", ",", "above"}], "]"}]], ")"}], "sign"], 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox[
        RowBox[{"SphericalDimension", "[", 
         RowBox[{"G", ",", "below"}], "]"}]], ")"}], 
      RowBox[{"-", "sign"}]]}], ",", "\[IndentingNewLine]", 
    "\"\<Lopsided\>\"", ",", 
    SuperscriptBox[
     RowBox[{"LopsidedDimension", "[", 
      RowBox[{"G", ",", "above"}], "]"}], "sign"]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526058823919153*^9, 3.5260588676640177`*^9}, {
   3.526058948763986*^9, 3.526059032078527*^9}, {3.526059065742134*^9, 
   3.52605906688575*^9}, {3.5260592088898706`*^9, 3.526059214718814*^9}, 
   3.526068489465782*^9, {3.52630601812464*^9, 3.5263060234844723`*^9}, {
   3.526306054259829*^9, 3.5263060644277277`*^9}, {3.54549556297182*^9, 
   3.5454956035188217`*^9}, {3.5455128510266027`*^9, 
   3.545512861397243*^9}},ExpressionUUID->"aa2528cf-9f3d-4124-9059-\
e847ce84d489"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graph planar algebra", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965332045342*^9, 
  3.445965336385316*^9}},ExpressionUUID->"208d3b3a-8d52-4964-98b3-\
d94dfd1e3ec1"],

Cell[CellGroupData[{

Cell["Planar algebra operations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965270784976*^9, 
  3.445965274822*^9}},ExpressionUUID->"fc58ab81-2903-43ee-a396-8978a6fcc588"],

Cell["\<\
GPA4Element takes : a pair of bigraphs with duals, a loops in the square, a \
pair {a,b} meaning a strands going up and b going down, and rules assigning \
any length a+b loop to a number.  Length (a+b) loops are denoted as a \
sequence of vertices and integers (the integer specifies which edge between \
the vertices to use).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4830149685073757`*^9, 3.483015085977614*^9}, {
  3.483015233838101*^9, 3.4830152902026167`*^9}, {3.4830153960587797`*^9, 
  3.4830154022817707`*^9}, {3.4830158190388527`*^9, 3.4830158333885937`*^9}, {
  3.495031077898758*^9, 
  3.495031103175582*^9}},ExpressionUUID->"58bf1970-fe00-4983-8ca0-\
0268ac729c05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmptyGPA4Element", "[", 
   RowBox[{
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"over", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", "over", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[Rule]", "1"}], "&"}], "/@", 
     RowBox[{"GraphLoops", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", "over", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4461439443885117`*^9, 3.4461439709575043`*^9}, {
  3.4461441725921183`*^9, 3.446144196049198*^9}, {3.4950308725972033`*^9, 
  3.4950309344021263`*^9}, {3.4950310130492163`*^9, 3.49503106037296*^9}, {
  3.526306030734014*^9, 
  3.526306069900887*^9}},ExpressionUUID->"bed30cb1-1e7d-4a1d-a6eb-\
7d7975086ac1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"otherLoopsZero", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"RepeatedSequence", "[", 
     RowBox[{"_Vertex", ",", "_Integer", ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], "}"}], "\[Rule]", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"otherLoopsZero", "[", "0", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", "_Vertex", "}"}], "\[Rule]", "0"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541860181141281*^9, 3.54186020122589*^9}, {
  3.541860375588705*^9, 
  3.541860390967168*^9}},ExpressionUUID->"b49423aa-9c0d-4411-8e7f-\
0fc9cb532725"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CapTopLeft", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"up", "\[GreaterEqual]", "2"}], "\[And]", 
    RowBox[{
     RowBox[{"up", "+", "down"}], "\[GreaterEqual]", "4"}], "\[And]", 
    RowBox[{
     RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[Equal]", 
     RowBox[{
     "over", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", 
         RowBox[{"up", "-", "2"}]}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_Vertex", ",", "na_Integer", ",", "z___"}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CriticalPointCoefficient", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"-", "1"}], ",", "a", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "pivotalStructure"}], "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "a", ",", "na", ",", "z"}], "}"}], "/.", "dispatch"}],
                ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "a", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445903265653133*^9, 3.4459033110813103`*^9}, {
   3.445903362302124*^9, 3.445903492909018*^9}, {3.44590352846031*^9, 
   3.445903623786755*^9}, 3.4459036539650183`*^9, {3.44591647367689*^9, 
   3.445916521628215*^9}, {3.445916677253497*^9, 3.4459166800939007`*^9}, {
   3.445916821839405*^9, 3.445916884011223*^9}, {3.4459185855170403`*^9, 
   3.445918588201708*^9}, {3.446080982106256*^9, 3.44608098777116*^9}, 
   3.446141292557818*^9, {3.446150186443223*^9, 3.446150187809655*^9}, {
   3.446150413858005*^9, 3.446150426864484*^9}, {3.446150673406405*^9, 
   3.4461506739639797`*^9}, {3.4461524632276163`*^9, 3.446152480439479*^9}, {
   3.446652873659424*^9, 3.446652899872682*^9}, 3.4468462590781603`*^9, 
   3.446849880219652*^9, 3.4468504973789454`*^9, {3.49503129654599*^9, 
   3.495031339945117*^9}, {3.495033151653616*^9, 3.4950331554197063`*^9}, {
   3.495033193202145*^9, 3.4950332254653797`*^9}, {3.4950332648006144`*^9, 
   3.49503326777065*^9}, {3.526059256343039*^9, 3.526059277238276*^9}, {
   3.526059393616886*^9, 3.5260594104246387`*^9}, {3.526306244390209*^9, 
   3.526306255962858*^9}, {3.526306293534923*^9, 3.526306295457057*^9}, {
   3.535741764791861*^9, 3.535741775496634*^9}, {3.541860208738793*^9, 
   3.5418602228992968`*^9}, {3.5433460126018457`*^9, 3.54334601763929*^9}, {
   3.543456687737502*^9, 3.543456687814205*^9}, {3.543456769681231*^9, 
   3.543456794618382*^9}},ExpressionUUID->"3699af70-3ba7-46fe-917d-\
21a9937390c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CapTopLeft", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    "\[Equal]", 
    RowBox[{
    "over", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", "2", "]"}], "}"}]}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a_Vertex", "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CriticalPointCoefficient", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"-", "1"}], ",", "a", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "pivotalStructure"}], "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "a", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433459556509857`*^9, 3.5433459840962353`*^9}, 
   3.543346104987109*^9, 3.543456690480287*^9, 
   3.5434567722426643`*^9},ExpressionUUID->"24cc36f9-df11-41bf-923b-\
f1cb95d4ea63"],

Cell[BoxData[
 RowBox[{"Clear", "[", "PartialTrace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742927525217*^9, 
  3.5357429304333553`*^9}},ExpressionUUID->"8858adb9-c90c-4e32-9307-\
eaf322f499b9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Note", ";", " ", 
   RowBox[{"the", " ", "implementation", " ", "below", " ", 
    RowBox[{"doesn", "'"}], "t", " ", "seem", " ", "to", " ", "work", " ", 
    "when", " ", "one", " ", "of", " ", "up", " ", "and", " ", "down", " ", 
    "is", " ", "1"}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345908642655*^9, 
  3.543345925673417*^9}},ExpressionUUID->"389dea9c-69bd-4998-a0b5-\
55aad065a9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PartialTrace", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"up", ">", "1"}], "&&", 
      RowBox[{"down", ">", "1"}]}], ")"}], "\[And]", 
    RowBox[{
     RowBox[{"over", "\[LeftDoubleBracket]", "up", "\[RightDoubleBracket]"}], 
     "\[Equal]", 
     RowBox[{"over", "\[LeftDoubleBracket]", 
      RowBox[{"up", "+", "2"}], "\[RightDoubleBracket]"}]}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"up", "+", "1"}], ",", 
           RowBox[{"up", "+", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "-", "1"}], ",", 
         RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", ":", 
            RowBox[{"RepeatedSequence", "[", 
             RowBox[{"_Vertex", ",", "_Integer", ",", 
              RowBox[{"{", 
               RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "v_Vertex", 
           ",", "n_Integer", ",", "B___"}], "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", "1", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "pivotalStructure"}], "]"}], 
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", 
                  RowBox[{"-", "1"}], ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "pivotalStructure"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"A", ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "n", ",", "B"}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "v", ",", 
              RowBox[{"over", "\[LeftDoubleBracket]", 
               RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}],
            ")"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445903265653133*^9, 3.4459033110813103`*^9}, {
   3.445903362302124*^9, 3.445903492909018*^9}, {3.44590352846031*^9, 
   3.445903623786755*^9}, 3.4459036539650183`*^9, {3.44591647367689*^9, 
   3.445916521628215*^9}, {3.445916677253497*^9, 3.4459166800939007`*^9}, {
   3.445916821839405*^9, 3.445916884011223*^9}, {3.4459185855170403`*^9, 
   3.445918588201708*^9}, {3.446080982106256*^9, 3.44608098777116*^9}, 
   3.446141292557818*^9, {3.446150186443223*^9, 3.446150187809655*^9}, {
   3.446150413858005*^9, 3.446150426864484*^9}, {3.446150673406405*^9, 
   3.4461506739639797`*^9}, {3.4461524632276163`*^9, 3.446152480439479*^9}, {
   3.446652873659424*^9, 3.446652899872682*^9}, 3.4468462590781603`*^9, 
   3.446849880219652*^9, 3.4468504973789454`*^9, {3.49503129654599*^9, 
   3.495031339945117*^9}, {3.495033151653616*^9, 3.4950331554197063`*^9}, {
   3.495033193202145*^9, 3.4950332254653797`*^9}, {3.4950332648006144`*^9, 
   3.49503326777065*^9}, {3.526059256343039*^9, 3.526059277238276*^9}, {
   3.526059393616886*^9, 3.5260594104246387`*^9}, {3.526306244390209*^9, 
   3.526306255962858*^9}, {3.526306293534923*^9, 3.526306295457057*^9}, {
   3.535741466294259*^9, 3.535741467637107*^9}, {3.535741522969935*^9, 
   3.5357415282818127`*^9}, {3.53574159090385*^9, 3.535741628347208*^9}, {
   3.5357417799357347`*^9, 3.535741805308468*^9}, {3.535742029268375*^9, 
   3.5357420671942997`*^9}, {3.535742127361409*^9, 3.53574215740168*^9}, {
   3.535742782559972*^9, 3.5357428049503393`*^9}, 3.5418602424208593`*^9, {
   3.5433459053807983`*^9, 
   3.5433459064367933`*^9}},ExpressionUUID->"900417a4-6b80-4a35-ace0-\
915997efa2d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTrace", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", "2", "]"}], "}"}]}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "v_Vertex", "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", "1", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "pivotalStructure"}], "]"}], 
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", 
                  RowBox[{"-", "1"}], ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "pivotalStructure"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "v", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742808674651*^9, 3.535742863291177*^9}, {
  3.535742902800458*^9, 3.53574292253465*^9}, {3.541860254152179*^9, 
  3.5418602583511868`*^9}},ExpressionUUID->"48558dfe-ece7-4800-92d4-\
96a1cf8743da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Trace", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", "_", ",", "_"}], "]"}]}], "]"}],
   ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"PartialTrace", ",", "A", ",", "k"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5357424356593037`*^9, 3.535742502639635*^9}, {
  3.535742966921042*^9, 3.535742968104697*^9}, {3.535743092869817*^9, 
  3.5357430935489607`*^9}},ExpressionUUID->"aba899e8-dc0b-448d-b576-\
b933bafc054d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4TraceEvaluation", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", "_", ",", "_"}], "]"}]}], "]"}],
   ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeffs", "=", 
      RowBox[{"GPACoefficients", "[", 
       RowBox[{"GPA4Trace", "[", "A", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"cachedRootReduce", "[", "coeffs", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "x_", "}"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"y_AlgebraicNumber", "\[RuleDelayed]", "y"}], ",", 
            RowBox[{"y_", "\[RuleDelayed]", 
             RowBox[{"RootReduce", "[", "y", "]"}]}]}], "}"}]}], ")"}]}], ",", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<0-box didn't have constant values\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535743145150734*^9, 3.535743292597618*^9}, {
  3.535743354053219*^9, 3.535743474474934*^9}, {3.556487755333955*^9, 
  3.556487756279072*^9}},ExpressionUUID->"8879954b-e5df-4b6d-96d4-\
03d866840616"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepeatedSequence", "[", 
   RowBox[{"A__", ",", 
    RowBox[{"repeat", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Integer", "|", 
        RowBox[{"{", "_Integer", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], ")"}], ":", 
      "\[Infinity]"}]}]}], "]"}], ":=", 
  RowBox[{"Repeated", "[", 
   RowBox[{
    RowBox[{"PatternSequence", "[", "A", "]"}], ",", "repeat"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446143190705271*^9, 3.446143327450014*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"1d65689d-96e1-4c9a-95bd-ce3723e2d071"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "transform", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"transform", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ":", 
           RowBox[{"RepeatedSequence", "[", 
            RowBox[{"_Vertex", ",", "_Integer", ",", 
             RowBox[{"{", "up", "}"}]}], "]"}]}], ",", "v_Vertex", ",", 
          "n_Integer", ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "v", ",", "n", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", "1", ",", "v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], "]"}]}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "-", "1"}], ",", 
         RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"transform", "/@", "coefficients"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446141050274499*^9, 3.446141052601837*^9}, 3.446143343759233*^9, {
   3.446846260391795*^9, 3.446846260581895*^9}, 3.4468498895524282`*^9, 
   3.446850522924406*^9, {3.4950333704977503`*^9, 3.495033404367949*^9}, {
   3.526059656055729*^9, 3.5260597097711067`*^9}, {3.52630627591259*^9, 
   3.526306301702795*^9}, {3.712374235668042*^9, 
   3.7123742825844183`*^9}},ExpressionUUID->"2143418a-7275-4bb8-9e02-\
50d48825e7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopRightCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "+", "1"}], ",", 
      RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ":", 
           RowBox[{"RepeatedSequence", "[", 
            RowBox[{"_Vertex", ",", "_Integer", ",", 
             RowBox[{"{", 
              RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "v_Vertex", 
          ",", "n_Integer", ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], 
       ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "v", ",", "n", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], "]"}]}]}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.446140411262151*^9}, {3.446140672774551*^9, 
   3.446140680623767*^9}, {3.4461407184695473`*^9, 3.446140882265745*^9}, {
   3.4461409741542788`*^9, 3.44614104392402*^9}, {3.446143168346834*^9, 
   3.446143175116309*^9}, {3.446143347831675*^9, 3.44614335309664*^9}, {
   3.4468462607923117`*^9, 3.4468462609907*^9}, 3.446849896015937*^9, 
   3.446850525504931*^9, {3.4950334272178907`*^9, 3.495033446230585*^9}, {
   3.5260597665307407`*^9, 3.5260598013779383`*^9}, {3.526059848397561*^9, 
   3.526059850660676*^9}, {3.52630630610478*^9, 
   3.526306316765316*^9}},ExpressionUUID->"55a767d4-f799-4c02-b308-\
eba49f04cbc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnUpBottomLeftCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"over", "\[LeftDoubleBracket]", 
       RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "}"}], "~", "Join", "~", 
     RowBox[{"Most", "[", "over", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "-", "1"}], ",", 
      RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "B___", ",", "b_Vertex", ",", 
          "nb_Integer"}], "}"}], "\[Rule]", "\[Zeta]_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "a", ",", "na", ",", "B"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{
          "g", ",", "1", ",", "a", ",", "b", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446140899620675*^9, 3.4461409325890837`*^9}, {3.4461410328097467`*^9, 
   3.4461410350659723`*^9}, {3.4461412110924253`*^9, 3.446141245939475*^9}, {
   3.446846261193063*^9, 3.446846261392714*^9}, 3.4468498984476967`*^9, 
   3.446850529587123*^9, {3.495033461523034*^9, 3.4950335317150517`*^9}, {
   3.495046101145028*^9, 3.495046126909863*^9}, {3.4950461787392693`*^9, 
   3.495046199409914*^9}, {3.495046326684564*^9, 3.495046328620358*^9}, {
   3.526059907991337*^9, 3.526059961553475*^9}, {3.526306321490183*^9, 
   3.526306330526116*^9}},ExpressionUUID->"5f0476c1-0e2c-4b7f-aed2-\
3ba9a8d61352"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"Rest", "[", "over", "]"}], "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "+", "1"}], ",", 
      RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", "nb_Integer", 
          ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "B", ",", "a", ",", "na"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "b", ",", "a", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.446140411262151*^9}, {3.446140672774551*^9, 
   3.446140680623767*^9}, {3.4461407184695473`*^9, 3.446140882265745*^9}, {
   3.4461410743260803`*^9, 3.4461411934118156`*^9}, {3.4461412518139763`*^9, 
   3.446141257349806*^9}, {3.446846261611636*^9, 3.446846261827194*^9}, 
   3.446849900631482*^9, 3.446865468618416*^9, {3.4950334632455683`*^9, 
   3.4950334793528433`*^9}, {3.495033513078804*^9, 3.495033535459675*^9}, {
   3.495046206266824*^9, 3.495046215234746*^9}, {3.526059969161972*^9, 
   3.5260600009734488`*^9}, {3.5263063347813053`*^9, 
   3.526306344568487*^9}},ExpressionUUID->"17a67f02-b7c5-4f30-917b-\
eca62e64ab89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GZIPGet", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gzip", ",", "file0", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"file", ",", 
          RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gzip", "=", "file"}], ";", "\[IndentingNewLine]", 
        RowBox[{"file0", "=", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"file", ",", 
           RowBox[{"-", "3"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gzip", "=", 
         RowBox[{"file", "<>", "\"\<.gz\>\""}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"file0", "=", "file"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "gzip", "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Run", "[", 
         RowBox[{
         "\"\<gunzip < \>\"", "<>", "gzip", "<>", "\"\< > \>\"", "<>", 
          "file0"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Get", "[", "file0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DeleteFile", "[", "file0", "]"}], ";", "\[IndentingNewLine]",
         "result"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Get", "[", "file0", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721937490333521*^9, 3.721937503882942*^9}, {
   3.721937539927034*^9, 3.721937561609535*^9}, {3.721937636058494*^9, 
   3.72193764569049*^9}, {3.721937734789048*^9, 3.721937771264106*^9}, 
   3.721937862931119*^9, {3.721937924793186*^9, 3.721937957124406*^9}, {
   3.722548327764965*^9, 
   3.7225484011568327`*^9}},ExpressionUUID->"d8130fdf-baa9-401a-805e-\
52633602a51b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GZIPPut", "[", 
   RowBox[{"expression_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gzip", ",", "file0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"file", ",", 
          RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<.gz\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gzip", "=", "file"}], ";", "\[IndentingNewLine]", 
        RowBox[{"file0", "=", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"file", ",", 
           RowBox[{"-", "3"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gzip", "=", 
         RowBox[{"file", "<>", "\"\<.gz\>\""}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"file0", "=", "file"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"AbortProtect", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Put", "[", 
        RowBox[{"expression", ",", "file0"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Run", "[", 
        RowBox[{
        "\"\<gzip < \>\"", "<>", "file0", "<>", "\"\< > \>\"", "<>", "gzip"}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "[", "file0", "]"}], ";"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721937777530066*^9, 3.7219378355031424`*^9}, {
  3.721937929609754*^9, 3.721937931809737*^9}, {3.722548404702124*^9, 
  3.722548416222604*^9}},ExpressionUUID->"1c0bfc48-7bfb-4b17-a559-\
458c8909bd33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "transform", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"transform", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", "nb_Integer", 
          ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "B", ",", "a", ",", "na"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "b", ",", "a", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{
        RowBox[{"Rest", "[", "over", "]"}], "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{
         "over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "+", "1"}], ",", 
         RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"transform", "/@", "coefficients"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446141050274499*^9, 3.446141052601837*^9}, 3.446143343759233*^9, {
   3.446846260391795*^9, 3.446846260581895*^9}, 3.4468498895524282`*^9, 
   3.446850522924406*^9, {3.4950333704977503`*^9, 3.495033404367949*^9}, {
   3.526059656055729*^9, 3.5260597097711067`*^9}, {3.52630627591259*^9, 
   3.526306301702795*^9}, {3.712374235668042*^9, 3.7123742825844183`*^9}, {
   3.713403947808045*^9, 
   3.713403989384013*^9}},ExpressionUUID->"2143418a-7275-4bb8-9e02-\
50d48825e7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteLargeGPA4Element", "[", 
   RowBox[{"LargeGPA4Element", "[", 
    RowBox[{"___", ",", "tag_"}], "]"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"DeleteFile", "/@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<large\>\"", ",", 
         RowBox[{"tag", "<>", "\"\<-*.m.gz\>\""}]}], "}"}], "]"}], "]"}]}], 
    ";"}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721939209852524*^9, 3.721939238694975*^9}, {
  3.722548070938035*^9, 3.722548075288704*^9}, {3.722548462035347*^9, 
  3.7225484623950567`*^9}, {3.722549134893568*^9, 
  3.722549138701043*^9}},ExpressionUUID->"0f09032d-fc69-4ec2-ae13-\
0783cc3332a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LargeGPA4Element", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], ",", "tag_String"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GZIPPut", "[", 
        RowBox[{
         RowBox[{"coefficients", "\[LeftDoubleBracket]", 
          RowBox[{"i", ";;", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"i", "+", "999"}], ",", 
             RowBox[{"Length", "[", "coefficients", "]"}]}], "]"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<large\>\"", 
            ",", 
            RowBox[{"tag", "<>", "\"\<-\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.m\>\""}]}], 
           "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "coefficients", "]"}], ",", "1000"}], "}"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LargeGPA4Element", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
       "tag"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713403680966242*^9, 3.713403814807987*^9}, {
  3.7151983154669933`*^9, 3.7151983300359173`*^9}, {3.715382640069172*^9, 
  3.715382640404592*^9}, {3.715392574801331*^9, 3.7153925770322866`*^9}, {
  3.715468844358159*^9, 3.715468849526287*^9}, {3.721937381463934*^9, 
  3.7219373821744213`*^9}},ExpressionUUID->"127cbafc-75bc-4bab-b64c-\
49832dbeac77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Element", "[", 
   RowBox[{"LargeGPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "tag_String"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"GZIPGet", "/@", 
       RowBox[{"FileNames", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<large\>\"", ",", 
           RowBox[{"tag", "<>", "\"\<-*.m.gz\>\""}]}], "}"}], "]"}], "]"}]}], 
      ",", "1"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7134038277502823`*^9, 3.713403889610919*^9}, 
   3.715548886854007*^9, {3.7219373880711203`*^9, 3.7219373884312277`*^9}, {
   3.722548435160631*^9, 
   3.722548435360368*^9}},ExpressionUUID->"9858a836-3e88-4da4-96a9-\
c48b9972c1a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"LargeGPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "tag_String"}], "]"}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"transform", ",", "newTag", ",", "coefficients", ",", "file"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTag", "=", 
      RowBox[{"tag", "<>", "\"\<r\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"transform", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ":", 
           RowBox[{"RepeatedSequence", "[", 
            RowBox[{"_Vertex", ",", "_Integer", ",", 
             RowBox[{"{", "up", "}"}]}], "]"}]}], ",", "v_Vertex", ",", 
          "n_Integer", ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "v", ",", "n", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", "1", ",", "v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], "]"}]}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"coefficients", "=", 
         RowBox[{"GZIPGet", "[", "file", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"GZIPPut", "[", 
         RowBox[{
          RowBox[{"transform", "/@", "coefficients"}], ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"file", ",", 
            RowBox[{"tag", "\[Rule]", "newTag"}]}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"file", ",", 
         RowBox[{"FileNames", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<large\>\"", 
             ",", 
             RowBox[{"tag", "<>", "\"\<-*.m.gz\>\""}]}], "}"}], "]"}], 
          "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LargeGPA4Element", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "-", "1"}], ",", 
         RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       "\[IndentingNewLine]", "newTag"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446141050274499*^9, 3.446141052601837*^9}, 3.446143343759233*^9, {
   3.446846260391795*^9, 3.446846260581895*^9}, 3.4468498895524282`*^9, 
   3.446850522924406*^9, {3.4950333704977503`*^9, 3.495033404367949*^9}, {
   3.526059656055729*^9, 3.5260597097711067`*^9}, {3.52630627591259*^9, 
   3.526306301702795*^9}, {3.712374235668042*^9, 3.7123742825844183`*^9}, {
   3.7134034660974293`*^9, 3.713403661281694*^9}, {3.715392533342821*^9, 
   3.715392541612474*^9}, {3.71546883923728*^9, 3.715468841581873*^9}, {
   3.7219374372849627`*^9, 3.721937447485746*^9}, {3.722548269568817*^9, 
   3.72254828604079*^9}, {3.7225484248728523`*^9, 
   3.722548429096239*^9}},ExpressionUUID->"2143418a-7275-4bb8-9e02-\
50d48825e7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"LargeGPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "tag_String"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"transform", ",", "newTag", ",", "coefficients", ",", "file"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTag", "=", 
      RowBox[{"tag", "<>", "\"\<s\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"transform", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", "nb_Integer", 
          ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "B", ",", "a", ",", "na"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "b", ",", "a", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"coefficients", "=", 
         RowBox[{"GZIPGet", "[", "file", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"GZIPPut", "[", 
         RowBox[{
          RowBox[{"transform", "/@", "coefficients"}], ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"file", ",", 
            RowBox[{"tag", "\[Rule]", "newTag"}]}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"file", ",", 
         RowBox[{"FileNames", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<large\>\"", 
             ",", 
             RowBox[{"tag", "<>", "\"\<-*.m.gz\>\""}]}], "}"}], "]"}], 
          "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LargeGPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{
        RowBox[{"Rest", "[", "over", "]"}], "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{
         "over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "+", "1"}], ",", 
         RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       "\[IndentingNewLine]", "newTag"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446141050274499*^9, 3.446141052601837*^9}, 3.446143343759233*^9, {
   3.446846260391795*^9, 3.446846260581895*^9}, 3.4468498895524282`*^9, 
   3.446850522924406*^9, {3.4950333704977503`*^9, 3.495033404367949*^9}, {
   3.526059656055729*^9, 3.5260597097711067`*^9}, {3.52630627591259*^9, 
   3.526306301702795*^9}, {3.712374235668042*^9, 3.7123742825844183`*^9}, {
   3.713403947808045*^9, 3.7134040416575336`*^9}, 3.7155487701230993`*^9, 
   3.7198702037089148`*^9, {3.720796927235746*^9, 3.720796953586532*^9}, {
   3.72193744113308*^9, 3.721937452422117*^9}, {3.722548454780161*^9, 
   3.7225484551393137`*^9}},ExpressionUUID->"2143418a-7275-4bb8-9e02-\
50d48825e7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "RotateOneClick", " ", "is", " ", "the", " ", "WRONG", " ", "rotation", 
    " ", "by", " ", "QuadraticTangles", " ", 
    RowBox[{"standards", ".", " ", "It"}], " ", "moves", " ", "the", " ", 
    "external", " ", "star", " ", 
    RowBox[{"clockwise", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateOneClick", "[", 
    RowBox[{
     RowBox[{"k", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients_"}], "]"}]}], "/;", 
     RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"TurnDownTopLeftCorner", "[", "k", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260677854704123`*^9}, 
   3.526306351847019*^9, {3.543170636344987*^9, 
   3.543170682518759*^9}},ExpressionUUID->"651aac16-0e1c-44d6-b521-\
2ee89b29a161"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateOneClick", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{"TurnUpBottomRightCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260677854704123`*^9}, 
   3.526306351847019*^9, {3.526306402523082*^9, 
   3.5263064112178926`*^9}},ExpressionUUID->"96a93bfc-c54d-41b1-ae01-\
02a6431aa0e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Also", " ", "rotates", " ", "the", " ", "wrong", " ", 
    RowBox[{"way", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateTwoClicks", "[", "k_GPA4Element", "]"}], ":=", 
   RowBox[{"RotateOneClick", "[", 
    RowBox[{"RotateOneClick", "[", "k", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260678153142843`*^9}, {
  3.543170687684066*^9, 
  3.543170694612253*^9}},ExpressionUUID->"5999543e-8637-4875-8b64-\
5740f3ed2edb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "GPAFourierTranform", " ", "is", " ", "the", " ", "other", " ", "one", " ",
     "click", " ", "rotation", " ", 
    RowBox[{"(", 
     RowBox[{
     "the", " ", "right", " ", "one", " ", "that", " ", "rotates", " ", 
      "counterclockwise"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GPAFourierTransform", "[", 
     RowBox[{
      RowBox[{"k", ":", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"g", ":", 
          RowBox[{"{", 
           RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
         ",", 
         RowBox[{"over", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
         RowBox[{"pivotalStructure", ":", 
          RowBox[{"(", 
           RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
         ",", "coefficients_"}], "]"}]}], "/;", 
      RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
    RowBox[{"TurnUpBottomLeftCorner", "[", 
     RowBox[{"TurnDownTopRightCorner", "[", "k", "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GPAFourierTransform", "[", 
     RowBox[{
      RowBox[{"k", ":", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"g", ":", 
          RowBox[{"{", 
           RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
         ",", 
         RowBox[{"over", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
         RowBox[{"pivotalStructure", ":", 
          RowBox[{"(", 
           RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
         ",", "coefficients_"}], "]"}]}], "/;", 
      RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
    RowBox[{"TurnDownTopRightCorner", "[", 
     RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.543170698725366*^9, 
  3.543170840548767*^9}},ExpressionUUID->"272d7628-6d2a-452f-812b-\
89ebd15eb370"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAFourierTransformTwice", "[", "k_GPA4Element", "]"}], ":=", 
  RowBox[{"GPAFourierTransform", "[", 
   RowBox[{"GPAFourierTransform", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5431708518157673`*^9, 
  3.543170869004019*^9}},ExpressionUUID->"0f5e8906-aa69-4ed2-a7d9-\
922eaba96e00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], ",", 
    RowBox[{"newOver", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dispatch", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"over", ",", 
           RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
         RowBox[{"{", "newOver", "}"}], "~", "Join", "~", 
         RowBox[{"Drop", "[", 
          RowBox[{"over", ",", "up"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"down", "+", "1"}], ",", 
          RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"down", ",", "up"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", 
              "na_Integer"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "a", "}"}], "/.", "dispatch"}], ")"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_Vertex", ",", "nc_Integer", ",", 
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", 
                  RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "a_Vertex",
               ",", "na_Integer", ",", "b_Vertex", ",", "na_Integer"}], "}"}],
             "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "nc", ",", "A"}], "}"}], "/.", "dispatch"}], 
             ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "up", "}"}]}], "]"}]}], ",", "a_Vertex", ",", 
              "na_Integer", ",", "b_Vertex", ",", "na_Integer", ",", 
              "a_Vertex", ",", "nc_Integer", ",", 
              RowBox[{"B", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", 
                  RowBox[{"down", "-", "1"}], "}"}]}], "]"}]}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"A", ",", "a", ",", "nc", ",", "B"}], "}"}], "/.", 
              "dispatch"}], ")"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446141320966792*^9, 3.446141379198556*^9}, {
   3.4461414235264397`*^9, 3.446141458365514*^9}, {3.446142643542164*^9, 
   3.4461426443563223`*^9}, {3.446142715057644*^9, 3.446142717225142*^9}, {
   3.446142759611849*^9, 3.446142810870644*^9}, {3.44614286142281*^9, 
   3.446142882885414*^9}, {3.4461429403251657`*^9, 3.446142962897225*^9}, {
   3.446143359117996*^9, 3.446143360982417*^9}, {3.446148358830414*^9, 
   3.446148366375103*^9}, {3.446846262023032*^9, 3.446846262870696*^9}, 
   3.4468499027119703`*^9, 3.446850534550316*^9, {3.4950336092469997`*^9, 
   3.495033620003326*^9}, {3.495045243730057*^9, 3.495045246201725*^9}, {
   3.49504528709837*^9, 3.495045412670459*^9}, {3.49504549439649*^9, 
   3.495045510167182*^9}, {3.5263064562342663`*^9, 3.526306471056511*^9}, {
   3.5418603091139917`*^9, 3.541860313340745*^9}, {3.569013789907518*^9, 
   3.569013857856578*^9}, {3.5690139197607613`*^9, 
   3.569013965274008*^9}},ExpressionUUID->"7d2c2176-0a8a-4df6-b1b0-\
6d2835b84fcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandsOnLeft", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], ",", 
    RowBox[{"newOvers", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"Length", "[", "newOvers", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{"newOvers", "~", "Join", "~", "over", "~", "Join", "~", 
         RowBox[{"Reverse", "[", "newOvers", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"down", "+", "k"}], ",", 
          RowBox[{"up", "+", "k"}]}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "k", "}"}]}], "]"}]}], ",", 
             RowBox[{"B", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", 
                 RowBox[{"up", "+", "down", "+", "1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"C", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", 
                 RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}]}], "}"}], "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "A", "}"}], "~", "Join", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "}"}]}], "===", 
             RowBox[{"Reverse", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{
                 RowBox[{"{", "B", "}"}], ",", 
                 RowBox[{"-", "2"}]}], "]"}], "~", "Join", "~", 
               RowBox[{"{", "C", "}"}], "~", "Join", "~", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "}"}]}], "]"}]}], ")"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"up", "+", "down"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"{", "B", "}"}], ",", 
                RowBox[{"-", "2"}]}], "]"}]}], "]"}], "/.", "dispatch"}], 
           ")"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569015678635935*^9, 3.569015909909061*^9}, {
  3.569015956274962*^9, 3.569016036296689*^9}, {3.569020171955059*^9, 
  3.569020191767392*^9}, {3.569020252544715*^9, 3.5690203772126207`*^9}, {
  3.569020752126964*^9, 3.569020755572331*^9}, {3.569020790235155*^9, 
  3.569020792217833*^9}, {3.569020871241786*^9, 3.569020931431197*^9}, {
  3.569020980031637*^9, 3.569020986982163*^9}, {3.56902127675322*^9, 
  3.569021278638653*^9}, {3.569021476323537*^9, 3.5690215947098923`*^9}, {
  3.569021670397976*^9, 3.569021673428562*^9}, {3.5691834533551607`*^9, 
  3.569183455157502*^9}, {3.5691930321133347`*^9, 3.5691930822005653`*^9}, {
  3.569193132649847*^9, 3.569193133153131*^9}, {3.569193164423052*^9, 
  3.569193197155683*^9}, {3.5691932847123117`*^9, 
  3.5691932863280077`*^9}},ExpressionUUID->"275267fb-2693-47e5-abb5-\
f4b636150369"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandsOnLeft", "[", 
   RowBox[{"A_GPA4Element", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "A"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5691886334196777`*^9, 
  3.56918864997656*^9}},ExpressionUUID->"e955d044-3a12-4888-b1a4-\
e0715fd0f2e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{"A_GPA4Matrix", ",", "over_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"AddStrandOnRight", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", "A", "]"}], ",", "over"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457678052177*^9, 3.527457703036878*^9}, {
  3.569013742183363*^9, 
  3.5690137439763308`*^9}},ExpressionUUID->"c3398c40-6e1e-4c9f-a7e9-\
979c940a611f"],

Cell[BoxData[
 RowBox[{"Clear", "[", "GPAMultiply", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.495042131577936*^9, 
  3.4950421344429626`*^9}},ExpressionUUID->"4707d7f7-de8f-49b8-8ce1-\
07650fc5884c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiply", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overBelow", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients1_"}], "]"}], ",", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overAbove", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients2_"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"overBelow", ",", 
      RowBox[{"middle", "+", "1"}]}], "]"}], "\[Equal]", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", 
       RowBox[{
        RowBox[{"-", "middle"}], "-", "1"}]}], "]"}], "]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch1", ",", "dispatch2", ",", "expand"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expand", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"coefficients1", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"Vertex", "[", 
                  RowBox[{"_", ",", "_", ",", "0", ",", "1"}], "]"}], "]"}], 
                ",", "___"}], "}"}], "\[Rule]", "_"}]}], "]"}], "\[And]", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"coefficients2", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"Vertex", "[", 
                  RowBox[{"_", ",", "_", ",", "0", ",", "1"}], "]"}], "]"}], 
                ",", "___"}], "}"}], "\[Rule]", "_"}]}], "]"}]}], ")"}]}], 
        ",", "\[IndentingNewLine]", "ExpandCoefficientRulesAtStar", ",", 
        "\[IndentingNewLine]", "ExpandCoefficientRules"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dispatch1", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients1", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "middle"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dispatch2", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients2", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"middle", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"overAbove", ",", 
           RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
         RowBox[{"Take", "[", 
          RowBox[{"overBelow", ",", 
           RowBox[{"-", "down"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"down", ",", "middle", ",", "up"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "middle", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "V_Vertex", "}"}], "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Reverse", "[", "#", "]"}], "/.", "dispatch1"}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "V", ",", "V", ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{
                    RowBox[{"-", "middle"}], "-", "1"}]}], "]"}]}], "]"}]}], 
              ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "up", "}"}]}], "]"}]}], "}"}], "\[RuleDelayed]", 
            
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "A", "}"}], "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch1"}], ")"}]}], "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ")"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "down", "}"}]}], "]"}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "B", "}"}], "/.", "dispatch1"}], ")"}]}], 
                "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ")"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "middle", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "up", "}"}]}], "]"}]}], ",", 
              RowBox[{"B", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "down", "}"}]}], "]"}]}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "A", "}"}], "~", "Join", "~", 
                    RowBox[{"Most", "[", "#", "]"}]}], "/.", "dispatch2"}], 
                  ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Most", "[", 
                    RowBox[{"Reverse", "[", "#", "]"}], "]"}], "~", "Join", 
                    "~", 
                    RowBox[{"{", "B", "}"}]}], "/.", "dispatch1"}], ")"}]}], 
                "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", 
                  "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "B"}], "}"}], "\[LeftDoubleBracket]", 
                  "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{
                    RowBox[{"-", "middle"}], "-", "1"}]}], "]"}]}], "]"}]}], 
              ")"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446143027737702*^9, 3.446143040387432*^9}, {
   3.44614309570789*^9, 3.446143148042493*^9}, 3.446143363404314*^9, {
   3.446143530539763*^9, 3.446143569313798*^9}, {3.44614361534016*^9, 
   3.4461437986505823`*^9}, {3.446146131363949*^9, 3.446146135448526*^9}, {
   3.446146205116487*^9, 3.4461462134890013`*^9}, {3.4461462494448643`*^9, 
   3.446146253269882*^9}, {3.446146299039256*^9, 3.4461463034179688`*^9}, {
   3.446146474355957*^9, 3.44614650203834*^9}, {3.446846264311413*^9, 
   3.4468462645354843`*^9}, 3.446849913547138*^9, {3.446850428275291*^9, 
   3.446850454481435*^9}, {3.495033682671708*^9, 3.495033829492198*^9}, {
   3.495033862556323*^9, 3.4950338899242563`*^9}, {3.495033946067052*^9, 
   3.495033949690954*^9}, {3.495034035291271*^9, 3.4950340443745327`*^9}, {
   3.4950421138994226`*^9, 3.495042128453071*^9}, {3.4950421820408792`*^9, 
   3.495042197588395*^9}, {3.4950445330970907`*^9, 3.495044536197178*^9}, {
   3.509411153059443*^9, 3.5094111696333733`*^9}, {3.514128937394614*^9, 
   3.514128948370569*^9}, {3.514128983503443*^9, 3.514129052311144*^9}, {
   3.5263064965516443`*^9, 3.52630650947429*^9}, {3.5418604024036837`*^9, 
   3.5418604275415993`*^9}, {3.568927609097398*^9, 3.568927618819182*^9}, {
   3.568928430842984*^9, 3.56892844034904*^9}, {3.569005767473308*^9, 
   3.5690060732065783`*^9}, 
   3.5690126883573637`*^9},ExpressionUUID->"c26cb999-8261-40f9-8c06-\
1649229c39c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAMultiply", "[", 
   RowBox[{"x_", ",", "y_", ",", "Z__"}], "]"}], ":=", 
  RowBox[{"GPAMultiply", "[", 
   RowBox[{
    RowBox[{"GPAMultiply", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", "Z"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535743623920663*^9, 
  3.535743646981662*^9}},ExpressionUUID->"37e2920b-dd29-4b11-a352-\
2b5af3c1239c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", "\"\<Lopsided\>\""}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "overs", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"up", ",", "down"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReverseLoop", "[", "a", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"down", "\[GreaterEqual]", "2"}], ",", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"LopsidedDimension", "[", 
                   RowBox[{"g", ",", "#"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
               RowBox[{"a", "\[LeftDoubleBracket]", 
                RowBox[{"3", ";;", 
                 RowBox[{
                  RowBox[{"2", "down"}], "-", "1"}], ";;", "2"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}], ",", "1"}], "]"}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"up", "\[GreaterEqual]", "2"}], ",", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"LopsidedDimension", "[", 
                 RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"a", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"-", "2"}], ";;", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", "up"}]}], ";;", 
                 RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ")"}]}], 
            ",", "1"}], "]"}], ")"}], 
         RowBox[{"conjugate", "[", "b", "]"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4886725101320763`*^9, 3.488672540908902*^9}, {
   3.488672682779689*^9, 3.488672688697996*^9}, {3.488672728096558*^9, 
   3.488672796335504*^9}, {3.488674220960629*^9, 3.488674230200107*^9}, {
   3.4886773677977247`*^9, 3.4886776619839*^9}, {3.495043641231689*^9, 
   3.4950437144930696`*^9}, {3.495043830921403*^9, 3.495043854258298*^9}, {
   3.4950439220859137`*^9, 3.495043967441518*^9}, 3.4950441101950817`*^9, {
   3.4989575620040827`*^9, 3.4989575729735527`*^9}, {3.509395007300632*^9, 
   3.50939500800356*^9}, {3.526060142760907*^9, 3.526060151978065*^9}, {
   3.526060446001032*^9, 3.526060452326582*^9}, {3.526306526708049*^9, 
   3.5263065469172487`*^9}, 
   3.52691506326283*^9},ExpressionUUID->"a78ebcb8-9104-49b4-9ded-\
99b8be9df19f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "overs", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"up", ",", "down"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReverseLoop", "[", "a", "]"}], "\[Rule]", 
        RowBox[{"conjugate", "[", "b", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4886725101320763`*^9, 3.488672540908902*^9}, {
   3.488672682779689*^9, 3.488672688697996*^9}, {3.488672728096558*^9, 
   3.488672796335504*^9}, {3.488674220960629*^9, 3.488674230200107*^9}, {
   3.4886773677977247`*^9, 3.4886776619839*^9}, {3.495043641231689*^9, 
   3.4950437144930696`*^9}, {3.495043830921403*^9, 3.495043854258298*^9}, {
   3.4950439220859137`*^9, 3.495043967441518*^9}, 3.4950441101950817`*^9, {
   3.4989575620040827`*^9, 3.4989575729735527`*^9}, {3.509395007300632*^9, 
   3.50939500800356*^9}, {3.526060142760907*^9, 3.5260601864464083`*^9}, {
   3.52630655531157*^9, 3.5263065730262527`*^9}, 
   3.526915065804895*^9},ExpressionUUID->"cd177bf9-1d2e-4b64-b6ed-\
f97098129e5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", "A_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPAConjugate", "[", 
    RowBox[{"GPA4Element", "[", "A", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527524054449087*^9, 
  3.5275240716405897`*^9}},ExpressionUUID->"82312001-1f4f-4499-b185-\
a39fc51f91fd"],

Cell[BoxData[
 RowBox[{"Clear", "[", "conjugate", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509395249141024*^9, 
  3.5093952507746058`*^9}},ExpressionUUID->"23b54a4d-5f3a-4cd5-8aa4-\
4461123275ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conjugate", "[", "a_Times", "]"}], ":=", 
  RowBox[{"conjugate", "/@", "a"}]}], "\n", 
 RowBox[{
  RowBox[{"conjugate", "[", "b_Plus", "]"}], ":=", 
  RowBox[{"conjugate", "/@", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"Exp", "[", "x_", "]"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"conjugate", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   SuperscriptBox["x_", "y_Integer"], "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"conjugate", "[", "x", "]"}], "y"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"1", "/", "x_"}], "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"conjugate", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", "x_AlgebraicNumber", "]"}], ":=", 
  RowBox[{"ToNumberField", "[", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], ",", 
    RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"Conjugate", "[", "x", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.50939502471938*^9, 3.509395031725524*^9}, {
  3.509395067036762*^9, 3.509395107859158*^9}, {3.509395243777728*^9, 
  3.5093952440247717`*^9}, {3.509395274810731*^9, 3.509395286368277*^9}, {
  3.5182711453243017`*^9, 3.518271152532732*^9}, {3.5592509733240757`*^9, 
  3.5592509742794733`*^9}},ExpressionUUID->"a730295d-c81e-4908-8673-\
589054bfcb4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"conjugate", "[", "x_", "]"}], "]"}], ":=", "x"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.514652964913678*^9, 
  3.514652969974833*^9}},ExpressionUUID->"fef33628-c80f-45f2-8153-\
2d0122676e3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaugeTransform", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"g_", ",", "over_", ",", 
      RowBox[{"{", 
       RowBox[{"down_", ",", "up_"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}], ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"values", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"path_", "\[Rule]", "coefficient_"}], ")"}], "\[RuleDelayed]", 
      
      RowBox[{"(", 
       RowBox[{"path", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Mu]", "@@", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"path", "~", "Join", "~", 
                RowBox[{"{", 
                 RowBox[{"First", "[", "path", "]"}], "}"}]}], ",", "3", ",", 
               "2"}], "]"}]}], ")"}]}], ")"}], "coefficient"}]}], ")"}]}]}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.539014742798821*^9, 3.5390148247285433`*^9}, {
  3.5390148689599113`*^9, 3.53901489143885*^9}, {3.5390149495405483`*^9, 
  3.539014997858568*^9}, {3.5390150894755507`*^9, 
  3.5390150930977793`*^9}},ExpressionUUID->"d7a8ea77-0544-4b0b-be4d-\
6f56a8cb1cfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arithmetic", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965260379401*^9, 
  3.44596526337621*^9}},ExpressionUUID->"860977ff-9364-472d-9daa-\
a928a77f14f5"],

Cell[BoxData[
 RowBox[{"GPA4Element", "/:", 
  RowBox[{"z_", " ", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}]}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"loop_List", "\[Rule]", "\[Zeta]_"}], ")"}], "\[RuleDelayed]", 
      
      RowBox[{"(", 
       RowBox[{"loop", "\[Rule]", 
        RowBox[{"z", " ", "\[Zeta]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459189949281693`*^9, 3.445919072755118*^9}, {
  3.4459191436969643`*^9, 3.4459191440651293`*^9}, {3.495035196969193*^9, 
  3.4950352262332478`*^9}, {3.526306631327425*^9, 
  3.52630663720443*^9}},ExpressionUUID->"d3504079-7031-465a-ac90-\
6e4c65720f09"],

Cell[BoxData[
 RowBox[{"GPA4Element", "/:", 
  RowBox[{
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients1_List"}], "]"}], "+", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients2_List"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dispatch1", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"coefficients1", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"otherLoopsZero", "[", 
           RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"dispatch2", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"coefficients2", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"otherLoopsZero", "[", 
           RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"loops", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"First", "/@", "coefficients1"}], ",", 
         RowBox[{"First", "/@", "coefficients2"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"g", ",", "over", ",", 
      RowBox[{"{", 
       RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"loops", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"loops", "/.", "dispatch1"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"loops", "/.", "dispatch2"}], ")"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459190761592703`*^9, 3.445919173400749*^9}, {
  3.445919267341947*^9, 3.445919269757209*^9}, {3.445919354504414*^9, 
  3.4459193565107317`*^9}, {3.4461700999440413`*^9, 3.4461701250251827`*^9}, {
  3.446170740388773*^9, 3.446170806282733*^9}, {3.495035296389758*^9, 
  3.4950353431803503`*^9}, {3.4950353740927753`*^9, 3.4950353844148197`*^9}, {
  3.526306732343581*^9, 3.5263067445192747`*^9}, {3.5418604552238913`*^9, 
  3.5418604646323767`*^9}, {3.541861811702854*^9, 
  3.541861846204617*^9}},ExpressionUUID->"b61ad834-6581-49e2-a037-\
95ab936e6fb2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Technical details", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4459653071431017`*^9, 3.445965328740335*^9}, {
  3.4461415307942743`*^9, 
  3.446141531075536*^9}},ExpressionUUID->"b40bcb2c-1aa5-4757-b555-\
d6539e40db80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expansionCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<.... expanding coefficients (\>\"", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"GraphLoops", "[", 
         RowBox[{"g", ",", "over"}], "]"}], "]"}], ",", "\"\<)\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", "over", ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"++", "expansionCounter"}], ",", "10000"}], "]"}], 
                 "\[Equal]", "0"}], ",", 
                RowBox[{"DebugPrint", "[", "expansionCounter", "]"}]}], "]"}],
               ";", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coefficients"}], ")"}], ",", 
                 RowBox[{"_List", "\[Rule]", "0"}]}], "]"}]}]}], ")"}], "&"}],
            "/@", 
           RowBox[{"GraphLoops", "[", 
            RowBox[{"g", ",", "over"}], "]"}]}], ",", 
          RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<.... finished expanding coefficients\>\"", "]"}],
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445905584279745*^9, 3.445905592351304*^9}, 
   3.445916378944194*^9, {3.4459169756223927`*^9, 3.445917017679369*^9}, {
   3.445917051977274*^9, 3.4459171738508*^9}, {3.446141514079033*^9, 
   3.446141525606818*^9}, 3.4461446314527597`*^9, {3.446145766819582*^9, 
   3.4461457699203453`*^9}, {3.446146438943179*^9, 3.446146450188395*^9}, {
   3.446150203783448*^9, 3.4461502382642107`*^9}, {3.446151331965104*^9, 
   3.446151401193177*^9}, {3.446151565565996*^9, 3.446151584103376*^9}, {
   3.495035396144053*^9, 3.4950354297794847`*^9}, {3.495035461756825*^9, 
   3.495035462133491*^9}, {3.5141285471341753`*^9, 3.514128567878413*^9}, {
   3.514128756430716*^9, 3.514128813822275*^9}, 3.514128963129431*^9, {
   3.5263067712407312`*^9, 3.5263067765491943`*^9}, 3.526309663515263*^9, {
   3.5418606552107964`*^9, 
   3.541860664141345*^9}},ExpressionUUID->"5e68f65d-5a3a-45eb-86ad-\
cba00101c5b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCoefficientRulesAtStar", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "loopsAtStar"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"loopsAtStar", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"GraphLoops", "[", 
         RowBox[{"g", ",", "over"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "==", 
          RowBox[{"Vertex", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expansionCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<.... expanding coefficients (\>\"", ",", 
       RowBox[{"Length", "[", "loopsAtStar", "]"}], ",", "\"\<)\>\""}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", "over", ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"++", "expansionCounter"}], ",", "10000"}], "]"}], 
                 "\[Equal]", "0"}], ",", 
                RowBox[{"DebugPrint", "[", "expansionCounter", "]"}]}], "]"}],
               ";", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coefficients"}], ")"}], ",", 
                 RowBox[{"_List", "\[Rule]", "0"}]}], "]"}]}]}], ")"}], "&"}],
            "/@", "loopsAtStar"}], ",", 
          RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<.... finished expanding coefficients\>\"", "]"}],
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568944960772674*^9, 3.568944962076056*^9}, {
  3.568944997283513*^9, 
  3.568945055612793*^9}},ExpressionUUID->"1b28b298-86e9-4626-ad70-\
46b35aeed8cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GraphLoops", "[", 
    RowBox[{"g", ",", "over"}], "]"}], "/.", 
   RowBox[{"Dispatch", "[", 
    RowBox[{"coefficients", "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"otherLoopsZero", "[", 
       RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918764654952*^9, 3.445918801350953*^9}, {
   3.446850043013908*^9, 3.446850043211912*^9}, {3.4831145834081507`*^9, 
   3.483114586590336*^9}, {3.495035473221476*^9, 3.495035478606579*^9}, 
   3.526306784243189*^9, {3.52735085627771*^9, 3.52735085793367*^9}, {
   3.527351417968799*^9, 3.527351419103397*^9}, {3.527351463703415*^9, 
   3.5273514728851233`*^9}, {3.531756843000719*^9, 3.531756844746086*^9}, 
   3.541860675549159*^9},ExpressionUUID->"705ad936-9b95-4b59-9594-\
107fee76ef9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPACoefficientsAtStar", "[", 
    RowBox[{"X", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
      "G_", ",", "overs_", ",", "updown_", ",", "ps_", ",", "rules_"}], 
      "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"overs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "loops", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"loops", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"GraphLoops", "[", 
         RowBox[{"G", ",", "overs"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "==", 
          RowBox[{"Vertex", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"loops", "/.", 
       RowBox[{"X", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_Vertex", ",", "__"}], "}"}], "\[Rule]", "0"}], "}"}]}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568935291025585*^9, 3.568935491192604*^9}, {
  3.5689369463226967`*^9, 
  3.568936947170431*^9}},ExpressionUUID->"c978a585-1ccc-4bca-a421-\
4e130cb1561d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"GPA4Element", "[", "A", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527524282732582*^9, 3.527524320595593*^9}, {
  3.5535482938461523`*^9, 
  3.553548313010715*^9}},ExpressionUUID->"baee6cc9-18de-4844-ae75-\
bd5eadfaff24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VariableGPA4Element", "[", 
   RowBox[{
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"over", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "f_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{"g", ",", "over", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loop", ":", 
        RowBox[{"{", "_Vertex", "}"}]}], "\[RuleDelayed]", 
       RowBox[{"f", "[", "loop", "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918216196302*^9, 3.445918333769546*^9}, 
   3.446846264757764*^9, {3.4468632761677*^9, 3.4468632775638647`*^9}, {
   3.495035488350319*^9, 3.4950355078073797`*^9}, {3.52630679030429*^9, 
   3.526306797147773*^9}, {3.543347055755856*^9, 
   3.5433470757058363`*^9}},ExpressionUUID->"944044e4-dd52-474a-92b2-\
175d42f2760e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VariableGPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "f_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"up", "+", "down"}], "\[GreaterEqual]", "2"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{"g", ",", "over", ",", 
     RowBox[{"{", 
      RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loop", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PatternSequence", "[", 
           RowBox[{"_Vertex", ",", "_Integer"}], "]"}], ".."}], "}"}]}], 
       "\[RuleDelayed]", 
       RowBox[{"f", "[", "loop", "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918216196302*^9, 3.445918333769546*^9}, 
   3.446846264757764*^9, {3.4468632761677*^9, 3.4468632775638647`*^9}, {
   3.495035488350319*^9, 3.4950355078073797`*^9}, {3.52630679030429*^9, 
   3.526306797147773*^9}},ExpressionUUID->"1fbb6240-e41a-4d4a-ba5b-\
2b009809b98d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "initialVertices", ",", "finalVertices", ",", "pathsList", ",", 
      "matrices", ",", "coefficients"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"coefficients", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"(", 
        RowBox[{"values", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"otherLoopsZero", "[", 
           RowBox[{"up", "+", "down"}], "]"}], "}"}]}], ")"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"initialVertices", "=", 
      RowBox[{"GraphVertices", "[", 
       RowBox[{"g", ",", 
        RowBox[{
        "over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalVertices", "=", 
      RowBox[{"GraphVertices", "[", 
       RowBox[{"g", ",", 
        RowBox[{"over", "\[LeftDoubleBracket]", 
         RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pathsList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2"}], "}"}], ",", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "#1", ",", "#2", ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"over", ",", 
                   RowBox[{"up", "+", "1"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "#1", ",", "#2", ",", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Take", "[", 
                   RowBox[{"over", ",", 
                    RowBox[{
                    RowBox[{"-", "down"}], "-", "1"}]}], "]"}], "]"}]}], 
                "]"}]}], "}"}], "&"}], ",", "initialVertices", ",", 
            "finalVertices"}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_Vertex", ",", "_Vertex"}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"matrices", "=", 
      RowBox[{"pathsList", "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"initial_Vertex", ",", "final_Vertex"}], "}"}], ",", 
          "upPaths_List", ",", "downPaths_List"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"initial", ",", "final"}], "}"}], "\[Rule]", 
          RowBox[{"MatrixWrapper", "[", 
           RowBox[{
            RowBox[{"Length", "[", "upPaths", "]"}], ",", 
            RowBox[{"Length", "[", "downPaths", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Outer", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"GraphPathToGraphLoop", "[", 
                  RowBox[{"ConcatenatePaths", "[", 
                   RowBox[{"#1", ",", 
                    RowBox[{"Reverse", "[", "#2", "]"}]}], "]"}], "]"}], 
                 RowBox[{"(*", 
                  RowBox[{"#1", "~", "Join", "~", 
                   RowBox[{"Most", "[", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Most", "[", "#2", "]"}], "]"}], "]"}]}], "*)"}], 
                 "&"}], ",", "upPaths", ",", "downPaths", ",", "1"}], "]"}], "/.",
               "coefficients"}], ")"}]}], "]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
       "matrices"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446852873526499*^9, 3.446852978494426*^9}, {
   3.446853057325824*^9, 3.446853142093996*^9}, {3.4468531767790813`*^9, 
   3.4468533538510523`*^9}, {3.4468534247796087`*^9, 3.446853601265432*^9}, {
   3.483112169476403*^9, 3.483112172584948*^9}, {3.4831123954098387`*^9, 
   3.483112426914116*^9}, {3.483112471142396*^9, 3.483112530937632*^9}, {
   3.483113457163494*^9, 3.4831134708577538`*^9}, {3.483114518369149*^9, 
   3.4831145220588703`*^9}, {3.4831145991087418`*^9, 3.4831146262020607`*^9}, 
   3.483201873608914*^9, {3.49573427457148*^9, 3.495734299211946*^9}, {
   3.495734338815115*^9, 3.495734382508469*^9}, {3.495734425826035*^9, 
   3.495734463648521*^9}, {3.495734539099204*^9, 3.495734540230301*^9}, {
   3.495734575242765*^9, 3.495734580201084*^9}, {3.509393619580472*^9, 
   3.509393641546503*^9}, {3.509394397763919*^9, 3.50939439805066*^9}, {
   3.526306806289969*^9, 3.526306810912092*^9}, {3.526913922453621*^9, 
   3.526913926693471*^9}, {3.526914159168771*^9, 3.526914162519581*^9}, {
   3.526914229459149*^9, 3.526914267097204*^9}, {3.526914827771495*^9, 
   3.526914838093279*^9}, {3.526915093164542*^9, 3.526915095203786*^9}, 
   3.52735059567175*^9, {3.541860705329455*^9, 3.541860749583856*^9}, {
   3.7190822882533627`*^9, 3.719082306238373*^9}, {3.719083073811788*^9, 
   3.719083076330748*^9}},ExpressionUUID->"3db0fd3c-9094-4152-b9c1-\
fc94772ccc13"],

Cell[BoxData[{
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"rows_", ",", "columns_", ",", "m1_"}], "]"}], "+", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"rows_", ",", "columns_", ",", "m2_"}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"rows", ",", "columns", ",", 
    RowBox[{"m1", "+", "m2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", " ", 
  RowBox[{"\[Alpha]_", " ", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"rows_", ",", "columns_", ",", "m_"}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"rows", ",", "columns", ",", 
    RowBox[{"\[Alpha]", " ", "m"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"a_", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], "..."}], "}"}]}], "]"}], ".", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"0", ",", "b_", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"a", ",", "b", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"0", ",", "b_", ",", 
     RowBox[{"{", "}"}]}], "]"}], ".", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"b_", ",", "c_", ",", "m_"}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"0", ",", "c", ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"a_", ",", "b_", ",", "m_"}], "]"}], ".", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"b_", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], "..."}], "}"}]}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"a", ",", "0", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "a", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"a_", ",", "b_", ",", "m_"}], "]"}], ".", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"b_", ",", "c_", ",", "n_"}], "]"}]}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"a", ",", "c", ",", 
    RowBox[{"m", ".", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixWrapper", "/:", 
  RowBox[{"Inverse", "[", 
   RowBox[{"MatrixWrapper", "[", 
    RowBox[{"a_", ",", "a_", ",", "m_"}], "]"}], "]"}], ":=", 
  RowBox[{"MatrixWrapper", "[", 
   RowBox[{"a", ",", "a", ",", 
    RowBox[{"Inverse", "[", "m", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719082278785615*^9, 3.7190822812503843`*^9}, {
  3.719082328600606*^9, 3.71908236827593*^9}, {3.719082488281871*^9, 
  3.7190826069980907`*^9}, {3.719082829166987*^9, 3.719082844903823*^9}, {
  3.719083191696233*^9, 
  3.71908325359673*^9}},ExpressionUUID->"b3e196e8-b47a-4e85-826c-\
15230ddf2fa0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphPathToGraphLoop", "[", 
   RowBox[{"{", "v_Vertex", "}"}], "]"}], ":=", 
  RowBox[{"{", "v", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphPathToGraphLoop", "[", 
   RowBox[{"{", 
    RowBox[{"v_Vertex", ",", "o___", ",", "v_Vertex"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"v", ",", "o"}], "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526914180681253*^9, 
  3.526914225275237*^9}},ExpressionUUID->"cb4fb1cb-517d-42aa-b747-\
667dbf93d2b5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"GPA4Matrix", "/:", 
   RowBox[{
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"overBelow", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values1_"}], "]"}], ".", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"overAbove", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values2_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{"g", ",", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"overAbove", ",", "up"}], "]"}], "~", "Join", "~", 
      RowBox[{"Take", "[", 
       RowBox[{"overBelow", ",", 
        RowBox[{
         RowBox[{"-", "down"}], "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ".", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ")"}], 
       "&"}], "/@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"values1", ",", "values2"}], "}"}], "]"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457993397991*^9, 3.527458126490863*^9}, {
  3.5274582164819403`*^9, 3.527458216560038*^9}, {3.719082239063591*^9, 
  3.719082246983337*^9}, {3.71908262597762*^9, 
  3.719082632233129*^9}},ExpressionUUID->"30c3927b-5b4c-4de9-b1d6-\
4762d5675342"],

Cell[BoxData[
 RowBox[{"GPA4Matrix", "/:", 
  RowBox[{
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values1_"}], "]"}], "+", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values2_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ")"}], 
      "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"values1", ",", "values2"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457993397991*^9, 3.527458126490863*^9}, {
  3.5274582164819403`*^9, 3.527458216560038*^9}, {3.5274582780350037`*^9, 
  3.527458304648881*^9}},ExpressionUUID->"19d2b324-3e84-4aa7-9eae-\
13e327e334d4"],

Cell[BoxData[
 RowBox[{"GPA4Matrix", "/:", 
  RowBox[{"\[Alpha]_", " ", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       ")"}], "&"}], "/@", "values"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446854069411498*^9, 3.446854092233837*^9}, {
  3.483113506683384*^9, 3.483113512370974*^9}, {3.527458309725812*^9, 
  3.527458340654117*^9}},ExpressionUUID->"ed0f433a-3f58-4c70-b327-\
9f888734b99a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{"m_GPA4Matrix", ",", "newOver_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"AddStrandOnRight", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", "m", "]"}], ",", "newOver"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526914340097583*^9, 
  3.526914362823091*^9}},ExpressionUUID->"86ce5bf2-3cb0-497e-9524-\
6ae33a922d5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Element", "[", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_", ",", "up_"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"values", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"initial_Vertex", ",", "final_Vertex"}], "}"}], "\[Rule]", 
           RowBox[{"MatrixWrapper", "[", 
            RowBox[{"_", ",", "_", ",", "matrix_"}], "]"}]}], ")"}], 
         "\[RuleDelayed]", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"downPaths", "=", 
              RowBox[{"GraphPathsBetween", "[", 
               RowBox[{"g", ",", "initial", ",", "final", ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Take", "[", 
                  RowBox[{"over", ",", 
                   RowBox[{
                    RowBox[{"-", "down"}], "-", "1"}]}], "]"}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"upPaths", "=", 
              RowBox[{"GraphPathsBetween", "[", 
               RowBox[{"g", ",", "initial", ",", "final", ",", 
                RowBox[{"Take", "[", 
                 RowBox[{"over", ",", 
                  RowBox[{"up", "+", "1"}]}], "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "downPaths", "]"}], "\[Equal]", "0"}], 
              "\[Or]", 
              RowBox[{
               RowBox[{"Length", "[", "upPaths", "]"}], "\[Equal]", "0"}]}], 
             ",", 
             RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GraphPathToGraphLoop", "[", 
                    RowBox[{"ConcatenatePaths", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Reverse", "[", "#2", "]"}]}], "]"}], "]"}], 
                    "&"}], ",", "upPaths", ",", "downPaths", ",", "1"}], 
                  "]"}], ",", "matrix"}], "}"}], ",", "2"}], "]"}]}], "]"}]}],
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", 
      RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4468541589085197`*^9, 3.446854192485771*^9}, {
   3.446854241556961*^9, 3.4468543322057858`*^9}, {3.446854388516992*^9, 
   3.446854441315452*^9}, {3.483112282765861*^9, 3.483112286455879*^9}, {
   3.4831125485017853`*^9, 3.483112629054243*^9}, {3.483113531495997*^9, 
   3.483113539581093*^9}, {3.483114363793109*^9, 3.4831144341971893`*^9}, {
   3.483114640462757*^9, 3.483114660829763*^9}, {3.495734609051076*^9, 
   3.495734639609188*^9}, {3.495734677183556*^9, 3.495734714414648*^9}, {
   3.526306816474815*^9, 3.526306825247032*^9}, 3.526914666266273*^9, 
   3.526915098579204*^9, {3.541860779390648*^9, 3.54186078636581*^9}, {
   3.719082649923335*^9, 
   3.71908265544386*^9}},ExpressionUUID->"c26bfed2-dbd6-4a51-a542-\
3b26ba01db6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiply", "[", 
    RowBox[{
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overBelow", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "matrices1_"}], "]"}], ",", 
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overAbove", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "matrices2_"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"overBelow", ",", 
      RowBox[{"middle", "+", "1"}]}], "]"}], "\[Equal]", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", 
       RowBox[{
        RowBox[{"-", "middle"}], "-", "1"}]}], "]"}], "]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "=", 
       RowBox[{"Dispatch", "[", "matrices1", "]"}]}], ",", 
      RowBox[{"d2", "=", 
       RowBox[{"Dispatch", "[", "matrices2", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"g", ",", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"overAbove", ",", 
         RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
       RowBox[{"Take", "[", 
        RowBox[{"overBelow", ",", 
         RowBox[{"-", "down"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matrices1", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p", ":", 
          RowBox[{"{", 
           RowBox[{"_Vertex", ",", "_Vertex"}], "}"}]}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"p", "/.", "d1"}], "]"}], ">", "10"}], ",", 
             RowBox[{"DebugPrint", "[", 
              RowBox[{
              "\"\<multiplying matrices: \>\"", ",", "p", ",", 
               "\"\<, size: \>\"", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"p", "/.", "d1"}], "]"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"(", 
            RowBox[{"p", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "/.", "d1"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"p", "/.", "d2"}], ")"}]}]}], ")"}]}], ")"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535904203378104*^9, 3.535904239883841*^9}, {
  3.535904333043518*^9, 3.535904396458054*^9}, {3.535904458062447*^9, 
  3.5359044651919622`*^9}, {3.5359045616286983`*^9, 3.535904570814663*^9}, {
  3.536336243732449*^9, 3.536336288769788*^9}, {3.536609954331002*^9, 
  3.5366099672903023`*^9}, {3.719083297699973*^9, 
  3.719083330701562*^9}},ExpressionUUID->"00872ba6-575f-4780-a7b6-\
f0e0c92f28a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnDownTopRightCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnUpBottomLeftCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnUpBottomRightCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4989671236548634`*^9, 
  3.4989672122450542`*^9}},ExpressionUUID->"5f1c349d-810d-4484-942c-\
02ef3f161174"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotateOneClick", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"RotateOneClick", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPAFourierTransform", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPAFourierTransform", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5359162500428333`*^9, 3.535916257242651*^9}, {
  3.5431709025101833`*^9, 
  3.5431709204557247`*^9}},ExpressionUUID->"5ca16ed5-4e0f-4a0f-83ba-\
42b8559c28e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PartialTrace", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPA4Trace", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Trace", "[", 
   RowBox[{"GPA4Element", "[", "m", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPA4TraceEvaluation", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4TraceEvaluation", "[", 
   RowBox[{"GPA4Element", "[", "m", "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742508918722*^9, 3.535742544623703*^9}, {
  3.535743505215242*^9, 
  3.535743513464377*^9}},ExpressionUUID->"b4851fa8-6183-42f5-9012-\
2b068ad113d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BigraphWithDuals", "[", 
         RowBox[{"g_GradedBigraph", ",", "_DualData"}], "]"}], ",", 
        "_BigraphWithDuals"}], "}"}]}], ",", 
     RowBox[{"GPAElement", "[", 
      RowBox[{"g_", ",", "False", ",", 
       RowBox[{"{", 
        RowBox[{"down_", ",", "up_"}], "}"}], ",", "coefficients_"}], "]"}]}],
     "]"}], "/;", 
   RowBox[{"PivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "bump", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"bump", "[", 
       RowBox[{"Vertex", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
      RowBox[{"Vertex", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "2"}], "]"}], ",", "i", ",", "j"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bump", "[", "l_List", "]"}], ":=", 
      RowBox[{"bump", "/@", "l"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bump", "[", "i_Integer", "]"}], ":=", "i"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"G", ",", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"up", "+", "down"}], ")"}], "/", "2"}], "}"}]}], "]"}],
           ",", "1"}], "]"}], "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "\"\<Lopsided\>\"", ",", 
       RowBox[{"coefficients", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"bump", "[", "x", "]"}], "\[Rule]", "y"}], ")"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498216183087294*^9, 3.498216423108822*^9}, {
  3.498216460052444*^9, 3.498216519009164*^9}, {3.498216587871004*^9, 
  3.4982165902866898`*^9}, {3.4982166657080727`*^9, 3.49821679203172*^9}, {
  3.4982169679231043`*^9, 3.4982169700579643`*^9}, {3.509410954197535*^9, 
  3.509410957052739*^9}, {3.526060271456835*^9, 3.5260602878461323`*^9}, {
  3.5263068514278393`*^9, 
  3.5263068540438557`*^9}},ExpressionUUID->"f582e498-faa7-49c2-89f3-\
a50275d4b3c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPATensor", "[", 
    RowBox[{
     RowBox[{"A", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", "over1_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_Integer", ",", "up1_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients1_"}], "]"}]}], ",", 
     RowBox[{"B", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", "over2_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_Integer", ",", "up2_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients2_"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"over1", "\[LeftDoubleBracket]", 
     RowBox[{"up1", "+", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
    RowBox[{
    "over2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnDownTopLeftCorner", "[", 
     RowBox[{
      RowBox[{"GPAMultiply", "[", 
       RowBox[{
        RowBox[{"TurnDownTopRightCorner", "[", 
         RowBox[{"B", ",", "up2"}], "]"}], ",", 
        RowBox[{"TurnUpBottomLeftCorner", "[", 
         RowBox[{"A", ",", "down1"}], "]"}]}], "]"}], ",", "down1"}], "]"}], 
    ",", "up2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190329603963*^9, 3.499190543611251*^9}, {
  3.526306875030229*^9, 3.526306877809074*^9}, {3.5590009143920813`*^9, 
  3.5590009523250303`*^9}},ExpressionUUID->"ce19df29-48a0-4c44-b8c5-\
879f6acb0369"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAInverse", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",",
       "over_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "matrices_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "over", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "k"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"p", "\[Rule]", 
        RowBox[{"Inverse", "[", "m", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526320542235379*^9, 3.5263206406777773`*^9}, {
  3.5268321589295683`*^9, 3.526832161544159*^9}, {3.52683244044197*^9, 
  3.526832443144598*^9}},ExpressionUUID->"d5b68dbf-1484-4482-ba44-\
25de5605b947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAInverse", "[", "A_GPA4Element", "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"GPAInverse", "[", 
    RowBox[{"GPA4Matrix", "[", "A", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526320674328753*^9, 3.5263206889868402`*^9}, 
   3.52632072054714*^9},ExpressionUUID->"1cd923de-0ed6-4a05-8004-\
64b2906df6a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotate\[Pi]Clockwise", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnUpBottomLeftCorner", "[", 
     RowBox[{"A", ",", "down"}], "]"}], ",", "up"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562128144236*^9, 
  3.52656219365143*^9}},ExpressionUUID->"bca0a785-f132-48ee-9a8c-\
221acf7efd18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotate\[Pi]Counterclockwise", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"TurnUpBottomRightCorner", "[", 
     RowBox[{"A", ",", "down"}], "]"}], ",", "up"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562128144236*^9, 
  3.526562219706421*^9}},ExpressionUUID->"70bbc678-ba1d-4d4b-990d-\
391f30b7f495"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopRightCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomRightCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopLeftCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomLeftCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomRightCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopRightCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomLeftCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopLeftCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5261375694610033`*^9, 
  3.526137663123433*^9}},ExpressionUUID->"1986c579-7307-4a62-834c-\
5d7c4deda910"],

Cell[BoxData[
 RowBox[{"Clear", "[", "GPAMultiplyWithOffset", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526138843450274*^9, 
  3.526138847590329*^9}},ExpressionUUID->"af0ef047-a74f-45c5-946b-\
dc5274532824"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Positive", " ", "k", " ", "shifts", " ", "the", " ", "lower", " ", 
   "factor", " ", "to", " ", "the", " ", "right"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526134668025573*^9, 
  3.526134676651544*^9}},ExpressionUUID->"907efbeb-cf16-4824-bf37-\
89876fe4f24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"k", "+", "up1"}], "\[GreaterEqual]", "down2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopLeftCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomRightCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopRightCorner", "[", 
              RowBox[{"lower", ",", 
               RowBox[{"k", "+", "up1", "-", "down2"}]}], "]"}], ",", 
             RowBox[{"TurnUpBottomLeftCorner", "[", 
              RowBox[{"upper", ",", "k"}], "]"}]}], "]"}], ",", 
           RowBox[{"k", "+", "up1", "-", "down2"}]}], "]"}], ",", "k"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.5141292908764544`*^9, 3.514129319545826*^9}, {
  3.514129491913278*^9, 3.514129500543997*^9}, {3.526137675956966*^9, 
  3.526137698119102*^9}, {3.526138511065794*^9, 3.526138535413191*^9}, {
  3.5263069006863403`*^9, 
  3.526306903994853*^9}},ExpressionUUID->"53f2ca6c-6ce9-407a-89ae-\
7f2945ef879b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"k", "+", "up1"}], "<", "down2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopLeftCorner", "[", 
        RowBox[{
         RowBox[{"TurnDownTopRightCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{"lower", ",", 
             RowBox[{"TurnUpBottomRightCorner", "[", 
              RowBox[{
               RowBox[{"TurnUpBottomLeftCorner", "[", 
                RowBox[{"upper", ",", "k"}], "]"}], ",", 
               RowBox[{"down2", "-", "k", "-", "up1"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"down2", "-", "k", "-", "up1"}]}], "]"}], ",", "k"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.5141292908764544`*^9, 3.514129319545826*^9}, {
  3.514129491913278*^9, 3.514129500543997*^9}, {3.526137675956966*^9, 
  3.526137698119102*^9}, {3.526138557353169*^9, 3.526138559175622*^9}, {
  3.526138593751574*^9, 3.5261386422493353`*^9}, {3.5261386779570017`*^9, 
  3.5261386900457687`*^9}, {3.526306916389863*^9, 
  3.526306918456623*^9}},ExpressionUUID->"a1d40a33-7e83-4df4-b6b8-\
820539d92699"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k"}], "+", "down2"}], "\[GreaterEqual]", "up1"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopRightCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomLeftCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopLeftCorner", "[", 
              RowBox[{"lower", ",", 
               RowBox[{"-", "k"}]}], "]"}], ",", 
             RowBox[{"TurnUpBottomRightCorner", "[", 
              RowBox[{"upper", ",", 
               RowBox[{
                RowBox[{"-", "k"}], "+", "down2", "-", "up1"}]}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"-", "k"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"-", "k"}], "+", "down2", "-", "up1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.499192481977853*^9, 3.499192482336419*^9}, {
  3.499192519318386*^9, 3.499192601166832*^9}, {3.514129327418623*^9, 
  3.5141293323715553`*^9}, {3.514129504633462*^9, 3.514129505208865*^9}, {
  3.5261377016431313`*^9, 3.526137722601585*^9}, {3.526138708614337*^9, 
  3.526138734214877*^9}, {3.526306924605708*^9, 
  3.526306927023225*^9}},ExpressionUUID->"241189c1-36bf-42b7-8c4d-\
6adf3e0ad17d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k"}], "+", "down2"}], "<", "up1"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomLeftCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopRightCorner", "[", 
              RowBox[{
               RowBox[{"TurnDownTopLeftCorner", "[", 
                RowBox[{"lower", ",", 
                 RowBox[{"-", "k"}]}], "]"}], ",", 
               RowBox[{"up1", "+", "k", "-", "down2"}]}], "]"}], ",", 
             "upper"}], "]"}], ",", 
           RowBox[{"-", "k"}]}], "]"}], ",", 
         RowBox[{"up1", "+", "k", "-", "down2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.499192481977853*^9, 3.499192482336419*^9}, {
  3.499192519318386*^9, 3.499192601166832*^9}, {3.514129327418623*^9, 
  3.5141293323715553`*^9}, {3.514129504633462*^9, 3.514129505208865*^9}, {
  3.5261377016431313`*^9, 3.526137722601585*^9}, {3.526138751132427*^9, 
  3.5261388387555637`*^9}, {3.526306928717555*^9, 
  3.526306930714943*^9}},ExpressionUUID->"32ccc77d-7b58-4869-8c34-\
a7948e14f7b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplifyCoefficients", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"pivotalStructure", ",", "\"\<Spherical\>\"", ",", 
    RowBox[{"RootReduce", "[", "x", "]"}], ",", "\"\<Lopsided\>\"", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", 
        RowBox[{
        "_AlgebraicNumber", "|", "_Integer", "|", "_Rational", "|", 
         "_Real"}]}], "]"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Panic --- not an AlgebraicNumber: \>\"", ",", "x"}], 
        "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499192227845319*^9, 3.4991922359725637`*^9}, {
  3.499225700049974*^9, 3.499225714247746*^9}, {3.526307525941434*^9, 
  3.526307545054496*^9}, {3.5263075921818666`*^9, 3.526307630196184*^9}, {
  3.526320886334474*^9, 3.526320888030036*^9}, {3.5265727031284647`*^9, 
  3.5265727045994453`*^9}, {3.578798820615964*^9, 
  3.5787988216162987`*^9}},ExpressionUUID->"def460a5-bacb-49ba-b062-\
d12a4b205d66"],

Cell[BoxData[
 RowBox[{"Clear", "[", "ConnectionGrid", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190573438545*^9, 
  3.499190576709388*^9}},ExpressionUUID->"866ebef8-1689-4f60-99c3-\
fe6687ff9d68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499191817235577*^9, 3.4991918815446863`*^9}, {
  3.526135520511448*^9, 
  3.5261355219507523`*^9}},ExpressionUUID->"3aa243db-7ed2-4696-935b-\
62f88a0c5732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PivotalStructure", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", "pivotalStructure"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526307646726097*^9, 3.5263076506417637`*^9}, {
  3.526307700129147*^9, 
  3.526307707613092*^9}},ExpressionUUID->"c63b5602-264e-4004-9fcb-\
12950fb47fa8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ":=", 
  "conn"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PivotalStructure", "[", "conn", "]"}], "\[Equal]", 
     "\"\<Spherical\>\""}], ",", 
    RowBox[{"GPAConjugate", "[", "conn", "]"}], ",", 
    RowBox[{"GPAInverse", "[", "conn", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190685498457*^9, 3.499190716412488*^9}, {
   3.499190789295823*^9, 3.499190789455349*^9}, {3.499190827934558*^9, 
   3.4991908618194437`*^9}, {3.4991920623307447`*^9, 3.499192201246724*^9}, {
   3.514126238831085*^9, 3.514126279237733*^9}, 3.514562418999177*^9, {
   3.5263207532752237`*^9, 
   3.526320769648753*^9}},ExpressionUUID->"bf031434-db35-46a2-994a-\
c38ba457a78e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", "start_", ",", "orientation_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"1", ",", "1", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{
    RowBox[{"TurnUpBottomRightCorner", "[", 
     RowBox[{"TurnDownTopLeftCorner", "[", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{"orientation", ",", "1", ",", "pp", ",", 
           RowBox[{"-", "1"}], ",", "ss"}], "]"}], "[", "start", "]"}], ",", 
        "orientation"}], "]"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{"x", "\[Rule]", 
       RowBox[{"simplifyCoefficients", "[", 
        RowBox[{"y", ",", 
         RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}], 
      ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.499192205003048*^9, {3.499192243255636*^9, 3.499192264350164*^9}, {
   3.514126285919791*^9, 3.5141263054152803`*^9}, {3.526307713459333*^9, 
   3.526307715863739*^9}},ExpressionUUID->"cd382ca5-b45f-40a9-9c54-\
265ae267424e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
    RowBox[{"1", ",", "k_", ",", "start_", ",", "orientation_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "2"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"1", ",", "k", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing ConnectionGrid for 1, \>\"", ",", "k", ",", " ", 
        "\"\<, \>\"", ",", "start", ",", "\"\<, \>\"", ",", "orientation"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GPAMultiplyWithOffset", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"k", ",", "2"}], "]"}], ",", "orientation"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "_"}], "}"}], ",", "start", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"pp", "[", "start", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"ss", "[", "start", "]"}]}], "]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"k", "-", "1"}]], "orientation"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"1", ",", 
           RowBox[{"k", "-", "1"}], ",", "start", ",", "orientation"}], "]"}],
          ",", 
         RowBox[{"k", "-", "1"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"x", "\[Rule]", 
          RowBox[{"simplifyCoefficients", "[", 
           RowBox[{"y", ",", 
            RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}], 
         ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190863489356*^9, 3.49919096097261*^9}, {
  3.49919141475217*^9, 3.499191469418664*^9}, {3.499191520791514*^9, 
  3.499191532319525*^9}, {3.499191676972334*^9, 3.499191693884076*^9}, {
  3.49919193586535*^9, 3.499192039590765*^9}, {3.499192395573122*^9, 
  3.4991924082894697`*^9}, {3.514126288889303*^9, 3.514126323318297*^9}, {
  3.514128093851872*^9, 3.514128136370516*^9}, {3.514128229911673*^9, 
  3.514128274833099*^9}, {3.526307720595448*^9, 
  3.526307720715124*^9}},ExpressionUUID->"7ba8795d-ae22-4d6b-a7a9-\
f36566bc5e78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
    RowBox[{"j_", ",", "k_", ",", "start_", ",", "orientation_"}], "]"}], "/;", 
   RowBox[{"j", "\[GreaterEqual]", "2"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"j", ",", "k", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simplifyCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing ConnectionGrid for \>\"", ",", "j", ",", " ", 
        "\"\<, \>\"", ",", "k", ",", " ", "\"\<, \>\"", ",", "start", ",", 
        "\"\<, \>\"", ",", "orientation"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"GPAMultiplyWithOffset", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", "k", ",", "start", ",", 
          "orientation"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{"1", ",", "k", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"j", ",", "2"}], "]"}], ",", "orientation"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "_"}], "}"}], ",", "start", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"ss", "[", "start", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"pp", "[", "start", "]"}]}], "]"}], ",", 
          RowBox[{"orientation", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"j", "-", "1"}]]}]}], "]"}], ",", 
        RowBox[{"1", "-", "j"}]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"x", "\[Rule]", "y"}], "]"}], ";", 
         RowBox[{"simplifyCounter", "++"}], ";", 
         RowBox[{"x", "\[Rule]", 
          RowBox[{"simplifyCoefficients", "[", 
           RowBox[{"y", ",", 
            RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}]}], 
        ")"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499192425174905*^9, 3.499192441574991*^9}, {
   3.4991926135719967`*^9, 3.4991926148836927`*^9}, {3.499192652473333*^9, 
   3.499192722542179*^9}, {3.499192770455518*^9, 3.4991927753184032`*^9}, {
   3.499192870496284*^9, 3.499192872845664*^9}, 3.4991929990315228`*^9, 
   3.499193046705984*^9, {3.499193135206971*^9, 3.4991931521488533`*^9}, 
   3.514126292107977*^9, {3.514126326086692*^9, 3.5141263301352043`*^9}, {
   3.5141281391136913`*^9, 3.514128160364169*^9}, {3.5141294398392773`*^9, 
   3.514129449742627*^9}, {3.514129548407345*^9, 3.514129554133757*^9}, {
   3.514129998243469*^9, 3.514130002058208*^9}, {3.526307728170039*^9, 
   3.52630772837722*^9}},ExpressionUUID->"1efb48f4-ca4c-44e7-ab65-\
c81801ef91b0"],

Cell[BoxData[
 RowBox[{"Clear", "[", "StrandCrossingAbove", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562585665287*^9, 
  3.526562589374934*^9}},ExpressionUUID->"33f24009-b2e3-4acf-9d14-\
3cd737d00359"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newOver", "=", 
      RowBox[{
       RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{"A", ",", "newOver"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5265626499164267`*^9, 3.526562656867133*^9}, {
  3.526562744023058*^9, 3.526562805223085*^9}, {3.543456480722158*^9, 
  3.543456526109194*^9}, {3.5434571819294653`*^9, 3.543457207447446*^9}, {
  3.5434573001967287`*^9, 
  3.54345732598496*^9}},ExpressionUUID->"1cfcb359-5647-46fe-8b27-\
ee3403d3787a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newOver", "=", 
      RowBox[{"ss", "[", 
       RowBox[{"ss", "[", 
        RowBox[{
        "over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{"A", ",", "newOver"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5265626499164267`*^9, 3.526562656867133*^9}, {
  3.526562744023058*^9, 
  3.526562805223085*^9}},ExpressionUUID->"4a3b525c-4de5-4a56-8dde-\
b9f662b70a47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
    RowBox[{"A", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "1"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "firstOrientation", ",", "newOver", ",", "strandOnRight", ",", 
      "connections", ",", "offsets"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<Starting StrandCrossingAbove on \>\"", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Most", "[", "A", "]"}], ",", "\"\<...\>\""}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"firstOrientation", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ss", "[", 
          RowBox[{"over", "\[LeftDoubleBracket]", 
           RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], "==", 
         RowBox[{
         "over", "\[LeftDoubleBracket]", "up", "\[RightDoubleBracket]"}]}], 
        ",", "1", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newOver", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"firstOrientation", "==", "1"}], ",", 
        RowBox[{"pp", "[", 
         RowBox[{"over", "\[LeftDoubleBracket]", 
          RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
        RowBox[{"ss", "[", 
         RowBox[{"over", "\[LeftDoubleBracket]", 
          RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "firstOrientation", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "newOver", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"strandOnRight", "=", 
      RowBox[{"AddStrandOnRight", "[", 
       RowBox[{"A", ",", "newOver"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"connections", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{
          "over", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"firstOrientation", " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"k", "-", "up"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "up", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"offsets", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"up", "-", "1"}], ")"}]}], ",", "0", ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"Most", "[", "strandOnRight", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"Most", "/@", "connections"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GPAMultiplyWithOffset", "[", 
         RowBox[{"#1", ",", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], ",", "strandOnRight", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"connections", ",", " ", "offsets"}], "}"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526134973957067*^9, 3.526134993637663*^9}, {
   3.5261350438434267`*^9, 3.526135061883203*^9}, {3.526135248343408*^9, 
   3.5261352560078373`*^9}, {3.526135295029649*^9, 3.526135374162925*^9}, {
   3.526135409020632*^9, 3.526135435477069*^9}, {3.526135497651334*^9, 
   3.526135505188346*^9}, {3.5261356234273148`*^9, 3.526135655635415*^9}, {
   3.526135687880814*^9, 3.526135749501404*^9}, {3.5261357841195087`*^9, 
   3.526135838503162*^9}, {3.526136015615679*^9, 3.526136016326831*^9}, {
   3.526136120482799*^9, 3.526136122672361*^9}, {3.526136364785164*^9, 
   3.526136367961382*^9}, {3.526136848762372*^9, 3.526136872781806*^9}, {
   3.526136994446784*^9, 3.5261370022673473`*^9}, {3.526137243120163*^9, 
   3.526137253745852*^9}, {3.526137326059016*^9, 3.526137326473509*^9}, 
   3.526147953155119*^9, 3.526307000180827*^9, {3.526562594925476*^9, 
   3.526562599099174*^9}, {3.526562636521864*^9, 3.526562636596836*^9}, {
   3.526566045765917*^9, 3.526566054518894*^9}, {3.568058418625958*^9, 
   3.5680585075996*^9}},ExpressionUUID->"e4de8ab4-2689-422c-861d-\
9d2fae2b39fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingBelow", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Rotate\[Pi]Counterclockwise", "[", 
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", 
    RowBox[{"Rotate\[Pi]Clockwise", "[", "A", "]"}], "]"}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.526562029630855*^9, 3.5265620867039824`*^9}, {
  3.52656214574338*^9, 3.526562156149353*^9}, {3.5265622343861017`*^9, 
  3.52656224277794*^9}, {3.526562403288769*^9, 
  3.526562404771101*^9}},ExpressionUUID->"2cbd58dc-27f1-4192-aeb0-\
b6a5a9b36590"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "bad", " ", "implementation", " ", "prepares", " ", "a", " ", 
    "giant", " ", "grid", " ", "first"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatness", "[", "conn_", "]"}], "[", 
     RowBox[{"A", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], ")"}], ".."}]}], "}"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GPAMultiply", "[", 
      RowBox[{"A", ",", 
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{"TurnUpBottomRightCorner", "[", 
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"2", ",", "up", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], "]"}], "-", " ", 
     RowBox[{"TurnUpBottomLeftCorner", "[", 
      RowBox[{"TurnUpBottomLeftCorner", "[", 
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}]}]}], 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, 3.526307007011527*^9, {3.526562252771318*^9, 
   3.526562269529565*^9}},ExpressionUUID->"17724db3-27ea-4121-b964-\
31bf9146f7dd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"FIXME", ":", " ", 
   RowBox[{
   "replace", " ", "the", " ", "constants", " ", "passed", " ", "to", " ", 
    RowBox[{"AddStrandOnRight", "."}]}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526147424261018*^9, 3.526147437924472*^9}, {
  3.526147784326065*^9, 
  3.5261477926858263`*^9}},ExpressionUUID->"e775e178-d46c-461a-b533-\
92b94b78c35b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TwoStrandFlatness", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ")"}], ".."}]}], "}"}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"0", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{
     RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", 
     RowBox[{"TurnDownTopLeftCorner", "[", 
      RowBox[{
       RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", "A", "]"}], 
      "]"}], "]"}], "]"}], "-", " ", 
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{
     RowBox[{"TurnDownTopRightCorner", "[", 
      RowBox[{
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
     "2"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, {3.5261473167012444`*^9, 3.526147332433848*^9}, {
   3.526148267311434*^9, 3.5261482870149193`*^9}, {3.526148890097692*^9, 
   3.526148896129068*^9}, {3.5261742010495577`*^9, 3.5261742011360292`*^9}, 
   3.526307028302812*^9, {3.526564887561133*^9, 
   3.526564888544178*^9}},ExpressionUUID->"2516d1cc-a8a0-4c10-8a06-\
d3b6dca08b14"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OneStrandFlatness", "[", "conn_", "]"}], "[", 
   RowBox[{"A_GPA4Element", ",", "B_GPA4Element"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", "A", "]"}], "-", 
   RowBox[{
    RowBox[{"StrandCrossingBelow", "[", "conn", "]"}], "[", "B", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, {3.5261473167012444`*^9, 3.526147332433848*^9}, {
   3.526148267311434*^9, 3.5261482870149193`*^9}, {3.526148890097692*^9, 
   3.526148896129068*^9}, {3.5261742010495577`*^9, 3.5261742011360292`*^9}, 
   3.526307028302812*^9, {3.526562385585651*^9, 3.526562394040291*^9}, {
   3.526562463836047*^9, 3.526562468058806*^9}, {3.52656285423568*^9, 
   3.526562878144616*^9}},ExpressionUUID->"2ea2c3fa-c8e8-48d5-9250-\
cc4bbbcdc411"],

Cell[BoxData[
 RowBox[{"Clear", "[", "FusionRulesFromConnection", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517072650345944*^9, 
  3.517072653989903*^9}},ExpressionUUID->"e6ad5000-6e71-4846-8d36-\
3af9047a778f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FusionRulesFromConnection", "[", 
     RowBox[{"G_", ",", "conn_"}], "]"}], "[", 
    RowBox[{"a_Vertex", ",", "b_Vertex", ",", "c_Vertex"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "\[And]", 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "\[And]", 
     RowBox[{
      RowBox[{"b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
     ")"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "star", ",", "starover", ",", "overa", ",", "overb", ",", "overac", ",", 
      "overbc", ",", "pa", ",", "pb", ",", "psac", ",", "psbc", ",", "grid1", 
      ",", "grid2", ",", "loops"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"starover", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"star", "=", 
      RowBox[{"Vertex", "[", 
       RowBox[{
        RowBox[{"Sequence", "@@", "starover"}], ",", "0", ",", "1"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"overa", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"starover", "+", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pa", "=", 
      RowBox[{
       RowBox[{"GraphPathsBetween", "[", 
        RowBox[{"G", ",", "star", ",", "a", ",", "overa"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"overb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"starover", "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pb", "=", 
      RowBox[{
       RowBox[{"GraphPathsBetween", "[", 
        RowBox[{"G", ",", "star", ",", "b", ",", "overb"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"overac", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psac", "=", 
      RowBox[{"GraphPathsBetween", "[", 
       RowBox[{"G", ",", "a", ",", "c", ",", "overac"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "psac", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"overbc", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "+", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psbc", "=", 
      RowBox[{"GraphPathsBetween", "[", 
       RowBox[{"G", ",", "b", ",", "c", ",", "overbc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "psbc", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"grid1", "=", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{
        RowBox[{"PathLength", "[", "pa", "]"}], ",", 
        RowBox[{"PathLength", "[", "pb", "]"}], ",", "starover", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"grid2", "=", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{
        RowBox[{"PathLength", "[", "pb", "]"}], ",", 
        RowBox[{"PathLength", "[", "pa", "]"}], ",", "starover", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<Finished preparing connection grids.\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"loops", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ConcatenatePaths", "[", 
             RowBox[{"pa", ",", "#1", ",", 
              RowBox[{"Reverse", "[", "#2", "]"}], ",", 
              RowBox[{"Reverse", "[", "pb", "]"}]}], "]"}], "]"}], "&"}], ",",
           "psac", ",", "psbc", ",", "1"}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{
       RowBox[{"Length", "[", "loops", "]"}], ",", 
       "\"\< loops to evaluate\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"grid1", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReverseLoop", "[", "#", "]"}], "/.", 
            RowBox[{"grid2", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}], "&"}], 
        "/@", "loops"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5146571191742*^9, 3.514657139248645*^9}, {
   3.514657192055806*^9, 3.514657211143649*^9}, {3.51584863537948*^9, 
   3.515848643409967*^9}, {3.515848701225958*^9, 3.5158487027868967`*^9}, {
   3.515848768008497*^9, 3.515848774371203*^9}, {3.5158488245849857`*^9, 
   3.515848835755377*^9}, {3.515848926468884*^9, 3.515849039655698*^9}, {
   3.515849073952334*^9, 3.51584911623736*^9}, {3.515849193033886*^9, 
   3.515849296505486*^9}, {3.515849386745741*^9, 3.51584941503714*^9}, {
   3.5158494597710953`*^9, 3.515849502430296*^9}, {3.515849540694437*^9, 
   3.515849571051194*^9}, {3.5158496173046713`*^9, 3.515849629877719*^9}, {
   3.515849676537899*^9, 3.515849865887525*^9}, {3.515850044110879*^9, 
   3.5158500720408792`*^9}, {3.515850143316625*^9, 3.5158501799253893`*^9}, {
   3.515850290434093*^9, 3.515850298138954*^9}, {3.515850350704995*^9, 
   3.515850365211248*^9}, {3.515850411120943*^9, 3.515850415096653*^9}, {
   3.5158504603781*^9, 3.515850461227971*^9}, {3.5158504970947857`*^9, 
   3.5158505177180767`*^9}, {3.515850567188191*^9, 3.515850593594096*^9}, {
   3.515850742534657*^9, 3.5158507726627903`*^9}, {3.515850834595726*^9, 
   3.515850888398594*^9}, {3.515850977008781*^9, 3.5158509872569313`*^9}, {
   3.515851155369659*^9, 3.515851157064571*^9}, {3.515998443596684*^9, 
   3.5159984587267923`*^9}, {3.517072648304421*^9, 3.5170726488633966`*^9}, {
   3.517072717201757*^9, 3.5170727663738213`*^9}, {3.517075925202694*^9, 
   3.517075947231166*^9}, {3.517077532342702*^9, 3.5170776255699587`*^9}, 
   3.51707774932456*^9, {3.518270360966504*^9, 3.518270370620533*^9}, {
   3.5182704241706057`*^9, 3.518270462384837*^9}, {3.518270506485292*^9, 
   3.518270511492735*^9}, {3.5182705548839893`*^9, 3.518270568533863*^9}, {
   3.518270635343031*^9, 3.5182706376228447`*^9}, {3.518271806018564*^9, 
   3.5182718064817743`*^9}},ExpressionUUID->"cf544687-97b4-478e-886c-\
3efe16ce1e00"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low weight spaces", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526067533582776*^9, 
  3.526067536872805*^9}},ExpressionUUID->"89b9563f-9650-4eea-a5e5-\
307065af084c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveTwoTermEquations", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "constantConditions", ",", "oneVariableConditions", ",", 
      "twoVariableConditions", ",", "sortedConditions", ",", "condition", ",",
       "targetVariable", ",", "solutions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sortedConditions", "=", "conditions"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... sorting conditions\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "constantConditions", ",", "oneVariableConditions", ",", 
           "twoVariableConditions", ",", "sortedConditions"}], "}"}], "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sow", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Union", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"#", ",", "variablePattern", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "]"}], 
                   "]"}], "/.", 
                  RowBox[{
                   RowBox[{"n_", "/;", 
                    RowBox[{"n", "\[GreaterEqual]", "3"}]}], "\[RuleDelayed]",
                    "\[Infinity]"}]}]}], "]"}], "&"}], "/@", 
              "sortedConditions"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "2", ",", "\[Infinity]"}], "}"}]}], 
            "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"constantConditions", ",", "0"}], "]"}], "]"}], ">", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "DebugPrint", "[", 
            "\"\<... no solution! This should be impossible; 0 always \
works.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"DebugPrint", "[", "constantConditions", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<... found \>\"", ",", 
          RowBox[{"Length", "[", "oneVariableConditions", "]"}], ",", 
          "\"\< and \>\"", ",", " ", 
          RowBox[{"Length", "[", "twoVariableConditions", "]"}], ",", 
          "\"\< one- and two-variable conditions.\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "oneVariableConditions", "]"}], "+", 
          RowBox[{"Length", "[", "twoVariableConditions", "]"}]}], ">", 
         "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{"oneVariableConditions", ",", "variablePattern", ",", 
            RowBox[{
             RowBox[{"RootReduce", "[", 
              RowBox[{"Together", "[", "#", "]"}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", ":", "variablePattern"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "=", "0"}], ")"}]}], ",", "\[Infinity]"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"condition", "=", 
             RowBox[{"Collect", "[", 
              RowBox[{"#", ",", "variablePattern", ",", "Together"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"condition", "=!=", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"targetVariable", "=", 
                RowBox[{"First", "[", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{"condition", ",", "variablePattern", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                   "variablePreferenceFunction"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"solutions", "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"condition", "\[Equal]", "0"}], ",", 
                  "targetVariable"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "solutions", "]"}], "\[Equal]", 
                  "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Collect", "[", 
                   RowBox[{
                    RowBox[{
                    "solutions", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "variablePattern", ",", 
                    "Together"}], "]"}], "/.", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
                   
                   RowBox[{"(", 
                    RowBox[{"x", "=", "y"}], ")"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<Something went wrong:\>\"", ",", "condition", ",", 
                    "\"\< \>\"", ",", "solutions"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], ")"}], "&"}], "/@", "twoVariableConditions"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "sortedConditions"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4668657851027193`*^9, 3.466865842008328*^9}, {
   3.466865886018044*^9, 3.4668659172220573`*^9}, {3.4668676450338163`*^9, 
   3.46686765414299*^9}, 
   3.46686772570022*^9},ExpressionUUID->"1f8e3711-fdfa-4837-8bef-\
2a1ddb6e9dfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VertexPreferences", "[", "g_GradedBigraph", "]"}], "[", 
   RowBox[{"Vertex", "[", 
    RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"LopsidedDimension", "[", 
     RowBox[{"g", ",", 
      RowBox[{"Vertex", "[", 
       RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}]}], "+", 
   RowBox[{"0.1", " ", "k"}], "+", 
   RowBox[{"0.01", "d"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459684862396517`*^9, 3.4459684960299177`*^9}, {
  3.4459685261325808`*^9, 3.445968570840234*^9}, {3.445968741354023*^9, 
  3.445968746956993*^9}, {3.44596883257246*^9, 3.445968838021318*^9}, {
  3.446846238711916*^9, 3.4468462393785677`*^9}, {3.526067912944121*^9, 
  3.526067923542611*^9}},ExpressionUUID->"0f55165e-1ffa-4be5-b922-\
3d61aa2026b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LoopPreferences", "[", "g_", "]"}], "[", "loop_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.", "+", 
      RowBox[{".01", "k"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "loop", "]"}], "/", "2"}]}], "}"}]}], "]"}], 
   ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"VertexPreferences", "[", "g", "]"}], "/@", 
     RowBox[{"loop", "\[LeftDoubleBracket]", 
      RowBox[{";;", ";;", "2"}], "\[RightDoubleBracket]"}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445968563682519*^9, 3.445968598231353*^9}, {
  3.445968691730507*^9, 3.4459686970883493`*^9}, {3.445968902713396*^9, 
  3.445968972588442*^9}, {3.4461710494049273`*^9, 
  3.446171066106533*^9}},ExpressionUUID->"5539ed72-11a1-4cb8-b79c-\
456bf2b68405"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LowestWeightEigenvectorConditions", "[", 
    RowBox[{
     RowBox[{"k", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "2"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "\[Lambda]0", "]"}], ",", 
        RowBox[{"ToNumberField", "[", 
         RowBox[{
          RowBox[{"RootReduce", "[", "\[Lambda]0", "]"}], ",", 
          RowBox[{"NumberFieldGenerator", "[", 
           RowBox[{
           "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "]"}], ",", "\[Lambda]0"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], ",", 
       RowBox[{
        RowBox[{"EnlargeNumberField", "[", 
         RowBox[{"k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "[", "\[Lambda]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing second cap\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", 
          RowBox[{"RotateOneClick", "[", "k", "]"}], "]"}], "]"}]}], ")"}], 
      "\[IndentingNewLine]", "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing first cap\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", "k", "]"}], "]"}]}], ")"}], "~", "Join", 
      "~", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing rotation\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{
          RowBox[{"RotateTwoClicks", "[", "k", "]"}], "-", 
          RowBox[{"\[Lambda]", " ", "k"}]}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445919393006501*^9, 3.445919401849578*^9}, {
   3.445919505999041*^9, 3.445919508006422*^9}, {3.445969726619781*^9, 
   3.4459698283466253`*^9}, {3.446141299513878*^9, 3.4461413022485943`*^9}, {
   3.446149684604862*^9, 3.446149744641642*^9}, {3.4461699495977907`*^9, 
   3.446169959725525*^9}, {3.446850050073351*^9, 3.446850058687944*^9}, {
   3.446909712188327*^9, 3.4469097435616198`*^9}, {3.446910582277701*^9, 
   3.446910597450952*^9}, {3.469138329847617*^9, 3.4691383823504877`*^9}, 
   3.481811417953023*^9, {3.48181334024564*^9, 3.481813343834915*^9}, {
   3.508773686280005*^9, 3.508773692253665*^9}, {3.50877376957824*^9, 
   3.508773835937017*^9}, {3.508773952612857*^9, 3.508773955677393*^9}, {
   3.510589726316659*^9, 3.5105897302994127`*^9}, 3.526067580141732*^9, 
   3.526067619750063*^9, {3.526067690901224*^9, 3.526067732356963*^9}, 
   3.526307093233986*^9, {3.5263074297560997`*^9, 3.526307440706038*^9}, {
   3.5287125864103518`*^9, 
   3.528712591897493*^9}},ExpressionUUID->"89152bc6-2bc8-4917-a7b0-\
df1cdad449d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], ":=", 
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433455142273607`*^9, 
  3.543345535797127*^9}},ExpressionUUID->"c30444c6-2658-4be5-9032-\
3e0af6adc99d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433455797770157`*^9, 
  3.5433455851011133`*^9}},ExpressionUUID->"61d5cb21-fbb6-4aca-9a03-\
3001386b987d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LowestWeightConditions", "[", 
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "2"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"NestList", "[", 
        RowBox[{"RotateOneClick", ",", "k", ",", 
         RowBox[{"up", "+", "down", "-", "1"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445919393006501*^9, 3.445919401849578*^9}, {
   3.445919505999041*^9, 3.445919508006422*^9}, {3.445969726619781*^9, 
   3.4459698283466253`*^9}, {3.446141299513878*^9, 3.4461413022485943`*^9}, {
   3.446149684604862*^9, 3.446149744641642*^9}, {3.4461699495977907`*^9, 
   3.446169959725525*^9}, {3.446850050073351*^9, 3.446850058687944*^9}, {
   3.446909712188327*^9, 3.4469097435616198`*^9}, {3.446910582277701*^9, 
   3.446910597450952*^9}, {3.469138329847617*^9, 3.4691383823504877`*^9}, 
   3.481811417953023*^9, {3.48181334024564*^9, 3.481813343834915*^9}, {
   3.508773686280005*^9, 3.508773692253665*^9}, {3.50877376957824*^9, 
   3.508773835937017*^9}, {3.508773952612857*^9, 3.508773955677393*^9}, {
   3.510589726316659*^9, 3.5105897302994127`*^9}, 3.526067580141732*^9, 
   3.526067619750063*^9, {3.526067690901224*^9, 3.526067732356963*^9}, 
   3.526307093233986*^9, {3.5263074297560997`*^9, 3.526307440706038*^9}, {
   3.5287125864103518`*^9, 3.528712591897493*^9}, {3.528727760315473*^9, 
   3.528727781791004*^9}, {3.5287278172138853`*^9, 3.528727830749028*^9}, 
   3.529846162301258*^9},ExpressionUUID->"84a9640a-e1be-40fa-a754-\
603dc27fb158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"k", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345461681632*^9, 3.543345488053504*^9}, 
   3.543345541436172*^9},ExpressionUUID->"a9975930-c95f-4f33-b99c-\
d8ccb764303f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"k", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345562121532*^9, 
  3.5433455656485662`*^9}},ExpressionUUID->"33f1d248-b0ae-4a4f-992f-\
df8bdf1d79ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseMatrixSolve", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"variables", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"conditions", ",", "variablePattern", ",", "\[Infinity]"}],
            "]"}], "]"}], ",", "variablePreferenceFunction"}], "]"}]}], ",", 
      "arrays", ",", "matrix", ",", "nullspace"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"matrix", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i_", ",", "j_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{
            "conditions", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "variables", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "conditions", "]"}], ",", 
           RowBox[{"Length", "[", "variables", "]"}]}], "}"}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DebugPrint", "[", "\"\<preparing SparseArray\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"arrays", "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"conditions", ",", "variables"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"matrix", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "arrays", "]"}], "\[Equal]", "2"}], ",", 
        RowBox[{
        "arrays", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "\"\<finding nullspace...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lastSparseMatrixSolveMatrix", "=", "matrix"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nullspace", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"matrix", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"prepare", " ", "a", " ", "list", " ", "of", " ", "rules"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "#"}], "]"}], "&"}], "/@", 
      "nullspace"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4667942693629704`*^9, 3.4667943275232964`*^9}, {
  3.4667950750311127`*^9, 3.4667951334203873`*^9}, {3.4667951666749783`*^9, 
  3.466795239536755*^9}, {3.466795271537733*^9, 3.4667952829034863`*^9}, {
  3.46679534240556*^9, 3.466795393547613*^9}, {3.4667955082921057`*^9, 
  3.466795515008913*^9}, {3.466795741880331*^9, 3.466795742100761*^9}, {
  3.466798819639162*^9, 3.466798825720826*^9}, {3.466798866221089*^9, 
  3.466798905562931*^9}, {3.4668006274660063`*^9, 3.4668006588000793`*^9}, {
  3.466800708384371*^9, 3.466800710411268*^9}, {3.466804501978815*^9, 
  3.46680452458456*^9}, {3.466804882614112*^9, 3.466804895509995*^9}, {
  3.508774676111102*^9, 3.5087747098724422`*^9}, {3.508774802391862*^9, 
  3.50877480571434*^9}, {3.508774877934349*^9, 3.508774895297783*^9}, {
  3.531680957168724*^9, 3.531680958176921*^9}, {3.5371305957618723`*^9, 
  3.537130609743536*^9}},ExpressionUUID->"ed8370a3-3d46-474a-b516-\
57fd903568ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ManyTermSparseMatrixSolve", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"SparseMatrixSolve", "[", 
   RowBox[{
    RowBox[{"SolveTwoTermEquations", "[", 
     RowBox[{
     "conditions", ",", "variablePattern", ",", 
      "variablePreferenceFunction"}], "]"}], ",", "variablePattern", ",", 
    "variablePreferenceFunction"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.466866005106608*^9, 
  3.466866076931291*^9}},ExpressionUUID->"ea7396f1-a95d-414e-aa7b-\
6e17807d8b2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CollectGPA4Matrix", "[", 
   RowBox[{
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", 
         RowBox[{"MatrixWrapper", "[", 
          RowBox[{"a_", ",", "b_", ",", "m_"}], "]"}]}], ")"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"MatrixWrapper", "[", 
          RowBox[{"a", ",", "b", ",", 
           RowBox[{"Collect", "[", 
            RowBox[{"m", ",", "p", ",", "Together"}], "]"}]}], "]"}]}], 
        ")"}]}], ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CollectGPA4Matrix", "[", 
   RowBox[{
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}], ",", "p_", ",", "f_"}], "]"}],
   ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", 
         RowBox[{"MatrixWrapper", "[", 
          RowBox[{"a_", ",", "b_", ",", "m_"}], "]"}]}], ")"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"MatrixWrapper", "[", 
          RowBox[{"a", ",", "b", ",", 
           RowBox[{"Collect", "[", 
            RowBox[{"m", ",", "p", ",", "f"}], "]"}]}], "]"}]}], ")"}]}], 
      ")"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4832155202902308`*^9, 3.483215545147975*^9}, {
  3.483215593859654*^9, 3.483215635629253*^9}, {3.483215761427021*^9, 
  3.483215770859211*^9}, {3.483216264306465*^9, 3.483216265868951*^9}, {
  3.5260680429251003`*^9, 3.52606806118749*^9}, {3.526069210092753*^9, 
  3.52606922829897*^9}, {3.526069275630728*^9, 3.526069276606557*^9}, {
  3.719082871939835*^9, 
  3.719082907862784*^9}},ExpressionUUID->"09ec1ae8-afb9-4f8f-b48d-\
31ab983f7b9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CollectGPA4Element", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"xx__", ",", "values_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"values", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "Together"}], "]"}]}], ")"}]}], 
      ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CollectGPA4Element", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"xx__", ",", "values_"}], "]"}], ",", "p_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"values", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "f"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4832155202902308`*^9, 3.483215545147975*^9}, {
  3.483215593859654*^9, 3.483215635629253*^9}, {3.483215761427021*^9, 
  3.483215770859211*^9}, {3.483216264306465*^9, 3.483216265868951*^9}, {
  3.5260680429251003`*^9, 3.52606806118749*^9}, {3.526069210092753*^9, 
  3.52606922829897*^9}, {3.526069275630728*^9, 3.526069276606557*^9}, {
  3.526310623549231*^9, 
  3.5263106484434547`*^9}},ExpressionUUID->"ee818abc-73a7-49ed-97c1-\
556acadd58de"],

Cell[BoxData[
 RowBox[{"Clear", "[", "LowestWeightEigenspace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526563205148951*^9, 
  3.526563212665739*^9}},ExpressionUUID->"8ceda2d0-97ee-441d-81f0-\
c5571d477905"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenspace", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "\[Lambda]_", ",", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", "|", "1"}], ")"}], ":", "0"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], ",", 
    RowBox[{"LowestWeightEigenspace", "[", 
     RowBox[{"G", ",", "pivotalStructure", ",", "\[Lambda]", ",", "t"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "f", ",", "over", ",", "kernel", ",", "conditions", ",",
         "solutions", ",", "variables", ",", "matrix", ",", "c", ",", 
        "replacements", ",", "remainingf"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<Preparing test kernel...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"over", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"DepthOfBranchPoint", "[", 
                   RowBox[{
                   "G", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", "1"}], "}"}]}], 
               "]"}], ",", "1"}], "]"}], "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "+", "t"}], ",", "2"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kernel", "=", 
        RowBox[{"VariableGPA4Element", "[", 
         RowBox[{"G", ",", "over", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DepthOfBranchPoint", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"DepthOfBranchPoint", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", "f"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", 
        "\"\<Preparing low weight eigenspace conditions...\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"LowestWeightEigenvectorConditions", "[", 
         RowBox[{"kernel", ",", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Beginning progressive solve...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"ManyTermSparseMatrixSolve", "[", 
         RowBox[{"conditions", ",", "_f", ",", 
          RowBox[{
           RowBox[{"LoopPreferences", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"replacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
           "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "solutions", "]"}]}], "}"}]}], "]"}], 
           ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
              "]"}], "/.", "solutions"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{
         RowBox[{"GPA4Matrix", "[", "kernel", "]"}], "/.", "replacements"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"CollectGPA4Matrix", "[", 
         RowBox[{"matrix", ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"matrix", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{
          "DebugPrint", "[", 
           "\"\<Oh dear --- the variable hasn't disappeared yet...\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"remainingf", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"matrix", ",", "_f", ",", "\[Infinity]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"matrix", "=", 
           RowBox[{"matrix", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"remainingf", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"c", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", 
                   RowBox[{"Length", "[", "remainingf", "]"}]}]}], "}"}]}], 
               "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DebugPrint", "[", "\"\<But now it's gone...\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LowestWeightEigenspace", "[", 
           RowBox[{"G", ",", "pivotalStructure", ",", "\[Lambda]", ",", "t"}],
            "]"}], "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "cc", "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"matrix", "/.", 
              RowBox[{"c", "\[Rule]", "cc"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<... finished LowestWeightEigenspace\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PackageLowestWeightEigenspaces", "[", "G", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445972779781309*^9, 3.445972864413204*^9}, {
   3.445972898895255*^9, 3.445972962146593*^9}, {3.4460802780418253`*^9, 
   3.446080359579668*^9}, {3.446647529522216*^9, 3.446647532408835*^9}, {
   3.446649834211596*^9, 3.4466498371145163`*^9}, {3.446650181039261*^9, 
   3.446650207173506*^9}, {3.446650853861106*^9, 3.446650855260021*^9}, {
   3.446652736647915*^9, 3.446652774964315*^9}, {3.446846572238379*^9, 
   3.446846644835526*^9}, {3.446846852813343*^9, 3.4468468606635838`*^9}, {
   3.446848369786813*^9, 3.446848419086179*^9}, {3.446856644990739*^9, 
   3.4468566508414907`*^9}, {3.4468575573434477`*^9, 3.446857576811185*^9}, {
   3.446909985692429*^9, 3.446910108380397*^9}, {3.446910248056724*^9, 
   3.446910263711671*^9}, {3.446910356391973*^9, 3.4469103612881107`*^9}, {
   3.4469103991103067`*^9, 3.4469103994670877`*^9}, {3.446910431171165*^9, 
   3.44691048055746*^9}, {3.447363457116119*^9, 3.44736345723777*^9}, {
   3.447363495142351*^9, 3.4473636015465813`*^9}, {3.464703811307473*^9, 
   3.464703817874318*^9}, {3.466805187163639*^9, 3.466805233806419*^9}, 
   3.466866116533052*^9, {3.466876674162283*^9, 3.466876700560186*^9}, {
   3.483214651752284*^9, 3.483214686734447*^9}, {3.483215213547867*^9, 
   3.483215240313656*^9}, {3.483216268383532*^9, 3.48321630792622*^9}, {
   3.483216338547185*^9, 3.483216349293456*^9}, {3.526068012884975*^9, 
   3.526068030288556*^9}, {3.52606806988025*^9, 3.5260680888793287`*^9}, {
   3.5260682836894693`*^9, 3.526068287304775*^9}, {3.5260683221117277`*^9, 
   3.526068362258387*^9}, {3.526068407063676*^9, 3.5260684386183157`*^9}, {
   3.526069678680943*^9, 3.5260696831275177`*^9}, {3.526069800988696*^9, 
   3.526069809351606*^9}, {3.526307168183586*^9, 3.526307190046574*^9}, {
   3.526563030590847*^9, 3.5265630461476183`*^9}, {3.5265631312553673`*^9, 
   3.526563136902454*^9}, {3.526563202046639*^9, 3.526563202125372*^9}, {
   3.535916686115509*^9, 3.53591668880202*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"6f3a490a-56e5-48dd-98b5-5220ace81b84"],

Cell[BoxData[
 RowBox[{"Clear", "[", "LowestWeightSpace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.528728684323185*^9, 
  3.5287286879996147`*^9}},ExpressionUUID->"26abc645-8df0-4637-9dc1-\
3a3864631e44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightSpace", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", "|", "1"}], ")"}], ":", "0"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], ",", 
    RowBox[{"LowestWeightSpace", "[", 
     RowBox[{"G", ",", "pivotalStructure", ",", "n", ",", "t"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "f", ",", "over", ",", "kernel", ",", "conditions", ",",
         "solutions", ",", "variables", ",", "matrix", ",", "c", ",", 
        "replacements"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<Preparing test kernel...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"over", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", "n", "}"}]}], "]"}], ",", "1"}], "]"}], "~", 
            "Join", "~", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "+", "t"}], ",", "2"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kernel", "=", 
        RowBox[{"VariableGPA4Element", "[", 
         RowBox[{"G", ",", "over", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
          "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Preparing low weight spacae conditions...\>\"",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"LowestWeightConditions", "[", "kernel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Beginning progressive solve...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"ManyTermSparseMatrixSolve", "[", 
         RowBox[{"conditions", ",", "_f", ",", 
          RowBox[{
           RowBox[{"LoopPreferences", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"replacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
           "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "solutions", "]"}]}], "}"}]}], "]"}], 
           ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
              "]"}], "/.", "solutions"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{
         RowBox[{"GPA4Matrix", "[", "kernel", "]"}], "/.", "replacements"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"CollectGPA4Matrix", "[", 
         RowBox[{"matrix", ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"matrix", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{
          "DebugPrint", "[", 
           "\"\<Oh dear --- the variable hasn't disappeared yet...\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"remainingf", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"matrix", ",", "_f", ",", "\[Infinity]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"matrix", "=", 
           RowBox[{"matrix", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"remainingf", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"c", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", 
                   RowBox[{"Length", "[", "remainingf", "]"}]}]}], "}"}]}], 
               "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DebugPrint", "[", "\"\<But now it's gone...\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LowestWeightSpace", "[", 
           RowBox[{"G", ",", "pivotalStructure", ",", "n", ",", "t"}], "]"}], 
          "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "cc", "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"matrix", "/.", 
              RowBox[{"c", "\[Rule]", "cc"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<... finished LowWeightSpace\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PackageLowestWeightEigenspaces", "[", "G", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445972779781309*^9, 3.445972864413204*^9}, {
   3.445972898895255*^9, 3.445972962146593*^9}, {3.4460802780418253`*^9, 
   3.446080359579668*^9}, {3.446647529522216*^9, 3.446647532408835*^9}, {
   3.446649834211596*^9, 3.4466498371145163`*^9}, {3.446650181039261*^9, 
   3.446650207173506*^9}, {3.446650853861106*^9, 3.446650855260021*^9}, {
   3.446652736647915*^9, 3.446652774964315*^9}, {3.446846572238379*^9, 
   3.446846644835526*^9}, {3.446846852813343*^9, 3.4468468606635838`*^9}, {
   3.446848369786813*^9, 3.446848419086179*^9}, {3.446856644990739*^9, 
   3.4468566508414907`*^9}, {3.4468575573434477`*^9, 3.446857576811185*^9}, {
   3.446909985692429*^9, 3.446910108380397*^9}, {3.446910248056724*^9, 
   3.446910263711671*^9}, {3.446910356391973*^9, 3.4469103612881107`*^9}, {
   3.4469103991103067`*^9, 3.4469103994670877`*^9}, {3.446910431171165*^9, 
   3.44691048055746*^9}, {3.447363457116119*^9, 3.44736345723777*^9}, {
   3.447363495142351*^9, 3.4473636015465813`*^9}, {3.464703811307473*^9, 
   3.464703817874318*^9}, {3.466805187163639*^9, 3.466805233806419*^9}, 
   3.466866116533052*^9, {3.466876674162283*^9, 3.466876700560186*^9}, {
   3.483214651752284*^9, 3.483214686734447*^9}, {3.483215213547867*^9, 
   3.483215240313656*^9}, {3.483216268383532*^9, 3.48321630792622*^9}, {
   3.483216338547185*^9, 3.483216349293456*^9}, {3.526068012884975*^9, 
   3.526068030288556*^9}, {3.52606806988025*^9, 3.5260680888793287`*^9}, {
   3.5260682836894693`*^9, 3.526068287304775*^9}, {3.5260683221117277`*^9, 
   3.526068362258387*^9}, {3.526068407063676*^9, 3.5260684386183157`*^9}, {
   3.526069678680943*^9, 3.5260696831275177`*^9}, {3.526069800988696*^9, 
   3.526069809351606*^9}, {3.526307168183586*^9, 3.526307190046574*^9}, {
   3.526563030590847*^9, 3.5265630461476183`*^9}, {3.5265631312553673`*^9, 
   3.526563136902454*^9}, {3.526563202046639*^9, 3.526563202125372*^9}, {
   3.5287278057374372`*^9, 3.52872780992447*^9}, {3.528727845245491*^9, 
   3.528727856889963*^9}, {3.528727941628729*^9, 3.528728032441126*^9}, 
   3.52872846895527*^9},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"2425d38b-3f72-49d6-8c91-58f7f1fbafca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadLowestWeightEigenspaces", "[", 
   RowBox[{"G", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Needs", "[", 
      RowBox[{"\"\<FusionAtlas`Data`\>\"", "<>", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"(", 
          RowBox[{"GraphToString", "/@", "G"}], ")"}]}], ")"}], "<>", 
       "\"\<`LowestWeightEigenspace`\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"On", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], "=", "False"}], 
     ";", "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411927026253885*^9, 3.4119270365386734`*^9}, {
   3.4140209075797215`*^9, 3.4140209151906652`*^9}, {3.446846517382749*^9, 
   3.446846561881503*^9}, {3.446846810617436*^9, 3.446846812981331*^9}, 
   3.446846981170701*^9, {3.446847052448126*^9, 3.446847055221373*^9}, {
   3.446847383054578*^9, 3.446847384819085*^9}, {3.5260681184487886`*^9, 
   3.526068134993869*^9}, {3.52606821408747*^9, 
   3.526068228463785*^9}},ExpressionUUID->"27b84bba-8e61-46ed-bc4d-\
774f6309207f"],

Cell[BoxData[
 RowBox[{"Clear", "[", "ChangePivotalStructure", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5263110178519287`*^9, 
  3.526311022256816*^9}},ExpressionUUID->"ea2de765-e658-48a4-944c-\
780482f769be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangePivotalStructure", "[", 
   RowBox[{
    RowBox[{"A", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], ",", 
    RowBox[{"newPivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exponent", ",", "simplifyCoefficient"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pivotalStructure", "\[Equal]", "newPivotalStructure"}], ",", 
       RowBox[{"Return", "[", "A", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"exponent", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pivotalStructure", ",", "newPivotalStructure"}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<Spherical\>\"", ",", "\"\<Lopsided\>\""}], "}"}], ",", 
        "1", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<Lopsided\>\"", ",", "\"\<Spherical\>\""}], "}"}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Spherical\>\"", ",", "\"\<Spherical\>\""}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"\"\<Lopsided\>\"", ",", "\"\<Lopsided\>\""}], "}"}]}], ",",
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simplifyCoefficient", "[", "x_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"newPivotalStructure", "\[Equal]", "\"\<Spherical\>\""}], ",", 
        RowBox[{"RootReduce", "[", "x", "]"}], ",", 
        RowBox[{"ToNumberField0", "[", 
         RowBox[{"x", ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "newPivotalStructure", ",", 
       RowBox[{"coefficients", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"loop_", "\[Rule]", "\[Zeta]_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"loop", "\[Rule]", 
           RowBox[{"simplifyCoefficient", "[", 
            RowBox[{"\[Zeta]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Times", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"LopsidedDimension", "[", 
                    RowBox[{"g", ",", "#"}], "]"}], ",", "1"}], "]"}], "&"}], 
                    "/@", 
                    RowBox[{"UpVertices", "[", 
                    RowBox[{"loop", ",", "up"}], "]"}]}], ")"}], "~", "Join", 
                    "~", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"LopsidedDimension", "[", 
                    RowBox[{"g", ",", "#"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"DownVertices", "[", 
                    RowBox[{"loop", ",", "down"}], "]"}]}], ")"}]}], ")"}]}], 
                 ")"}], ",", "exponent"}], "]"}], "]"}]}], "]"}]}], 
          ")"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526307924501946*^9, 3.526307947233427*^9}, {
   3.5263080818668423`*^9, 3.526308101416889*^9}, {3.526308542550867*^9, 
   3.526308582560541*^9}, {3.526308759678413*^9, 3.526308790493166*^9}, {
   3.526308824638112*^9, 3.526308947524477*^9}, {3.526308984939636*^9, 
   3.526309019947324*^9}, {3.526309051226866*^9, 3.526309078202306*^9}, {
   3.526309127058469*^9, 3.526309189498269*^9}, {3.526309245488329*^9, 
   3.5263092841588182`*^9}, {3.526309989133964*^9, 3.526310053468577*^9}, {
   3.526310259694478*^9, 3.526310302400609*^9}, {3.526310332734384*^9, 
   3.5263103338691587`*^9}, {3.5263103741924477`*^9, 3.5263103903882*^9}, {
   3.5263104912844553`*^9, 3.526310506044055*^9}, 3.526311012467415*^9, {
   3.526311120366075*^9, 3.52631113062152*^9}, {3.526311200710511*^9, 
   3.526311202909711*^9}, {3.526311471866022*^9, 3.526311488615391*^9}, {
   3.5263120417139587`*^9, 3.526312044122986*^9}, {3.526312538087716*^9, 
   3.5263125434408627`*^9}, {3.52631259741632*^9, 3.5263125997990503`*^9}, {
   3.526312632884294*^9, 3.526312634867127*^9}, {3.5263127436911173`*^9, 
   3.526312747517337*^9}, {3.5263128735635433`*^9, 3.5263128765456467`*^9}, {
   3.526313047725773*^9, 3.526313049571557*^9}, {3.526313147903009*^9, 
   3.526313150405938*^9}, {3.5273517308905354`*^9, 3.527351740505417*^9}, {
   3.527352296318883*^9, 3.527352325456492*^9}, {3.527417187422597*^9, 
   3.5274172102668247`*^9}, {3.5366090355274153`*^9, 
   3.536609064998599*^9}},ExpressionUUID->"d73523ae-2b58-4901-a43d-\
5e40e452d02c"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"UpVertices", ",", "DownVertices"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5274171611732283`*^9, 
  3.527417166947812*^9}},ExpressionUUID->"7d7cd3a4-73a2-45e3-af38-\
27ad8809f820"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UpVertices", "[", 
   RowBox[{"loop_", ",", "up_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"loop", "~", "Join", "~", "loop"}], ")"}], "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", 
    RowBox[{
     RowBox[{"2", "up"}], "+", "1"}], ";;", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownVertices", "[", 
   RowBox[{"loop_", ",", "down_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"loop", "~", "Join", "~", "loop", "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"loop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "}"}]}], ")"}], "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{"-", "1"}], ";;", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "down"}], "-", "1"}], ";;", 
    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526311316349783*^9, 3.526311463955002*^9}, {
  3.5274158545370417`*^9, 3.527415883254711*^9}, {3.527416949570669*^9, 
  3.527416992301673*^9}, {3.527417024388233*^9, 3.527417032847412*^9}, {
  3.527417082967841*^9, 3.5274170965744762`*^9}, {3.5274173091408377`*^9, 
  3.527417330078755*^9}},ExpressionUUID->"4050ac4c-0f52-41d1-b76e-\
5c36f036635c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangePivotalStructure", "[", 
   RowBox[{"A_GPA4Matrix", ",", "ps_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     "\[Equal]", "ps"}], ",", "A", ",", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"ChangePivotalStructure", "[", 
      RowBox[{
       RowBox[{"GPA4Element", "[", "A", "]"}], ",", "ps"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526563890465164*^9, 3.52656391815948*^9}, {
  3.535919166293028*^9, 3.535919175924436*^9}, {3.535919210378859*^9, 
  3.535919230947453*^9}},ExpressionUUID->"f3a770d6-207e-47f6-8320-\
389c9b1bea4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cachedToNumberField", "[", "z__", "]"}], ":=", 
  RowBox[{
   RowBox[{"cachedToNumberField", "[", "z", "]"}], "=", 
   RowBox[{"ToNumberField", "[", "z", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.536606863855052*^9, 3.536606878885789*^9}, {
  3.578797199007188*^9, 3.578797220710829*^9}, {3.5787972533495607`*^9, 
  3.578797254060741*^9}, {3.578797339852393*^9, 
  3.578797341155559*^9}},ExpressionUUID->"b5ec5d3e-0326-47a3-8ada-\
5ca012f28f4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaugeAction", "[", 
   RowBox[{"g_", ",", "X_GPA4Element"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "gauge"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{"g", "~", "Join", "~", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "\[Rule]", 
           SuperscriptBox[
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            RowBox[{"-", "1"}]]}], "&"}], "/@", "g"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gauge", "[", "loop_", "]"}], ":=", 
      RowBox[{"Times", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"loop", ",", "3", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "/.", "f"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"X", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"loop_", "\[Rule]", "value_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"loop", "\[Rule]", 
         RowBox[{"value", " ", 
          RowBox[{"gauge", "[", "loop", "]"}]}]}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556039601335362*^9, 3.556039631948288*^9}, {
  3.556040419615266*^9, 3.556040442625526*^9}, {3.556040478630726*^9, 
  3.556040592452302*^9}, {3.556040652485057*^9, 3.5560406598034363`*^9}, {
  3.55604071799537*^9, 
  3.556040772537808*^9}},ExpressionUUID->"f10568ec-7776-4ef6-ad5e-\
3d24efe20c17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VariableGaugeElement", "[", 
   RowBox[{"G_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "edges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edges", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GraphPaths", "[", 
           RowBox[{"G", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "2", ",", "1"}], 
          "]"}]}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"\[Gamma]", "[", "#", "]"}]}], "&"}], "/@", "edges"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5560399238354073`*^9, 3.556039949880279*^9}, {
  3.556040256678627*^9, 3.5560402973473587`*^9}, {3.5560403440464973`*^9, 
  3.556040363436597*^9}, {3.556040978277914*^9, 
  3.556040978355748*^9}},ExpressionUUID->"030e5174-dbc6-41f1-9872-\
47c7a805af30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGaugeElementRelating", "[", 
   RowBox[{"X_GPA4Element", ",", "Y_GPA4Element"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"G", ",", "\[Gamma]", ",", "g", ",", "solutions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"VariableGaugeElement", "[", 
       RowBox[{"G", ",", "\[Gamma]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GPACoefficients", "[", 
          RowBox[{
           RowBox[{"GaugeAction", "[", 
            RowBox[{"g", ",", "X"}], "]"}], "-", "Y"}], "]"}], "\[Equal]", 
         "0"}], ",", 
        RowBox[{"g", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"solutions", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "/.", "solutions"}], ")"}], "/.", 
        RowBox[{"_\[Gamma]", "\[RuleDelayed]", "1"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556039639602192*^9, 3.5560396596896677`*^9}, {
   3.556039964689641*^9, 3.556040059147768*^9}, {3.556040095657344*^9, 
   3.556040109706419*^9}, {3.556040426491983*^9, 3.55604042910006*^9}, {
   3.5560412485211887`*^9, 3.5560412612094393`*^9}, 
   3.5560414638440247`*^9},ExpressionUUID->"51b59dcd-5a85-4a92-860d-\
78a8b55c78be"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "NumberFieldGauge", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumberFieldGauge", "[", 
   RowBox[{"conn_", ",", 
    RowBox[{"expandNumberField", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "False"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "=", "conn"}], ",", "G", ",", "\[Gamma]", ",", "targets", 
      ",", "var", ",", "solutions", ",", "gaugeElement", ",", "length"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"\"\<\[Theta]\>\"", ",", "___"}], "]"}], "\[RuleDelayed]", 
        "1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"GaugeAction", "[", 
       RowBox[{
        RowBox[{"gaugeElement", "=", 
         RowBox[{"VariableGaugeElement", "[", 
          RowBox[{"G", ",", "\[Gamma]"}], "]"}]}], ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"Together", "[", "y", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x_", "\[Rule]", 
             RowBox[{"y_", "?", "NumericQ"}]}], ")"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"cachedToNumberField", "[", 
               RowBox[{
                RowBox[{"RootReduce", "[", "y", "]"}], ",", 
                RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}], 
              ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"expandNumberField", "\[And]", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"c", ",", "ToNumberField"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "DebugPrint", "[", "\"\<Enlarging number field...\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"NumberFieldGenerator", "[", "G", "]"}], "=", 
            RowBox[{
             RowBox[{"ToNumberField", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"NumberFieldGenerator", "[", "G", "]"}], "}"}], "~", 
               "Join", "~", 
               RowBox[{"Union", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{
                   RowBox[{"HoldPattern", "[", 
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{"x_", ",", "_"}], "]"}], "]"}], "\[RuleDelayed]", 
                   
                   RowBox[{"RootReduce", "[", "x", "]"}]}], ",", 
                  "\[Infinity]"}], "]"}], "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"DebugPrint", "[", 
            RowBox[{"\"\<... new number field generator: \>\"", ",", 
             RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RedefineLopsidedDimension", "[", "G", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{"ToNumberField", "[", 
                  RowBox[{"x_", ",", "_"}], "]"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"cachedToNumberField", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], 
               ",", 
               RowBox[{"x_AlgebraicNumber", "\[RuleDelayed]", 
                RowBox[{"cachedToNumberField", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], 
                 "]"}]}]}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"length", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"targets", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"GPACoefficients", "[", "c", "]"}], ",", 
             RowBox[{"e_", "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"e", ",", "_\[Gamma]"}], "]"}]}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "length", "]"}], "<>", 
          "\"\< targets to go...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"length", ">", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
           "targets", ",", "_\[Gamma]", ",", "\[Infinity]", ",", "1"}], "]"}],
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<Solving \>\"", ",", 
          RowBox[{
          "targets", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "\"\< for \>\"", ",", "var"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"solutions", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "targets", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "\[Equal]", "1"}], ",", "var"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "solutions", "]"}], "\[NotEqual]", "1"}], 
          ",", 
          RowBox[{
           RowBox[{"Print", "[", "targets", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
          "solutions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gaugeElement", "=", 
         RowBox[{"gaugeElement", "/.", 
          RowBox[{
          "solutions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"gaugeElement", "/.", 
         RowBox[{"_\[Gamma]", "\[RuleDelayed]", "1"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556222294013072*^9, 3.556222454599093*^9}, {
  3.556222486060711*^9, 3.5562226086675777`*^9}, {3.556222649906789*^9, 
  3.556222691065855*^9}, {3.556223057344563*^9, 3.556223119956852*^9}, {
  3.5562231777043*^9, 3.556223180586913*^9}, {3.5562236816922398`*^9, 
  3.5562237072038727`*^9}, {3.568057283545027*^9, 3.5680573126291227`*^9}, {
  3.568057442681877*^9, 3.5680574877445517`*^9}, {3.5787964061753597`*^9, 
  3.578796423582468*^9}, {3.578796497073223*^9, 3.5787965055630713`*^9}, {
  3.578796539284924*^9, 3.578796550656495*^9}, {3.5787973307438383`*^9, 
  3.578797333549848*^9}, {3.578797675479973*^9, 3.5787976784465733`*^9}, {
  3.6305463669075937`*^9, 3.630546385062196*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"62d4124a-2584-4153-9934-58a9c81e3fde"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PivotalStructureOf", "[", "A_GPA4Element", "]"}], ":=", 
  RowBox[{
  "A", "\[LeftDoubleBracket]", "4", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PivotalStructureOf", "[", "A_GPA4Matrix", "]"}], ":=", 
  RowBox[{
  "A", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.537124725677889*^9, 
  3.537124768995255*^9}},ExpressionUUID->"b4ba835b-6dce-4938-a464-\
b51f4ee433bd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindEquationsForFlatGenerators", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindEquationsForFlatGenerators", "[", 
   RowBox[{"conn0_", ",", "\[Lambda]_", ",", "c_", ",", 
    RowBox[{"allowGaugeTransformation", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}]}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
       "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
       "ps", ",", "conn", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
      "solutions", ",", "generators", ",", "remaining"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ps", "=", 
      RowBox[{"If", "[", 
       RowBox[{"allowGaugeTransformation", ",", "\"\<Lopsided\>\"", ",", 
        RowBox[{"PivotalStructureOf", "[", "conn0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lws0", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"LowestWeightEigenspace", "[", 
         RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "0"}], "]"}], "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lws1", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"LowestWeightEigenspace", "[", 
         RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "1"}], "]"}], "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conn", "=", 
      RowBox[{"If", "[", 
       RowBox[{"allowGaugeTransformation", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NumberFieldGauge", "[", 
          RowBox[{"ChangePivotalStructure", "[", 
           RowBox[{"conn0", ",", "\"\<Lopsided\>\""}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\[IndentingNewLine]", "conn0"}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"flatness", "=", 
      RowBox[{
       RowBox[{"OneStrandFlatness", "[", "conn", "]"}], "[", 
       RowBox[{"lws0", ",", 
        RowBox[{"RotateOneClick", "[", "lws1", "]"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.532294917079309*^9, 3.5322949807565327`*^9}, {
  3.5323697611281147`*^9, 3.532369771422543*^9}, {3.537124606027546*^9, 
  3.5371247824690733`*^9}, {3.5371248586096573`*^9, 3.5371248608489122`*^9}, {
  3.556223745102161*^9, 3.556223747030772*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"3d60f679-52b1-4654-9eb5-6f6fdbf9da9e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindFlatGenerators", "]"}], "\n", 
 RowBox[{
  RowBox[{"FindFlatGenerators", "[", 
   RowBox[{"conn0_", ",", "\[Lambda]_", ",", 
    RowBox[{"allowGaugeTransformation", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}]}], "]"}], ":=", 
  
  RowBox[{
   RowBox[{"FindFlatGenerators", "[", 
    RowBox[{"conn0", ",", "\[Lambda]", ",", "allowGaugeTransformation"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
        "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ",", "ps", ",", "c", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
       "solutions", ",", "generators", ",", "remaining", ",", "map"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ps", "=", 
       RowBox[{"If", "[", 
        RowBox[{"allowGaugeTransformation", ",", "\"\<Lopsided\>\"", ",", 
         RowBox[{"PivotalStructureOf", "[", "conn0", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws0", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightEigenspace", "[", 
          RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "0"}], "]"}], "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws1", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightEigenspace", "[", 
          RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "1"}], "]"}], "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatness", "=", 
       RowBox[{
        RowBox[{"FindEquationsForFlatGenerators", "[", 
         RowBox[{
         "conn0", ",", "\[Lambda]", ",", "c", ",", 
          "allowGaugeTransformation"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "All", ",", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lastFlatnessEquations", "=", "flatness"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatnessReductionCounter", "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ps", "\[Equal]", "\"\<Spherical\>\""}], ",", 
        RowBox[{
         RowBox[{"DebugPrint", "[", "\"\<RootReducing...\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"map", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SecretParallelMode", "\[Equal]", "True"}], ",", 
            RowBox[{
             RowBox[{"DistributeDefinitions", "[", "cachedRootReduce", "]"}], 
             ";", "ParallelMap"}], ",", "Map"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"flatness", "=", 
          RowBox[{"map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{"#", ",", "_c", ",", "cachedRootReduce"}], "]"}], "&"}],
             ",", "flatness"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<Finished preparing flatness equations\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lastFlatnessEquations", "=", "flatness"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solutions", "=", 
       RowBox[{"SparseMatrixSolve", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"Union", "[", "flatness", "]"}], ",", "_c"}], "]"}], ",",
            "0"}], "]"}], ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"generators", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lws0", "/.", "#"}], "&"}], ")"}], "/@", 
        "solutions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526573004302967*^9, 3.526573008422333*^9}, 
   3.532897315087549*^9, {3.5359169580360193`*^9, 3.535916972522904*^9}, {
   3.537124628091508*^9, 3.537124640404571*^9}, {3.5371247921896887`*^9, 
   3.5371248239473953`*^9}, {3.537125645501313*^9, 3.537125682083681*^9}, {
   3.537125858354059*^9, 3.5371258931992292`*^9}, {3.537126098238208*^9, 
   3.5371260987419643`*^9}, {3.537127313669674*^9, 3.537127402963333*^9}, {
   3.569093630997081*^9, 3.569093633190793*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"9c9ee8cb-b9ad-4516-8357-0a304d7ec23e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FindFlatLowestWeightVectors", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFlatLowestWeightVectors", "[", 
   RowBox[{"conn0_", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FindFlatLowestWeightVectors", "[", 
    RowBox[{"conn0", ",", "n"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
        "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ",", "c", ",", "conn", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
       "solutions", ",", "generators", ",", "remaining"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lws0", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightSpace", "[", 
          RowBox[{"G", ",", "\"\<Lopsided\>\"", ",", "n", ",", "0"}], "]"}], 
         "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws1", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightSpace", "[", 
          RowBox[{"G", ",", "\"\<Lopsided\>\"", ",", "n", ",", "1"}], "]"}], 
         "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conn", "=", 
       RowBox[{
        RowBox[{"NumberFieldGauge", "[", 
         RowBox[{"ChangePivotalStructure", "[", 
          RowBox[{"conn0", ",", "\"\<Lopsided\>\""}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatness", "=", 
       RowBox[{
        RowBox[{"OneStrandFlatness", "[", "conn", "]"}], "[", 
        RowBox[{"lws0", ",", 
         RowBox[{"RotateOneClick", "[", "lws1", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solutions", "=", 
       RowBox[{"SparseMatrixSolve", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"flatness", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], ",", 
             "_c"}], "]"}], ",", "0"}], "]"}], ",", "_c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"generators", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lws0", "/.", "#"}], "&"}], ")"}], "/@", 
        "solutions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.528728062826112*^9, 3.528728094878077*^9}, {
   3.528728703074692*^9, 3.5287287050737658`*^9}, {3.531748534491808*^9, 
   3.531748546703866*^9}, {3.531756879796567*^9, 3.531756884684737*^9}, {
   3.5328972644035187`*^9, 3.5328973028570223`*^9}, 3.535916998057332*^9, {
   3.5562237673255453`*^9, 
   3.556223769136059*^9}},ExpressionUUID->"205a8b44-f18d-433e-b2a8-\
c7f8975c49f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qInteger\[Delta]", "[", "k_", "]"}], ":=", 
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "\[Delta]", "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Delta]", " ", 
          RowBox[{
           RowBox[{"qInteger\[Delta]", "[", 
            RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"qInteger\[Delta]", "[", 
           RowBox[{"k", "-", "2"}], "]"}], "[", "\[Delta]", "]"}]}], ",", 
        "\[Delta]"}], "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "2", "]"}], "=", 
   RowBox[{"#", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "1", "]"}], "=", 
   RowBox[{"1", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "0", "]"}], "=", 
   RowBox[{"0", "&"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428707067673397`*^9, 3.4428708698941298`*^9}, {
  3.4428725554708967`*^9, 3.4428725570067*^9}, {3.4432351243828487`*^9, 
  3.443235134879043*^9}, {3.444689998795965*^9, 
  3.4446900080094557`*^9}},ExpressionUUID->"55708361-f90d-4c41-9e92-\
f2dd47d23da0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WenzlRecursion", "[", 
   RowBox[{
    RowBox[{"gpa", ":", 
     RowBox[{"(", 
      RowBox[{"_GPA4Matrix", "|", "_GPA4Element"}], ")"}]}], ",", "x_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "DebugPrint", "[", "\"\<Beginning Wenzl recursion calculation.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<   adding strand on right\>\"", "]"}], 
       ";", 
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{"gpa", ",", 
         RowBox[{"gpa", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"gpa", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "+", "2"}]}],
           "\[RightDoubleBracket]"}]}], "]"}]}], ")"}], "-", 
     RowBox[{"x", " ", 
      RowBox[{"GPAMultiply", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "DebugPrint", "[", "\"\<   turning down top right\>\"", "]"}], ";", 
          
          RowBox[{"TurnDownTopRightCorner", "[", "gpa", "]"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "DebugPrint", "[", "\"\<   turning up bottom right\>\"", "]"}], ";", 
          RowBox[{"TurnUpBottomRightCorner", "[", "gpa", "]"}]}], ")"}]}], 
       "]"}]}]}]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44207086802013*^9, 3.4420708917762613`*^9}, {
   3.442071004220521*^9, 3.442071005002489*^9}, {3.442074837078445*^9, 
   3.442074915998242*^9}, {3.442078301039007*^9, 3.4420783254311037`*^9}, {
   3.442160317554632*^9, 3.442160341399254*^9}, {3.442160534875649*^9, 
   3.442160847626791*^9}, {3.442160899220743*^9, 3.4421609857430363`*^9}, {
   3.442161061159869*^9, 3.442161115833652*^9}, {3.442163479438676*^9, 
   3.442163479947233*^9}, {3.442163650466667*^9, 3.442163689178329*^9}, 
   3.442163991181943*^9, {3.4421640714322577`*^9, 3.44216413601126*^9}, {
   3.442164861271735*^9, 3.442164886059987*^9}, {3.44216533703292*^9, 
   3.4421653411891623`*^9}, {3.4421671612949944`*^9, 3.4421671824211683`*^9}, 
   3.4421679072639647`*^9, {3.442167939346631*^9, 3.442167949986918*^9}, {
   3.442169600574132*^9, 3.4421696039463167`*^9}, {3.442870476789954*^9, 
   3.442870510803516*^9}, {3.44295431225*^9, 3.442954313265625*^9}, {
   3.443143856840056*^9, 3.443143858223157*^9}, 3.4431447683595533`*^9, {
   3.443144807244235*^9, 3.443144808460107*^9}, {3.443164681425619*^9, 
   3.443164682775586*^9}, {3.4432248248128757`*^9, 3.443224826571258*^9}, {
   3.443237366750311*^9, 3.44323737053924*^9}, {3.446145114126292*^9, 
   3.446145185611867*^9}, {3.446145334703454*^9, 3.44614533479353*^9}, 
   3.4468504535397367`*^9, {3.483201202454526*^9, 3.483201210157916*^9}, {
   3.483201331957724*^9, 3.483201335178288*^9}, {3.4832017163385572`*^9, 
   3.483201718200325*^9}, {3.483201792680458*^9, 3.483201794701951*^9}, {
   3.483201887477561*^9, 3.483201889235231*^9}, {3.483202954428892*^9, 
   3.483203015396006*^9}, 3.526912883906151*^9, {3.5274578089087763`*^9, 
   3.527457831150052*^9}, {3.5274578710033207`*^9, 3.527457895184791*^9}, {
   3.568348727523885*^9, 3.568348735153726*^9}, {3.5683572497781143`*^9, 
   3.568357260280532*^9}},ExpressionUUID->"f8322cfc-24e1-44be-b730-\
d1e8d3e699ca"],

Cell[BoxData[
 RowBox[{"Clear", "[", "JonesWenzlIdempotent", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457369455669*^9, 
  3.527457375303918*^9}},ExpressionUUID->"576c2cf4-b6fa-48e7-b11f-\
9e9baad70b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "0", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{"EmptyGPA4Element", "[", 
     RowBox[{"g", ",", "over1", ",", "pivotalStructure"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "1", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
     "g", ",", "1", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], "=", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{
      RowBox[{"JonesWenzlIdempotent", "[", 
       RowBox[{
       "g", ",", "0", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
       "]"}], ",", "over2"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.483019693299192*^9, 3.483019693363494*^9}, {3.483032286253389*^9, 
   3.4830322869367847`*^9}, {3.483201214800728*^9, 3.48320123395257*^9}, {
   3.4832015380143547`*^9, 3.483201543918481*^9}, {3.483201765946623*^9, 
   3.483201770304327*^9}, {3.4832025258596354`*^9, 3.483202531601242*^9}, {
   3.5269129451622972`*^9, 3.5269129475895576`*^9}, {3.52691299687399*^9, 
   3.526913052143632*^9}, {3.526913110375098*^9, 3.526913151190661*^9}, {
   3.526913605716093*^9, 3.526913606715332*^9}, {3.527457589144375*^9, 
   3.5274575943589487`*^9}, {3.527457630818268*^9, 3.527457630889481*^9}, {
   3.527458388467453*^9, 
   3.5274583900861607`*^9}},ExpressionUUID->"a2903f68-2f79-40d4-9b50-\
ae468794b2a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "k_", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], "/;", 
   RowBox[{"k", ">", "1"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadIdempotents", "[", "g", "]"}], ",", 
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
     "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"JonesWenzlIdempotent", "[", 
       RowBox[{
       "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
       "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sm", "=", 
           RowBox[{"GPA4Element", "[", 
            RowBox[{"JonesWenzlIdempotent", "[", 
             RowBox[{"g", ",", 
              RowBox[{"k", "-", "1"}], ",", "over1", ",", "over2", ",", 
              "pivotalStructure"}], "]"}], "]"}]}], ",", "td", ",", 
          RowBox[{"\[Delta]", "=", 
           RowBox[{"DimensionOfGenerator", "[", "g", "]"}]}], ",", "shove"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"shove", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumericQ", "[", "x", "]"}], ",", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "pivotalStructure", ",", "\"\<Spherical\>\"", ",", "x", ",", 
              "\"\<Lopsided\>\"", ",", 
              RowBox[{"ToNumberField", "[", 
               RowBox[{
                RowBox[{"RootReduce", "[", "x", "]"}], ",", 
                RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"Together", "[", "x", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"td", "=", 
          RowBox[{"TurnDownTopRightCorner", "[", "sm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GPA4Matrix", "[", 
          RowBox[{
           RowBox[{"AddStrandOnRight", "[", 
            RowBox[{"sm", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"EvenQ", "[", "k", "]"}], ",", "over1", ",", "over2"}],
               "]"}]}], "]"}], "+", "\[IndentingNewLine]", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"shove", "[", 
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], ",", 
                  RowBox[{"a", "+", "k"}]}], "]"}], 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                   "\[Delta]", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "a", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", "\[Delta]", ",", "1"}], 
                    "]"}], 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "k", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", 
                    RowBox[{"Power", "[", 
                    RowBox[{"\[Delta]", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], ",", 
                  "1"}], "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", "a", "]"}], "[", "\[Delta]",
                  "]"}]}], "]"}], 
              RowBox[{"TurnUpBottomRightCorner", "[", 
               RowBox[{
                RowBox[{"AddStrandOnRight", "[", 
                 RowBox[{
                  RowBox[{"TurnDownTopRightCorner", "[", 
                   RowBox[{"td", ",", 
                    RowBox[{"k", "-", "a", "-", "1"}]}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"EvenQ", "[", "a", "]"}], ",", "over1", ",", 
                    "over2"}], "]"}]}], "]"}], ",", 
                RowBox[{"k", "-", "a", "-", "1", "+", "1"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PackageIdempotents", "[", "g", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"JonesWenzlIdempotent", "[", 
      RowBox[{
      "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.447003405717081*^9, 3.447003494432659*^9}, 3.4818114152691317`*^9, {
   3.4830196933902807`*^9, 3.4830196934586697`*^9}, {3.4830322871721363`*^9, 
   3.4830322878757553`*^9}, {3.483201237864205*^9, 3.483201252594293*^9}, {
   3.48320204151832*^9, 3.483202067791091*^9}, {3.4832025340820637`*^9, 
   3.483202543872821*^9}, 3.52691294937321*^9, {3.5269131767975273`*^9, 
   3.5269132281126833`*^9}, {3.526913277940961*^9, 3.5269132915010567`*^9}, {
   3.5269133586077843`*^9, 3.526913377806181*^9}, 3.52691344361539*^9, {
   3.5269134789980717`*^9, 3.5269134810048027`*^9}, {3.526913560536415*^9, 
   3.52691359871546*^9}, {3.527457363305416*^9, 3.527457367376017*^9}, {
   3.527457522471744*^9, 3.527457529442719*^9}, {3.527457562110259*^9, 
   3.527457564207642*^9}, {3.527458173463109*^9, 3.527458173758203*^9}, {
   3.527458393516523*^9, 3.527458396827712*^9}, {3.527524906650465*^9, 
   3.527524942392817*^9}, {3.5396204681243467`*^9, 3.539620646761516*^9}, {
   3.5396207535607023`*^9, 3.539620803766368*^9}, {3.5396208713370247`*^9, 
   3.539620881244814*^9}, {3.5396209505550127`*^9, 3.5396209513423862`*^9}, {
   3.539621317042019*^9, 3.5396213226545477`*^9}, {3.5396213548889093`*^9, 
   3.539621369439494*^9}, {3.539621445029376*^9, 3.5396215424053993`*^9}, {
   3.5396215771231413`*^9, 3.5396215970786343`*^9}, {3.53962184208462*^9, 
   3.539621942426655*^9}, {3.539621976570566*^9, 3.5396219904207163`*^9}, {
   3.539622518268214*^9, 3.539622546866253*^9}, {3.539622624312908*^9, 
   3.5396226995918818`*^9}, {3.545690148828679*^9, 
   3.5456901679443617`*^9}},ExpressionUUID->"a3fdd223-3a8d-4495-88c1-\
aa3b1e09a1a7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",",
       "k_", ",", 
      RowBox[{"over1", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
      RowBox[{"over2", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
     "]"}], "/;", 
    RowBox[{"k", ">", "1"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LoadIdempotents", "[", "g", "]"}], ",", 
     RowBox[{"JonesWenzlIdempotent", "[", 
      RowBox[{
      "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"JonesWenzlIdempotent", "[", 
          RowBox[{
          "g", ",", "k", ",", "over1", ",", "over2", ",", 
           "pivotalStructure"}], "]"}], "=", 
         RowBox[{"result", "=", 
          RowBox[{"WenzlRecursion", "[", 
           RowBox[{
            RowBox[{"JonesWenzlIdempotent", "[", 
             RowBox[{"g", ",", 
              RowBox[{"k", "-", "1"}], ",", "over1", ",", "over2", ",", 
              "pivotalStructure"}], "]"}], ",", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Delta]", "=", 
                RowBox[{"DimensionOfGenerator", "[", "g", "]"}]}], "}"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"ToNumberField0", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "k", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", "\[Delta]", ",", 
                    FractionBox["1", "\[Delta]"]}], "]"}], 
                   FractionBox[
                    RowBox[{
                    RowBox[{"qInteger\[Delta]", "[", 
                    RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                    RowBox[{
                    RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                    "\[Delta]", "]"}]]}], ",", 
                  RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"RootReduce", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", 
                    RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                   "\[Delta]", "]"}]], "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PackageIdempotents", "[", "g", "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.447003405717081*^9, 3.447003494432659*^9}, 3.4818114152691317`*^9, {
   3.4830196933902807`*^9, 3.4830196934586697`*^9}, {3.4830322871721363`*^9, 
   3.4830322878757553`*^9}, {3.483201237864205*^9, 3.483201252594293*^9}, {
   3.48320204151832*^9, 3.483202067791091*^9}, {3.4832025340820637`*^9, 
   3.483202543872821*^9}, 3.52691294937321*^9, {3.5269131767975273`*^9, 
   3.5269132281126833`*^9}, {3.526913277940961*^9, 3.5269132915010567`*^9}, {
   3.5269133586077843`*^9, 3.526913377806181*^9}, 3.52691344361539*^9, {
   3.5269134789980717`*^9, 3.5269134810048027`*^9}, {3.526913560536415*^9, 
   3.52691359871546*^9}, {3.527457363305416*^9, 3.527457367376017*^9}, {
   3.527457522471744*^9, 3.527457529442719*^9}, {3.527457562110259*^9, 
   3.527457564207642*^9}, {3.527458173463109*^9, 3.527458173758203*^9}, {
   3.527458393516523*^9, 3.527458396827712*^9}, {3.527524906650465*^9, 
   3.527524942392817*^9}, {3.5396206010979853`*^9, 3.539620601975959*^9}, {
   3.539622729749608*^9, 
   3.5396227323073673`*^9}},ExpressionUUID->"735fbc5e-5f67-48ef-b230-\
7c99b8ce1e7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadIdempotents", "[", 
   RowBox[{"g", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Needs", "[", 
      RowBox[{"\"\<FusionAtlas`Data`\>\"", "<>", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"(", 
          RowBox[{"GraphToString", "/@", "g"}], ")"}]}], ")"}], "<>", 
       "\"\<`Idempotents`\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"On", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LoadIdempotents", "[", "g", "]"}], "=", "False"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411927026253885*^9, 3.4119270365386734`*^9}, {
   3.4140209075797215`*^9, 3.4140209151906652`*^9}, {3.446846517382749*^9, 
   3.446846561881503*^9}, {3.446846810617436*^9, 3.446846812981331*^9}, 
   3.446846981170701*^9, {3.446847052448126*^9, 3.446847055221373*^9}, {
   3.446847383054578*^9, 3.446847384819085*^9}, {3.447003351141345*^9, 
   3.447003364246028*^9}, 3.5275249603720083`*^9, {3.532363003046315*^9, 
   3.5323630039014683`*^9}, {3.536340669170742*^9, 
   3.536340670217553*^9}},ExpressionUUID->"705469e9-114f-4eff-aed3-\
f01c75b2251c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2Equation", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "r", ",", "f"}], "}"}], ",", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"CollectGPA4Matrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"LowestWeightEigenspace", "[", 
             RowBox[{
             "G", ",", "\"\<Lopsided\>\"", ",", "\[Lambda]", ",", "0"}], 
             "]"}], "[", "c", "]"}], ",", "_c"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"ToNumberField0", "[", 
          RowBox[{
           RowBox[{"RootReduce", "[", 
            RowBox[{"BranchFactor", "[", 
             RowBox[{
             "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "]"}], ",", 
           RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GPA4Element", "[", 
         RowBox[{
          RowBox[{"S", ".", "S"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r", "-", "1"}], ")"}], "S"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{"JonesWenzlIdempotent", "[", 
            RowBox[{"G", ",", 
             RowBox[{
              RowBox[{"DepthOfBranchPoint", "[", 
               RowBox[{
               "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Lopsided\>\""}], 
            "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5275227249163017`*^9, 3.527522767648981*^9}, {
   3.527522804001464*^9, 3.527522865281333*^9}, {3.527522897233316*^9, 
   3.527522898033206*^9}, {3.527522930834103*^9, 3.527522943209852*^9}, {
   3.527523321407069*^9, 3.527523360448002*^9}, 3.527523449602442*^9, {
   3.528115612350113*^9, 3.528115614538558*^9}, {3.5281159846266813`*^9, 
   3.5281159850736847`*^9}, {3.605361435051762*^9, 
   3.605361436082817*^9}},ExpressionUUID->"1cf74d9c-5682-4254-807a-\
f0007cae0219"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgressiveRowReduce", "[", 
   RowBox[{"matrix_", ",", 
    RowBox[{"p_:", "50"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"counter", "=", "0"}], ",", 
      RowBox[{"result", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"remainingRows", "=", "matrix"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "remainingRows", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "counter", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"counter", "+=", 
         RowBox[{"Min", "[", 
          RowBox[{"p", ",", 
           RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"RowReduce", "[", 
            RowBox[{"result", "~", "Join", "~", 
             RowBox[{"Take", "[", 
              RowBox[{"remainingRows", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"p", ",", 
                 RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", "..."}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"remainingRows", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"remainingRows", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"p", ",", 
             RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5389452908120403`*^9, 
  3.5389452926918488`*^9}},ExpressionUUID->"96a143d7-4a40-4802-acf4-\
d7a0b38f546a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RowReducedS2Equation", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "quadratics", ",", "variables", ",", "vectors", ",", "rr", ",", 
      "monomials"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"quadratics", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"GPACoefficients", "[", 
             RowBox[{
              RowBox[{"S2Equation", "[", 
               RowBox[{"G", ",", "\[Lambda]"}], "]"}], "[", "c", "]"}], "]"}],
             "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"variables", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"quadratics", ",", 
            RowBox[{"c", "[", "i_", "]"}], ",", "\[Infinity]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectors", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Normal", "[", 
            RowBox[{"CoefficientArrays", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"quadratics", ",", "All"}], "]"}], ",", "variables"}], 
             "]"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rr", "=", 
         RowBox[{"ProgressiveRowReduce", "[", 
          RowBox[{"vectors", ",", "20"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"monomials", "=", 
         RowBox[{
          RowBox[{"{", "1", "}"}], "~", "Join", "~", "variables", "~", "Join",
           "~", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "variables", ",", "variables"}], "]"}], 
            ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"rr", ",", 
           RowBox[{"_", "?", "ZeroVectorQ"}]}], "]"}], ".", "monomials"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5389450456949577`*^9, 3.5389450851839046`*^9}, {
   3.538945117356567*^9, 3.538945213151616*^9}, {3.53894527216418*^9, 
   3.538945272328948*^9}, {3.538945320950612*^9, 3.5389453366740437`*^9}, {
   3.538945371634369*^9, 3.538945377063497*^9}, 
   3.538947473668989*^9},ExpressionUUID->"5fada6a9-6028-4405-84fa-\
74704289ff4a"],

Cell[BoxData[
 RowBox[{"Clear", "[", "S2Solutions", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5275236606264887`*^9, 
  3.527523662969486*^9}},ExpressionUUID->"dd7ae55f-b0c8-4405-99d7-\
773094890b1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2Solutions", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"simplifyCoefficient", ",", "S", ",", "gb", ",", "solution"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"simplifyCoefficient", "[", "x_", "]"}], ":=", 
      RowBox[{"ToNumberField", "[", 
       RowBox[{"x", ",", 
        RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"S", "=", 
          RowBox[{"CollectGPA4Matrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LowestWeightEigenspace", "[", 
              RowBox[{
              "G", ",", "\"\<Lopsided\>\"", ",", "\[Lambda]", ",", "0"}], 
              "]"}], "[", "c", "]"}], ",", "_c"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gb", "=", 
          RowBox[{"GroebnerBasis", "[", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"GPACoefficients", "[", 
                RowBox[{
                 RowBox[{"S2Equation", "[", 
                  RowBox[{"G", ",", "\[Lambda]"}], "]"}], "[", "c", "]"}], 
                "]"}], "]"}], ",", "_c"}], "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"S", ",", "_c", ",", "\[Infinity]"}], "]"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gb", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "_AlgebraicNumber"}], "]"}], ",", "#", ",", 
               
               RowBox[{"#", "/", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{
                  "#", ",", "_AlgebraicNumber", ",", "\[Infinity]", ",", 
                   "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], "&"}], "/@", 
           "gb"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solution", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{"gb", "\[Equal]", "0"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"x_", ",", 
               RowBox[{"1", "/", "2"}]}], "]"}], "\[RuleDelayed]", 
             RowBox[{"simplifyCoefficient", "[", 
              RowBox[{"Power", "[", 
               RowBox[{"x", ",", 
                RowBox[{"1", "/", "2"}]}], "]"}], "]"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"CollectGPA4Matrix", "[", 
            RowBox[{"#", ",", "_c", ",", "simplifyCoefficient"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"S", "/.", "solution"}], ")"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527522967220997*^9, 3.527523057172282*^9}, {
   3.527523263481176*^9, 3.527523281424225*^9}, {3.527523362863368*^9, 
   3.527523368599287*^9}, {3.527523419394809*^9, 3.527523419761902*^9}, 
   3.527523451593265*^9, {3.527523515747695*^9, 3.527523524418405*^9}, {
   3.527523564818116*^9, 3.527523633934444*^9}, {3.527523705823703*^9, 
   3.527523706942479*^9}, 3.5275238380054827`*^9, {3.527523964238154*^9, 
   3.527523964494076*^9}, {3.528115565667251*^9, 3.528115569522612*^9}, {
   3.528115702830282*^9, 3.528115739858309*^9}, {3.528115801975875*^9, 
   3.528115815866865*^9}, {3.528116174920532*^9, 3.5281161874796143`*^9}, {
   3.528116221295824*^9, 3.528116225110549*^9}, {3.528463190366487*^9, 
   3.528463194286661*^9}, {3.528463279538979*^9, 
   3.528463312022657*^9}},ExpressionUUID->"9301ffca-3f83-4027-b999-\
1b5d7fbd9f84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["One cup JW", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5418583082891808`*^9, 
  3.541858310001275*^9}},ExpressionUUID->"247d4ad4-bd3c-4dc4-9736-\
6b04fcd7c1a6"],

Cell[BoxData[
 RowBox[{"Clear", "[", "IdentityTL", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541859152566949*^9, 
  3.541859156023349*^9}},ExpressionUUID->"e7d30e74-3041-4be9-9fce-\
57cfdd58e3f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IdentityTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "0", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"EmptyGPA4Element", "[", 
   RowBox[{"G", ",", "over1", ",", "pivotalStructure"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541859126479774*^9, 3.541859135411221*^9}, {
  3.5418595993201237`*^9, 
  3.541859600158166*^9}},ExpressionUUID->"53062041-99e6-4dc9-b796-\
f8c0ab9c2291"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IdentityTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"IdentityTL", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "over", ",", "paths", ",", "rpath", ",", "ae", ",", "be", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "values"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing IdentityTL[G,\>\"", ",", "n", ",", "\"\<, ...]\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "0", "]"}], "=", "over1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "1", "]"}], "=", "over2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paths", "=", 
       RowBox[{"GraphPaths", "[", 
        RowBox[{"G", ",", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"over1", ",", "over2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "/", "2"}], "+", "1"}], "}"}]}], "]"}], ",", 
             "1"}], "]"}], ",", 
           RowBox[{"n", "+", "1"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rpath", "=", 
              RowBox[{"Reverse", "[", "path", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PathToLoop", "[", 
               RowBox[{"ConcatenatePaths", "[", 
                RowBox[{"path", ",", "rpath"}], "]"}], "]"}], "\[Rule]", 
              "1"}]}]}], "\[IndentingNewLine]", "]"}], "/@", "paths"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"G", ",", 
        RowBox[{"Most", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"over1", ",", "over2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
        "values"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549347531085*^9, 3.542549398567725*^9}, {
   3.542549492266087*^9, 3.5425495062339487`*^9}, {3.542549543800351*^9, 
   3.5425495590890493`*^9}, {3.542549732095945*^9, 3.542549789658887*^9}, {
   3.542549848409892*^9, 3.542549848471713*^9}, {3.5425498921747713`*^9, 
   3.542549979376711*^9}, {3.542550086566765*^9, 3.542550106946743*^9}, {
   3.542550275818598*^9, 3.542550365254471*^9}, {3.5425504623320427`*^9, 
   3.5425504978659477`*^9}, {3.542550555696291*^9, 3.5425505574158363`*^9}, {
   3.5425506408520184`*^9, 3.542550746508684*^9}, {3.542550888180461*^9, 
   3.5425509014950447`*^9}, {3.542551056996614*^9, 3.542551302602466*^9}, {
   3.542551466136601*^9, 3.542551602768509*^9}, 3.54255168838967*^9, {
   3.5425517486600037`*^9, 3.542551767258574*^9}, {3.542551856051229*^9, 
   3.542551915945138*^9}, {3.542551952767187*^9, 3.542551977833879*^9}, {
   3.542552063597136*^9, 3.542552071701633*^9}, {3.542552254702835*^9, 
   3.5425522609355297`*^9}, {3.542552325221184*^9, 3.542552325535075*^9}, {
   3.542552580780795*^9, 3.542552586140863*^9}, {3.542553736857193*^9, 
   3.54255378681605*^9}, {3.542996390840514*^9, 3.5429963949292793`*^9}, {
   3.5429964306611633`*^9, 3.542996568303993*^9}, {3.542996795415884*^9, 
   3.5429967955821667`*^9}, {3.542996847838813*^9, 
   3.5429968532936993`*^9}},ExpressionUUID->"82c57096-c8d8-45ca-8e4d-\
55c5cf33d84d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "a", " ", "counts", " ", "the", " ", "number", " ", "of", " ", "strands", 
    " ", "until", " ", "the", " ", "cup", " ", "from", " ", "the", " ", "top",
     " ", "left"}], ",", " ", 
   RowBox[{
   "b", " ", "counts", " ", "from", " ", "the", " ", "bottom", " ", 
    "right"}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549646821637*^9, 
  3.542549663669264*^9}},ExpressionUUID->"8d51aaf2-3d8e-4d47-a122-\
ff5502939fb8"],

Cell[BoxData[
 RowBox[{"Clear", "[", "OneCupTL", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542552376036706*^9, 
  3.5425523780411377`*^9}},ExpressionUUID->"e16bc11f-f079-4db6-89d7-\
bc50e0731a2d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"OneCupTL", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "n_Integer", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OneCupTL", "[", 
      RowBox[{"G", ",", "n", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
       "pivotalStructure"}], "]"}], "="}], "*)"}], 
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{
     RowBox[{"AddStrandOnRight", "[", 
      RowBox[{
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{
           RowBox[{"TurnDownTopRightCorner", "[", 
            RowBox[{
             RowBox[{"IdentityTL", "[", 
              RowBox[{"G", ",", 
               RowBox[{"n", "-", "2"}], ",", "over1", ",", "over2", ",", 
               "pivotalStructure"}], "]"}], ",", 
             RowBox[{"n", "-", "a", "-", "2"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"over1", ",", "over2"}], "}"}], "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"a", "+", "1"}], ",", "2"}], "]"}], "+", "1"}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"n", "-", "a", "-", "1", "+", "b"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"over1", ",", "over2"}], "}"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"n", "-", "b", "-", "1"}], ",", "2"}], "]"}], "+", "1"}], 
        "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"b", "+", "1"}]}], "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418583166325607`*^9, 3.541858319982934*^9}, {
  3.541858362169094*^9, 3.5418584045668993`*^9}, {3.541858732779777*^9, 
  3.54185879894238*^9}, {3.5418588585405397`*^9, 3.541858970489895*^9}, {
  3.541859000968294*^9, 3.541859009245247*^9}, {3.54185905202522*^9, 
  3.541859052905414*^9}, {3.541859182728691*^9, 3.541859183056011*^9}, {
  3.541859278100749*^9, 3.541859279638279*^9}, {3.541861862844687*^9, 
  3.541861876797091*^9}, {3.542549329978086*^9, 3.542549334768881*^9}, {
  3.542551173769002*^9, 3.5425511749842243`*^9}, {3.542551306601775*^9, 
  3.5425513094278812`*^9}, {3.542552372132662*^9, 3.542552373521541*^9}, {
  3.542552576534317*^9, 
  3.542552578812096*^9}},ExpressionUUID->"145dde6c-d6ab-4915-84b5-\
4eef3fb00c8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupPaths", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupPaths", "[", 
    RowBox[{"G", ",", "n", ",", "over1", ",", "over2"}], "]"}], "=", 
   RowBox[{"GraphPaths", "[", 
    RowBox[{"G", ",", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"over1", ",", "over2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", "/", "2"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5430043074203653`*^9, 
  3.543004333779272*^9}},ExpressionUUID->"b9f5fec7-a176-4eac-a2a6-\
2e4f4afee005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupTL", "[", 
    RowBox[{"G", ",", "n", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
     "pivotalStructure"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "over", ",", "paths", ",", "rpath", ",", "ae", ",", "be", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "values"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing OneCupTL[G,\>\"", ",", "n", ",", "\"\<,\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", "\"\<...\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "0", "]"}], "=", "over1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "1", "]"}], "=", "over2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paths", "=", 
       RowBox[{"OneCupPaths", "[", 
        RowBox[{"G", ",", "n", ",", "over1", ",", "over2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rpath", "=", 
              RowBox[{"Reverse", "[", "path", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ae", "=", 
              RowBox[{"EdgesAdjacentTo", "[", 
               RowBox[{"G", ",", 
                RowBox[{"path", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"over", "[", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"a", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"be", "=", 
              RowBox[{"EdgesAdjacentTo", "[", 
               RowBox[{"G", ",", 
                RowBox[{"rpath", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"over", "[", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "b", "+", "1"}], ",", "2"}], "]"}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p1", ",", "p2"}], "}"}], "=", 
              RowBox[{"SplitPathAt", "[", 
               RowBox[{"path", ",", "a"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p3", ",", "p4"}], "}"}], "=", 
              RowBox[{"SplitPathAt", "[", 
               RowBox[{"rpath", ",", "b"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Outer", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"PathToLoop", "[", 
                    RowBox[{"ConcatenatePaths", "[", 
                    RowBox[{"p1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "p2", ",", "p3", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "p4"}], "]"}], 
                    "]"}], "\[Rule]", 
                   RowBox[{
                    RowBox[{"CriticalPointCoefficient", "[", 
                    RowBox[{"G", ",", "1", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", "pivotalStructure"}], "]"}], 
                    RowBox[{"CriticalPointCoefficient", "[", 
                    RowBox[{"G", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], 
                    "]"}]}]}], "&"}], ",", "\[IndentingNewLine]", "ae", ",", 
                 "be", ",", "1"}], "]"}], ",", "1"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], "/@", "paths"}], ",", "1"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"G", ",", 
        RowBox[{"Most", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"over1", ",", "over2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
        "values"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549347531085*^9, 3.542549398567725*^9}, {
   3.542549492266087*^9, 3.5425495062339487`*^9}, {3.542549543800351*^9, 
   3.5425495590890493`*^9}, {3.542549732095945*^9, 3.542549789658887*^9}, {
   3.542549848409892*^9, 3.542549848471713*^9}, {3.5425498921747713`*^9, 
   3.542549979376711*^9}, {3.542550086566765*^9, 3.542550106946743*^9}, {
   3.542550275818598*^9, 3.542550365254471*^9}, {3.5425504623320427`*^9, 
   3.5425504978659477`*^9}, {3.542550555696291*^9, 3.5425505574158363`*^9}, {
   3.5425506408520184`*^9, 3.542550746508684*^9}, {3.542550888180461*^9, 
   3.5425509014950447`*^9}, {3.542551056996614*^9, 3.542551302602466*^9}, {
   3.542551466136601*^9, 3.542551602768509*^9}, 3.54255168838967*^9, {
   3.5425517486600037`*^9, 3.542551767258574*^9}, {3.542551856051229*^9, 
   3.542551915945138*^9}, {3.542551952767187*^9, 3.542551977833879*^9}, {
   3.542552063597136*^9, 3.542552071701633*^9}, {3.542552254702835*^9, 
   3.5425522609355297`*^9}, {3.542552325221184*^9, 3.542552325535075*^9}, {
   3.542552580780795*^9, 3.542552586140863*^9}, {3.542553736857193*^9, 
   3.54255378681605*^9}, 
   3.543004345810095*^9},ExpressionUUID->"f7d9a8d2-240d-4eb7-96e6-\
a66b1b695e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupJonesWenzl", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupJonesWenzl", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IdentityTL", "[", 
     RowBox[{
     "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Delta]", "=", 
            RowBox[{"DimensionOfGenerator", "[", "G", "]"}]}], ",", 
           RowBox[{"aa", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"a", ",", 
              RowBox[{"n", "-", "b", "-", "2"}]}], "]"}]}], ",", 
           RowBox[{"bb", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"b", ",", 
              RowBox[{"n", "-", "a", "-", "2"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cc", "=", 
             RowBox[{"n", "-", "aa", "-", "bb", "-", "2"}]}], "}"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"cc", "+", "1"}]], 
            RowBox[{
             RowBox[{"qInteger\[Delta]", "[", 
              RowBox[{"aa", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
            RowBox[{
             RowBox[{"qInteger\[Delta]", "[", 
              RowBox[{"bb", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
            SuperscriptBox[
             RowBox[{
              RowBox[{"qInteger\[Delta]", "[", "n", "]"}], "[", "\[Delta]", 
              "]"}], 
             RowBox[{"-", "1"}]]}]}], "]"}]}], "]"}], 
       RowBox[{"OneCupTL", "[", 
        RowBox[{"G", ",", "n", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
         "pivotalStructure"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "0", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418619882353897`*^9, 3.5418620706816998`*^9}, {
  3.541862225138234*^9, 3.541862229481957*^9}, {3.541862464817371*^9, 
  3.541862599399908*^9}, {3.5418629506343317`*^9, 3.541862950770574*^9}, {
  3.5418635520063*^9, 3.541863563732616*^9}, {3.542552602680297*^9, 
  3.54255263204488*^9}},ExpressionUUID->"fb6593f2-f1e5-4201-8572-\
b7479130a3f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SomeOneCupJonesWenzl", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"EvenQ", "[", "n", "]"}]}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SomeOneCupJonesWenzl", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<beginning SomeOneCupJonesWenzl[\>\"", ",", "G", ",", "\"\<,\>\"", 
        ",", "n", ",", "\"\<...]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{"IdentityTL", "[", 
         RowBox[{
         "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}],
          "]"}], "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Delta]", "=", 
                RowBox[{"DimensionOfGenerator", "[", "G", "]"}]}], ",", 
               RowBox[{"aa", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"n", "-", "b", "-", "2"}]}], "]"}]}], ",", 
               RowBox[{"bb", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"n", "-", "a", "-", "2"}]}], "]"}]}]}], "}"}], ",", 
             
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cc", "=", 
                 RowBox[{"n", "-", "aa", "-", "bb", "-", "2"}]}], "}"}], ",", 
               
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], ",", 
                  RowBox[{"cc", "+", "1"}]}], "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", 
                  RowBox[{"aa", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", 
                  RowBox[{"bb", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "n", "]"}], "[", 
                   "\[Delta]", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], 
           RowBox[{"OneCupTL", "[", 
            RowBox[{"G", ",", "n", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",",
              "pivotalStructure"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"n", "/", "2"}], "-", "1"}], ",", 
              RowBox[{"n", "-", "2"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "0", ",", 
            RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<...finished SomeOneCupJonesWenzl\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418619882353897`*^9, 3.5418620706816998`*^9}, {
  3.541862225138234*^9, 3.541862229481957*^9}, {3.541862464817371*^9, 
  3.541862599399908*^9}, {3.5418629506343317`*^9, 3.541862950770574*^9}, {
  3.5418635520063*^9, 3.541863563732616*^9}, {3.542552602680297*^9, 
  3.542552677740378*^9}, {3.542553624325164*^9, 
  3.5425537082733192`*^9}},ExpressionUUID->"474e0056-2c00-4619-a6ec-\
11f166409b53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnLeft", "[", 
   RowBox[{"A_GPA4Element", ",", "newOver_"}], "]"}], ":=", 
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnDownTopLeftCorner", "[", 
     RowBox[{"AddStrandOnRight", "[", 
      RowBox[{
       RowBox[{"TurnDownTopRightCorner", "[", 
        RowBox[{"A", ",", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       "newOver"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5430257568029423`*^9, 3.5430257801197367`*^9}, {
   3.543025889345511*^9, 3.543025943646214*^9}, 
   3.543026145401775*^9},ExpressionUUID->"51e14d0a-0628-405d-8578-\
bf46e639a28d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AnnularConsequences", "[", 
   RowBox[{"A_GPA4Element", ",", "\[Sigma]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AnnularConsequences", "[", 
    RowBox[{"A", ",", "\[Sigma]"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{
        "A", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GPAFourierTransformTwice", "[", "#", "]"}], "&"}], ",", 
            
            RowBox[{"AddStrandOnLeft", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Sigma]", 
                RowBox[{"-", "1"}]], 
               RowBox[{"GPAFourierTransform", "[", "A", "]"}]}], ",", 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            ",", 
            RowBox[{"n", "/", "2"}]}], "]"}], ",", 
          RowBox[{"GPAFourierTransform", "/@", 
           RowBox[{"NestList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GPAFourierTransformTwice", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"AddStrandOnLeft", "[", 
              RowBox[{"A", ",", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
             ",", 
             RowBox[{"n", "/", "2"}]}], "]"}]}]}], "}"}], "]"}], ",", "1"}], 
      "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543025423208015*^9, 3.5430254256193657`*^9}, {
  3.5430254963718853`*^9, 3.5430254997944183`*^9}, {3.5430255869590263`*^9, 
  3.543025753413122*^9}, {3.543026016131926*^9, 3.543026085471298*^9}, {
  3.543026144244259*^9, 3.543026157010627*^9}, {3.543027391520307*^9, 
  3.543027392894012*^9}, {3.5430274262654743`*^9, 3.543027428292946*^9}, {
  3.543027731200832*^9, 3.5430277334161053`*^9}, {3.54308811263421*^9, 
  3.54308811303325*^9}, {3.543168904355732*^9, 3.543168937566701*^9}, {
  3.543168986537202*^9, 3.543168988571419*^9}, {3.5431709579689207`*^9, 
  3.5431709678243437`*^9}, {3.544298576914394*^9, 
  3.5442985815677843`*^9}},ExpressionUUID->"4f65aa96-9528-47d7-a982-\
12a615ff8287"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACirc", "[", 
   RowBox[{"A_GPA4Element", ",", "B_GPA4Element"}], "]"}], ":=", 
  RowBox[{"GPAMultiply", "[", 
   RowBox[{
    RowBox[{"TurnDownTopRightCorner", "[", "A", "]"}], ",", 
    RowBox[{"TurnUpBottomRightCorner", "[", "B", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543026104352758*^9, 
  3.543026140254827*^9}},ExpressionUUID->"fae67a21-855d-439e-a657-\
5f69917d45c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAStar", "[", 
   RowBox[{"S_GPA4Element", ",", "T_GPA4Element"}], "]"}], ":=", 
  RowBox[{"GPAFourierTransform", "[", 
   RowBox[{"GPACirc", "[", 
    RowBox[{
     RowBox[{"GPAFourierTransform", "[", "S", "]"}], ",", 
     RowBox[{"GPAFourierTransform", "[", "T", "]"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556487184723236*^9, 
  3.556487211391399*^9}},ExpressionUUID->"a1f7e653-3b32-4be3-905f-\
ed9cd1bc1ccc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7bd86cf8-1489-4797-a177-072ca0e7d29a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"ad3ac81b-303d-4633-bf1b-1be9b91a6509"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
Evaluator->"Local (2)",
WindowSize->{1440, 852},
WindowMargins->{{120, Automatic}, {103, Automatic}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1066, 20, 70, "Input", "ExpressionUUID" -> \
"fd63c85c-1b81-4fb9-8546-85e839d566fa",
 InitializationCell->True],
Cell[1614, 42, 2784, 43, 1372, "Input", "ExpressionUUID" -> \
"454c88e6-25a4-43ca-bf25-3df16372f672",
 InitializationCell->True],
Cell[4401, 87, 524, 12, 70, "Input", "ExpressionUUID" -> \
"4328e29b-8320-4ea9-81b2-faf2b36528cd",
 InitializationCell->True],
Cell[4928, 101, 177, 4, 48, "Input", "ExpressionUUID" -> \
"d2046164-4fc2-433c-873c-ecd2ab09f798",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5130, 109, 188, 4, 44, "Subsection", "ExpressionUUID" -> \
"b6e28ace-c0a9-424a-9cad-93463549e74e",
 InitializationCell->True],
Cell[5321, 115, 818, 21, 51, "Input", "ExpressionUUID" -> \
"342ba11b-aa79-4689-886f-10d4aa0f982a",
 InitializationCell->True],
Cell[6142, 138, 883, 21, 70, "Input", "ExpressionUUID" -> \
"c5a7dbf9-2da0-43c9-ba77-9624c07840a9",
 InitializationCell->True],
Cell[7028, 161, 2384, 57, 280, "Input", "ExpressionUUID" -> \
"f5f2b95f-637e-48d2-a7d4-368d82a5936f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9449, 223, 194, 4, 44, "Subsection", "ExpressionUUID" -> \
"ae2e5282-d80a-429a-9cc2-d03aa98f8900",
 InitializationCell->True],
Cell[9646, 229, 2996, 69, 238, "Input", "ExpressionUUID" -> \
"ee311e44-3769-440d-a7b0-01395a5d140f",
 InitializationCell->True],
Cell[12645, 300, 158, 3, 48, "Input", "ExpressionUUID" -> \
"ce6f90a1-71c3-4e35-befe-ae64b60c6a47",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[12840, 308, 244, 5, 44, "Subsection", "ExpressionUUID" -> \
"65f530f9-8b13-4299-b42f-6a05b199facb",
 InitializationCell->True],
Cell[13087, 315, 228, 5, 48, "Input", "ExpressionUUID" -> \
"23d8a144-d687-496c-9eb4-5ef0b9db5d0b",
 InitializationCell->True],
Cell[13318, 322, 1622, 36, 91, "Input", "ExpressionUUID" -> \
"3f921052-0994-4b75-907e-a992e61f7c38",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[14977, 363, 204, 4, 44, "Subsection", "ExpressionUUID" -> \
"ae8f8704-97ef-46f0-92b6-c8fee13c0960",
 InitializationCell->True],
Cell[15184, 369, 1633, 40, 163, "Input", "ExpressionUUID" -> \
"aa2528cf-9f3d-4124-9059-e847ce84d489",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16854, 414, 195, 4, 44, "Subsection", "ExpressionUUID" -> \
"208d3b3a-8d52-4964-98b3-d94dfd1e3ec1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[17074, 422, 198, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"fc58ab81-2903-43ee-a396-8978a6fcc588",
 InitializationCell->True],
Cell[17275, 427, 709, 13, 49, "Text", "ExpressionUUID" -> \
"58bf1970-fe00-4983-8ca0-0268ac729c05",
 InitializationCell->True],
Cell[17987, 442, 1380, 38, 70, "Input", "ExpressionUUID" -> \
"bed30cb1-1e7d-4a1d-a6eb-7d7975086ac1",
 InitializationCell->True],
Cell[19370, 482, 624, 17, 70, "Input", "ExpressionUUID" -> \
"b49423aa-9c0d-4411-8e7f-0fc9cb532725",
 InitializationCell->True],
Cell[19997, 501, 5051, 115, 217, "Input", "ExpressionUUID" -> \
"3699af70-3ba7-46fe-917d-21a9937390c5",
 InitializationCell->True],
Cell[25051, 618, 3433, 90, 196, "Input", "ExpressionUUID" -> \
"24cc36f9-df11-41bf-923b-f1cb95d4ea63",
 InitializationCell->True],
Cell[28487, 710, 224, 5, 48, "Input", "ExpressionUUID" -> \
"8858adb9-c90c-4e32-9307-eaf322f499b9",
 InitializationCell->True],
Cell[28714, 717, 477, 10, 48, "Input", "ExpressionUUID" -> \
"389dea9c-69bd-4998-a0b5-55aad065a9a1",
 InitializationCell->True],
Cell[29194, 729, 5951, 134, 238, "Input", "ExpressionUUID" -> \
"900417a4-6b80-4a35-ace0-915997efa2d1",
 InitializationCell->True],
Cell[35148, 865, 3590, 92, 238, "Input", "ExpressionUUID" -> \
"48558dfe-ece7-4800-92d4-96a1cf8743da",
 InitializationCell->True],
Cell[38741, 959, 594, 15, 48, "Input", "ExpressionUUID" -> \
"aba899e8-dc0b-448d-b576-b933bafc054d",
 InitializationCell->True],
Cell[39338, 976, 1622, 44, 91, "Input", "ExpressionUUID" -> \
"8879954b-e5df-4b6d-96d4-03d866840616",
 InitializationCell->True],
Cell[40963, 1022, 666, 19, 50, "Input", "ExpressionUUID" -> \
"1d65689d-96e1-4c9a-95bd-ce3723e2d071",
 InitializationCell->True],
Cell[41632, 1043, 3117, 75, 238, "Input", "ExpressionUUID" -> \
"2143418a-7275-4bb8-9e02-50d48825e7c8",
 InitializationCell->True],
Cell[44752, 1120, 3004, 73, 175, "Input", "ExpressionUUID" -> \
"55a767d4-f799-4c02-b308-eba49f04cbc9",
 InitializationCell->True],
Cell[47759, 1195, 3013, 73, 154, "Input", "ExpressionUUID" -> \
"5f0476c1-0e2c-4b7f-aed2-3ba9a8d61352",
 InitializationCell->True],
Cell[50775, 1270, 2891, 72, 133, "Input", "ExpressionUUID" -> \
"17a67f02-b7c5-4f30-917b-eca62e64ab89",
 InitializationCell->True],
Cell[53669, 1344, 2066, 50, 343, "Input", "ExpressionUUID" -> \
"d8130fdf-baa9-401a-805e-52633602a51b",
 InitializationCell->True],
Cell[55738, 1396, 1730, 44, 301, "Input", "ExpressionUUID" -> \
"1c0bfc48-7bfb-4b17-a559-458c8909bd33",
 InitializationCell->True],
Cell[57471, 1442, 3125, 77, 217, "Input", "ExpressionUUID" -> \
"2143418a-7275-4bb8-9e02-50d48825e7c8",
 InitializationCell->True],
Cell[60599, 1521, 808, 20, 48, "Input", "ExpressionUUID" -> \
"0f09032d-fc69-4ec2-ae13-0783cc3332a3",
 InitializationCell->True],
Cell[61410, 1543, 2704, 67, 196, "Input", "ExpressionUUID" -> \
"127cbafc-75bc-4bab-b64c-49832dbeac77",
 InitializationCell->True],
Cell[64117, 1612, 1772, 47, 91, "Input", "ExpressionUUID" -> \
"9858a836-3e88-4da4-96a9-c48b9972c1a7",
 InitializationCell->True],
Cell[65892, 1661, 4455, 105, 343, "Input", "ExpressionUUID" -> \
"2143418a-7275-4bb8-9e02-50d48825e7c8",
 InitializationCell->True],
Cell[70350, 1768, 4364, 105, 322, "Input", "ExpressionUUID" -> \
"2143418a-7275-4bb8-9e02-50d48825e7c8",
 InitializationCell->True],
Cell[74717, 1875, 1786, 46, 113, "Input", "ExpressionUUID" -> \
"651aac16-0e1c-44d6-b521-2ee89b29a161",
 InitializationCell->True],
Cell[76506, 1923, 1396, 37, 92, "Input", "ExpressionUUID" -> \
"96a93bfc-c54d-41b1-ae01-02a6431aa0e0",
 InitializationCell->True],
Cell[77905, 1962, 551, 13, 70, "Input", "ExpressionUUID" -> \
"5999543e-8637-4875-8b64-5740f3ed2edb",
 InitializationCell->True],
Cell[78459, 1977, 2981, 80, 176, "Input", "ExpressionUUID" -> \
"272d7628-6d2a-452f-812b-89ebd15eb370",
 InitializationCell->True],
Cell[81443, 2059, 361, 8, 48, "Input", "ExpressionUUID" -> \
"0f5e8906-aa69-4ed2-a7d9-922eaba96e00",
 InitializationCell->True],
Cell[81807, 2069, 5762, 138, 280, "Input", "ExpressionUUID" -> \
"7d2c2176-0a8a-4df6-b1b0-6d2835b84fcf",
 InitializationCell->True],
Cell[87572, 2209, 5472, 134, 196, "Input", "ExpressionUUID" -> \
"275267fb-2693-47e5-abb5-f4b636150369",
 InitializationCell->True],
Cell[93047, 2345, 303, 8, 48, "Input", "ExpressionUUID" -> \
"e955d044-3a12-4888-b1a4-e0715fd0f2e7",
 InitializationCell->True],
Cell[93353, 2355, 490, 13, 48, "Input", "ExpressionUUID" -> \
"c3398c40-6e1e-4c9f-a7e9-979c940a611f",
 InitializationCell->True],
Cell[93846, 2370, 223, 5, 48, "Input", "ExpressionUUID" -> \
"4707d7f7-de8f-49b8-8ce1-07650fc5884c",
 InitializationCell->True],
Cell[94072, 2377, 12074, 290, 532, "Input", "ExpressionUUID" -> \
"c26cb999-8261-40f9-8c06-1649229c39c6",
 InitializationCell->True],
Cell[106149, 2669, 407, 11, 48, "Input", "ExpressionUUID" -> \
"37e2920b-dd29-4b11-a352-2b5af3c1239c",
 InitializationCell->True],
Cell[106559, 2682, 3603, 89, 175, "Input", "ExpressionUUID" -> \
"a78ebcb8-9104-49b4-9ded-99b8be9df19f",
 InitializationCell->True],
Cell[110165, 2773, 2103, 51, 91, "Input", "ExpressionUUID" -> \
"cd177bf9-1d2e-4b64-b6ed-f97098129e5e",
 InitializationCell->True],
Cell[112271, 2826, 372, 9, 48, "Input", "ExpressionUUID" -> \
"82312001-1f4f-4499-b185-a39fc51f91fd",
 InitializationCell->True],
Cell[112646, 2837, 221, 5, 48, "Input", "ExpressionUUID" -> \
"23b54a4d-5f3a-4cd5-8aa4-4461123275ac",
 InitializationCell->True],
Cell[112870, 2844, 1605, 39, 177, "Input", "ExpressionUUID" -> \
"a730295d-c81e-4908-8673-589054bfcb4f",
 InitializationCell->True],
Cell[114478, 2885, 277, 7, 48, "Input", "ExpressionUUID" -> \
"fef33628-c80f-45f2-8153-2d0122676e3b",
 InitializationCell->True],
Cell[114758, 2894, 1635, 43, 91, "Input", "ExpressionUUID" -> \
"d7a8ea77-0544-4b0b-be4d-6f56a8cb1cfa",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[116430, 2942, 187, 4, 35, "Subsubsection", "ExpressionUUID" -> \
"860977ff-9364-472d-9daa-a928a77f14f5",
 InitializationCell->True],
Cell[116620, 2948, 1669, 45, 71, "Input", "ExpressionUUID" -> \
"d3504079-7031-465a-ac90-6e4c65720f09",
 InitializationCell->True],
Cell[118292, 2995, 3693, 96, 196, "Input", "ExpressionUUID" -> \
"b61ad834-6581-49e2-a037-95ab936e6fb2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[122022, 3096, 248, 5, 35, "Subsubsection", "ExpressionUUID" -> \
"b40bcb2c-1aa5-4757-b555-d6539e40db80",
 InitializationCell->True],
Cell[122273, 3103, 3760, 89, 238, "Input", "ExpressionUUID" -> \
"5e68f65d-5a3a-45eb-86ad-cba00101c5b4",
 InitializationCell->True],
Cell[126036, 3194, 3377, 89, 259, "Input", "ExpressionUUID" -> \
"1b28b298-86e9-4626-ad70-46b35aeed8cd",
 InitializationCell->True],
Cell[129416, 3285, 1759, 44, 71, "Input", "ExpressionUUID" -> \
"705ad936-9b95-4b59-9594-107fee76ef9f",
 InitializationCell->True],
Cell[131178, 3331, 1506, 43, 112, "Input", "ExpressionUUID" -> \
"c978a585-1ccc-4bca-a421-4e130cb1561d",
 InitializationCell->True],
Cell[132687, 3376, 477, 12, 48, "Input", "ExpressionUUID" -> \
"baee6cc9-18de-4844-ae75-bd5eadfaff24",
 InitializationCell->True],
Cell[133167, 3390, 1620, 42, 70, "Input", "ExpressionUUID" -> \
"944044e4-dd52-474a-92b2-175d42f2760e",
 InitializationCell->True],
Cell[134790, 3434, 1839, 50, 91, "Input", "ExpressionUUID" -> \
"1fbb6240-e41a-4d4a-ba5b-2b009809b98d",
 InitializationCell->True],
Cell[136632, 3486, 6330, 146, 322, "Input", "ExpressionUUID" -> \
"3db0fd3c-9094-4152-b9c1-fc94772ccc13",
 InitializationCell->True],
Cell[142965, 3634, 3118, 80, 175, "Input", "ExpressionUUID" -> \
"b3e196e8-b47a-4e85-826c-15230ddf2fa0",
 InitializationCell->True],
Cell[146086, 3716, 527, 14, 70, "Input", "ExpressionUUID" -> \
"cb4fb1cb-517d-42aa-b747-667dbf93d2b5",
 InitializationCell->True],
Cell[146616, 3732, 3151, 84, 133, "Input", "ExpressionUUID" -> \
"30c3927b-5b4c-4de9-b1d6-4762d5675342",
 InitializationCell->True],
Cell[149770, 3818, 2773, 77, 133, "Input", "ExpressionUUID" -> \
"19d2b324-3e84-4aa7-9eae-13e327e334d4",
 InitializationCell->True],
Cell[152546, 3897, 1695, 46, 91, "Input", "ExpressionUUID" -> \
"ed0f433a-3f58-4c70-b327-9f888734b99a",
 InitializationCell->True],
Cell[154244, 3945, 445, 12, 48, "Input", "ExpressionUUID" -> \
"86ce5bf2-3cb0-497e-9524-6ae33a922d5c",
 InitializationCell->True],
Cell[154692, 3959, 4355, 102, 259, "Input", "ExpressionUUID" -> \
"c26bfed2-dbd6-4a51-a542-3b26ba01db6a",
 InitializationCell->True],
Cell[159050, 4063, 4566, 123, 238, "Input", "ExpressionUUID" -> \
"00872ba6-575f-4780-a7b6-f0e0c92f28a0",
 InitializationCell->True],
Cell[163619, 4188, 1122, 27, 112, "Input", "ExpressionUUID" -> \
"5f1c349d-810d-4484-942c-02ef3f161174",
 InitializationCell->True],
Cell[164744, 4217, 667, 16, 70, "Input", "ExpressionUUID" -> \
"5ca16ed5-4e0f-4a0f-83ba-42b8559c28e0",
 InitializationCell->True],
Cell[165414, 4235, 791, 19, 91, "Input", "ExpressionUUID" -> \
"b4851fa8-6183-42f5-9012-2b068ad113d5",
 InitializationCell->True],
Cell[166208, 4256, 2862, 75, 175, "Input", "ExpressionUUID" -> \
"f582e498-faa7-49c2-89f3-a50275d4b3c5",
 InitializationCell->True],
Cell[169073, 4333, 2007, 51, 91, "Input", "ExpressionUUID" -> \
"ce19df29-48a0-4c44-b8c5-879f6acb0369",
 InitializationCell->True],
Cell[171083, 4386, 1218, 32, 70, "Input", "ExpressionUUID" -> \
"d5b68dbf-1484-4482-ba44-25de5605b947",
 InitializationCell->True],
Cell[172304, 4420, 391, 9, 48, "Input", "ExpressionUUID" -> \
"1cd923de-0ed6-4a05-8004-64b2906df6a4",
 InitializationCell->True],
Cell[172698, 4431, 1288, 35, 71, "Input", "ExpressionUUID" -> \
"bca0a785-f132-48ee-9a8c-221acf7efd18",
 InitializationCell->True],
Cell[173989, 4468, 1296, 35, 92, "Input", "ExpressionUUID" -> \
"70bbc678-ba1d-4d4b-990d-391f30b7f495",
 InitializationCell->True],
Cell[175288, 4505, 2444, 68, 196, "Input", "ExpressionUUID" -> \
"1986c579-7307-4a62-834c-5d7c4deda910",
 InitializationCell->True],
Cell[177735, 4575, 231, 5, 48, "Input", "ExpressionUUID" -> \
"af0ef047-a74f-45c5-946b-dc5274532824",
 InitializationCell->True],
Cell[177969, 4582, 344, 8, 48, "Input", "ExpressionUUID" -> \
"907efbeb-cf16-4824-bf37-89876fe4f24b",
 InitializationCell->True],
Cell[178316, 4592, 2630, 63, 217, "Input", "ExpressionUUID" -> \
"53f2ca6c-6ce9-407a-89ae-7f2945ef879b",
 InitializationCell->True],
Cell[180949, 4657, 2719, 64, 217, "Input", "ExpressionUUID" -> \
"a1d40a33-7e83-4df4-b6b8-820539d92699",
 InitializationCell->True],
Cell[183671, 4723, 2858, 70, 217, "Input", "ExpressionUUID" -> \
"241189c1-36bf-42b7-8c4d-6adf3e0ad17d",
 InitializationCell->True],
Cell[186532, 4795, 2795, 68, 217, "Input", "ExpressionUUID" -> \
"32ccc77d-7b58-4869-8c34-a7948e14f7b4",
 InitializationCell->True],
Cell[189330, 4865, 1282, 30, 112, "Input", "ExpressionUUID" -> \
"def460a5-bacb-49ba-b062-d12a4b205d66",
 InitializationCell->True],
Cell[190615, 4897, 224, 5, 48, "Input", "ExpressionUUID" -> \
"866ebef8-1689-4f60-99c3-fe6687ff9d68",
 InitializationCell->True],
Cell[190842, 4904, 1581, 55, 133, "Input", "ExpressionUUID" -> \
"3aa243db-7ed2-4696-935b-62f88a0c5732",
 InitializationCell->True],
Cell[192426, 4961, 1155, 32, 71, "Input", "ExpressionUUID" -> \
"c63b5602-264e-4004-9fcb-12950fb47fa8",
 InitializationCell->True],
Cell[193584, 4995, 1147, 29, 70, "Input", "ExpressionUUID" -> \
"bf031434-db35-46a2-994a-c38ba457a78e",
 InitializationCell->True],
Cell[194734, 5026, 1371, 34, 112, "Input", "ExpressionUUID" -> \
"cd382ca5-b45f-40a9-9c54-265ae267424e",
 InitializationCell->True],
Cell[196108, 5062, 2981, 71, 141, "Input", "ExpressionUUID" -> \
"7ba8795d-ae22-4d6b-a7a9-f36566bc5e78",
 InitializationCell->True],
Cell[199092, 5135, 3423, 79, 225, "Input", "ExpressionUUID" -> \
"1efb48f4-ca4c-44e7-ab65-c81801ef91b0",
 InitializationCell->True],
Cell[202518, 5216, 229, 5, 48, "Input", "ExpressionUUID" -> \
"33f24009-b2e3-4acf-9d14-3cd737d00359",
 InitializationCell->True],
Cell[202750, 5223, 2391, 67, 133, "Input", "ExpressionUUID" -> \
"1cfcb359-5647-46fe-8b27-ee3403d3787a",
 InitializationCell->True],
Cell[205144, 5292, 1610, 45, 133, "Input", "ExpressionUUID" -> \
"4a3b525c-4de5-4a56-8dde-b9f662b70a47",
 InitializationCell->True],
Cell[206757, 5339, 5660, 134, 343, "Input", "ExpressionUUID" -> \
"e4de8ab4-2689-422c-861d-9d2fae2b39fa",
 InitializationCell->True],
Cell[212420, 5475, 1498, 39, 92, "Input", "ExpressionUUID" -> \
"2cbd58dc-27f1-4192-aeb0-b6a5a9b36590",
 InitializationCell->True],
Cell[213921, 5516, 2645, 67, 133, "Input", "ExpressionUUID" -> \
"17724db3-27ea-4121-b964-31bf9146f7dd",
 InitializationCell->True],
Cell[216569, 5585, 422, 10, 48, "Input", "ExpressionUUID" -> \
"e775e178-d46c-461a-b533-92b94b78c35b",
 InitializationCell->True],
Cell[216994, 5597, 2481, 61, 133, "Input", "ExpressionUUID" -> \
"2516d1cc-a8a0-4c10-8a06-d3b6dca08b14",
 InitializationCell->True],
Cell[219478, 5660, 1240, 24, 70, "Input", "ExpressionUUID" -> \
"2ea2c3fa-c8e8-48d5-9250-cc4bbbcdc411",
 InitializationCell->True],
Cell[220721, 5686, 235, 5, 48, "Input", "ExpressionUUID" -> \
"e6ad5000-6e71-4846-8d36-3af9047a778f",
 InitializationCell->True],
Cell[220959, 5693, 9245, 217, 469, "Input", "ExpressionUUID" -> \
"cf544687-97b4-478e-886c-3efe16ce1e00",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230253, 5916, 192, 4, 44, "Subsection", "ExpressionUUID" -> \
"89b9563f-9650-4eea-a5e5-307065af084c",
 InitializationCell->True],
Cell[230448, 5922, 6680, 152, 595, "Input", "ExpressionUUID" -> \
"1f8e3711-fdfa-4837-8bef-2a1ddb6e9dfb",
 InitializationCell->True],
Cell[237131, 6076, 876, 20, 48, "Input", "ExpressionUUID" -> \
"0f55165e-1ffa-4be5-b922-3d61aa2026b8",
 InitializationCell->True],
Cell[238010, 6098, 900, 25, 48, "Input", "ExpressionUUID" -> \
"5539ed72-11a1-4cb8-b79c-456bf2b68405",
 InitializationCell->True],
Cell[238913, 6125, 4142, 98, 217, "Input", "ExpressionUUID" -> \
"89152bc6-2bc8-4917-a7b0-df1cdad449d4",
 InitializationCell->True],
Cell[243058, 6225, 1301, 35, 91, "Input", "ExpressionUUID" -> \
"c30444c6-2658-4be5-9032-3e0af6adc99d",
 InitializationCell->True],
Cell[244362, 6262, 1211, 34, 91, "Input", "ExpressionUUID" -> \
"61d5cb21-fbb6-4aca-9a03-3001386b987d",
 InitializationCell->True],
Cell[245576, 6298, 2769, 61, 133, "Input", "ExpressionUUID" -> \
"84a9640a-e1be-40fa-a754-603dc27fb158",
 InitializationCell->True],
Cell[248348, 6361, 1233, 33, 91, "Input", "ExpressionUUID" -> \
"a9975930-c95f-4f33-b99c-d8ccb764303f",
 InitializationCell->True],
Cell[249584, 6396, 1131, 32, 91, "Input", "ExpressionUUID" -> \
"33f1d248-b0ae-4a4f-992f-df8bdf1d79ad",
 InitializationCell->True],
Cell[250718, 6430, 3862, 88, 280, "Input", "ExpressionUUID" -> \
"ed8370a3-3d46-474a-b516-57fd903568ea",
 InitializationCell->True],
Cell[254583, 6520, 701, 17, 70, "Input", "ExpressionUUID" -> \
"ea7396f1-a95d-414e-aa7b-6e17807d8b2c",
 InitializationCell->True],
Cell[255287, 6539, 2044, 54, 70, "Input", "ExpressionUUID" -> \
"09ec1ae8-afb9-4f8f-b48d-31ab983f7b9a",
 InitializationCell->True],
Cell[257334, 6595, 1656, 43, 70, "Input", "ExpressionUUID" -> \
"ee818abc-73a7-49ed-97c1-556acadd58de",
 InitializationCell->True],
Cell[258993, 6640, 232, 5, 48, "Input", "ExpressionUUID" -> \
"8ceda2d0-97ee-441d-81f0-c5571d477905",
 InitializationCell->True],
Cell[259228, 6647, 9201, 204, 553, "Input", "ExpressionUUID" -> \
"6f3a490a-56e5-48dd-98b5-5220ace81b84",
 InitializationCell->True],
Cell[268432, 6853, 229, 5, 48, "Input", "ExpressionUUID" -> \
"26abc645-8df0-4637-9dc1-3a3864631e44",
 InitializationCell->True],
Cell[268664, 6860, 8572, 188, 553, "Input", "ExpressionUUID" -> \
"2425d38b-3f72-49d6-8c91-58f7f1fbafca",
 InitializationCell->True],
Cell[277239, 7050, 1661, 39, 175, "Input", "ExpressionUUID" -> \
"27b84bba-8e61-46ed-bc4d-774f6309207f",
 InitializationCell->True],
Cell[278903, 7091, 234, 5, 48, "Input", "ExpressionUUID" -> \
"ea2de765-e658-48a4-944c-780482f769be",
 InitializationCell->True],
Cell[279140, 7098, 6094, 136, 364, "Input", "ExpressionUUID" -> \
"d73523ae-2b58-4901-a43d-5e40e452d02c",
 InitializationCell->True],
Cell[285237, 7236, 256, 6, 48, "Input", "ExpressionUUID" -> \
"7d7cd3a4-73a2-45e3-af38-27ad8809f820",
 InitializationCell->True],
Cell[285496, 7244, 1273, 32, 70, "Input", "ExpressionUUID" -> \
"4050ac4c-0f52-41d1-b76e-5c36f036635c",
 InitializationCell->True],
Cell[286772, 7278, 721, 18, 48, "Input", "ExpressionUUID" -> \
"f3a770d6-207e-47f6-8320-389c9b1bea4e",
 InitializationCell->True],
Cell[287496, 7298, 508, 11, 48, "Input", "ExpressionUUID" -> \
"b5ec5d3e-0326-47a3-8ada-5ca012f28f4f",
 InitializationCell->True],
Cell[288007, 7311, 1811, 49, 139, "Input", "ExpressionUUID" -> \
"f10568ec-7776-4ef6-ad5e-3d24efe20c17",
 InitializationCell->True],
Cell[289821, 7362, 1508, 40, 112, "Input", "ExpressionUUID" -> \
"030e5174-dbc6-41f1-9872-47c7a805af30",
 InitializationCell->True],
Cell[291332, 7404, 1829, 45, 196, "Input", "ExpressionUUID" -> \
"51b59dcd-5a85-4a92-860d-78a8b55c78be",
 InitializationCell->True],
Cell[293164, 7451, 8111, 190, 595, "Input", "ExpressionUUID" -> \
"62d4124a-2584-4153-9934-58a9c81e3fde",
 InitializationCell->True],
Cell[301278, 7643, 513, 13, 70, "Input", "ExpressionUUID" -> \
"b4ba835b-6dce-4938-a464-b51f4ee433bd",
 InitializationCell->True],
Cell[301794, 7658, 2807, 67, 280, "Input", "ExpressionUUID" -> \
"3d60f679-52b1-4654-9eb5-6f6fdbf9da9e",
 InitializationCell->True],
Cell[304604, 7727, 4713, 113, 385, "Input", "ExpressionUUID" -> \
"9c9ee8cb-b9ad-4516-8357-0a304d7ec23e",
 InitializationCell->True],
Cell[309320, 7842, 3223, 81, 238, "Input", "ExpressionUUID" -> \
"205a8b44-f18d-433e-b2a8-c7f8975c49f6",
 InitializationCell->True],
Cell[312546, 7925, 1394, 37, 112, "Input", "ExpressionUUID" -> \
"55708361-f90d-4c41-9e92-f2dd47d23da0",
 InitializationCell->True],
Cell[313943, 7964, 3387, 68, 154, "Input", "ExpressionUUID" -> \
"f8322cfc-24e1-44be-b730-d1e8d3e699ca",
 InitializationCell->True],
Cell[317333, 8034, 230, 5, 48, "Input", "ExpressionUUID" -> \
"576c2cf4-b6fa-48e7-b11f-9e9baad70b9c",
 InitializationCell->True],
Cell[317566, 8041, 4717, 112, 133, "Input", "ExpressionUUID" -> \
"a2903f68-2f79-40d4-9b50-ae468794b2a3",
 InitializationCell->True],
Cell[322286, 8155, 9334, 202, 364, "Input", "ExpressionUUID" -> \
"a3fdd223-3a8d-4495-88c1-aa3b1e09a1a7",
 InitializationCell->True],
Cell[331623, 8359, 6613, 139, 416, "Input", "ExpressionUUID" -> \
"735fbc5e-5f67-48ef-b230-7c99b8ce1e7b",
 InitializationCell->True],
Cell[338239, 8500, 1695, 39, 175, "Input", "ExpressionUUID" -> \
"705469e9-114f-4eff-aed3-f01c75b2251c",
 InitializationCell->True],
Cell[339937, 8541, 2564, 63, 175, "Input", "ExpressionUUID" -> \
"1cf74d9c-5682-4254-807a-f0007cae0219",
 InitializationCell->True],
Cell[342504, 8606, 1995, 54, 217, "Input", "ExpressionUUID" -> \
"96a143d7-4a40-4802-acf4-d7a0b38f546a",
 InitializationCell->True],
Cell[344502, 8662, 2758, 65, 259, "Input", "ExpressionUUID" -> \
"5fada6a9-6028-4405-84fa-74704289ff4a",
 InitializationCell->True],
Cell[347263, 8729, 223, 5, 48, "Input", "ExpressionUUID" -> \
"dd7ae55f-b0c8-4405-99d7-773094890b1b",
 InitializationCell->True],
Cell[347489, 8736, 4269, 100, 259, "Input", "ExpressionUUID" -> \
"9301ffca-3f83-4027-b999-1b5d7fbd9f84",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[351795, 8841, 187, 4, 44, "Subsection", "ExpressionUUID" -> \
"247d4ad4-bd3c-4dc4-9736-6b04fcd7c1a6",
 InitializationCell->True],
Cell[351985, 8847, 220, 5, 48, "Input", "ExpressionUUID" -> \
"e7d30e74-3041-4be9-9fce-57cfdd58e3f7",
 InitializationCell->True],
Cell[352208, 8854, 1367, 40, 91, "Input", "ExpressionUUID" -> \
"53062041-99e6-4dc9-b796-f8c0ab9c2291",
 InitializationCell->True],
Cell[353578, 8896, 5190, 127, 280, "Input", "ExpressionUUID" -> \
"82c57096-c8d8-45ca-8e4d-55c5cf33d84d",
 InitializationCell->True],
Cell[358771, 9025, 519, 13, 48, "Input", "ExpressionUUID" -> \
"8d51aaf2-3d8e-4d47-a122-ff5502939fb8",
 InitializationCell->True],
Cell[359293, 9040, 220, 5, 48, "Input", "ExpressionUUID" -> \
"e16bc11f-f079-4db6-89d7-bc50e0731a2d",
 InitializationCell->True],
Cell[359516, 9047, 3510, 89, 133, "Input", "ExpressionUUID" -> \
"145dde6c-d6ab-4915-84b5-4eef3fb00c8c",
 InitializationCell->True],
Cell[363029, 9138, 1613, 49, 70, "Input", "ExpressionUUID" -> \
"b9f5fec7-a176-4eac-a2a6-2e4f4afee005",
 InitializationCell->True],
Cell[364645, 9189, 9389, 219, 406, "Input", "ExpressionUUID" -> \
"f7d9a8d2-240d-4eb7-96e6-a66b1b695e69",
 InitializationCell->True],
Cell[374037, 9410, 3540, 96, 160, "Input", "ExpressionUUID" -> \
"fb6593f2-f1e5-4201-8572-b7479130a3f3",
 InitializationCell->True],
Cell[377580, 9508, 4685, 120, 238, "Input", "ExpressionUUID" -> \
"474e0056-2c00-4619-a6ec-11f166409b53",
 InitializationCell->True],
Cell[382268, 9630, 890, 22, 48, "Input", "ExpressionUUID" -> \
"51e14d0a-0628-405d-8578-bf46e639a28d",
 InitializationCell->True],
Cell[383161, 9654, 2496, 58, 97, "Input", "ExpressionUUID" -> \
"4f65aa96-9528-47d7-a982-12a615ff8287",
 InitializationCell->True],
Cell[385660, 9714, 450, 11, 48, "Input", "ExpressionUUID" -> \
"fae67a21-855d-439e-a657-5f69917d45c0",
 InitializationCell->True],
Cell[386113, 9727, 493, 13, 48, "Input", "ExpressionUUID" -> \
"a1f7e653-3b32-4be3-905f-ed9cd1bc1ccc",
 InitializationCell->True],
Cell[386609, 9742, 154, 4, 48, "Input", "ExpressionUUID" -> \
"7bd86cf8-1489-4797-a177-072ca0e7d29a",
 InitializationCell->True],
Cell[386766, 9748, 161, 4, 48, "Input", "ExpressionUUID" -> \
"ad3ac81b-303d-4633-bf1b-1be9b91a6509",
 InitializationCell->True]
}, Open  ]]
}
]
*)

