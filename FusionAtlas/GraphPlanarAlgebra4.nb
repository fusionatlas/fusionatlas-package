(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    362826,       9175]
NotebookOptionsPosition[    350449,       8802]
NotebookOutlinePosition[    350863,       8820]
CellTagsIndexPosition[    350820,       8817]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FusionAtlas`GraphPlanarAlgebra4`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FusionAtlas`\>\"", ",", "\"\<FusionAtlas`Bigraphs`\>\"", ",", 
      "\"\<FusionAtlas`GraphPairs`\>\"", ",", 
      "\"\<FusionAtlas`PackageData`\>\"", ",", 
      "\"\<FusionAtlas`Debugging`\>\""}], "}"}]}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411791124354661*^9, 3.411791125936936*^9}, {
   3.421197918237237*^9, 3.4211979460372114`*^9}, {3.432428044175173*^9, 
   3.432428050664504*^9}, {3.432608057742691*^9, 3.4326080604165363`*^9}, {
   3.4328634732132688`*^9, 3.432863479131779*^9}, {3.4328641929682255`*^9, 
   3.432864198966851*^9}, {3.4468456261699753`*^9, 3.446845633325498*^9}, {
   3.446847319782378*^9, 3.446847325859624*^9}, {3.446847404675356*^9, 
   3.4468474092485123`*^9}, {3.524158355512816*^9, 3.524158358938444*^9}, {
   3.543324971561059*^9, 3.543324980477037*^9}, 3.54332636949778*^9}],

Cell[BoxData[
 RowBox[{"NumberFieldGenerator", ";", "EnlargeNumberField", ";", 
  "RedefineLopsidedDimension", ";", "LopsidedDimension", ";", 
  "SphericalDimension", ";", "CriticalPointCoefficient", ";", "GPA4Element", 
  ";", "EmptyGPA4Element", ";", "CapTopLeft", ";", "PartialTrace", ";", 
  "GPA4Trace", ";", "GPA4TraceEvaluation", ";", "TurnUpBottomRightCorner", 
  ";", "TurnDownTopRightCorner", ";", "TurnUpBottomLeftCorner", ";", 
  "TurnDownTopLeftCorner", ";", "RotateOneClick", ";", "RotateTwoClicks", ";",
   "GPAFourierTransform", ";", "GPAFourierTransformTwice", ";", 
  "AddStrandOnRight", ";", "AddStrandOnLeft", ";", "AddStrandsOnLeft", ";", 
  "GPAMultiply", ";", "GPAConjugate", ";", "GPACoefficients", ";", 
  "GPACoefficientsAtStar", ";", "VariableGPA4Element", ";", "GPA4Matrix", ";",
   "GPATensor", ";", "GPAInverse", ";", "Rotate\[Pi]Clockwise", ";", 
  "Rotate\[Pi]Counterclockwise", ";", "GPAMultiplyWithOffset", ";", 
  "PivotalStructure", ";", "ConnectionGrid", ";", "StrandCrossingAbove", ";", 
  "StrandCrossingBelow", ";", "TwoStrandFlatness", ";", "OneStrandFlatness", 
  ";", "FusionRulesFromConnection", ";", "LowestWeightEigenvectorConditions", 
  ";", "LowestWeightConditions", ";", "CollectGPA4Matrix", ";", 
  "CollectGPA4Element", ";", "LowestWeightEigenspace", ";", 
  "LowestWeightSpace", ";", "LoadLowestWeightEigenspaces", ";", 
  "ChangePivotalStructure", ";", "NumberFieldGauge", ";", 
  "FindEquationsForFlatGenerators", ";", "FindFlatGenerators", ";", 
  "FindFlatLowestWeightVectors", ";", "qInteger\[Delta]", ";", 
  "JonesWenzlIdempotent", ";", "LoadIdempotents", ";", "S2Equation", ";", 
  "RowReducedS2Equation", ";", "S2Solutions", ";", "IdentityTL", ";", 
  "OneCupTL", ";", "OneCupJonesWenzl", ";", "SomeOneCupJonesWenzl", ";", 
  "AnnularConsequences", ";", "GPACirc", ";", "GPAStar", ";", 
  "GaugeTransform", ";", " ", "GaugeAction", ";", " ", "VariableGaugeElement",
   ";", " ", "FindGaugeElementRelating", ";", "WenzlRecursion", 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433288905738363`*^9, 3.543328890822812*^9}, 
   3.543329878914299*^9, {3.555793352707879*^9, 3.555793352858045*^9}, {
   3.55622206560997*^9, 3.5562220978329573`*^9}, {3.556487231999084*^9, 
   3.5564872335582247`*^9}, {3.568348747913727*^9, 3.568348748488269*^9}, {
   3.569006177494961*^9, 3.569006179052012*^9}, {3.5690204951149473`*^9, 
   3.569020495469895*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"progressiveRootReduce", "[", "x_GPA4Element", "]"}], ":=", " ", 
  RowBox[{"MapAt", "[", 
   RowBox[{"progressiveRootReduce", ",", "x", ",", 
    RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parallelRootReduce", "[", "x_GPA4Element", "]"}], ":=", " ", 
  RowBox[{"MapAt", "[", 
   RowBox[{"parallelRootReduce", ",", "x", ",", 
    RowBox[{"-", "1"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Number fields", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526058761497238*^9, 3.526058762634798*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumberFieldGenerator", "[", 
   RowBox[{"g", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"NumberFieldGenerator", "[", "g", "]"}], "=", 
   RowBox[{"RootReduce", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", "-", 
      SuperscriptBox[
       RowBox[{"ReducedDimensionOfGenerator", "[", 
        RowBox[{"g", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "2"]}], 
     "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445965366306158*^9, 3.445965400956201*^9}, {
  3.49503058040851*^9, 3.495030585155127*^9}, {3.498258800289007*^9, 
  3.498258800359996*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToNumberField0", "[", 
   RowBox[{
    RowBox[{"x_", "?", "NumericQ"}], ",", 
    RowBox[{"y_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"ToNumberField", "[", 
    RowBox[{
     RowBox[{"RootReduce", "[", "x", "]"}], ",", "y"}], "]"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToNumberField0", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", "x"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.481811346821521*^9, 3.48181138323132*^9}, {
   3.488680422568572*^9, 3.488680435006353*^9}, 3.488680596773786*^9, {
   3.4886806798697443`*^9, 3.488680683126719*^9}, {3.526068543406829*^9, 
   3.5260685515921583`*^9}, 3.5263057308256617`*^9, {3.552697444853833*^9, 
   3.5526974935934057`*^9}, {3.556223816758473*^9, 3.5562238181103*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnlargeNumberField", "[", 
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}],
    "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"ToNumberField", "::", "\"\<nnfel\>\""}], "]"}], ";"}], "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"ToNumberField0", "[", 
        RowBox[{"x", ",", 
         RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "_ToNumberField", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NumberFieldGenerator", "[", "g", "]"}], "=", 
         RowBox[{
          RowBox[{"ToNumberField", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RootReduce", "[", "x", "]"}], ",", 
             RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "}"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<Enlarging number field for \>\"", ",", 
          RowBox[{"GraphToString", "[", "g", "]"}], ",", "\"\<: \>\"", ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "_", ",", "0"}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"On", "[", 
        RowBox[{"ToNumberField", "::", "\"\<nnfel\>\""}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RedefineLopsidedDimension", "[", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446909171476357*^9, 3.446909419044162*^9}, {
   3.446909604994635*^9, 3.44690962015508*^9}, {3.46913831521391*^9, 
   3.469138316497611*^9}, 3.4818114029629097`*^9, {3.483274958990704*^9, 
   3.483274961229281*^9}, 3.495030619451597*^9, {3.529846305860358*^9, 
   3.52984630786747*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lopsided dimensions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965437139605*^9, 3.445965439155334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RedefineLopsidedDimension", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "LopsidedDimension", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LopsidedDimension", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"Vertex", "[", 
        RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"LopsidedDimension", "[", 
       RowBox[{"g", ",", 
        RowBox[{"Vertex", "[", 
         RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}], "=", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Delta]", "=", 
          RowBox[{"ReducedDimensionOfGenerator", "[", 
           RowBox[{"g", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ToNumberField0", "[", 
         RowBox[{
          RowBox[{"RootReduce", "[", 
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              FractionBox["1", "\[Delta]"], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", "1", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", "\[Delta]"}], "]"}], 
            RowBox[{
             RowBox[{"ReducedDimensionsByDepth", "[", 
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "1"}], 
               "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"d", "+", "1"}], ",", "k"}], 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459049633267612`*^9, 3.445905128930409*^9}, {
   3.445958825594243*^9, 3.445958828084826*^9}, {3.445965384944689*^9, 
   3.445965427534886*^9}, {3.446845751126251*^9, 3.4468457520777893`*^9}, {
   3.446846233452298*^9, 3.446846234057397*^9}, 3.481811413376189*^9, {
   3.495030653705083*^9, 3.495030683096169*^9}, {3.495030807026062*^9, 
   3.495030839505031*^9}, {3.49504246928113*^9, 3.495042498630651*^9}, {
   3.4950440774990273`*^9, 3.4950440775686483`*^9}, {3.5284624322085733`*^9, 
   3.528462436208699*^9}, {3.529846261549897*^9, 3.529846292098892*^9}}],

Cell[BoxData[
 RowBox[{"RedefineLopsidedDimension", "[", "]"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spherical dimensions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965437139605*^9, 3.445965439155334*^9}, {
  3.526058745507452*^9, 3.526058746183351*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "SphericalDimension", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526068588959951*^9, 3.526068592472829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDimension", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"Vertex", "[", 
      RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SphericalDimension", "[", 
     RowBox[{"g", ",", 
      RowBox[{"Vertex", "[", 
       RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{"ReducedDimensionsByDepth", "[", 
      RowBox[{"g", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
      "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"d", "+", "1"}], ",", "k"}], "\[RightDoubleBracket]"}]}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459049633267612`*^9, 3.445905128930409*^9}, {
   3.445958825594243*^9, 3.445958828084826*^9}, {3.445965384944689*^9, 
   3.445965427534886*^9}, {3.446845751126251*^9, 3.4468457520777893`*^9}, {
   3.446846233452298*^9, 3.446846234057397*^9}, 3.481811413376189*^9, {
   3.495030653705083*^9, 3.495030683096169*^9}, {3.495030807026062*^9, 
   3.495030839505031*^9}, {3.49504246928113*^9, 3.495042498630651*^9}, {
   3.4950440774990273`*^9, 3.4950440775686483`*^9}, {3.526058768750132*^9, 
   3.526058789292197*^9}, {3.526068792019594*^9, 3.52606879273617*^9}, {
   3.526069089700481*^9, 3.526069093381184*^9}, {3.5293428726721*^9, 
   3.529342876477837*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Critical point coefficients", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526058797350629*^9, 3.5260588015089817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CriticalPointCoefficient", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "sign_", ",", "above_Vertex", ",", "below_Vertex", ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "pivotalStructure", ",", "\[IndentingNewLine]", "\"\<Spherical\>\"", ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox[
        RowBox[{"SphericalDimension", "[", 
         RowBox[{"G", ",", "above"}], "]"}]], ")"}], "sign"], 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox[
        RowBox[{"SphericalDimension", "[", 
         RowBox[{"G", ",", "below"}], "]"}]], ")"}], 
      RowBox[{"-", "sign"}]]}], ",", "\[IndentingNewLine]", 
    "\"\<Lopsided\>\"", ",", 
    SuperscriptBox[
     RowBox[{"LopsidedDimension", "[", 
      RowBox[{"G", ",", "above"}], "]"}], "sign"]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526058823919153*^9, 3.5260588676640177`*^9}, {
   3.526058948763986*^9, 3.526059032078527*^9}, {3.526059065742134*^9, 
   3.52605906688575*^9}, {3.5260592088898706`*^9, 3.526059214718814*^9}, 
   3.526068489465782*^9, {3.52630601812464*^9, 3.5263060234844723`*^9}, {
   3.526306054259829*^9, 3.5263060644277277`*^9}, {3.54549556297182*^9, 
   3.5454956035188217`*^9}, {3.5455128510266027`*^9, 3.545512861397243*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graph planar algebra", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965332045342*^9, 3.445965336385316*^9}}],

Cell[CellGroupData[{

Cell["Planar algebra operations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965270784976*^9, 3.445965274822*^9}}],

Cell["\<\
GPA4Element takes : a pair of bigraphs with duals, a loops in the square, a \
pair {a,b} meaning a strands going up and b going down, and rules assigning \
any length a+b loop to a number.  Length (a+b) loops are denoted as a \
sequence of vertices and integers (the integer specifies which edge between \
the vertices to use).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4830149685073757`*^9, 3.483015085977614*^9}, {
  3.483015233838101*^9, 3.4830152902026167`*^9}, {3.4830153960587797`*^9, 
  3.4830154022817707`*^9}, {3.4830158190388527`*^9, 3.4830158333885937`*^9}, {
  3.495031077898758*^9, 3.495031103175582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmptyGPA4Element", "[", 
   RowBox[{
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"over", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", "over", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[Rule]", "1"}], "&"}], "/@", 
     RowBox[{"GraphLoops", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", "over", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4461439443885117`*^9, 3.4461439709575043`*^9}, {
  3.4461441725921183`*^9, 3.446144196049198*^9}, {3.4950308725972033`*^9, 
  3.4950309344021263`*^9}, {3.4950310130492163`*^9, 3.49503106037296*^9}, {
  3.526306030734014*^9, 3.526306069900887*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"otherLoopsZero", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"RepeatedSequence", "[", 
     RowBox[{"_Vertex", ",", "_Integer", ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], "}"}], "\[Rule]", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"otherLoopsZero", "[", "0", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", "_Vertex", "}"}], "\[Rule]", "0"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541860181141281*^9, 3.54186020122589*^9}, {
  3.541860375588705*^9, 3.541860390967168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CapTopLeft", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"up", "\[GreaterEqual]", "2"}], "\[And]", 
    RowBox[{
     RowBox[{"up", "+", "down"}], "\[GreaterEqual]", "4"}], "\[And]", 
    RowBox[{
     RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[Equal]", 
     RowBox[{
     "over", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", 
         RowBox[{"up", "-", "2"}]}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_Vertex", ",", "na_Integer", ",", "z___"}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CriticalPointCoefficient", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"-", "1"}], ",", "a", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "pivotalStructure"}], "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "a", ",", "na", ",", "z"}], "}"}], "/.", "dispatch"}],
                ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "a", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445903265653133*^9, 3.4459033110813103`*^9}, {
   3.445903362302124*^9, 3.445903492909018*^9}, {3.44590352846031*^9, 
   3.445903623786755*^9}, 3.4459036539650183`*^9, {3.44591647367689*^9, 
   3.445916521628215*^9}, {3.445916677253497*^9, 3.4459166800939007`*^9}, {
   3.445916821839405*^9, 3.445916884011223*^9}, {3.4459185855170403`*^9, 
   3.445918588201708*^9}, {3.446080982106256*^9, 3.44608098777116*^9}, 
   3.446141292557818*^9, {3.446150186443223*^9, 3.446150187809655*^9}, {
   3.446150413858005*^9, 3.446150426864484*^9}, {3.446150673406405*^9, 
   3.4461506739639797`*^9}, {3.4461524632276163`*^9, 3.446152480439479*^9}, {
   3.446652873659424*^9, 3.446652899872682*^9}, 3.4468462590781603`*^9, 
   3.446849880219652*^9, 3.4468504973789454`*^9, {3.49503129654599*^9, 
   3.495031339945117*^9}, {3.495033151653616*^9, 3.4950331554197063`*^9}, {
   3.495033193202145*^9, 3.4950332254653797`*^9}, {3.4950332648006144`*^9, 
   3.49503326777065*^9}, {3.526059256343039*^9, 3.526059277238276*^9}, {
   3.526059393616886*^9, 3.5260594104246387`*^9}, {3.526306244390209*^9, 
   3.526306255962858*^9}, {3.526306293534923*^9, 3.526306295457057*^9}, {
   3.535741764791861*^9, 3.535741775496634*^9}, {3.541860208738793*^9, 
   3.5418602228992968`*^9}, {3.5433460126018457`*^9, 3.54334601763929*^9}, {
   3.543456687737502*^9, 3.543456687814205*^9}, {3.543456769681231*^9, 
   3.543456794618382*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CapTopLeft", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    "\[Equal]", 
    RowBox[{
    "over", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", "2", "]"}], "}"}]}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a_Vertex", "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CriticalPointCoefficient", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"-", "1"}], ",", "a", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "pivotalStructure"}], "]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "a", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433459556509857`*^9, 3.5433459840962353`*^9}, 
   3.543346104987109*^9, 3.543456690480287*^9, 3.5434567722426643`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "PartialTrace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742927525217*^9, 3.5357429304333553`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Note", ";", " ", 
   RowBox[{"the", " ", "implementation", " ", "below", " ", 
    RowBox[{"doesn", "'"}], "t", " ", "seem", " ", "to", " ", "work", " ", 
    "when", " ", "one", " ", "of", " ", "up", " ", "and", " ", "down", " ", 
    "is", " ", "1"}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345908642655*^9, 3.543345925673417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PartialTrace", "[", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_List"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"up", ">", "1"}], "&&", 
      RowBox[{"down", ">", "1"}]}], ")"}], "\[And]", 
    RowBox[{
     RowBox[{"over", "\[LeftDoubleBracket]", "up", "\[RightDoubleBracket]"}], 
     "\[Equal]", 
     RowBox[{"over", "\[LeftDoubleBracket]", 
      RowBox[{"up", "+", "2"}], "\[RightDoubleBracket]"}]}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"up", "+", "1"}], ",", 
           RowBox[{"up", "+", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"down", "-", "1"}], ",", 
         RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", ":", 
            RowBox[{"RepeatedSequence", "[", 
             RowBox[{"_Vertex", ",", "_Integer", ",", 
              RowBox[{"{", 
               RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "v_Vertex", 
           ",", "n_Integer", ",", "B___"}], "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", "1", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "pivotalStructure"}], "]"}], 
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", 
                  RowBox[{"-", "1"}], ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "pivotalStructure"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"A", ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "n", ",", "B"}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "v", ",", 
              RowBox[{"over", "\[LeftDoubleBracket]", 
               RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}],
            ")"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445903265653133*^9, 3.4459033110813103`*^9}, {
   3.445903362302124*^9, 3.445903492909018*^9}, {3.44590352846031*^9, 
   3.445903623786755*^9}, 3.4459036539650183`*^9, {3.44591647367689*^9, 
   3.445916521628215*^9}, {3.445916677253497*^9, 3.4459166800939007`*^9}, {
   3.445916821839405*^9, 3.445916884011223*^9}, {3.4459185855170403`*^9, 
   3.445918588201708*^9}, {3.446080982106256*^9, 3.44608098777116*^9}, 
   3.446141292557818*^9, {3.446150186443223*^9, 3.446150187809655*^9}, {
   3.446150413858005*^9, 3.446150426864484*^9}, {3.446150673406405*^9, 
   3.4461506739639797`*^9}, {3.4461524632276163`*^9, 3.446152480439479*^9}, {
   3.446652873659424*^9, 3.446652899872682*^9}, 3.4468462590781603`*^9, 
   3.446849880219652*^9, 3.4468504973789454`*^9, {3.49503129654599*^9, 
   3.495031339945117*^9}, {3.495033151653616*^9, 3.4950331554197063`*^9}, {
   3.495033193202145*^9, 3.4950332254653797`*^9}, {3.4950332648006144`*^9, 
   3.49503326777065*^9}, {3.526059256343039*^9, 3.526059277238276*^9}, {
   3.526059393616886*^9, 3.5260594104246387`*^9}, {3.526306244390209*^9, 
   3.526306255962858*^9}, {3.526306293534923*^9, 3.526306295457057*^9}, {
   3.535741466294259*^9, 3.535741467637107*^9}, {3.535741522969935*^9, 
   3.5357415282818127`*^9}, {3.53574159090385*^9, 3.535741628347208*^9}, {
   3.5357417799357347`*^9, 3.535741805308468*^9}, {3.535742029268375*^9, 
   3.5357420671942997`*^9}, {3.535742127361409*^9, 3.53574215740168*^9}, {
   3.535742782559972*^9, 3.5357428049503393`*^9}, 3.5418602424208593`*^9, {
   3.5433459053807983`*^9, 3.5433459064367933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTrace", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", "2", "]"}], "}"}]}], "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"over", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "v_Vertex", "}"}], "\[RuleDelayed]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", "1", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "v", ",", "pivotalStructure"}], "]"}], 
                RowBox[{"CriticalPointCoefficient", "[", 
                 RowBox[{"g", ",", 
                  RowBox[{"-", "1"}], ",", "v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "pivotalStructure"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"v", ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], "/.", "dispatch"}], 
               ")"}]}], "&"}], "/@", 
            RowBox[{"EdgesAdjacentTo", "[", 
             RowBox[{"g", ",", "v", ",", 
              RowBox[{
              "over", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}]}], "}"}]}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742808674651*^9, 3.535742863291177*^9}, {
  3.535742902800458*^9, 3.53574292253465*^9}, {3.541860254152179*^9, 
  3.5418602583511868`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Trace", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", "_", ",", "_"}], "]"}]}], "]"}],
   ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"PartialTrace", ",", "A", ",", "k"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5357424356593037`*^9, 3.535742502639635*^9}, {
  3.535742966921042*^9, 3.535742968104697*^9}, {3.535743092869817*^9, 
  3.5357430935489607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4TraceEvaluation", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", "_", ",", "_"}], "]"}]}], "]"}],
   ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeffs", "=", 
      RowBox[{"GPACoefficients", "[", 
       RowBox[{"GPA4Trace", "[", "A", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"cachedRootReduce", "[", "coeffs", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "x_", "}"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"y_AlgebraicNumber", "\[RuleDelayed]", "y"}], ",", 
            RowBox[{"y_", "\[RuleDelayed]", 
             RowBox[{"RootReduce", "[", "y", "]"}]}]}], "}"}]}], ")"}]}], ",", 
       RowBox[{"_", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<0-box didn't have constant values\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535743145150734*^9, 3.535743292597618*^9}, {
  3.535743354053219*^9, 3.535743474474934*^9}, {3.556487755333955*^9, 
  3.556487756279072*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepeatedSequence", "[", 
   RowBox[{"A__", ",", 
    RowBox[{"repeat", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Integer", "|", 
        RowBox[{"{", "_Integer", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], ")"}], ":", 
      "\[Infinity]"}]}]}], "]"}], ":=", 
  RowBox[{"Repeated", "[", 
   RowBox[{
    RowBox[{"PatternSequence", "[", "A", "]"}], ",", "repeat"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446143190705271*^9, 3.446143327450014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "-", "1"}], ",", 
      RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ":", 
           RowBox[{"RepeatedSequence", "[", 
            RowBox[{"_Vertex", ",", "_Integer", ",", 
             RowBox[{"{", "up", "}"}]}], "]"}]}], ",", "v_Vertex", ",", 
          "n_Integer", ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "v", ",", "n", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", "1", ",", "v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], "]"}]}]}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446141050274499*^9, 3.446141052601837*^9}, 3.446143343759233*^9, {
   3.446846260391795*^9, 3.446846260581895*^9}, 3.4468498895524282`*^9, 
   3.446850522924406*^9, {3.4950333704977503`*^9, 3.495033404367949*^9}, {
   3.526059656055729*^9, 3.5260597097711067`*^9}, {3.52630627591259*^9, 
   3.526306301702795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopRightCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "+", "1"}], ",", 
      RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ":", 
           RowBox[{"RepeatedSequence", "[", 
            RowBox[{"_Vertex", ",", "_Integer", ",", 
             RowBox[{"{", 
              RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "v_Vertex", 
          ",", "n_Integer", ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], 
       ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "v", ",", "n", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], "]"}]}]}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.446140411262151*^9}, {3.446140672774551*^9, 
   3.446140680623767*^9}, {3.4461407184695473`*^9, 3.446140882265745*^9}, {
   3.4461409741542788`*^9, 3.44614104392402*^9}, {3.446143168346834*^9, 
   3.446143175116309*^9}, {3.446143347831675*^9, 3.44614335309664*^9}, {
   3.4468462607923117`*^9, 3.4468462609907*^9}, 3.446849896015937*^9, 
   3.446850525504931*^9, {3.4950334272178907`*^9, 3.495033446230585*^9}, {
   3.5260597665307407`*^9, 3.5260598013779383`*^9}, {3.526059848397561*^9, 
   3.526059850660676*^9}, {3.52630630610478*^9, 3.526306316765316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnUpBottomLeftCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"over", "\[LeftDoubleBracket]", 
       RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "}"}], "~", "Join", "~", 
     RowBox[{"Most", "[", "over", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "-", "1"}], ",", 
      RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "B___", ",", "b_Vertex", ",", 
          "nb_Integer"}], "}"}], "\[Rule]", "\[Zeta]_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "a", ",", "na", ",", "B"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{
          "g", ",", "1", ",", "a", ",", "b", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.44614053294624*^9}, {3.4461406216048317`*^9, 
   3.44614065392938*^9}, {3.4461407316218767`*^9, 3.446140734037303*^9}, {
   3.446140899620675*^9, 3.4461409325890837`*^9}, {3.4461410328097467`*^9, 
   3.4461410350659723`*^9}, {3.4461412110924253`*^9, 3.446141245939475*^9}, {
   3.446846261193063*^9, 3.446846261392714*^9}, 3.4468498984476967`*^9, 
   3.446850529587123*^9, {3.495033461523034*^9, 3.4950335317150517`*^9}, {
   3.495046101145028*^9, 3.495046126909863*^9}, {3.4950461787392693`*^9, 
   3.495046199409914*^9}, {3.495046326684564*^9, 3.495046328620358*^9}, {
   3.526059907991337*^9, 3.526059961553475*^9}, {3.526306321490183*^9, 
   3.526306330526116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], "/;", 
    RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"Rest", "[", "over", "]"}], "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"down", "+", "1"}], ",", 
      RowBox[{"up", "-", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", "nb_Integer", 
          ",", "B___"}], "}"}], "\[Rule]", "\[Zeta]_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"b", ",", "nb", ",", "B", ",", "a", ",", "na"}], "}"}], 
        "\[Rule]", 
        RowBox[{"\[Zeta]", " ", 
         RowBox[{"CriticalPointCoefficient", "[", 
          RowBox[{"g", ",", 
           RowBox[{"-", "1"}], ",", "b", ",", "a", ",", "pivotalStructure"}], 
          "]"}]}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44608198800707*^9, 3.446082012311233*^9}, {
   3.446140367994547*^9, 3.446140411262151*^9}, {3.446140672774551*^9, 
   3.446140680623767*^9}, {3.4461407184695473`*^9, 3.446140882265745*^9}, {
   3.4461410743260803`*^9, 3.4461411934118156`*^9}, {3.4461412518139763`*^9, 
   3.446141257349806*^9}, {3.446846261611636*^9, 3.446846261827194*^9}, 
   3.446849900631482*^9, 3.446865468618416*^9, {3.4950334632455683`*^9, 
   3.4950334793528433`*^9}, {3.495033513078804*^9, 3.495033535459675*^9}, {
   3.495046206266824*^9, 3.495046215234746*^9}, {3.526059969161972*^9, 
   3.5260600009734488`*^9}, {3.5263063347813053`*^9, 3.526306344568487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "RotateOneClick", " ", "is", " ", "the", " ", "WRONG", " ", "rotation", 
    " ", "by", " ", "QuadraticTangles", " ", 
    RowBox[{"standards", ".", " ", "It"}], " ", "moves", " ", "the", " ", 
    "external", " ", "star", " ", 
    RowBox[{"clockwise", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateOneClick", "[", 
    RowBox[{
     RowBox[{"k", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients_"}], "]"}]}], "/;", 
     RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"TurnDownTopLeftCorner", "[", "k", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260677854704123`*^9}, 
   3.526306351847019*^9, {3.543170636344987*^9, 3.543170682518759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotateOneClick", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], "/;", 
    RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{"TurnUpBottomRightCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260677854704123`*^9}, 
   3.526306351847019*^9, {3.526306402523082*^9, 3.5263064112178926`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Also", " ", "rotates", " ", "the", " ", "wrong", " ", 
    RowBox[{"way", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateTwoClicks", "[", "k_GPA4Element", "]"}], ":=", 
   RowBox[{"RotateOneClick", "[", 
    RowBox[{"RotateOneClick", "[", "k", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526067747061253*^9, 3.5260678153142843`*^9}, {
  3.543170687684066*^9, 3.543170694612253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "GPAFourierTranform", " ", "is", " ", "the", " ", "other", " ", "one", " ",
     "click", " ", "rotation", " ", 
    RowBox[{"(", 
     RowBox[{
     "the", " ", "right", " ", "one", " ", "that", " ", "rotates", " ", 
      "counterclockwise"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GPAFourierTransform", "[", 
     RowBox[{
      RowBox[{"k", ":", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"g", ":", 
          RowBox[{"{", 
           RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
         ",", 
         RowBox[{"over", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
         RowBox[{"pivotalStructure", ":", 
          RowBox[{"(", 
           RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
         ",", "coefficients_"}], "]"}]}], "/;", 
      RowBox[{"up", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
    RowBox[{"TurnUpBottomLeftCorner", "[", 
     RowBox[{"TurnDownTopRightCorner", "[", "k", "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GPAFourierTransform", "[", 
     RowBox[{
      RowBox[{"k", ":", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"g", ":", 
          RowBox[{"{", 
           RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
         ",", 
         RowBox[{"over", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
         RowBox[{"pivotalStructure", ":", 
          RowBox[{"(", 
           RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
         ",", "coefficients_"}], "]"}]}], "/;", 
      RowBox[{"down", "\[GreaterEqual]", "1"}]}], "]"}], ":=", 
    RowBox[{"TurnDownTopRightCorner", "[", 
     RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.543170698725366*^9, 3.543170840548767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAFourierTransformTwice", "[", "k_GPA4Element", "]"}], ":=", 
  RowBox[{"GPAFourierTransform", "[", 
   RowBox[{"GPAFourierTransform", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5431708518157673`*^9, 3.543170869004019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], ",", 
    RowBox[{"newOver", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dispatch", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"over", ",", 
           RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
         RowBox[{"{", "newOver", "}"}], "~", "Join", "~", 
         RowBox[{"Drop", "[", 
          RowBox[{"over", ",", "up"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"down", "+", "1"}], ",", 
          RowBox[{"up", "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"down", ",", "up"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a_Vertex", ",", "na_Integer", ",", "b_Vertex", ",", 
              "na_Integer"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "a", "}"}], "/.", "dispatch"}], ")"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_Vertex", ",", "nc_Integer", ",", 
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", 
                  RowBox[{"up", "-", "1"}], "}"}]}], "]"}]}], ",", "a_Vertex",
               ",", "na_Integer", ",", "b_Vertex", ",", "na_Integer"}], "}"}],
             "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "nc", ",", "A"}], "}"}], "/.", "dispatch"}], 
             ")"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "up", "}"}]}], "]"}]}], ",", "a_Vertex", ",", 
              "na_Integer", ",", "b_Vertex", ",", "na_Integer", ",", 
              "a_Vertex", ",", "nc_Integer", ",", 
              RowBox[{"B", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", 
                  RowBox[{"down", "-", "1"}], "}"}]}], "]"}]}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"A", ",", "a", ",", "nc", ",", "B"}], "}"}], "/.", 
              "dispatch"}], ")"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446141320966792*^9, 3.446141379198556*^9}, {
   3.4461414235264397`*^9, 3.446141458365514*^9}, {3.446142643542164*^9, 
   3.4461426443563223`*^9}, {3.446142715057644*^9, 3.446142717225142*^9}, {
   3.446142759611849*^9, 3.446142810870644*^9}, {3.44614286142281*^9, 
   3.446142882885414*^9}, {3.4461429403251657`*^9, 3.446142962897225*^9}, {
   3.446143359117996*^9, 3.446143360982417*^9}, {3.446148358830414*^9, 
   3.446148366375103*^9}, {3.446846262023032*^9, 3.446846262870696*^9}, 
   3.4468499027119703`*^9, 3.446850534550316*^9, {3.4950336092469997`*^9, 
   3.495033620003326*^9}, {3.495045243730057*^9, 3.495045246201725*^9}, {
   3.49504528709837*^9, 3.495045412670459*^9}, {3.49504549439649*^9, 
   3.495045510167182*^9}, {3.5263064562342663`*^9, 3.526306471056511*^9}, {
   3.5418603091139917`*^9, 3.541860313340745*^9}, {3.569013789907518*^9, 
   3.569013857856578*^9}, {3.5690139197607613`*^9, 3.569013965274008*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandsOnLeft", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}], ",", 
    RowBox[{"newOvers", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}], ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"Length", "[", "newOvers", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dispatch", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{"newOvers", "~", "Join", "~", "over", "~", "Join", "~", 
         RowBox[{"Reverse", "[", "newOvers", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"down", "+", "k"}], ",", 
          RowBox[{"up", "+", "k"}]}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "k", "}"}]}], "]"}]}], ",", 
             RowBox[{"B", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", 
                 RowBox[{"up", "+", "down", "+", "1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"C", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", 
                 RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}]}], "}"}], "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "A", "}"}], "~", "Join", "~", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "}"}]}], "===", 
             RowBox[{"Reverse", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{
                 RowBox[{"{", "B", "}"}], ",", 
                 RowBox[{"-", "2"}]}], "]"}], "~", "Join", "~", 
               RowBox[{"{", "C", "}"}], "~", "Join", "~", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "}"}]}], "]"}]}], ")"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"up", "+", "down"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"{", "B", "}"}], ",", 
                RowBox[{"-", "2"}]}], "]"}]}], "]"}], "/.", "dispatch"}], 
           ")"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.569015678635935*^9, 3.569015909909061*^9}, {
  3.569015956274962*^9, 3.569016036296689*^9}, {3.569020171955059*^9, 
  3.569020191767392*^9}, {3.569020252544715*^9, 3.5690203772126207`*^9}, {
  3.569020752126964*^9, 3.569020755572331*^9}, {3.569020790235155*^9, 
  3.569020792217833*^9}, {3.569020871241786*^9, 3.569020931431197*^9}, {
  3.569020980031637*^9, 3.569020986982163*^9}, {3.56902127675322*^9, 
  3.569021278638653*^9}, {3.569021476323537*^9, 3.5690215947098923`*^9}, {
  3.569021670397976*^9, 3.569021673428562*^9}, {3.5691834533551607`*^9, 
  3.569183455157502*^9}, {3.5691930321133347`*^9, 3.5691930822005653`*^9}, {
  3.569193132649847*^9, 3.569193133153131*^9}, {3.569193164423052*^9, 
  3.569193197155683*^9}, {3.5691932847123117`*^9, 3.5691932863280077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandsOnLeft", "[", 
   RowBox[{"A_GPA4Element", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "A"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5691886334196777`*^9, 3.56918864997656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{"A_GPA4Matrix", ",", "over_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"AddStrandOnRight", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", "A", "]"}], ",", "over"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457678052177*^9, 3.527457703036878*^9}, {
  3.569013742183363*^9, 3.5690137439763308`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "GPAMultiply", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.495042131577936*^9, 3.4950421344429626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiply", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overBelow", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients1_"}], "]"}], ",", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overAbove", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients2_"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"overBelow", ",", 
      RowBox[{"middle", "+", "1"}]}], "]"}], "\[Equal]", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", 
       RowBox[{
        RowBox[{"-", "middle"}], "-", "1"}]}], "]"}], "]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dispatch1", ",", "dispatch2", ",", "expand"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expand", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"coefficients1", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"Vertex", "[", 
                  RowBox[{"_", ",", "_", ",", "0", ",", "1"}], "]"}], "]"}], 
                ",", "___"}], "}"}], "\[Rule]", "_"}]}], "]"}], "\[And]", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"coefficients2", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"Vertex", "[", 
                  RowBox[{"_", ",", "_", ",", "0", ",", "1"}], "]"}], "]"}], 
                ",", "___"}], "}"}], "\[Rule]", "_"}]}], "]"}]}], ")"}]}], 
        ",", "\[IndentingNewLine]", "ExpandCoefficientRulesAtStar", ",", 
        "\[IndentingNewLine]", "ExpandCoefficientRules"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dispatch1", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients1", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"down", "+", "middle"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dispatch2", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"coefficients2", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"middle", "+", "up"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCoefficientRules", "[", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"overAbove", ",", 
           RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
         RowBox[{"Take", "[", 
          RowBox[{"overBelow", ",", 
           RowBox[{"-", "down"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"down", ",", "middle", ",", "up"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "middle", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "V_Vertex", "}"}], "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Reverse", "[", "#", "]"}], "/.", "dispatch1"}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "V", ",", "V", ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{
                    RowBox[{"-", "middle"}], "-", "1"}]}], "]"}]}], "]"}]}], 
              ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "up", "}"}]}], "]"}]}], "}"}], "\[RuleDelayed]", 
            
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "A", "}"}], "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch1"}], ")"}]}], "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", "A", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ")"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B", ":", 
              RowBox[{"RepeatedSequence", "[", 
               RowBox[{"_Vertex", ",", "_Integer", ",", 
                RowBox[{"{", "down", "}"}]}], "]"}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "dispatch2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "B", "}"}], "/.", "dispatch1"}], ")"}]}], 
                "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", "B", "}"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ")"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"down", ",", "middle", ",", "up"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "up", "}"}]}], "]"}]}], ",", 
              RowBox[{"B", ":", 
               RowBox[{"RepeatedSequence", "[", 
                RowBox[{"_Vertex", ",", "_Integer", ",", 
                 RowBox[{"{", "down", "}"}]}], "]"}]}]}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "A", "}"}], "~", "Join", "~", 
                    RowBox[{"Most", "[", "#", "]"}]}], "/.", "dispatch2"}], 
                  ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Most", "[", 
                    RowBox[{"Reverse", "[", "#", "]"}], "]"}], "~", "Join", 
                    "~", 
                    RowBox[{"{", "B", "}"}]}], "/.", "dispatch1"}], ")"}]}], 
                "&"}], "/@", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"B", ",", "A"}], "}"}], "\[LeftDoubleBracket]", 
                  "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"A", ",", "B"}], "}"}], "\[LeftDoubleBracket]", 
                  "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"overAbove", ",", 
                   RowBox[{
                    RowBox[{"-", "middle"}], "-", "1"}]}], "]"}]}], "]"}]}], 
              ")"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446143027737702*^9, 3.446143040387432*^9}, {
   3.44614309570789*^9, 3.446143148042493*^9}, 3.446143363404314*^9, {
   3.446143530539763*^9, 3.446143569313798*^9}, {3.44614361534016*^9, 
   3.4461437986505823`*^9}, {3.446146131363949*^9, 3.446146135448526*^9}, {
   3.446146205116487*^9, 3.4461462134890013`*^9}, {3.4461462494448643`*^9, 
   3.446146253269882*^9}, {3.446146299039256*^9, 3.4461463034179688`*^9}, {
   3.446146474355957*^9, 3.44614650203834*^9}, {3.446846264311413*^9, 
   3.4468462645354843`*^9}, 3.446849913547138*^9, {3.446850428275291*^9, 
   3.446850454481435*^9}, {3.495033682671708*^9, 3.495033829492198*^9}, {
   3.495033862556323*^9, 3.4950338899242563`*^9}, {3.495033946067052*^9, 
   3.495033949690954*^9}, {3.495034035291271*^9, 3.4950340443745327`*^9}, {
   3.4950421138994226`*^9, 3.495042128453071*^9}, {3.4950421820408792`*^9, 
   3.495042197588395*^9}, {3.4950445330970907`*^9, 3.495044536197178*^9}, {
   3.509411153059443*^9, 3.5094111696333733`*^9}, {3.514128937394614*^9, 
   3.514128948370569*^9}, {3.514128983503443*^9, 3.514129052311144*^9}, {
   3.5263064965516443`*^9, 3.52630650947429*^9}, {3.5418604024036837`*^9, 
   3.5418604275415993`*^9}, {3.568927609097398*^9, 3.568927618819182*^9}, {
   3.568928430842984*^9, 3.56892844034904*^9}, {3.569005767473308*^9, 
   3.5690060732065783`*^9}, 3.5690126883573637`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAMultiply", "[", 
   RowBox[{"x_", ",", "y_", ",", "Z__"}], "]"}], ":=", 
  RowBox[{"GPAMultiply", "[", 
   RowBox[{
    RowBox[{"GPAMultiply", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", "Z"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535743623920663*^9, 3.535743646981662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", "\"\<Lopsided\>\""}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "overs", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"up", ",", "down"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReverseLoop", "[", "a", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"down", "\[GreaterEqual]", "2"}], ",", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"LopsidedDimension", "[", 
                   RowBox[{"g", ",", "#"}], "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
               RowBox[{"a", "\[LeftDoubleBracket]", 
                RowBox[{"3", ";;", 
                 RowBox[{
                  RowBox[{"2", "down"}], "-", "1"}], ";;", "2"}], 
                "\[RightDoubleBracket]"}]}], ")"}]}], ",", "1"}], "]"}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"up", "\[GreaterEqual]", "2"}], ",", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"LopsidedDimension", "[", 
                 RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"a", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"-", "2"}], ";;", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", "up"}]}], ";;", 
                 RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ")"}]}], 
            ",", "1"}], "]"}], ")"}], 
         RowBox[{"conjugate", "[", "b", "]"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4886725101320763`*^9, 3.488672540908902*^9}, {
   3.488672682779689*^9, 3.488672688697996*^9}, {3.488672728096558*^9, 
   3.488672796335504*^9}, {3.488674220960629*^9, 3.488674230200107*^9}, {
   3.4886773677977247`*^9, 3.4886776619839*^9}, {3.495043641231689*^9, 
   3.4950437144930696`*^9}, {3.495043830921403*^9, 3.495043854258298*^9}, {
   3.4950439220859137`*^9, 3.495043967441518*^9}, 3.4950441101950817`*^9, {
   3.4989575620040827`*^9, 3.4989575729735527`*^9}, {3.509395007300632*^9, 
   3.50939500800356*^9}, {3.526060142760907*^9, 3.526060151978065*^9}, {
   3.526060446001032*^9, 3.526060452326582*^9}, {3.526306526708049*^9, 
   3.5263065469172487`*^9}, 3.52691506326283*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "overs", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"up", ",", "down"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReverseLoop", "[", "a", "]"}], "\[Rule]", 
        RowBox[{"conjugate", "[", "b", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4886725101320763`*^9, 3.488672540908902*^9}, {
   3.488672682779689*^9, 3.488672688697996*^9}, {3.488672728096558*^9, 
   3.488672796335504*^9}, {3.488674220960629*^9, 3.488674230200107*^9}, {
   3.4886773677977247`*^9, 3.4886776619839*^9}, {3.495043641231689*^9, 
   3.4950437144930696`*^9}, {3.495043830921403*^9, 3.495043854258298*^9}, {
   3.4950439220859137`*^9, 3.495043967441518*^9}, 3.4950441101950817`*^9, {
   3.4989575620040827`*^9, 3.4989575729735527`*^9}, {3.509395007300632*^9, 
   3.50939500800356*^9}, {3.526060142760907*^9, 3.5260601864464083`*^9}, {
   3.52630655531157*^9, 3.5263065730262527`*^9}, 3.526915065804895*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAConjugate", "[", "A_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPAConjugate", "[", 
    RowBox[{"GPA4Element", "[", "A", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527524054449087*^9, 3.5275240716405897`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "conjugate", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.509395249141024*^9, 3.5093952507746058`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conjugate", "[", "a_Times", "]"}], ":=", 
  RowBox[{"conjugate", "/@", "a"}]}], "\n", 
 RowBox[{
  RowBox[{"conjugate", "[", "b_Plus", "]"}], ":=", 
  RowBox[{"conjugate", "/@", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"Exp", "[", "x_", "]"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"conjugate", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   SuperscriptBox["x_", "y_Integer"], "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"conjugate", "[", "x", "]"}], "y"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"1", "/", "x_"}], "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"conjugate", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", "x_AlgebraicNumber", "]"}], ":=", 
  RowBox[{"ToNumberField", "[", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], ",", 
    RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"Conjugate", "[", "x", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.50939502471938*^9, 3.509395031725524*^9}, {
  3.509395067036762*^9, 3.509395107859158*^9}, {3.509395243777728*^9, 
  3.5093952440247717`*^9}, {3.509395274810731*^9, 3.509395286368277*^9}, {
  3.5182711453243017`*^9, 3.518271152532732*^9}, {3.5592509733240757`*^9, 
  3.5592509742794733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conjugate", "[", 
   RowBox[{"conjugate", "[", "x_", "]"}], "]"}], ":=", "x"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.514652964913678*^9, 3.514652969974833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaugeTransform", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"g_", ",", "over_", ",", 
      RowBox[{"{", 
       RowBox[{"down_", ",", "up_"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}], ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"values", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"path_", "\[Rule]", "coefficient_"}], ")"}], "\[RuleDelayed]", 
      
      RowBox[{"(", 
       RowBox[{"path", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Mu]", "@@", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"path", "~", "Join", "~", 
                RowBox[{"{", 
                 RowBox[{"First", "[", "path", "]"}], "}"}]}], ",", "3", ",", 
               "2"}], "]"}]}], ")"}]}], ")"}], "coefficient"}]}], ")"}]}]}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.539014742798821*^9, 3.5390148247285433`*^9}, {
  3.5390148689599113`*^9, 3.53901489143885*^9}, {3.5390149495405483`*^9, 
  3.539014997858568*^9}, {3.5390150894755507`*^9, 3.5390150930977793`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arithmetic", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445965260379401*^9, 3.44596526337621*^9}}],

Cell[BoxData[
 RowBox[{"GPA4Element", "/:", 
  RowBox[{"z_", " ", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}]}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"coefficients", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"loop_List", "\[Rule]", "\[Zeta]_"}], ")"}], "\[RuleDelayed]", 
      
      RowBox[{"(", 
       RowBox[{"loop", "\[Rule]", 
        RowBox[{"z", " ", "\[Zeta]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459189949281693`*^9, 3.445919072755118*^9}, {
  3.4459191436969643`*^9, 3.4459191440651293`*^9}, {3.495035196969193*^9, 
  3.4950352262332478`*^9}, {3.526306631327425*^9, 3.52630663720443*^9}}],

Cell[BoxData[
 RowBox[{"GPA4Element", "/:", 
  RowBox[{
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients1_List"}], "]"}], "+", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients2_List"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dispatch1", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"coefficients1", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"otherLoopsZero", "[", 
           RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"dispatch2", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"coefficients2", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"otherLoopsZero", "[", 
           RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"loops", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"First", "/@", "coefficients1"}], ",", 
         RowBox[{"First", "/@", "coefficients2"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{"g", ",", "over", ",", 
      RowBox[{"{", 
       RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{"loops", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"loops", "/.", "dispatch1"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"loops", "/.", "dispatch2"}], ")"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459190761592703`*^9, 3.445919173400749*^9}, {
  3.445919267341947*^9, 3.445919269757209*^9}, {3.445919354504414*^9, 
  3.4459193565107317`*^9}, {3.4461700999440413`*^9, 3.4461701250251827`*^9}, {
  3.446170740388773*^9, 3.446170806282733*^9}, {3.495035296389758*^9, 
  3.4950353431803503`*^9}, {3.4950353740927753`*^9, 3.4950353844148197`*^9}, {
  3.526306732343581*^9, 3.5263067445192747`*^9}, {3.5418604552238913`*^9, 
  3.5418604646323767`*^9}, {3.541861811702854*^9, 3.541861846204617*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Technical details", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4459653071431017`*^9, 3.445965328740335*^9}, {
  3.4461415307942743`*^9, 3.446141531075536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expansionCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<.... expanding coefficients (\>\"", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"GraphLoops", "[", 
         RowBox[{"g", ",", "over"}], "]"}], "]"}], ",", "\"\<)\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", "over", ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"++", "expansionCounter"}], ",", "10000"}], "]"}], 
                 "\[Equal]", "0"}], ",", 
                RowBox[{"DebugPrint", "[", "expansionCounter", "]"}]}], "]"}],
               ";", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coefficients"}], ")"}], ",", 
                 RowBox[{"_List", "\[Rule]", "0"}]}], "]"}]}]}], ")"}], "&"}],
            "/@", 
           RowBox[{"GraphLoops", "[", 
            RowBox[{"g", ",", "over"}], "]"}]}], ",", 
          RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<.... finished expanding coefficients\>\"", "]"}],
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445905584279745*^9, 3.445905592351304*^9}, 
   3.445916378944194*^9, {3.4459169756223927`*^9, 3.445917017679369*^9}, {
   3.445917051977274*^9, 3.4459171738508*^9}, {3.446141514079033*^9, 
   3.446141525606818*^9}, 3.4461446314527597`*^9, {3.446145766819582*^9, 
   3.4461457699203453`*^9}, {3.446146438943179*^9, 3.446146450188395*^9}, {
   3.446150203783448*^9, 3.4461502382642107`*^9}, {3.446151331965104*^9, 
   3.446151401193177*^9}, {3.446151565565996*^9, 3.446151584103376*^9}, {
   3.495035396144053*^9, 3.4950354297794847`*^9}, {3.495035461756825*^9, 
   3.495035462133491*^9}, {3.5141285471341753`*^9, 3.514128567878413*^9}, {
   3.514128756430716*^9, 3.514128813822275*^9}, 3.514128963129431*^9, {
   3.5263067712407312`*^9, 3.5263067765491943`*^9}, 3.526309663515263*^9, {
   3.5418606552107964`*^9, 3.541860664141345*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCoefficientRulesAtStar", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "loopsAtStar"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"loopsAtStar", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"GraphLoops", "[", 
         RowBox[{"g", ",", "over"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "==", 
          RowBox[{"Vertex", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expansionCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<.... expanding coefficients (\>\"", ",", 
       RowBox[{"Length", "[", "loopsAtStar", "]"}], ",", "\"\<)\>\""}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g", ",", "over", ",", 
        RowBox[{"{", 
         RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"++", "expansionCounter"}], ",", "10000"}], "]"}], 
                 "\[Equal]", "0"}], ",", 
                RowBox[{"DebugPrint", "[", "expansionCounter", "]"}]}], "]"}],
               ";", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coefficients"}], ")"}], ",", 
                 RowBox[{"_List", "\[Rule]", "0"}]}], "]"}]}]}], ")"}], "&"}],
            "/@", "loopsAtStar"}], ",", 
          RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<.... finished expanding coefficients\>\"", "]"}],
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568944960772674*^9, 3.568944962076056*^9}, {
  3.568944997283513*^9, 3.568945055612793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_List"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"GraphLoops", "[", 
    RowBox[{"g", ",", "over"}], "]"}], "/.", 
   RowBox[{"Dispatch", "[", 
    RowBox[{"coefficients", "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"otherLoopsZero", "[", 
       RowBox[{"up", "+", "down"}], "]"}], "}"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918764654952*^9, 3.445918801350953*^9}, {
   3.446850043013908*^9, 3.446850043211912*^9}, {3.4831145834081507`*^9, 
   3.483114586590336*^9}, {3.495035473221476*^9, 3.495035478606579*^9}, 
   3.526306784243189*^9, {3.52735085627771*^9, 3.52735085793367*^9}, {
   3.527351417968799*^9, 3.527351419103397*^9}, {3.527351463703415*^9, 
   3.5273514728851233`*^9}, {3.531756843000719*^9, 3.531756844746086*^9}, 
   3.541860675549159*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPACoefficientsAtStar", "[", 
    RowBox[{"X", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
      "G_", ",", "overs_", ",", "updown_", ",", "ps_", ",", "rules_"}], 
      "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"overs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "loops", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"loops", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"GraphLoops", "[", 
         RowBox[{"G", ",", "overs"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "==", 
          RowBox[{"Vertex", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"loops", "/.", 
       RowBox[{"X", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_Vertex", ",", "__"}], "}"}], "\[Rule]", "0"}], "}"}]}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568935291025585*^9, 3.568935491192604*^9}, {
  3.5689369463226967`*^9, 3.568936947170431*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"GPACoefficients", "[", 
   RowBox[{"GPA4Element", "[", "A", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527524282732582*^9, 3.527524320595593*^9}, {
  3.5535482938461523`*^9, 3.553548313010715*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VariableGPA4Element", "[", 
   RowBox[{
    RowBox[{"g", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"over", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "f_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{"g", ",", "over", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "pivotalStructure", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loop", ":", 
        RowBox[{"{", "_Vertex", "}"}]}], "\[RuleDelayed]", 
       RowBox[{"f", "[", "loop", "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918216196302*^9, 3.445918333769546*^9}, 
   3.446846264757764*^9, {3.4468632761677*^9, 3.4468632775638647`*^9}, {
   3.495035488350319*^9, 3.4950355078073797`*^9}, {3.52630679030429*^9, 
   3.526306797147773*^9}, {3.543347055755856*^9, 3.5433470757058363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VariableGPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "f_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"up", "+", "down"}], "\[GreaterEqual]", "2"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandCoefficientRules", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{"g", ",", "over", ",", 
     RowBox[{"{", 
      RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loop", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PatternSequence", "[", 
           RowBox[{"_Vertex", ",", "_Integer"}], "]"}], ".."}], "}"}]}], 
       "\[RuleDelayed]", 
       RowBox[{"f", "[", "loop", "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445918216196302*^9, 3.445918333769546*^9}, 
   3.446846264757764*^9, {3.4468632761677*^9, 3.4468632775638647`*^9}, {
   3.495035488350319*^9, 3.4950355078073797`*^9}, {3.52630679030429*^9, 
   3.526306797147773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "initialVertices", ",", "finalVertices", ",", "pathsList", ",", 
      "matrices", ",", "coefficients"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"coefficients", "=", 
      RowBox[{"(", 
       RowBox[{"values", "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"otherLoopsZero", "[", 
          RowBox[{"up", "+", "down"}], "]"}], "}"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"initialVertices", "=", 
      RowBox[{"GraphVertices", "[", 
       RowBox[{"g", ",", 
        RowBox[{
        "over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalVertices", "=", 
      RowBox[{"GraphVertices", "[", 
       RowBox[{"g", ",", 
        RowBox[{"over", "\[LeftDoubleBracket]", 
         RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pathsList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2"}], "}"}], ",", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "#1", ",", "#2", ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"over", ",", 
                   RowBox[{"up", "+", "1"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"GraphPathsBetween", "[", 
                RowBox[{"g", ",", "#1", ",", "#2", ",", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Take", "[", 
                   RowBox[{"over", ",", 
                    RowBox[{
                    RowBox[{"-", "down"}], "-", "1"}]}], "]"}], "]"}]}], 
                "]"}]}], "}"}], "&"}], ",", "initialVertices", ",", 
            "finalVertices"}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_Vertex", ",", "_Vertex"}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"matrices", "=", 
      RowBox[{"pathsList", "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"initial_Vertex", ",", "final_Vertex"}], "}"}], ",", 
          "upPaths_List", ",", "downPaths_List"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"initial", ",", "final"}], "}"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"GraphPathToGraphLoop", "[", 
                RowBox[{"ConcatenatePaths", "[", 
                 RowBox[{"#1", ",", 
                  RowBox[{"Reverse", "[", "#2", "]"}]}], "]"}], "]"}], 
               RowBox[{"(*", 
                RowBox[{"#1", "~", "Join", "~", 
                 RowBox[{"Most", "[", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Most", "[", "#2", "]"}], "]"}], "]"}]}], "*)"}], 
               "&"}], ",", "upPaths", ",", "downPaths", ",", "1"}], "]"}], "/.",
             "coefficients"}], ")"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
       "matrices"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446852873526499*^9, 3.446852978494426*^9}, {
   3.446853057325824*^9, 3.446853142093996*^9}, {3.4468531767790813`*^9, 
   3.4468533538510523`*^9}, {3.4468534247796087`*^9, 3.446853601265432*^9}, {
   3.483112169476403*^9, 3.483112172584948*^9}, {3.4831123954098387`*^9, 
   3.483112426914116*^9}, {3.483112471142396*^9, 3.483112530937632*^9}, {
   3.483113457163494*^9, 3.4831134708577538`*^9}, {3.483114518369149*^9, 
   3.4831145220588703`*^9}, {3.4831145991087418`*^9, 3.4831146262020607`*^9}, 
   3.483201873608914*^9, {3.49573427457148*^9, 3.495734299211946*^9}, {
   3.495734338815115*^9, 3.495734382508469*^9}, {3.495734425826035*^9, 
   3.495734463648521*^9}, {3.495734539099204*^9, 3.495734540230301*^9}, {
   3.495734575242765*^9, 3.495734580201084*^9}, {3.509393619580472*^9, 
   3.509393641546503*^9}, {3.509394397763919*^9, 3.50939439805066*^9}, {
   3.526306806289969*^9, 3.526306810912092*^9}, {3.526913922453621*^9, 
   3.526913926693471*^9}, {3.526914159168771*^9, 3.526914162519581*^9}, {
   3.526914229459149*^9, 3.526914267097204*^9}, {3.526914827771495*^9, 
   3.526914838093279*^9}, {3.526915093164542*^9, 3.526915095203786*^9}, 
   3.52735059567175*^9, {3.541860705329455*^9, 3.541860749583856*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphPathToGraphLoop", "[", 
   RowBox[{"{", "v_Vertex", "}"}], "]"}], ":=", 
  RowBox[{"{", "v", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphPathToGraphLoop", "[", 
   RowBox[{"{", 
    RowBox[{"v_Vertex", ",", "o___", ",", "v_Vertex"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"v", ",", "o"}], "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526914180681253*^9, 3.526914225275237*^9}}],

Cell[BoxData[
 RowBox[{"GPA4Matrix", "/:", 
  RowBox[{
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overBelow", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values1_"}], "]"}], ".", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"overAbove", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values2_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", "up"}], "]"}], "~", "Join", "~", 
     RowBox[{"Take", "[", 
      RowBox[{"overBelow", ",", 
       RowBox[{
        RowBox[{"-", "down"}], "-", "1"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ".", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ")"}], 
      "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"values1", ",", "values2"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457993397991*^9, 3.527458126490863*^9}, {
  3.5274582164819403`*^9, 3.527458216560038*^9}}],

Cell[BoxData[
 RowBox[{"GPA4Matrix", "/:", 
  RowBox[{
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values1_"}], "]"}], "+", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values2_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ")"}], 
      "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"values1", ",", "values2"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457993397991*^9, 3.527458126490863*^9}, {
  3.5274582164819403`*^9, 3.527458216560038*^9}, {3.5274582780350037`*^9, 
  3.527458304648881*^9}}],

Cell[BoxData[
 RowBox[{"GPA4Matrix", "/:", 
  RowBox[{"\[Alpha]_", " ", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"\[Alpha]", " ", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       ")"}], "&"}], "/@", "values"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446854069411498*^9, 3.446854092233837*^9}, {
  3.483113506683384*^9, 3.483113512370974*^9}, {3.527458309725812*^9, 
  3.527458340654117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnRight", "[", 
   RowBox[{"m_GPA4Matrix", ",", "newOver_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"AddStrandOnRight", "[", 
    RowBox[{
     RowBox[{"GPA4Element", "[", "m", "]"}], ",", "newOver"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526914340097583*^9, 3.526914362823091*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPA4Element", "[", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_", ",", "up_"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "values_"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"g", ",", "over", ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"values", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"initial_Vertex", ",", "final_Vertex"}], "}"}], "\[Rule]",
            "matrix_"}], ")"}], "\[RuleDelayed]", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"downPaths", "=", 
              RowBox[{"GraphPathsBetween", "[", 
               RowBox[{"g", ",", "initial", ",", "final", ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Take", "[", 
                  RowBox[{"over", ",", 
                   RowBox[{
                    RowBox[{"-", "down"}], "-", "1"}]}], "]"}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"upPaths", "=", 
              RowBox[{"GraphPathsBetween", "[", 
               RowBox[{"g", ",", "initial", ",", "final", ",", 
                RowBox[{"Take", "[", 
                 RowBox[{"over", ",", 
                  RowBox[{"up", "+", "1"}]}], "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "downPaths", "]"}], "\[Equal]", "0"}], 
              "\[Or]", 
              RowBox[{
               RowBox[{"Length", "[", "upPaths", "]"}], "\[Equal]", "0"}]}], 
             ",", 
             RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Outer", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GraphPathToGraphLoop", "[", 
                    RowBox[{"ConcatenatePaths", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Reverse", "[", "#2", "]"}]}], "]"}], "]"}], 
                    "&"}], ",", "upPaths", ",", "downPaths", ",", "1"}], 
                  "]"}], ",", "matrix"}], "}"}], ",", "2"}], "]"}]}], "]"}]}],
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", 
      RowBox[{"_", "\[Rule]", "0"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4468541589085197`*^9, 3.446854192485771*^9}, {
   3.446854241556961*^9, 3.4468543322057858`*^9}, {3.446854388516992*^9, 
   3.446854441315452*^9}, {3.483112282765861*^9, 3.483112286455879*^9}, {
   3.4831125485017853`*^9, 3.483112629054243*^9}, {3.483113531495997*^9, 
   3.483113539581093*^9}, {3.483114363793109*^9, 3.4831144341971893`*^9}, {
   3.483114640462757*^9, 3.483114660829763*^9}, {3.495734609051076*^9, 
   3.495734639609188*^9}, {3.495734677183556*^9, 3.495734714414648*^9}, {
   3.526306816474815*^9, 3.526306825247032*^9}, 3.526914666266273*^9, 
   3.526915098579204*^9, {3.541860779390648*^9, 3.54186078636581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiply", "[", 
    RowBox[{
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overBelow", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "middle_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "matrices1_"}], "]"}], ",", 
     RowBox[{"GPA4Matrix", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"overAbove", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"middle_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "matrices2_"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"overBelow", ",", 
      RowBox[{"middle", "+", "1"}]}], "]"}], "\[Equal]", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", 
       RowBox[{
        RowBox[{"-", "middle"}], "-", "1"}]}], "]"}], "]"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{"overAbove", ",", 
       RowBox[{"up", "+", "1"}]}], "]"}], "~", "Join", "~", 
     RowBox[{"Take", "[", 
      RowBox[{"overBelow", ",", 
       RowBox[{"-", "down"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"down", ",", "up"}], "}"}], ",", "pivotalStructure", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"matrices1", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", ":", 
        RowBox[{"{", 
         RowBox[{"_Vertex", ",", "_Vertex"}], "}"}]}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"p", "/.", "matrices1"}], "]"}], ">", "10"}], ",", 
           RowBox[{"DebugPrint", "[", 
            RowBox[{
            "\"\<multiplying matrices: \>\"", ",", "p", ",", 
             "\"\<, size: \>\"", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"p", "/.", "matrices1"}], "]"}]}], "]"}]}], "]"}], ";", 
         
         RowBox[{"(", 
          RowBox[{"p", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "/.", "matrices1"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"p", "/.", "matrices2"}], ")"}]}]}], ")"}]}], ")"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535904203378104*^9, 3.535904239883841*^9}, {
  3.535904333043518*^9, 3.535904396458054*^9}, {3.535904458062447*^9, 
  3.5359044651919622`*^9}, {3.5359045616286983`*^9, 3.535904570814663*^9}, {
  3.536336243732449*^9, 3.536336288769788*^9}, {3.536609954331002*^9, 
  3.5366099672903023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TurnDownTopLeftCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnDownTopRightCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnUpBottomLeftCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TurnUpBottomRightCorner", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4989671236548634`*^9, 3.4989672122450542`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotateOneClick", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"RotateOneClick", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPAFourierTransform", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"GPAFourierTransform", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5359162500428333`*^9, 3.535916257242651*^9}, {
  3.5431709025101833`*^9, 3.5431709204557247`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PartialTrace", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"GPA4Element", "[", "m", "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPA4Trace", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4Trace", "[", 
   RowBox[{"GPA4Element", "[", "m", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GPA4TraceEvaluation", "[", "m_GPA4Matrix", "]"}], ":=", 
  RowBox[{"GPA4TraceEvaluation", "[", 
   RowBox[{"GPA4Element", "[", "m", "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.535742508918722*^9, 3.535742544623703*^9}, {
  3.535743505215242*^9, 3.535743513464377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BigraphWithDuals", "[", 
         RowBox[{"g_GradedBigraph", ",", "_DualData"}], "]"}], ",", 
        "_BigraphWithDuals"}], "}"}]}], ",", 
     RowBox[{"GPAElement", "[", 
      RowBox[{"g_", ",", "False", ",", 
       RowBox[{"{", 
        RowBox[{"down_", ",", "up_"}], "}"}], ",", "coefficients_"}], "]"}]}],
     "]"}], "/;", 
   RowBox[{"PivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "bump", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"bump", "[", 
       RowBox[{"Vertex", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
      RowBox[{"Vertex", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"i", ",", "2"}], "]"}], ",", "i", ",", "j"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bump", "[", "l_List", "]"}], ":=", 
      RowBox[{"bump", "/@", "l"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bump", "[", "i_Integer", "]"}], ":=", "i"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"G", ",", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"up", "+", "down"}], ")"}], "/", "2"}], "}"}]}], "]"}],
           ",", "1"}], "]"}], "~", "Join", "~", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "\"\<Lopsided\>\"", ",", 
       RowBox[{"coefficients", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"bump", "[", "x", "]"}], "\[Rule]", "y"}], ")"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498216183087294*^9, 3.498216423108822*^9}, {
  3.498216460052444*^9, 3.498216519009164*^9}, {3.498216587871004*^9, 
  3.4982165902866898`*^9}, {3.4982166657080727`*^9, 3.49821679203172*^9}, {
  3.4982169679231043`*^9, 3.4982169700579643`*^9}, {3.509410954197535*^9, 
  3.509410957052739*^9}, {3.526060271456835*^9, 3.5260602878461323`*^9}, {
  3.5263068514278393`*^9, 3.5263068540438557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPATensor", "[", 
    RowBox[{
     RowBox[{"A", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", "over1_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_Integer", ",", "up1_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients1_"}], "]"}]}], ",", 
     RowBox[{"B", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", "over2_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_Integer", ",", "up2_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients2_"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"over1", "\[LeftDoubleBracket]", 
     RowBox[{"up1", "+", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
    RowBox[{
    "over2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], ":=", 
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnDownTopLeftCorner", "[", 
     RowBox[{
      RowBox[{"GPAMultiply", "[", 
       RowBox[{
        RowBox[{"TurnDownTopRightCorner", "[", 
         RowBox[{"B", ",", "up2"}], "]"}], ",", 
        RowBox[{"TurnUpBottomLeftCorner", "[", 
         RowBox[{"A", ",", "down1"}], "]"}]}], "]"}], ",", "down1"}], "]"}], 
    ",", "up2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190329603963*^9, 3.499190543611251*^9}, {
  3.526306875030229*^9, 3.526306877809074*^9}, {3.5590009143920813`*^9, 
  3.5590009523250303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAInverse", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",",
       "over_", ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "k_"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "matrices_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"g", ",", 
    RowBox[{"Reverse", "[", "over", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "k"}], "}"}], ",", "pivotalStructure", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"p", "\[Rule]", 
        RowBox[{"Inverse", "[", "m", "]"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526320542235379*^9, 3.5263206406777773`*^9}, {
  3.5268321589295683`*^9, 3.526832161544159*^9}, {3.52683244044197*^9, 
  3.526832443144598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAInverse", "[", "A_GPA4Element", "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"GPAInverse", "[", 
    RowBox[{"GPA4Matrix", "[", "A", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526320674328753*^9, 3.5263206889868402`*^9}, 
   3.52632072054714*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotate\[Pi]Clockwise", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnUpBottomLeftCorner", "[", 
     RowBox[{"A", ",", "down"}], "]"}], ",", "up"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562128144236*^9, 3.52656219365143*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotate\[Pi]Counterclockwise", "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"TurnDownTopLeftCorner", "[", 
   RowBox[{
    RowBox[{"TurnUpBottomRightCorner", "[", 
     RowBox[{"A", ",", "down"}], "]"}], ",", "up"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562128144236*^9, 3.526562219706421*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopRightCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomRightCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopLeftCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnDownTopLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomLeftCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomRightCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomRightCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopRightCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnUpBottomLeftCorner", ",", "X", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{"X_", ",", "k_"}], "]"}], "/;", 
   RowBox[{"k", "<", "0"}]}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"TurnDownTopLeftCorner", ",", "X", ",", " ", 
    RowBox[{"-", "k"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5261375694610033`*^9, 3.526137663123433*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "GPAMultiplyWithOffset", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526138843450274*^9, 3.526138847590329*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Positive", " ", "k", " ", "shifts", " ", "the", " ", "lower", " ", 
   "factor", " ", "to", " ", "the", " ", "right"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526134668025573*^9, 3.526134676651544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"k", "+", "up1"}], "\[GreaterEqual]", "down2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopLeftCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomRightCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopRightCorner", "[", 
              RowBox[{"lower", ",", 
               RowBox[{"k", "+", "up1", "-", "down2"}]}], "]"}], ",", 
             RowBox[{"TurnUpBottomLeftCorner", "[", 
              RowBox[{"upper", ",", "k"}], "]"}]}], "]"}], ",", 
           RowBox[{"k", "+", "up1", "-", "down2"}]}], "]"}], ",", "k"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.5141292908764544`*^9, 3.514129319545826*^9}, {
  3.514129491913278*^9, 3.514129500543997*^9}, {3.526137675956966*^9, 
  3.526137698119102*^9}, {3.526138511065794*^9, 3.526138535413191*^9}, {
  3.5263069006863403`*^9, 3.526306903994853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "\[GreaterEqual]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{"k", "+", "up1"}], "<", "down2"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopLeftCorner", "[", 
        RowBox[{
         RowBox[{"TurnDownTopRightCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{"lower", ",", 
             RowBox[{"TurnUpBottomRightCorner", "[", 
              RowBox[{
               RowBox[{"TurnUpBottomLeftCorner", "[", 
                RowBox[{"upper", ",", "k"}], "]"}], ",", 
               RowBox[{"down2", "-", "k", "-", "up1"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"down2", "-", "k", "-", "up1"}]}], "]"}], ",", "k"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.5141292908764544`*^9, 3.514129319545826*^9}, {
  3.514129491913278*^9, 3.514129500543997*^9}, {3.526137675956966*^9, 
  3.526137698119102*^9}, {3.526138557353169*^9, 3.526138559175622*^9}, {
  3.526138593751574*^9, 3.5261386422493353`*^9}, {3.5261386779570017`*^9, 
  3.5261386900457687`*^9}, {3.526306916389863*^9, 3.526306918456623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k"}], "+", "down2"}], "\[GreaterEqual]", "up1"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnDownTopRightCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomLeftCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopLeftCorner", "[", 
              RowBox[{"lower", ",", 
               RowBox[{"-", "k"}]}], "]"}], ",", 
             RowBox[{"TurnUpBottomRightCorner", "[", 
              RowBox[{"upper", ",", 
               RowBox[{
                RowBox[{"-", "k"}], "+", "down2", "-", "up1"}]}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"-", "k"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"-", "k"}], "+", "down2", "-", "up1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.499192481977853*^9, 3.499192482336419*^9}, {
  3.499192519318386*^9, 3.499192601166832*^9}, {3.514129327418623*^9, 
  3.5141293323715553`*^9}, {3.514129504633462*^9, 3.514129505208865*^9}, {
  3.5261377016431313`*^9, 3.526137722601585*^9}, {3.526138708614337*^9, 
  3.526138734214877*^9}, {3.526306924605708*^9, 3.526306927023225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{
     RowBox[{"lower", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down1_", ",", "up1_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", 
     RowBox[{"upper", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"g_", ",", "_", ",", 
        RowBox[{"{", 
         RowBox[{"down2_", ",", "up2_"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "_"}], "]"}]}], ",", "k_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"k", "<", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k"}], "+", "down2"}], "<", "up1"}]}]}], ":=", 
  RowBox[{
   RowBox[{"GPAMultiplyWithOffset", "[", 
    RowBox[{"lower", ",", "upper", ",", "k"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "DebugPrint", "[", "\"\<beginning GPAMultiplyWithOffset\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{
         RowBox[{"TurnUpBottomLeftCorner", "[", 
          RowBox[{
           RowBox[{"GPAMultiply", "[", 
            RowBox[{
             RowBox[{"TurnDownTopRightCorner", "[", 
              RowBox[{
               RowBox[{"TurnDownTopLeftCorner", "[", 
                RowBox[{"lower", ",", 
                 RowBox[{"-", "k"}]}], "]"}], ",", 
               RowBox[{"up1", "+", "k", "-", "down2"}]}], "]"}], ",", 
             "upper"}], "]"}], ",", 
           RowBox[{"-", "k"}]}], "]"}], ",", 
         RowBox[{"up1", "+", "k", "-", "down2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<finished GPAMultiplyWithOffset\>\"", "]"}], ";",
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190964311791*^9, 3.4991910526468143`*^9}, {
  3.499191238611739*^9, 3.499191358156477*^9}, {3.499191548296215*^9, 
  3.499191550023752*^9}, {3.499192481977853*^9, 3.499192482336419*^9}, {
  3.499192519318386*^9, 3.499192601166832*^9}, {3.514129327418623*^9, 
  3.5141293323715553`*^9}, {3.514129504633462*^9, 3.514129505208865*^9}, {
  3.5261377016431313`*^9, 3.526137722601585*^9}, {3.526138751132427*^9, 
  3.5261388387555637`*^9}, {3.526306928717555*^9, 3.526306930714943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplifyCoefficients", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"pivotalStructure", ",", "\"\<Spherical\>\"", ",", 
    RowBox[{"RootReduce", "[", "x", "]"}], ",", "\"\<Lopsided\>\"", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"x", ",", 
        RowBox[{
        "_AlgebraicNumber", "|", "_Integer", "|", "_Rational", "|", 
         "_Real"}]}], "]"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Panic --- not an AlgebraicNumber: \>\"", ",", "x"}], 
        "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499192227845319*^9, 3.4991922359725637`*^9}, {
  3.499225700049974*^9, 3.499225714247746*^9}, {3.526307525941434*^9, 
  3.526307545054496*^9}, {3.5263075921818666`*^9, 3.526307630196184*^9}, {
  3.526320886334474*^9, 3.526320888030036*^9}, {3.5265727031284647`*^9, 
  3.5265727045994453`*^9}, {3.578798820615964*^9, 3.5787988216162987`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "ConnectionGrid", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190573438545*^9, 3.499190576709388*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"ss", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499191817235577*^9, 3.4991918815446863`*^9}, {
  3.526135520511448*^9, 3.5261355219507523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PivotalStructure", "[", 
   RowBox[{"GPA4Element", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     
     RowBox[{"over", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
     "coefficients_"}], "]"}], "]"}], ":=", "pivotalStructure"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526307646726097*^9, 3.5263076506417637`*^9}, {
  3.526307700129147*^9, 3.526307707613092*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ":=", 
  "conn"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PivotalStructure", "[", "conn", "]"}], "\[Equal]", 
     "\"\<Spherical\>\""}], ",", 
    RowBox[{"GPAConjugate", "[", "conn", "]"}], ",", 
    RowBox[{"GPAInverse", "[", "conn", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190685498457*^9, 3.499190716412488*^9}, {
   3.499190789295823*^9, 3.499190789455349*^9}, {3.499190827934558*^9, 
   3.4991908618194437`*^9}, {3.4991920623307447`*^9, 3.499192201246724*^9}, {
   3.514126238831085*^9, 3.514126279237733*^9}, 3.514562418999177*^9, {
   3.5263207532752237`*^9, 3.526320769648753*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
   RowBox[{"1", ",", "1", ",", "start_", ",", "orientation_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"1", ",", "1", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{
    RowBox[{"TurnUpBottomRightCorner", "[", 
     RowBox[{"TurnDownTopLeftCorner", "[", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{"orientation", ",", "1", ",", "pp", ",", 
           RowBox[{"-", "1"}], ",", "ss"}], "]"}], "[", "start", "]"}], ",", 
        "orientation"}], "]"}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{"x", "\[Rule]", 
       RowBox[{"simplifyCoefficients", "[", 
        RowBox[{"y", ",", 
         RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}], 
      ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.499192205003048*^9, {3.499192243255636*^9, 3.499192264350164*^9}, {
   3.514126285919791*^9, 3.5141263054152803`*^9}, {3.526307713459333*^9, 
   3.526307715863739*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
    RowBox[{"1", ",", "k_", ",", "start_", ",", "orientation_"}], "]"}], "/;", 
   RowBox[{"k", "\[GreaterEqual]", "2"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"1", ",", "k", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing ConnectionGrid for 1, \>\"", ",", "k", ",", " ", 
        "\"\<, \>\"", ",", "start", ",", "\"\<, \>\"", ",", "orientation"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GPAMultiplyWithOffset", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"k", ",", "2"}], "]"}], ",", "orientation"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "_"}], "}"}], ",", "start", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"pp", "[", "start", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"ss", "[", "start", "]"}]}], "]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"k", "-", "1"}]], "orientation"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"1", ",", 
           RowBox[{"k", "-", "1"}], ",", "start", ",", "orientation"}], "]"}],
          ",", 
         RowBox[{"k", "-", "1"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"x", "\[Rule]", 
          RowBox[{"simplifyCoefficients", "[", 
           RowBox[{"y", ",", 
            RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}], 
         ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499190863489356*^9, 3.49919096097261*^9}, {
  3.49919141475217*^9, 3.499191469418664*^9}, {3.499191520791514*^9, 
  3.499191532319525*^9}, {3.499191676972334*^9, 3.499191693884076*^9}, {
  3.49919193586535*^9, 3.499192039590765*^9}, {3.499192395573122*^9, 
  3.4991924082894697`*^9}, {3.514126288889303*^9, 3.514126323318297*^9}, {
  3.514128093851872*^9, 3.514128136370516*^9}, {3.514128229911673*^9, 
  3.514128274833099*^9}, {3.526307720595448*^9, 3.526307720715124*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn_", "]"}], "[", 
    RowBox[{"j_", ",", "k_", ",", "start_", ",", "orientation_"}], "]"}], "/;", 
   RowBox[{"j", "\[GreaterEqual]", "2"}]}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
    RowBox[{"j", ",", "k", ",", "start", ",", "orientation"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simplifyCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing ConnectionGrid for \>\"", ",", "j", ",", " ", 
        "\"\<, \>\"", ",", "k", ",", " ", "\"\<, \>\"", ",", "start", ",", 
        "\"\<, \>\"", ",", "orientation"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"GPAMultiplyWithOffset", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", "k", ",", "start", ",", 
          "orientation"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{"1", ",", "k", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"j", ",", "2"}], "]"}], ",", "orientation"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "_"}], "}"}], ",", "start", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"ss", "[", "start", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"pp", "[", "start", "]"}]}], "]"}], ",", 
          RowBox[{"orientation", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"j", "-", "1"}]]}]}], "]"}], ",", 
        RowBox[{"1", "-", "j"}]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"x", "\[Rule]", "y"}], "]"}], ";", 
         RowBox[{"simplifyCounter", "++"}], ";", 
         RowBox[{"x", "\[Rule]", 
          RowBox[{"simplifyCoefficients", "[", 
           RowBox[{"y", ",", 
            RowBox[{"PivotalStructure", "[", "conn", "]"}]}], "]"}]}]}], 
        ")"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.499192425174905*^9, 3.499192441574991*^9}, {
   3.4991926135719967`*^9, 3.4991926148836927`*^9}, {3.499192652473333*^9, 
   3.499192722542179*^9}, {3.499192770455518*^9, 3.4991927753184032`*^9}, {
   3.499192870496284*^9, 3.499192872845664*^9}, 3.4991929990315228`*^9, 
   3.499193046705984*^9, {3.499193135206971*^9, 3.4991931521488533`*^9}, 
   3.514126292107977*^9, {3.514126326086692*^9, 3.5141263301352043`*^9}, {
   3.5141281391136913`*^9, 3.514128160364169*^9}, {3.5141294398392773`*^9, 
   3.514129449742627*^9}, {3.514129548407345*^9, 3.514129554133757*^9}, {
   3.514129998243469*^9, 3.514130002058208*^9}, {3.526307728170039*^9, 
   3.52630772837722*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "StrandCrossingAbove", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526562585665287*^9, 3.526562589374934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newOver", "=", 
      RowBox[{
       RowBox[{"over", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}]}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{"A", ",", "newOver"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5265626499164267`*^9, 3.526562656867133*^9}, {
  3.526562744023058*^9, 3.526562805223085*^9}, {3.543456480722158*^9, 
  3.543456526109194*^9}, {3.5434571819294653`*^9, 3.543457207447446*^9}, {
  3.5434573001967287`*^9, 3.54345732598496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newOver", "=", 
      RowBox[{"ss", "[", 
       RowBox[{"ss", "[", 
        RowBox[{
        "over", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{"A", ",", "newOver"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5265626499164267`*^9, 3.526562656867133*^9}, {
  3.526562744023058*^9, 3.526562805223085*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn_", "]"}], "[", 
    RowBox[{"A", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "1"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "firstOrientation", ",", "newOver", ",", "strandOnRight", ",", 
      "connections", ",", "offsets"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DebugPrint", "[", 
      RowBox[{"\"\<Starting StrandCrossingAbove on \>\"", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Most", "[", "A", "]"}], ",", "\"\<...\>\""}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"firstOrientation", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ss", "[", 
          RowBox[{"over", "\[LeftDoubleBracket]", 
           RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], "==", 
         RowBox[{
         "over", "\[LeftDoubleBracket]", "up", "\[RightDoubleBracket]"}]}], 
        ",", "1", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newOver", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"firstOrientation", "==", "1"}], ",", 
        RowBox[{"pp", "[", 
         RowBox[{"over", "\[LeftDoubleBracket]", 
          RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
        RowBox[{"ss", "[", 
         RowBox[{"over", "\[LeftDoubleBracket]", 
          RowBox[{"up", "+", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "firstOrientation", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "newOver", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"strandOnRight", "=", 
      RowBox[{"AddStrandOnRight", "[", 
       RowBox[{"A", ",", "newOver"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"connections", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{
          "over", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"firstOrientation", " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"k", "-", "up"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "up", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"offsets", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"up", "-", "1"}], ")"}]}], ",", "0", ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"Most", "[", "strandOnRight", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{"Most", "/@", "connections"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GPAMultiplyWithOffset", "[", 
         RowBox[{"#1", ",", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], ",", "strandOnRight", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"connections", ",", " ", "offsets"}], "}"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526134973957067*^9, 3.526134993637663*^9}, {
   3.5261350438434267`*^9, 3.526135061883203*^9}, {3.526135248343408*^9, 
   3.5261352560078373`*^9}, {3.526135295029649*^9, 3.526135374162925*^9}, {
   3.526135409020632*^9, 3.526135435477069*^9}, {3.526135497651334*^9, 
   3.526135505188346*^9}, {3.5261356234273148`*^9, 3.526135655635415*^9}, {
   3.526135687880814*^9, 3.526135749501404*^9}, {3.5261357841195087`*^9, 
   3.526135838503162*^9}, {3.526136015615679*^9, 3.526136016326831*^9}, {
   3.526136120482799*^9, 3.526136122672361*^9}, {3.526136364785164*^9, 
   3.526136367961382*^9}, {3.526136848762372*^9, 3.526136872781806*^9}, {
   3.526136994446784*^9, 3.5261370022673473`*^9}, {3.526137243120163*^9, 
   3.526137253745852*^9}, {3.526137326059016*^9, 3.526137326473509*^9}, 
   3.526147953155119*^9, 3.526307000180827*^9, {3.526562594925476*^9, 
   3.526562599099174*^9}, {3.526562636521864*^9, 3.526562636596836*^9}, {
   3.526566045765917*^9, 3.526566054518894*^9}, {3.568058418625958*^9, 
   3.5680585075996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StrandCrossingBelow", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Rotate\[Pi]Counterclockwise", "[", 
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", 
    RowBox[{"Rotate\[Pi]Clockwise", "[", "A", "]"}], "]"}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.526562029630855*^9, 3.5265620867039824`*^9}, {
  3.52656214574338*^9, 3.526562156149353*^9}, {3.5265622343861017`*^9, 
  3.52656224277794*^9}, {3.526562403288769*^9, 3.526562404771101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "bad", " ", "implementation", " ", "prepares", " ", "a", " ", 
    "giant", " ", "grid", " ", "first"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatness", "[", "conn_", "]"}], "[", 
     RowBox[{"A", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], ")"}], ".."}]}], "}"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "coefficients_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GPAMultiply", "[", 
      RowBox[{"A", ",", 
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{"TurnUpBottomRightCorner", "[", 
         RowBox[{
          RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
          RowBox[{"2", ",", "up", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], "]"}], "-", " ", 
     RowBox[{"TurnUpBottomLeftCorner", "[", 
      RowBox[{"TurnUpBottomLeftCorner", "[", 
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}]}]}], 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, 3.526307007011527*^9, {3.526562252771318*^9, 
   3.526562269529565*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"FIXME", ":", " ", 
   RowBox[{
   "replace", " ", "the", " ", "constants", " ", "passed", " ", "to", " ", 
    RowBox[{"AddStrandOnRight", "."}]}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526147424261018*^9, 3.526147437924472*^9}, {
  3.526147784326065*^9, 3.5261477926858263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TwoStrandFlatness", "[", "conn_", "]"}], "[", 
   RowBox[{"A", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ")"}], ".."}]}], "}"}]}], ",", 
      
      RowBox[{"{", 
       RowBox[{"0", ",", "up_Integer"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "coefficients_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{
     RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", 
     RowBox[{"TurnDownTopLeftCorner", "[", 
      RowBox[{
       RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", "A", "]"}], 
      "]"}], "]"}], "]"}], "-", " ", 
   RowBox[{"TurnUpBottomLeftCorner", "[", 
    RowBox[{
     RowBox[{"TurnDownTopRightCorner", "[", 
      RowBox[{
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
     "2"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, {3.5261473167012444`*^9, 3.526147332433848*^9}, {
   3.526148267311434*^9, 3.5261482870149193`*^9}, {3.526148890097692*^9, 
   3.526148896129068*^9}, {3.5261742010495577`*^9, 3.5261742011360292`*^9}, 
   3.526307028302812*^9, {3.526564887561133*^9, 3.526564888544178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OneStrandFlatness", "[", "conn_", "]"}], "[", 
   RowBox[{"A_GPA4Element", ",", "B_GPA4Element"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"StrandCrossingAbove", "[", "conn", "]"}], "[", "A", "]"}], "-", 
   RowBox[{
    RowBox[{"StrandCrossingBelow", "[", "conn", "]"}], "[", "B", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5094065335884666`*^9, 3.509406551472204*^9}, {
   3.509406582018718*^9, 3.509406683242997*^9}, {3.509409398212017*^9, 
   3.5094094099368143`*^9}, {3.5094095638530407`*^9, 3.509409586707568*^9}, {
   3.5094096430551434`*^9, 3.509409673554747*^9}, {3.509411422278583*^9, 
   3.5094114238613443`*^9}, 3.509411580266914*^9, {3.514126229009762*^9, 
   3.5141262360566597`*^9}, {3.5261473167012444`*^9, 3.526147332433848*^9}, {
   3.526148267311434*^9, 3.5261482870149193`*^9}, {3.526148890097692*^9, 
   3.526148896129068*^9}, {3.5261742010495577`*^9, 3.5261742011360292`*^9}, 
   3.526307028302812*^9, {3.526562385585651*^9, 3.526562394040291*^9}, {
   3.526562463836047*^9, 3.526562468058806*^9}, {3.52656285423568*^9, 
   3.526562878144616*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "FusionRulesFromConnection", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517072650345944*^9, 3.517072653989903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FusionRulesFromConnection", "[", 
     RowBox[{"G_", ",", "conn_"}], "]"}], "[", 
    RowBox[{"a_Vertex", ",", "b_Vertex", ",", "c_Vertex"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "\[And]", 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "\[And]", 
     RowBox[{
      RowBox[{"b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Equal]", 
      RowBox[{"c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
     ")"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "star", ",", "starover", ",", "overa", ",", "overb", ",", "overac", ",", 
      "overbc", ",", "pa", ",", "pb", ",", "psac", ",", "psbc", ",", "grid1", 
      ",", "grid2", ",", "loops"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"starover", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"star", "=", 
      RowBox[{"Vertex", "[", 
       RowBox[{
        RowBox[{"Sequence", "@@", "starover"}], ",", "0", ",", "1"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"overa", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"starover", "+", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pa", "=", 
      RowBox[{
       RowBox[{"GraphPathsBetween", "[", 
        RowBox[{"G", ",", "star", ",", "a", ",", "overa"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"overb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"starover", "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pb", "=", 
      RowBox[{
       RowBox[{"GraphPathsBetween", "[", 
        RowBox[{"G", ",", "star", ",", "b", ",", "overb"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"overac", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psac", "=", 
      RowBox[{"GraphPathsBetween", "[", 
       RowBox[{"G", ",", "a", ",", "c", ",", "overac"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "psac", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"overbc", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "+", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0"}], "}"}]}], ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{
          "a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psbc", "=", 
      RowBox[{"GraphPathsBetween", "[", 
       RowBox[{"G", ",", "b", ",", "c", ",", "overbc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "psbc", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"grid1", "=", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{
        RowBox[{"PathLength", "[", "pa", "]"}], ",", 
        RowBox[{"PathLength", "[", "pb", "]"}], ",", "starover", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"grid2", "=", 
      RowBox[{
       RowBox[{"ConnectionGrid", "[", "conn", "]"}], "[", 
       RowBox[{
        RowBox[{"PathLength", "[", "pb", "]"}], ",", 
        RowBox[{"PathLength", "[", "pa", "]"}], ",", "starover", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "DebugPrint", "[", "\"\<Finished preparing connection grids.\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"loops", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ConcatenatePaths", "[", 
             RowBox[{"pa", ",", "#1", ",", 
              RowBox[{"Reverse", "[", "#2", "]"}], ",", 
              RowBox[{"Reverse", "[", "pb", "]"}]}], "]"}], "]"}], "&"}], ",",
           "psac", ",", "psbc", ",", "1"}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", 
      RowBox[{
       RowBox[{"Length", "[", "loops", "]"}], ",", 
       "\"\< loops to evaluate\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"grid1", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReverseLoop", "[", "#", "]"}], "/.", 
            RowBox[{"grid2", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}], "&"}], 
        "/@", "loops"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5146571191742*^9, 3.514657139248645*^9}, {
   3.514657192055806*^9, 3.514657211143649*^9}, {3.51584863537948*^9, 
   3.515848643409967*^9}, {3.515848701225958*^9, 3.5158487027868967`*^9}, {
   3.515848768008497*^9, 3.515848774371203*^9}, {3.5158488245849857`*^9, 
   3.515848835755377*^9}, {3.515848926468884*^9, 3.515849039655698*^9}, {
   3.515849073952334*^9, 3.51584911623736*^9}, {3.515849193033886*^9, 
   3.515849296505486*^9}, {3.515849386745741*^9, 3.51584941503714*^9}, {
   3.5158494597710953`*^9, 3.515849502430296*^9}, {3.515849540694437*^9, 
   3.515849571051194*^9}, {3.5158496173046713`*^9, 3.515849629877719*^9}, {
   3.515849676537899*^9, 3.515849865887525*^9}, {3.515850044110879*^9, 
   3.5158500720408792`*^9}, {3.515850143316625*^9, 3.5158501799253893`*^9}, {
   3.515850290434093*^9, 3.515850298138954*^9}, {3.515850350704995*^9, 
   3.515850365211248*^9}, {3.515850411120943*^9, 3.515850415096653*^9}, {
   3.5158504603781*^9, 3.515850461227971*^9}, {3.5158504970947857`*^9, 
   3.5158505177180767`*^9}, {3.515850567188191*^9, 3.515850593594096*^9}, {
   3.515850742534657*^9, 3.5158507726627903`*^9}, {3.515850834595726*^9, 
   3.515850888398594*^9}, {3.515850977008781*^9, 3.5158509872569313`*^9}, {
   3.515851155369659*^9, 3.515851157064571*^9}, {3.515998443596684*^9, 
   3.5159984587267923`*^9}, {3.517072648304421*^9, 3.5170726488633966`*^9}, {
   3.517072717201757*^9, 3.5170727663738213`*^9}, {3.517075925202694*^9, 
   3.517075947231166*^9}, {3.517077532342702*^9, 3.5170776255699587`*^9}, 
   3.51707774932456*^9, {3.518270360966504*^9, 3.518270370620533*^9}, {
   3.5182704241706057`*^9, 3.518270462384837*^9}, {3.518270506485292*^9, 
   3.518270511492735*^9}, {3.5182705548839893`*^9, 3.518270568533863*^9}, {
   3.518270635343031*^9, 3.5182706376228447`*^9}, {3.518271806018564*^9, 
   3.5182718064817743`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low weight spaces", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.526067533582776*^9, 3.526067536872805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveTwoTermEquations", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "constantConditions", ",", "oneVariableConditions", ",", 
      "twoVariableConditions", ",", "sortedConditions", ",", "condition", ",",
       "targetVariable", ",", "solutions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sortedConditions", "=", "conditions"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... sorting conditions\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "constantConditions", ",", "oneVariableConditions", ",", 
           "twoVariableConditions", ",", "sortedConditions"}], "}"}], "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sow", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Union", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"#", ",", "variablePattern", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "]"}], 
                   "]"}], "/.", 
                  RowBox[{
                   RowBox[{"n_", "/;", 
                    RowBox[{"n", "\[GreaterEqual]", "3"}]}], "\[RuleDelayed]",
                    "\[Infinity]"}]}]}], "]"}], "&"}], "/@", 
              "sortedConditions"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "2", ",", "\[Infinity]"}], "}"}]}], 
            "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"constantConditions", ",", "0"}], "]"}], "]"}], ">", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "DebugPrint", "[", 
            "\"\<... no solution! This should be impossible; 0 always \
works.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"DebugPrint", "[", "constantConditions", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<... found \>\"", ",", 
          RowBox[{"Length", "[", "oneVariableConditions", "]"}], ",", 
          "\"\< and \>\"", ",", " ", 
          RowBox[{"Length", "[", "twoVariableConditions", "]"}], ",", 
          "\"\< one- and two-variable conditions.\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "oneVariableConditions", "]"}], "+", 
          RowBox[{"Length", "[", "twoVariableConditions", "]"}]}], ">", 
         "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{"oneVariableConditions", ",", "variablePattern", ",", 
            RowBox[{
             RowBox[{"RootReduce", "[", 
              RowBox[{"Together", "[", "#", "]"}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", ":", "variablePattern"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "=", "0"}], ")"}]}], ",", "\[Infinity]"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"condition", "=", 
             RowBox[{"Collect", "[", 
              RowBox[{"#", ",", "variablePattern", ",", "Together"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"condition", "=!=", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"targetVariable", "=", 
                RowBox[{"First", "[", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{"condition", ",", "variablePattern", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                   "variablePreferenceFunction"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"solutions", "=", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"condition", "\[Equal]", "0"}], ",", 
                  "targetVariable"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "solutions", "]"}], "\[Equal]", 
                  "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Collect", "[", 
                   RowBox[{
                    RowBox[{
                    "solutions", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "variablePattern", ",", 
                    "Together"}], "]"}], "/.", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
                   
                   RowBox[{"(", 
                    RowBox[{"x", "=", "y"}], ")"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<Something went wrong:\>\"", ",", "condition", ",", 
                    "\"\< \>\"", ",", "solutions"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], ")"}], "&"}], "/@", "twoVariableConditions"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "sortedConditions"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4668657851027193`*^9, 3.466865842008328*^9}, {
   3.466865886018044*^9, 3.4668659172220573`*^9}, {3.4668676450338163`*^9, 
   3.46686765414299*^9}, 3.46686772570022*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VertexPreferences", "[", "g_GradedBigraph", "]"}], "[", 
   RowBox[{"Vertex", "[", 
    RowBox[{"i_", ",", "j_", ",", "d_", ",", "k_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"LopsidedDimension", "[", 
     RowBox[{"g", ",", 
      RowBox[{"Vertex", "[", 
       RowBox[{"i", ",", "j", ",", "d", ",", "k"}], "]"}]}], "]"}]}], "+", 
   RowBox[{"0.1", " ", "k"}], "+", 
   RowBox[{"0.01", "d"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4459684862396517`*^9, 3.4459684960299177`*^9}, {
  3.4459685261325808`*^9, 3.445968570840234*^9}, {3.445968741354023*^9, 
  3.445968746956993*^9}, {3.44596883257246*^9, 3.445968838021318*^9}, {
  3.446846238711916*^9, 3.4468462393785677`*^9}, {3.526067912944121*^9, 
  3.526067923542611*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LoopPreferences", "[", "g_", "]"}], "[", "loop_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.", "+", 
      RowBox[{".01", "k"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "loop", "]"}], "/", "2"}]}], "}"}]}], "]"}], 
   ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"VertexPreferences", "[", "g", "]"}], "/@", 
     RowBox[{"loop", "\[LeftDoubleBracket]", 
      RowBox[{";;", ";;", "2"}], "\[RightDoubleBracket]"}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445968563682519*^9, 3.445968598231353*^9}, {
  3.445968691730507*^9, 3.4459686970883493`*^9}, {3.445968902713396*^9, 
  3.445968972588442*^9}, {3.4461710494049273`*^9, 3.446171066106533*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LowestWeightEigenvectorConditions", "[", 
    RowBox[{
     RowBox[{"k", ":", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"g", ":", 
         RowBox[{"{", 
          RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
        ",", 
        RowBox[{"over", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
        RowBox[{"pivotalStructure", ":", 
         RowBox[{"(", 
          RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], 
        ",", "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "2"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "\[Lambda]0", "]"}], ",", 
        RowBox[{"ToNumberField", "[", 
         RowBox[{
          RowBox[{"RootReduce", "[", "\[Lambda]0", "]"}], ",", 
          RowBox[{"NumberFieldGenerator", "[", 
           RowBox[{
           "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "]"}], ",", "\[Lambda]0"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], ",", 
       RowBox[{
        RowBox[{"EnlargeNumberField", "[", 
         RowBox[{"k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "[", "\[Lambda]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing second cap\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", 
          RowBox[{"RotateOneClick", "[", "k", "]"}], "]"}], "]"}]}], ")"}], 
      "\[IndentingNewLine]", "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing first cap\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", "k", "]"}], "]"}]}], ")"}], "~", "Join", 
      "~", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "\"\<... preparing rotation\>\"", "]"}], 
        ";", 
        RowBox[{"GPACoefficients", "[", 
         RowBox[{
          RowBox[{"RotateTwoClicks", "[", "k", "]"}], "-", 
          RowBox[{"\[Lambda]", " ", "k"}]}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445919393006501*^9, 3.445919401849578*^9}, {
   3.445919505999041*^9, 3.445919508006422*^9}, {3.445969726619781*^9, 
   3.4459698283466253`*^9}, {3.446141299513878*^9, 3.4461413022485943`*^9}, {
   3.446149684604862*^9, 3.446149744641642*^9}, {3.4461699495977907`*^9, 
   3.446169959725525*^9}, {3.446850050073351*^9, 3.446850058687944*^9}, {
   3.446909712188327*^9, 3.4469097435616198`*^9}, {3.446910582277701*^9, 
   3.446910597450952*^9}, {3.469138329847617*^9, 3.4691383823504877`*^9}, 
   3.481811417953023*^9, {3.48181334024564*^9, 3.481813343834915*^9}, {
   3.508773686280005*^9, 3.508773692253665*^9}, {3.50877376957824*^9, 
   3.508773835937017*^9}, {3.508773952612857*^9, 3.508773955677393*^9}, {
   3.510589726316659*^9, 3.5105897302994127`*^9}, 3.526067580141732*^9, 
   3.526067619750063*^9, {3.526067690901224*^9, 3.526067732356963*^9}, 
   3.526307093233986*^9, {3.5263074297560997`*^9, 3.526307440706038*^9}, {
   3.5287125864103518`*^9, 3.528712591897493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], ":=", 
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433455142273607`*^9, 3.543345535797127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenvectorConditions", "[", 
   RowBox[{
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], ",", "\[Lambda]0_"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5433455797770157`*^9, 3.5433455851011133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LowestWeightConditions", "[", 
    RowBox[{"k", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "values_"}], "]"}]}], "]"}], "/;", 
   RowBox[{"up", "\[GreaterEqual]", "2"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"GPACoefficients", "[", 
         RowBox[{"CapTopLeft", "[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"NestList", "[", 
        RowBox[{"RotateOneClick", ",", "k", ",", 
         RowBox[{"up", "+", "down", "-", "1"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445919393006501*^9, 3.445919401849578*^9}, {
   3.445919505999041*^9, 3.445919508006422*^9}, {3.445969726619781*^9, 
   3.4459698283466253`*^9}, {3.446141299513878*^9, 3.4461413022485943`*^9}, {
   3.446149684604862*^9, 3.446149744641642*^9}, {3.4461699495977907`*^9, 
   3.446169959725525*^9}, {3.446850050073351*^9, 3.446850058687944*^9}, {
   3.446909712188327*^9, 3.4469097435616198`*^9}, {3.446910582277701*^9, 
   3.446910597450952*^9}, {3.469138329847617*^9, 3.4691383823504877`*^9}, 
   3.481811417953023*^9, {3.48181334024564*^9, 3.481813343834915*^9}, {
   3.508773686280005*^9, 3.508773692253665*^9}, {3.50877376957824*^9, 
   3.508773835937017*^9}, {3.508773952612857*^9, 3.508773955677393*^9}, {
   3.510589726316659*^9, 3.5105897302994127`*^9}, 3.526067580141732*^9, 
   3.526067619750063*^9, {3.526067690901224*^9, 3.526067732356963*^9}, 
   3.526307093233986*^9, {3.5263074297560997`*^9, 3.526307440706038*^9}, {
   3.5287125864103518`*^9, 3.528712591897493*^9}, {3.528727760315473*^9, 
   3.528727781791004*^9}, {3.5287278172138853`*^9, 3.528727830749028*^9}, 
   3.529846162301258*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"k", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"TurnUpBottomLeftCorner", "[", "k", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345461681632*^9, 3.543345488053504*^9}, 
   3.543345541436172*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightConditions", "[", 
   RowBox[{"k", ":", 
    RowBox[{"GPA4Element", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
      RowBox[{"over", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
      "values_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543345562121532*^9, 3.5433455656485662`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseMatrixSolve", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"variables", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"conditions", ",", "variablePattern", ",", "\[Infinity]"}],
            "]"}], "]"}], ",", "variablePreferenceFunction"}], "]"}]}], ",", 
      "arrays", ",", "matrix", ",", "nullspace"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"matrix", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i_", ",", "j_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{
            "conditions", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "variables", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "conditions", "]"}], ",", 
           RowBox[{"Length", "[", "variables", "]"}]}], "}"}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DebugPrint", "[", "\"\<preparing SparseArray\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"arrays", "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"conditions", ",", "variables"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"matrix", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "arrays", "]"}], "\[Equal]", "2"}], ",", 
        RowBox[{
        "arrays", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DebugPrint", "[", "\"\<finding nullspace...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lastSparseMatrixSolveMatrix", "=", "matrix"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nullspace", "=", 
      RowBox[{"NullSpace", "[", 
       RowBox[{"matrix", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<OneStepRowReduction\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"prepare", " ", "a", " ", "list", " ", "of", " ", "rules"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "#"}], "]"}], "&"}], "/@", 
      "nullspace"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4667942693629704`*^9, 3.4667943275232964`*^9}, {
  3.4667950750311127`*^9, 3.4667951334203873`*^9}, {3.4667951666749783`*^9, 
  3.466795239536755*^9}, {3.466795271537733*^9, 3.4667952829034863`*^9}, {
  3.46679534240556*^9, 3.466795393547613*^9}, {3.4667955082921057`*^9, 
  3.466795515008913*^9}, {3.466795741880331*^9, 3.466795742100761*^9}, {
  3.466798819639162*^9, 3.466798825720826*^9}, {3.466798866221089*^9, 
  3.466798905562931*^9}, {3.4668006274660063`*^9, 3.4668006588000793`*^9}, {
  3.466800708384371*^9, 3.466800710411268*^9}, {3.466804501978815*^9, 
  3.46680452458456*^9}, {3.466804882614112*^9, 3.466804895509995*^9}, {
  3.508774676111102*^9, 3.5087747098724422`*^9}, {3.508774802391862*^9, 
  3.50877480571434*^9}, {3.508774877934349*^9, 3.508774895297783*^9}, {
  3.531680957168724*^9, 3.531680958176921*^9}, {3.5371305957618723`*^9, 
  3.537130609743536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ManyTermSparseMatrixSolve", "[", 
   RowBox[{"conditions_", ",", "variablePattern_", ",", 
    RowBox[{"variablePreferenceFunction_:", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"SparseMatrixSolve", "[", 
   RowBox[{
    RowBox[{"SolveTwoTermEquations", "[", 
     RowBox[{
     "conditions", ",", "variablePattern", ",", 
      "variablePreferenceFunction"}], "]"}], ",", "variablePattern", ",", 
    "variablePreferenceFunction"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.466866005106608*^9, 3.466866076931291*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CollectGPA4Matrix", "[", 
   RowBox[{
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "Together"}], "]"}]}], ")"}]}], 
      ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CollectGPA4Matrix", "[", 
   RowBox[{
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"xx__", ",", "matrices_"}], "]"}], ",", "p_", ",", "f_"}], "]"}],
   ":=", 
  RowBox[{"GPA4Matrix", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"matrices", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "f"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4832155202902308`*^9, 3.483215545147975*^9}, {
  3.483215593859654*^9, 3.483215635629253*^9}, {3.483215761427021*^9, 
  3.483215770859211*^9}, {3.483216264306465*^9, 3.483216265868951*^9}, {
  3.5260680429251003`*^9, 3.52606806118749*^9}, {3.526069210092753*^9, 
  3.52606922829897*^9}, {3.526069275630728*^9, 3.526069276606557*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CollectGPA4Element", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"xx__", ",", "values_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"values", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "Together"}], "]"}]}], ")"}]}], 
      ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CollectGPA4Element", "[", 
   RowBox[{
    RowBox[{"GPA4Element", "[", 
     RowBox[{"xx__", ",", "values_"}], "]"}], ",", "p_", ",", "f_"}], "]"}], ":=", 
  RowBox[{"GPA4Element", "[", 
   RowBox[{"xx", ",", 
    RowBox[{"values", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v_", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"Collect", "[", 
          RowBox[{"m", ",", "p", ",", "f"}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4832155202902308`*^9, 3.483215545147975*^9}, {
  3.483215593859654*^9, 3.483215635629253*^9}, {3.483215761427021*^9, 
  3.483215770859211*^9}, {3.483216264306465*^9, 3.483216265868951*^9}, {
  3.5260680429251003`*^9, 3.52606806118749*^9}, {3.526069210092753*^9, 
  3.52606922829897*^9}, {3.526069275630728*^9, 3.526069276606557*^9}, {
  3.526310623549231*^9, 3.5263106484434547`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "LowestWeightEigenspace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526563205148951*^9, 3.526563212665739*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightEigenspace", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "\[Lambda]_", ",", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", "|", "1"}], ")"}], ":", "0"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], ",", 
    RowBox[{"LowestWeightEigenspace", "[", 
     RowBox[{"G", ",", "pivotalStructure", ",", "\[Lambda]", ",", "t"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "f", ",", "over", ",", "kernel", ",", "conditions", ",",
         "solutions", ",", "variables", ",", "matrix", ",", "c", ",", 
        "replacements", ",", "remainingf"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<Preparing test kernel...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"over", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"DepthOfBranchPoint", "[", 
                   RowBox[{
                   "G", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", "1"}], "}"}]}], 
               "]"}], ",", "1"}], "]"}], "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "+", "t"}], ",", "2"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kernel", "=", 
        RowBox[{"VariableGPA4Element", "[", 
         RowBox[{"G", ",", "over", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DepthOfBranchPoint", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"DepthOfBranchPoint", "[", 
              RowBox[{
              "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "+", "1"}]}], "}"}], ",", "pivotalStructure", ",", "f"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", 
        "\"\<Preparing low weight eigenspace conditions...\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"LowestWeightEigenvectorConditions", "[", 
         RowBox[{"kernel", ",", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Beginning progressive solve...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"ManyTermSparseMatrixSolve", "[", 
         RowBox[{"conditions", ",", "_f", ",", 
          RowBox[{
           RowBox[{"LoopPreferences", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"replacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
           "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "solutions", "]"}]}], "}"}]}], "]"}], 
           ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
              "]"}], "/.", "solutions"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{
         RowBox[{"GPA4Matrix", "[", "kernel", "]"}], "/.", "replacements"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"CollectGPA4Matrix", "[", 
         RowBox[{"matrix", ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"matrix", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{
          "DebugPrint", "[", 
           "\"\<Oh dear --- the variable hasn't disappeared yet...\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"remainingf", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"matrix", ",", "_f", ",", "\[Infinity]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"matrix", "=", 
           RowBox[{"matrix", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"remainingf", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"c", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", 
                   RowBox[{"Length", "[", "remainingf", "]"}]}]}], "}"}]}], 
               "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DebugPrint", "[", "\"\<But now it's gone...\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LowestWeightEigenspace", "[", 
           RowBox[{"G", ",", "pivotalStructure", ",", "\[Lambda]", ",", "t"}],
            "]"}], "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "cc", "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"matrix", "/.", 
              RowBox[{"c", "\[Rule]", "cc"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<... finished LowestWeightEigenspace\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PackageLowestWeightEigenspaces", "[", "G", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445972779781309*^9, 3.445972864413204*^9}, {
   3.445972898895255*^9, 3.445972962146593*^9}, {3.4460802780418253`*^9, 
   3.446080359579668*^9}, {3.446647529522216*^9, 3.446647532408835*^9}, {
   3.446649834211596*^9, 3.4466498371145163`*^9}, {3.446650181039261*^9, 
   3.446650207173506*^9}, {3.446650853861106*^9, 3.446650855260021*^9}, {
   3.446652736647915*^9, 3.446652774964315*^9}, {3.446846572238379*^9, 
   3.446846644835526*^9}, {3.446846852813343*^9, 3.4468468606635838`*^9}, {
   3.446848369786813*^9, 3.446848419086179*^9}, {3.446856644990739*^9, 
   3.4468566508414907`*^9}, {3.4468575573434477`*^9, 3.446857576811185*^9}, {
   3.446909985692429*^9, 3.446910108380397*^9}, {3.446910248056724*^9, 
   3.446910263711671*^9}, {3.446910356391973*^9, 3.4469103612881107`*^9}, {
   3.4469103991103067`*^9, 3.4469103994670877`*^9}, {3.446910431171165*^9, 
   3.44691048055746*^9}, {3.447363457116119*^9, 3.44736345723777*^9}, {
   3.447363495142351*^9, 3.4473636015465813`*^9}, {3.464703811307473*^9, 
   3.464703817874318*^9}, {3.466805187163639*^9, 3.466805233806419*^9}, 
   3.466866116533052*^9, {3.466876674162283*^9, 3.466876700560186*^9}, {
   3.483214651752284*^9, 3.483214686734447*^9}, {3.483215213547867*^9, 
   3.483215240313656*^9}, {3.483216268383532*^9, 3.48321630792622*^9}, {
   3.483216338547185*^9, 3.483216349293456*^9}, {3.526068012884975*^9, 
   3.526068030288556*^9}, {3.52606806988025*^9, 3.5260680888793287`*^9}, {
   3.5260682836894693`*^9, 3.526068287304775*^9}, {3.5260683221117277`*^9, 
   3.526068362258387*^9}, {3.526068407063676*^9, 3.5260684386183157`*^9}, {
   3.526069678680943*^9, 3.5260696831275177`*^9}, {3.526069800988696*^9, 
   3.526069809351606*^9}, {3.526307168183586*^9, 3.526307190046574*^9}, {
   3.526563030590847*^9, 3.5265630461476183`*^9}, {3.5265631312553673`*^9, 
   3.526563136902454*^9}, {3.526563202046639*^9, 3.526563202125372*^9}, {
   3.535916686115509*^9, 3.53591668880202*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "LowestWeightSpace", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.528728684323185*^9, 3.5287286879996147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LowestWeightSpace", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"t", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", "|", "1"}], ")"}], ":", "0"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], ",", 
    RowBox[{"LowestWeightSpace", "[", 
     RowBox[{"G", ",", "pivotalStructure", ",", "n", ",", "t"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "f", ",", "over", ",", "kernel", ",", "conditions", ",",
         "solutions", ",", "variables", ",", "matrix", ",", "c", ",", 
        "replacements"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<Preparing test kernel...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"over", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", "n", "}"}]}], "]"}], ",", "1"}], "]"}], "~", 
            "Join", "~", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "+", "t"}], ",", "2"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kernel", "=", 
        RowBox[{"VariableGPA4Element", "[", 
         RowBox[{"G", ",", "over", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
          "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Preparing low weight spacae conditions...\>\"",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"LowestWeightConditions", "[", "kernel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<Beginning progressive solve...\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solutions", "=", 
        RowBox[{"ManyTermSparseMatrixSolve", "[", 
         RowBox[{"conditions", ",", "_f", ",", 
          RowBox[{
           RowBox[{"LoopPreferences", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"replacements", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
           "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "solutions", "]"}]}], "}"}]}], "]"}], 
           ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"solutions", ",", "_f", ",", "\[Infinity]"}], "]"}], 
              "]"}], "/.", "solutions"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{
         RowBox[{"GPA4Matrix", "[", "kernel", "]"}], "/.", "replacements"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"CollectGPA4Matrix", "[", 
         RowBox[{"matrix", ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"matrix", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{
          "DebugPrint", "[", 
           "\"\<Oh dear --- the variable hasn't disappeared yet...\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"remainingf", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"matrix", ",", "_f", ",", "\[Infinity]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"matrix", "=", 
           RowBox[{"matrix", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"remainingf", "\[Rule]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"c", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "solutions", "]"}], "+", 
                   RowBox[{"Length", "[", "remainingf", "]"}]}]}], "}"}]}], 
               "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DebugPrint", "[", "\"\<But now it's gone...\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LowestWeightSpace", "[", 
           RowBox[{"G", ",", "pivotalStructure", ",", "n", ",", "t"}], "]"}], 
          "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "cc", "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"matrix", "/.", 
              RowBox[{"c", "\[Rule]", "cc"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "DebugPrint", "[", "\"\<... finished LowWeightSpace\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PackageLowestWeightEigenspaces", "[", "G", "]"}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445972779781309*^9, 3.445972864413204*^9}, {
   3.445972898895255*^9, 3.445972962146593*^9}, {3.4460802780418253`*^9, 
   3.446080359579668*^9}, {3.446647529522216*^9, 3.446647532408835*^9}, {
   3.446649834211596*^9, 3.4466498371145163`*^9}, {3.446650181039261*^9, 
   3.446650207173506*^9}, {3.446650853861106*^9, 3.446650855260021*^9}, {
   3.446652736647915*^9, 3.446652774964315*^9}, {3.446846572238379*^9, 
   3.446846644835526*^9}, {3.446846852813343*^9, 3.4468468606635838`*^9}, {
   3.446848369786813*^9, 3.446848419086179*^9}, {3.446856644990739*^9, 
   3.4468566508414907`*^9}, {3.4468575573434477`*^9, 3.446857576811185*^9}, {
   3.446909985692429*^9, 3.446910108380397*^9}, {3.446910248056724*^9, 
   3.446910263711671*^9}, {3.446910356391973*^9, 3.4469103612881107`*^9}, {
   3.4469103991103067`*^9, 3.4469103994670877`*^9}, {3.446910431171165*^9, 
   3.44691048055746*^9}, {3.447363457116119*^9, 3.44736345723777*^9}, {
   3.447363495142351*^9, 3.4473636015465813`*^9}, {3.464703811307473*^9, 
   3.464703817874318*^9}, {3.466805187163639*^9, 3.466805233806419*^9}, 
   3.466866116533052*^9, {3.466876674162283*^9, 3.466876700560186*^9}, {
   3.483214651752284*^9, 3.483214686734447*^9}, {3.483215213547867*^9, 
   3.483215240313656*^9}, {3.483216268383532*^9, 3.48321630792622*^9}, {
   3.483216338547185*^9, 3.483216349293456*^9}, {3.526068012884975*^9, 
   3.526068030288556*^9}, {3.52606806988025*^9, 3.5260680888793287`*^9}, {
   3.5260682836894693`*^9, 3.526068287304775*^9}, {3.5260683221117277`*^9, 
   3.526068362258387*^9}, {3.526068407063676*^9, 3.5260684386183157`*^9}, {
   3.526069678680943*^9, 3.5260696831275177`*^9}, {3.526069800988696*^9, 
   3.526069809351606*^9}, {3.526307168183586*^9, 3.526307190046574*^9}, {
   3.526563030590847*^9, 3.5265630461476183`*^9}, {3.5265631312553673`*^9, 
   3.526563136902454*^9}, {3.526563202046639*^9, 3.526563202125372*^9}, {
   3.5287278057374372`*^9, 3.52872780992447*^9}, {3.528727845245491*^9, 
   3.528727856889963*^9}, {3.528727941628729*^9, 3.528728032441126*^9}, 
   3.52872846895527*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadLowestWeightEigenspaces", "[", 
   RowBox[{"G", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Needs", "[", 
      RowBox[{"\"\<FusionAtlas`Data`\>\"", "<>", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"(", 
          RowBox[{"GraphToString", "/@", "G"}], ")"}]}], ")"}], "<>", 
       "\"\<`LowestWeightEigenspace`\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"On", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LoadLowestWeightEigenspaces", "[", "G", "]"}], "=", "False"}], 
     ";", "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411927026253885*^9, 3.4119270365386734`*^9}, {
   3.4140209075797215`*^9, 3.4140209151906652`*^9}, {3.446846517382749*^9, 
   3.446846561881503*^9}, {3.446846810617436*^9, 3.446846812981331*^9}, 
   3.446846981170701*^9, {3.446847052448126*^9, 3.446847055221373*^9}, {
   3.446847383054578*^9, 3.446847384819085*^9}, {3.5260681184487886`*^9, 
   3.526068134993869*^9}, {3.52606821408747*^9, 3.526068228463785*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "ChangePivotalStructure", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5263110178519287`*^9, 3.526311022256816*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangePivotalStructure", "[", 
   RowBox[{
    RowBox[{"A", ":", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], 
       ",", 
       RowBox[{"over", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "..."}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"down_Integer", ",", "up_Integer"}], "}"}], ",", 
       RowBox[{"pivotalStructure", ":", 
        RowBox[{"(", 
         RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}], ",",
        "coefficients_"}], "]"}]}], ",", 
    RowBox[{"newPivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exponent", ",", "simplifyCoefficient"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pivotalStructure", "\[Equal]", "newPivotalStructure"}], ",", 
       RowBox[{"Return", "[", "A", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"exponent", "=", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pivotalStructure", ",", "newPivotalStructure"}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<Spherical\>\"", ",", "\"\<Lopsided\>\""}], "}"}], ",", 
        "1", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<Lopsided\>\"", ",", "\"\<Spherical\>\""}], "}"}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Spherical\>\"", ",", "\"\<Spherical\>\""}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"\"\<Lopsided\>\"", ",", "\"\<Lopsided\>\""}], "}"}]}], ",",
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simplifyCoefficient", "[", "x_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"newPivotalStructure", "\[Equal]", "\"\<Spherical\>\""}], ",", 
        RowBox[{"RootReduce", "[", "x", "]"}], ",", 
        RowBox[{"ToNumberField0", "[", 
         RowBox[{"x", ",", 
          RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"GPA4Element", "[", 
      RowBox[{"g", ",", "over", ",", 
       RowBox[{"{", 
        RowBox[{"down", ",", "up"}], "}"}], ",", "newPivotalStructure", ",", 
       RowBox[{"coefficients", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"loop_", "\[Rule]", "\[Zeta]_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"loop", "\[Rule]", 
           RowBox[{"simplifyCoefficient", "[", 
            RowBox[{"\[Zeta]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Times", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"LopsidedDimension", "[", 
                    RowBox[{"g", ",", "#"}], "]"}], ",", "1"}], "]"}], "&"}], 
                    "/@", 
                    RowBox[{"UpVertices", "[", 
                    RowBox[{"loop", ",", "up"}], "]"}]}], ")"}], "~", "Join", 
                    "~", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"LopsidedDimension", "[", 
                    RowBox[{"g", ",", "#"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"DownVertices", "[", 
                    RowBox[{"loop", ",", "down"}], "]"}]}], ")"}]}], ")"}]}], 
                 ")"}], ",", "exponent"}], "]"}], "]"}]}], "]"}]}], 
          ")"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526307924501946*^9, 3.526307947233427*^9}, {
   3.5263080818668423`*^9, 3.526308101416889*^9}, {3.526308542550867*^9, 
   3.526308582560541*^9}, {3.526308759678413*^9, 3.526308790493166*^9}, {
   3.526308824638112*^9, 3.526308947524477*^9}, {3.526308984939636*^9, 
   3.526309019947324*^9}, {3.526309051226866*^9, 3.526309078202306*^9}, {
   3.526309127058469*^9, 3.526309189498269*^9}, {3.526309245488329*^9, 
   3.5263092841588182`*^9}, {3.526309989133964*^9, 3.526310053468577*^9}, {
   3.526310259694478*^9, 3.526310302400609*^9}, {3.526310332734384*^9, 
   3.5263103338691587`*^9}, {3.5263103741924477`*^9, 3.5263103903882*^9}, {
   3.5263104912844553`*^9, 3.526310506044055*^9}, 3.526311012467415*^9, {
   3.526311120366075*^9, 3.52631113062152*^9}, {3.526311200710511*^9, 
   3.526311202909711*^9}, {3.526311471866022*^9, 3.526311488615391*^9}, {
   3.5263120417139587`*^9, 3.526312044122986*^9}, {3.526312538087716*^9, 
   3.5263125434408627`*^9}, {3.52631259741632*^9, 3.5263125997990503`*^9}, {
   3.526312632884294*^9, 3.526312634867127*^9}, {3.5263127436911173`*^9, 
   3.526312747517337*^9}, {3.5263128735635433`*^9, 3.5263128765456467`*^9}, {
   3.526313047725773*^9, 3.526313049571557*^9}, {3.526313147903009*^9, 
   3.526313150405938*^9}, {3.5273517308905354`*^9, 3.527351740505417*^9}, {
   3.527352296318883*^9, 3.527352325456492*^9}, {3.527417187422597*^9, 
   3.5274172102668247`*^9}, {3.5366090355274153`*^9, 3.536609064998599*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"UpVertices", ",", "DownVertices"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5274171611732283`*^9, 3.527417166947812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UpVertices", "[", 
   RowBox[{"loop_", ",", "up_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"loop", "~", "Join", "~", "loop"}], ")"}], "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", 
    RowBox[{
     RowBox[{"2", "up"}], "+", "1"}], ";;", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownVertices", "[", 
   RowBox[{"loop_", ",", "down_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"loop", "~", "Join", "~", "loop", "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"loop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "}"}]}], ")"}], "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{"-", "1"}], ";;", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "down"}], "-", "1"}], ";;", 
    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526311316349783*^9, 3.526311463955002*^9}, {
  3.5274158545370417`*^9, 3.527415883254711*^9}, {3.527416949570669*^9, 
  3.527416992301673*^9}, {3.527417024388233*^9, 3.527417032847412*^9}, {
  3.527417082967841*^9, 3.5274170965744762`*^9}, {3.5274173091408377`*^9, 
  3.527417330078755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangePivotalStructure", "[", 
   RowBox[{"A_GPA4Matrix", ",", "ps_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     "\[Equal]", "ps"}], ",", "A", ",", 
    RowBox[{"GPA4Matrix", "[", 
     RowBox[{"ChangePivotalStructure", "[", 
      RowBox[{
       RowBox[{"GPA4Element", "[", "A", "]"}], ",", "ps"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526563890465164*^9, 3.52656391815948*^9}, {
  3.535919166293028*^9, 3.535919175924436*^9}, {3.535919210378859*^9, 
  3.535919230947453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cachedToNumberField", "[", "z__", "]"}], ":=", 
  RowBox[{
   RowBox[{"cachedToNumberField", "[", "z", "]"}], "=", 
   RowBox[{"ToNumberField", "[", "z", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.536606863855052*^9, 3.536606878885789*^9}, {
  3.578797199007188*^9, 3.578797220710829*^9}, {3.5787972533495607`*^9, 
  3.578797254060741*^9}, {3.578797339852393*^9, 3.578797341155559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaugeAction", "[", 
   RowBox[{"g_", ",", "X_GPA4Element"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "gauge"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{"g", "~", "Join", "~", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "\[Rule]", 
           SuperscriptBox[
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            RowBox[{"-", "1"}]]}], "&"}], "/@", "g"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gauge", "[", "loop_", "]"}], ":=", 
      RowBox[{"Times", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"loop", ",", "3", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "/.", "f"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"X", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"loop_", "\[Rule]", "value_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"loop", "\[Rule]", 
         RowBox[{"value", " ", 
          RowBox[{"gauge", "[", "loop", "]"}]}]}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556039601335362*^9, 3.556039631948288*^9}, {
  3.556040419615266*^9, 3.556040442625526*^9}, {3.556040478630726*^9, 
  3.556040592452302*^9}, {3.556040652485057*^9, 3.5560406598034363`*^9}, {
  3.55604071799537*^9, 3.556040772537808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VariableGaugeElement", "[", 
   RowBox[{"G_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "edges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edges", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GraphPaths", "[", 
           RowBox[{"G", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "2", ",", "1"}], 
          "]"}]}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"\[Gamma]", "[", "#", "]"}]}], "&"}], "/@", "edges"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5560399238354073`*^9, 3.556039949880279*^9}, {
  3.556040256678627*^9, 3.5560402973473587`*^9}, {3.5560403440464973`*^9, 
  3.556040363436597*^9}, {3.556040978277914*^9, 3.556040978355748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGaugeElementRelating", "[", 
   RowBox[{"X_GPA4Element", ",", "Y_GPA4Element"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"G", ",", "\[Gamma]", ",", "g", ",", "solutions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"VariableGaugeElement", "[", 
       RowBox[{"G", ",", "\[Gamma]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GPACoefficients", "[", 
          RowBox[{
           RowBox[{"GaugeAction", "[", 
            RowBox[{"g", ",", "X"}], "]"}], "-", "Y"}], "]"}], "\[Equal]", 
         "0"}], ",", 
        RowBox[{"g", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"solutions", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "/.", "solutions"}], ")"}], "/.", 
        RowBox[{"_\[Gamma]", "\[RuleDelayed]", "1"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556039639602192*^9, 3.5560396596896677`*^9}, {
   3.556039964689641*^9, 3.556040059147768*^9}, {3.556040095657344*^9, 
   3.556040109706419*^9}, {3.556040426491983*^9, 3.55604042910006*^9}, {
   3.5560412485211887`*^9, 3.5560412612094393`*^9}, 3.5560414638440247`*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "NumberFieldGauge", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumberFieldGauge", "[", 
   RowBox[{"conn_", ",", 
    RowBox[{"expandNumberField", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "False"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "=", "conn"}], ",", "G", ",", "\[Gamma]", ",", "targets", 
      ",", "var", ",", "solutions", ",", "gaugeElement", ",", "length"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"\"\<\[Theta]\>\"", ",", "___"}], "]"}], "\[RuleDelayed]", 
        "1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"GaugeAction", "[", 
       RowBox[{
        RowBox[{"gaugeElement", "=", 
         RowBox[{"VariableGaugeElement", "[", 
          RowBox[{"G", ",", "\[Gamma]"}], "]"}]}], ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"Together", "[", "y", "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x_", "\[Rule]", 
             RowBox[{"y_", "?", "NumericQ"}]}], ")"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"cachedToNumberField", "[", 
               RowBox[{
                RowBox[{"RootReduce", "[", "y", "]"}], ",", 
                RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}], 
              ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"expandNumberField", "\[And]", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"c", ",", "ToNumberField"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "DebugPrint", "[", "\"\<Enlarging number field...\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"NumberFieldGenerator", "[", "G", "]"}], "=", 
            RowBox[{
             RowBox[{"ToNumberField", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"NumberFieldGenerator", "[", "G", "]"}], "}"}], "~", 
               "Join", "~", 
               RowBox[{"Union", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{
                   RowBox[{"HoldPattern", "[", 
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{"x_", ",", "_"}], "]"}], "]"}], "\[RuleDelayed]", 
                   
                   RowBox[{"RootReduce", "[", "x", "]"}]}], ",", 
                  "\[Infinity]"}], "]"}], "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"DebugPrint", "[", 
            RowBox[{"\"\<... new number field generator: \>\"", ",", 
             RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RedefineLopsidedDimension", "[", "G", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{"ToNumberField", "[", 
                  RowBox[{"x_", ",", "_"}], "]"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"cachedToNumberField", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], 
               ",", 
               RowBox[{"x_AlgebraicNumber", "\[RuleDelayed]", 
                RowBox[{"cachedToNumberField", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], 
                 "]"}]}]}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"length", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"targets", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"GPACoefficients", "[", "c", "]"}], ",", 
             RowBox[{"e_", "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"e", ",", "_\[Gamma]"}], "]"}]}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "length", "]"}], "<>", 
          "\"\< targets to go...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"length", ">", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
           "targets", ",", "_\[Gamma]", ",", "\[Infinity]", ",", "1"}], "]"}],
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DebugPrint", "[", 
         RowBox[{"\"\<Solving \>\"", ",", 
          RowBox[{
          "targets", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "\"\< for \>\"", ",", "var"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"solutions", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "targets", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "\[Equal]", "1"}], ",", "var"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "solutions", "]"}], "\[NotEqual]", "1"}], 
          ",", 
          RowBox[{
           RowBox[{"Print", "[", "targets", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", 
          RowBox[{
          "solutions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gaugeElement", "=", 
         RowBox[{"gaugeElement", "/.", 
          RowBox[{
          "solutions", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"gaugeElement", "/.", 
         RowBox[{"_\[Gamma]", "\[RuleDelayed]", "1"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556222294013072*^9, 3.556222454599093*^9}, {
  3.556222486060711*^9, 3.5562226086675777`*^9}, {3.556222649906789*^9, 
  3.556222691065855*^9}, {3.556223057344563*^9, 3.556223119956852*^9}, {
  3.5562231777043*^9, 3.556223180586913*^9}, {3.5562236816922398`*^9, 
  3.5562237072038727`*^9}, {3.568057283545027*^9, 3.5680573126291227`*^9}, {
  3.568057442681877*^9, 3.5680574877445517`*^9}, {3.5787964061753597`*^9, 
  3.578796423582468*^9}, {3.578796497073223*^9, 3.5787965055630713`*^9}, {
  3.578796539284924*^9, 3.578796550656495*^9}, {3.5787973307438383`*^9, 
  3.578797333549848*^9}, {3.578797675479973*^9, 3.5787976784465733`*^9}, {
  3.6305463669075937`*^9, 3.630546385062196*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PivotalStructureOf", "[", "A_GPA4Element", "]"}], ":=", 
  RowBox[{
  "A", "\[LeftDoubleBracket]", "4", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PivotalStructureOf", "[", "A_GPA4Matrix", "]"}], ":=", 
  RowBox[{
  "A", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.537124725677889*^9, 3.537124768995255*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindEquationsForFlatGenerators", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindEquationsForFlatGenerators", "[", 
   RowBox[{"conn0_", ",", "\[Lambda]_", ",", "c_", ",", 
    RowBox[{"allowGaugeTransformation", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}]}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
       "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
       "ps", ",", "conn", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
      "solutions", ",", "generators", ",", "remaining"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ps", "=", 
      RowBox[{"If", "[", 
       RowBox[{"allowGaugeTransformation", ",", "\"\<Lopsided\>\"", ",", 
        RowBox[{"PivotalStructureOf", "[", "conn0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lws0", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"LowestWeightEigenspace", "[", 
         RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "0"}], "]"}], "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lws1", "=", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{
        RowBox[{"LowestWeightEigenspace", "[", 
         RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "1"}], "]"}], "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conn", "=", 
      RowBox[{"If", "[", 
       RowBox[{"allowGaugeTransformation", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NumberFieldGauge", "[", 
          RowBox[{"ChangePivotalStructure", "[", 
           RowBox[{"conn0", ",", "\"\<Lopsided\>\""}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\[IndentingNewLine]", "conn0"}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"flatness", "=", 
      RowBox[{
       RowBox[{"OneStrandFlatness", "[", "conn", "]"}], "[", 
       RowBox[{"lws0", ",", 
        RowBox[{"RotateOneClick", "[", "lws1", "]"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.532294917079309*^9, 3.5322949807565327`*^9}, {
  3.5323697611281147`*^9, 3.532369771422543*^9}, {3.537124606027546*^9, 
  3.5371247824690733`*^9}, {3.5371248586096573`*^9, 3.5371248608489122`*^9}, {
  3.556223745102161*^9, 3.556223747030772*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindFlatGenerators", "]"}], "\n", 
 RowBox[{
  RowBox[{"FindFlatGenerators", "[", 
   RowBox[{"conn0_", ",", "\[Lambda]_", ",", 
    RowBox[{"allowGaugeTransformation", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"True", "|", "False"}], ")"}], ":", "True"}]}]}], "]"}], ":=", 
  
  RowBox[{
   RowBox[{"FindFlatGenerators", "[", 
    RowBox[{"conn0", ",", "\[Lambda]", ",", "allowGaugeTransformation"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
        "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ",", "ps", ",", "c", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
       "solutions", ",", "generators", ",", "remaining", ",", "map"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ps", "=", 
       RowBox[{"If", "[", 
        RowBox[{"allowGaugeTransformation", ",", "\"\<Lopsided\>\"", ",", 
         RowBox[{"PivotalStructureOf", "[", "conn0", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws0", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightEigenspace", "[", 
          RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "0"}], "]"}], "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws1", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightEigenspace", "[", 
          RowBox[{"G", ",", "ps", ",", "\[Lambda]", ",", "1"}], "]"}], "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatness", "=", 
       RowBox[{
        RowBox[{"FindEquationsForFlatGenerators", "[", 
         RowBox[{
         "conn0", ",", "\[Lambda]", ",", "c", ",", 
          "allowGaugeTransformation"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "All", ",", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lastFlatnessEquations", "=", "flatness"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatnessReductionCounter", "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ps", "\[Equal]", "\"\<Spherical\>\""}], ",", 
        RowBox[{
         RowBox[{"DebugPrint", "[", "\"\<RootReducing...\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"map", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SecretParallelMode", "\[Equal]", "True"}], ",", 
            RowBox[{
             RowBox[{"DistributeDefinitions", "[", "cachedRootReduce", "]"}], 
             ";", "ParallelMap"}], ",", "Map"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"flatness", "=", 
          RowBox[{"map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{"#", ",", "_c", ",", "cachedRootReduce"}], "]"}], "&"}],
             ",", "flatness"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<Finished preparing flatness equations\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lastFlatnessEquations", "=", "flatness"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solutions", "=", 
       RowBox[{"SparseMatrixSolve", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"Union", "[", "flatness", "]"}], ",", "_c"}], "]"}], ",",
            "0"}], "]"}], ",", "_c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"generators", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lws0", "/.", "#"}], "&"}], ")"}], "/@", 
        "solutions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.526573004302967*^9, 3.526573008422333*^9}, 
   3.532897315087549*^9, {3.5359169580360193`*^9, 3.535916972522904*^9}, {
   3.537124628091508*^9, 3.537124640404571*^9}, {3.5371247921896887`*^9, 
   3.5371248239473953`*^9}, {3.537125645501313*^9, 3.537125682083681*^9}, {
   3.537125858354059*^9, 3.5371258931992292`*^9}, {3.537126098238208*^9, 
   3.5371260987419643`*^9}, {3.537127313669674*^9, 3.537127402963333*^9}, {
   3.569093630997081*^9, 3.569093633190793*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FindFlatLowestWeightVectors", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFlatLowestWeightVectors", "[", 
   RowBox[{"conn0_", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FindFlatLowestWeightVectors", "[", 
    RowBox[{"conn0", ",", "n"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
        "conn0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ",", "c", ",", "conn", ",", "lws0", ",", "lws1", ",", "flatness", ",", 
       "solutions", ",", "generators", ",", "remaining"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lws0", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightSpace", "[", 
          RowBox[{"G", ",", "\"\<Lopsided\>\"", ",", "n", ",", "0"}], "]"}], 
         "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lws1", "=", 
       RowBox[{"GPA4Element", "[", 
        RowBox[{
         RowBox[{"LowestWeightSpace", "[", 
          RowBox[{"G", ",", "\"\<Lopsided\>\"", ",", "n", ",", "1"}], "]"}], 
         "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"1", ",", "#"}], "]"}], "&"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conn", "=", 
       RowBox[{
        RowBox[{"NumberFieldGauge", "[", 
         RowBox[{"ChangePivotalStructure", "[", 
          RowBox[{"conn0", ",", "\"\<Lopsided\>\""}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"flatness", "=", 
       RowBox[{
        RowBox[{"OneStrandFlatness", "[", "conn", "]"}], "[", 
        RowBox[{"lws0", ",", 
         RowBox[{"RotateOneClick", "[", "lws1", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solutions", "=", 
       RowBox[{"SparseMatrixSolve", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"flatness", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], ",", 
             "_c"}], "]"}], ",", "0"}], "]"}], ",", "_c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"generators", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lws0", "/.", "#"}], "&"}], ")"}], "/@", 
        "solutions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.528728062826112*^9, 3.528728094878077*^9}, {
   3.528728703074692*^9, 3.5287287050737658`*^9}, {3.531748534491808*^9, 
   3.531748546703866*^9}, {3.531756879796567*^9, 3.531756884684737*^9}, {
   3.5328972644035187`*^9, 3.5328973028570223`*^9}, 3.535916998057332*^9, {
   3.5562237673255453`*^9, 3.556223769136059*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qInteger\[Delta]", "[", "k_", "]"}], ":=", 
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "\[Delta]", "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Delta]", " ", 
          RowBox[{
           RowBox[{"qInteger\[Delta]", "[", 
            RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"qInteger\[Delta]", "[", 
           RowBox[{"k", "-", "2"}], "]"}], "[", "\[Delta]", "]"}]}], ",", 
        "\[Delta]"}], "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "2", "]"}], "=", 
   RowBox[{"#", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "1", "]"}], "=", 
   RowBox[{"1", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qInteger\[Delta]", "[", "0", "]"}], "=", 
   RowBox[{"0", "&"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428707067673397`*^9, 3.4428708698941298`*^9}, {
  3.4428725554708967`*^9, 3.4428725570067*^9}, {3.4432351243828487`*^9, 
  3.443235134879043*^9}, {3.444689998795965*^9, 3.4446900080094557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WenzlRecursion", "[", 
   RowBox[{
    RowBox[{"gpa", ":", 
     RowBox[{"(", 
      RowBox[{"_GPA4Matrix", "|", "_GPA4Element"}], ")"}]}], ",", "x_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "DebugPrint", "[", "\"\<Beginning Wenzl recursion calculation.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DebugPrint", "[", "\"\<   adding strand on right\>\"", "]"}], 
       ";", 
       RowBox[{"AddStrandOnRight", "[", 
        RowBox[{"gpa", ",", 
         RowBox[{"gpa", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"gpa", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "+", "2"}]}],
           "\[RightDoubleBracket]"}]}], "]"}]}], ")"}], "-", 
     RowBox[{"x", " ", 
      RowBox[{"GPAMultiply", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "DebugPrint", "[", "\"\<   turning down top right\>\"", "]"}], ";", 
          
          RowBox[{"TurnDownTopRightCorner", "[", "gpa", "]"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "DebugPrint", "[", "\"\<   turning up bottom right\>\"", "]"}], ";", 
          RowBox[{"TurnUpBottomRightCorner", "[", "gpa", "]"}]}], ")"}]}], 
       "]"}]}]}]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44207086802013*^9, 3.4420708917762613`*^9}, {
   3.442071004220521*^9, 3.442071005002489*^9}, {3.442074837078445*^9, 
   3.442074915998242*^9}, {3.442078301039007*^9, 3.4420783254311037`*^9}, {
   3.442160317554632*^9, 3.442160341399254*^9}, {3.442160534875649*^9, 
   3.442160847626791*^9}, {3.442160899220743*^9, 3.4421609857430363`*^9}, {
   3.442161061159869*^9, 3.442161115833652*^9}, {3.442163479438676*^9, 
   3.442163479947233*^9}, {3.442163650466667*^9, 3.442163689178329*^9}, 
   3.442163991181943*^9, {3.4421640714322577`*^9, 3.44216413601126*^9}, {
   3.442164861271735*^9, 3.442164886059987*^9}, {3.44216533703292*^9, 
   3.4421653411891623`*^9}, {3.4421671612949944`*^9, 3.4421671824211683`*^9}, 
   3.4421679072639647`*^9, {3.442167939346631*^9, 3.442167949986918*^9}, {
   3.442169600574132*^9, 3.4421696039463167`*^9}, {3.442870476789954*^9, 
   3.442870510803516*^9}, {3.44295431225*^9, 3.442954313265625*^9}, {
   3.443143856840056*^9, 3.443143858223157*^9}, 3.4431447683595533`*^9, {
   3.443144807244235*^9, 3.443144808460107*^9}, {3.443164681425619*^9, 
   3.443164682775586*^9}, {3.4432248248128757`*^9, 3.443224826571258*^9}, {
   3.443237366750311*^9, 3.44323737053924*^9}, {3.446145114126292*^9, 
   3.446145185611867*^9}, {3.446145334703454*^9, 3.44614533479353*^9}, 
   3.4468504535397367`*^9, {3.483201202454526*^9, 3.483201210157916*^9}, {
   3.483201331957724*^9, 3.483201335178288*^9}, {3.4832017163385572`*^9, 
   3.483201718200325*^9}, {3.483201792680458*^9, 3.483201794701951*^9}, {
   3.483201887477561*^9, 3.483201889235231*^9}, {3.483202954428892*^9, 
   3.483203015396006*^9}, 3.526912883906151*^9, {3.5274578089087763`*^9, 
   3.527457831150052*^9}, {3.5274578710033207`*^9, 3.527457895184791*^9}, {
   3.568348727523885*^9, 3.568348735153726*^9}, {3.5683572497781143`*^9, 
   3.568357260280532*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "JonesWenzlIdempotent", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527457369455669*^9, 3.527457375303918*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "0", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"GPA4Matrix", "[", 
    RowBox[{"EmptyGPA4Element", "[", 
     RowBox[{"g", ",", "over1", ",", "pivotalStructure"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "1", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
     "g", ",", "1", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], "=", 
    RowBox[{"AddStrandOnRight", "[", 
     RowBox[{
      RowBox[{"JonesWenzlIdempotent", "[", 
       RowBox[{
       "g", ",", "0", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
       "]"}], ",", "over2"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.483019693299192*^9, 3.483019693363494*^9}, {3.483032286253389*^9, 
   3.4830322869367847`*^9}, {3.483201214800728*^9, 3.48320123395257*^9}, {
   3.4832015380143547`*^9, 3.483201543918481*^9}, {3.483201765946623*^9, 
   3.483201770304327*^9}, {3.4832025258596354`*^9, 3.483202531601242*^9}, {
   3.5269129451622972`*^9, 3.5269129475895576`*^9}, {3.52691299687399*^9, 
   3.526913052143632*^9}, {3.526913110375098*^9, 3.526913151190661*^9}, {
   3.526913605716093*^9, 3.526913606715332*^9}, {3.527457589144375*^9, 
   3.5274575943589487`*^9}, {3.527457630818268*^9, 3.527457630889481*^9}, {
   3.527458388467453*^9, 3.5274583900861607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JonesWenzlIdempotent", "[", 
    RowBox[{
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "k_", ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], "/;", 
   RowBox[{"k", ">", "1"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"LoadIdempotents", "[", "g", "]"}], ",", 
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
     "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"JonesWenzlIdempotent", "[", 
       RowBox[{
       "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
       "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sm", "=", 
           RowBox[{"GPA4Element", "[", 
            RowBox[{"JonesWenzlIdempotent", "[", 
             RowBox[{"g", ",", 
              RowBox[{"k", "-", "1"}], ",", "over1", ",", "over2", ",", 
              "pivotalStructure"}], "]"}], "]"}]}], ",", "td", ",", 
          RowBox[{"\[Delta]", "=", 
           RowBox[{"DimensionOfGenerator", "[", "g", "]"}]}], ",", "shove"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"shove", "[", "x_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumericQ", "[", "x", "]"}], ",", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "pivotalStructure", ",", "\"\<Spherical\>\"", ",", "x", ",", 
              "\"\<Lopsided\>\"", ",", 
              RowBox[{"ToNumberField", "[", 
               RowBox[{
                RowBox[{"RootReduce", "[", "x", "]"}], ",", 
                RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"Together", "[", "x", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"td", "=", 
          RowBox[{"TurnDownTopRightCorner", "[", "sm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GPA4Matrix", "[", 
          RowBox[{
           RowBox[{"AddStrandOnRight", "[", 
            RowBox[{"sm", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"EvenQ", "[", "k", "]"}], ",", "over1", ",", "over2"}],
               "]"}]}], "]"}], "+", "\[IndentingNewLine]", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"shove", "[", 
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], ",", 
                  RowBox[{"a", "+", "k"}]}], "]"}], 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                   "\[Delta]", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "a", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", "\[Delta]", ",", "1"}], 
                    "]"}], 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"OddQ", "[", "k", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", 
                    RowBox[{"Power", "[", 
                    RowBox[{"\[Delta]", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], ",", 
                  "1"}], "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", "a", "]"}], "[", "\[Delta]",
                  "]"}]}], "]"}], 
              RowBox[{"TurnUpBottomRightCorner", "[", 
               RowBox[{
                RowBox[{"AddStrandOnRight", "[", 
                 RowBox[{
                  RowBox[{"TurnDownTopRightCorner", "[", 
                   RowBox[{"td", ",", 
                    RowBox[{"k", "-", "a", "-", "1"}]}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"EvenQ", "[", "a", "]"}], ",", "over1", ",", 
                    "over2"}], "]"}]}], "]"}], ",", 
                RowBox[{"k", "-", "a", "-", "1", "+", "1"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PackageIdempotents", "[", "g", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"JonesWenzlIdempotent", "[", 
      RowBox[{
      "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.447003405717081*^9, 3.447003494432659*^9}, 3.4818114152691317`*^9, {
   3.4830196933902807`*^9, 3.4830196934586697`*^9}, {3.4830322871721363`*^9, 
   3.4830322878757553`*^9}, {3.483201237864205*^9, 3.483201252594293*^9}, {
   3.48320204151832*^9, 3.483202067791091*^9}, {3.4832025340820637`*^9, 
   3.483202543872821*^9}, 3.52691294937321*^9, {3.5269131767975273`*^9, 
   3.5269132281126833`*^9}, {3.526913277940961*^9, 3.5269132915010567`*^9}, {
   3.5269133586077843`*^9, 3.526913377806181*^9}, 3.52691344361539*^9, {
   3.5269134789980717`*^9, 3.5269134810048027`*^9}, {3.526913560536415*^9, 
   3.52691359871546*^9}, {3.527457363305416*^9, 3.527457367376017*^9}, {
   3.527457522471744*^9, 3.527457529442719*^9}, {3.527457562110259*^9, 
   3.527457564207642*^9}, {3.527458173463109*^9, 3.527458173758203*^9}, {
   3.527458393516523*^9, 3.527458396827712*^9}, {3.527524906650465*^9, 
   3.527524942392817*^9}, {3.5396204681243467`*^9, 3.539620646761516*^9}, {
   3.5396207535607023`*^9, 3.539620803766368*^9}, {3.5396208713370247`*^9, 
   3.539620881244814*^9}, {3.5396209505550127`*^9, 3.5396209513423862`*^9}, {
   3.539621317042019*^9, 3.5396213226545477`*^9}, {3.5396213548889093`*^9, 
   3.539621369439494*^9}, {3.539621445029376*^9, 3.5396215424053993`*^9}, {
   3.5396215771231413`*^9, 3.5396215970786343`*^9}, {3.53962184208462*^9, 
   3.539621942426655*^9}, {3.539621976570566*^9, 3.5396219904207163`*^9}, {
   3.539622518268214*^9, 3.539622546866253*^9}, {3.539622624312908*^9, 
   3.5396226995918818`*^9}, {3.545690148828679*^9, 3.5456901679443617`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"JonesWenzlIdempotent", "[", 
     RowBox[{
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",",
       "k_", ",", 
      RowBox[{"over1", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
      RowBox[{"over2", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
      RowBox[{"pivotalStructure", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
     "]"}], "/;", 
    RowBox[{"k", ">", "1"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LoadIdempotents", "[", "g", "]"}], ",", 
     RowBox[{"JonesWenzlIdempotent", "[", 
      RowBox[{
      "g", ",", "k", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"JonesWenzlIdempotent", "[", 
          RowBox[{
          "g", ",", "k", ",", "over1", ",", "over2", ",", 
           "pivotalStructure"}], "]"}], "=", 
         RowBox[{"result", "=", 
          RowBox[{"WenzlRecursion", "[", 
           RowBox[{
            RowBox[{"JonesWenzlIdempotent", "[", 
             RowBox[{"g", ",", 
              RowBox[{"k", "-", "1"}], ",", "over1", ",", "over2", ",", 
              "pivotalStructure"}], "]"}], ",", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Delta]", "=", 
                RowBox[{"DimensionOfGenerator", "[", "g", "]"}]}], "}"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pivotalStructure", "\[Equal]", "\"\<Lopsided\>\""}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"ToNumberField0", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Xor", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", "k", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "over1"}], ",", "2"}], "]"}], 
                    "\[Equal]", "1"}]}], "]"}], ",", "\[Delta]", ",", 
                    FractionBox["1", "\[Delta]"]}], "]"}], 
                   FractionBox[
                    RowBox[{
                    RowBox[{"qInteger\[Delta]", "[", 
                    RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                    RowBox[{
                    RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                    "\[Delta]", "]"}]]}], ",", 
                  RowBox[{"NumberFieldGenerator", "[", "g", "]"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"RootReduce", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", 
                    RowBox[{"k", "-", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "k", "]"}], "[", 
                   "\[Delta]", "]"}]], "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PackageIdempotents", "[", "g", "]"}], ";", 
        "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4428702112511663`*^9, 3.442870266638506*^9}, {
   3.44287049039583*^9, 3.4428704931554613`*^9}, {3.442870885525857*^9, 
   3.442871003455031*^9}, {3.4428712417815123`*^9, 3.4428712896736727`*^9}, 
   3.4428723108258343`*^9, {3.442872467494985*^9, 3.442872514213332*^9}, {
   3.442895819015916*^9, 3.442895825516017*^9}, {3.443144722300695*^9, 
   3.443144724594027*^9}, {3.443235136911112*^9, 3.44323513946381*^9}, {
   3.4461453226159897`*^9, 3.446145344166298*^9}, {3.446145417982871*^9, 
   3.44614562293731*^9}, {3.446145969814979*^9, 3.44614597360525*^9}, {
   3.446146014416836*^9, 3.446146040269608*^9}, {3.446146558527294*^9, 
   3.446146568634858*^9}, {3.446146948202641*^9, 3.446146950004511*^9}, {
   3.4461469829130497`*^9, 3.446147001499916*^9}, 3.4461472492405443`*^9, 
   3.446147344672585*^9, 3.446147375486534*^9, {3.446147538519149*^9, 
   3.446147543482782*^9}, {3.446147658687475*^9, 3.44614765970294*^9}, {
   3.4461481157772503`*^9, 3.4461481168813972`*^9}, 3.446148152915209*^9, {
   3.4461488473303432`*^9, 3.446148849435091*^9}, {3.446854783405035*^9, 
   3.44685482524362*^9}, {3.446854868320126*^9, 3.446854873183865*^9}, {
   3.446859480454373*^9, 3.446859485613077*^9}, 3.447003367793858*^9, {
   3.447003405717081*^9, 3.447003494432659*^9}, 3.4818114152691317`*^9, {
   3.4830196933902807`*^9, 3.4830196934586697`*^9}, {3.4830322871721363`*^9, 
   3.4830322878757553`*^9}, {3.483201237864205*^9, 3.483201252594293*^9}, {
   3.48320204151832*^9, 3.483202067791091*^9}, {3.4832025340820637`*^9, 
   3.483202543872821*^9}, 3.52691294937321*^9, {3.5269131767975273`*^9, 
   3.5269132281126833`*^9}, {3.526913277940961*^9, 3.5269132915010567`*^9}, {
   3.5269133586077843`*^9, 3.526913377806181*^9}, 3.52691344361539*^9, {
   3.5269134789980717`*^9, 3.5269134810048027`*^9}, {3.526913560536415*^9, 
   3.52691359871546*^9}, {3.527457363305416*^9, 3.527457367376017*^9}, {
   3.527457522471744*^9, 3.527457529442719*^9}, {3.527457562110259*^9, 
   3.527457564207642*^9}, {3.527458173463109*^9, 3.527458173758203*^9}, {
   3.527458393516523*^9, 3.527458396827712*^9}, {3.527524906650465*^9, 
   3.527524942392817*^9}, {3.5396206010979853`*^9, 3.539620601975959*^9}, {
   3.539622729749608*^9, 3.5396227323073673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadIdempotents", "[", 
   RowBox[{"g", ":", 
    RowBox[{"{", 
     RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Needs", "[", 
      RowBox[{"\"\<FusionAtlas`Data`\>\"", "<>", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"(", 
          RowBox[{"GraphToString", "/@", "g"}], ")"}]}], ")"}], "<>", 
       "\"\<`Idempotents`\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"On", "[", 
      RowBox[{
       RowBox[{"Get", "::", "noopen"}], ",", 
       RowBox[{"Needs", "::", "nocont"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LoadIdempotents", "[", "g", "]"}], "=", "False"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.411927026253885*^9, 3.4119270365386734`*^9}, {
   3.4140209075797215`*^9, 3.4140209151906652`*^9}, {3.446846517382749*^9, 
   3.446846561881503*^9}, {3.446846810617436*^9, 3.446846812981331*^9}, 
   3.446846981170701*^9, {3.446847052448126*^9, 3.446847055221373*^9}, {
   3.446847383054578*^9, 3.446847384819085*^9}, {3.447003351141345*^9, 
   3.447003364246028*^9}, 3.5275249603720083`*^9, {3.532363003046315*^9, 
   3.5323630039014683`*^9}, {3.536340669170742*^9, 3.536340670217553*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2Equation", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "r", ",", "f"}], "}"}], ",", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"CollectGPA4Matrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"LowestWeightEigenspace", "[", 
             RowBox[{
             "G", ",", "\"\<Lopsided\>\"", ",", "\[Lambda]", ",", "0"}], 
             "]"}], "[", "c", "]"}], ",", "_c"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"ToNumberField0", "[", 
          RowBox[{
           RowBox[{"RootReduce", "[", 
            RowBox[{"BranchFactor", "[", 
             RowBox[{
             "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "]"}], ",", 
           RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GPA4Element", "[", 
         RowBox[{
          RowBox[{"S", ".", "S"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r", "-", "1"}], ")"}], "S"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{"JonesWenzlIdempotent", "[", 
            RowBox[{"G", ",", 
             RowBox[{
              RowBox[{"DepthOfBranchPoint", "[", 
               RowBox[{
               "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Lopsided\>\""}], 
            "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5275227249163017`*^9, 3.527522767648981*^9}, {
   3.527522804001464*^9, 3.527522865281333*^9}, {3.527522897233316*^9, 
   3.527522898033206*^9}, {3.527522930834103*^9, 3.527522943209852*^9}, {
   3.527523321407069*^9, 3.527523360448002*^9}, 3.527523449602442*^9, {
   3.528115612350113*^9, 3.528115614538558*^9}, {3.5281159846266813`*^9, 
   3.5281159850736847`*^9}, {3.605361435051762*^9, 3.605361436082817*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgressiveRowReduce", "[", 
   RowBox[{"matrix_", ",", 
    RowBox[{"p_:", "50"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"counter", "=", "0"}], ",", 
      RowBox[{"result", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"remainingRows", "=", "matrix"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "remainingRows", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DebugPrint", "[", "counter", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"counter", "+=", 
         RowBox[{"Min", "[", 
          RowBox[{"p", ",", 
           RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"RowReduce", "[", 
            RowBox[{"result", "~", "Join", "~", 
             RowBox[{"Take", "[", 
              RowBox[{"remainingRows", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"p", ",", 
                 RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", "..."}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"remainingRows", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"remainingRows", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"p", ",", 
             RowBox[{"Length", "[", "remainingRows", "]"}]}], "]"}]}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5389452908120403`*^9, 3.5389452926918488`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RowReducedS2Equation", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "quadratics", ",", "variables", ",", "vectors", ",", "rr", ",", 
      "monomials"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"quadratics", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"GPACoefficients", "[", 
             RowBox[{
              RowBox[{"S2Equation", "[", 
               RowBox[{"G", ",", "\[Lambda]"}], "]"}], "[", "c", "]"}], "]"}],
             "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"variables", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"quadratics", ",", 
            RowBox[{"c", "[", "i_", "]"}], ",", "\[Infinity]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectors", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Normal", "[", 
            RowBox[{"CoefficientArrays", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"quadratics", ",", "All"}], "]"}], ",", "variables"}], 
             "]"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rr", "=", 
         RowBox[{"ProgressiveRowReduce", "[", 
          RowBox[{"vectors", ",", "20"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"monomials", "=", 
         RowBox[{
          RowBox[{"{", "1", "}"}], "~", "Join", "~", "variables", "~", "Join",
           "~", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", "variables", ",", "variables"}], "]"}], 
            ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"rr", ",", 
           RowBox[{"_", "?", "ZeroVectorQ"}]}], "]"}], ".", "monomials"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5389450456949577`*^9, 3.5389450851839046`*^9}, {
   3.538945117356567*^9, 3.538945213151616*^9}, {3.53894527216418*^9, 
   3.538945272328948*^9}, {3.538945320950612*^9, 3.5389453366740437`*^9}, {
   3.538945371634369*^9, 3.538945377063497*^9}, 3.538947473668989*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "S2Solutions", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5275236606264887`*^9, 3.527523662969486*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2Solutions", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", "__BigraphWithDuals", "}"}]}], ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"simplifyCoefficient", ",", "S", ",", "gb", ",", "solution"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"simplifyCoefficient", "[", "x_", "]"}], ":=", 
      RowBox[{"ToNumberField", "[", 
       RowBox[{"x", ",", 
        RowBox[{"NumberFieldGenerator", "[", "G", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "c", "}"}], ",", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"S", "=", 
          RowBox[{"CollectGPA4Matrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LowestWeightEigenspace", "[", 
              RowBox[{
              "G", ",", "\"\<Lopsided\>\"", ",", "\[Lambda]", ",", "0"}], 
              "]"}], "[", "c", "]"}], ",", "_c"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gb", "=", 
          RowBox[{"GroebnerBasis", "[", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"GPACoefficients", "[", 
                RowBox[{
                 RowBox[{"S2Equation", "[", 
                  RowBox[{"G", ",", "\[Lambda]"}], "]"}], "[", "c", "]"}], 
                "]"}], "]"}], ",", "_c"}], "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"S", ",", "_c", ",", "\[Infinity]"}], "]"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gb", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "_AlgebraicNumber"}], "]"}], ",", "#", ",", 
               
               RowBox[{"#", "/", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{
                  "#", ",", "_AlgebraicNumber", ",", "\[Infinity]", ",", 
                   "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], "&"}], "/@", 
           "gb"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solution", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{"gb", "\[Equal]", "0"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"x_", ",", 
               RowBox[{"1", "/", "2"}]}], "]"}], "\[RuleDelayed]", 
             RowBox[{"simplifyCoefficient", "[", 
              RowBox[{"Power", "[", 
               RowBox[{"x", ",", 
                RowBox[{"1", "/", "2"}]}], "]"}], "]"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"CollectGPA4Matrix", "[", 
            RowBox[{"#", ",", "_c", ",", "simplifyCoefficient"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"S", "/.", "solution"}], ")"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527522967220997*^9, 3.527523057172282*^9}, {
   3.527523263481176*^9, 3.527523281424225*^9}, {3.527523362863368*^9, 
   3.527523368599287*^9}, {3.527523419394809*^9, 3.527523419761902*^9}, 
   3.527523451593265*^9, {3.527523515747695*^9, 3.527523524418405*^9}, {
   3.527523564818116*^9, 3.527523633934444*^9}, {3.527523705823703*^9, 
   3.527523706942479*^9}, 3.5275238380054827`*^9, {3.527523964238154*^9, 
   3.527523964494076*^9}, {3.528115565667251*^9, 3.528115569522612*^9}, {
   3.528115702830282*^9, 3.528115739858309*^9}, {3.528115801975875*^9, 
   3.528115815866865*^9}, {3.528116174920532*^9, 3.5281161874796143`*^9}, {
   3.528116221295824*^9, 3.528116225110549*^9}, {3.528463190366487*^9, 
   3.528463194286661*^9}, {3.528463279538979*^9, 3.528463312022657*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["One cup JW", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5418583082891808`*^9, 3.541858310001275*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "IdentityTL", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541859152566949*^9, 3.541859156023349*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IdentityTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "0", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"EmptyGPA4Element", "[", 
   RowBox[{"G", ",", "over1", ",", "pivotalStructure"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.541859126479774*^9, 3.541859135411221*^9}, {
  3.5418595993201237`*^9, 3.541859600158166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IdentityTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"n", "\[GreaterEqual]", "1"}]}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"IdentityTL", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "over", ",", "paths", ",", "rpath", ",", "ae", ",", "be", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "values"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing IdentityTL[G,\>\"", ",", "n", ",", "\"\<, ...]\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "0", "]"}], "=", "over1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "1", "]"}], "=", "over2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paths", "=", 
       RowBox[{"GraphPaths", "[", 
        RowBox[{"G", ",", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"over1", ",", "over2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "/", "2"}], "+", "1"}], "}"}]}], "]"}], ",", 
             "1"}], "]"}], ",", 
           RowBox[{"n", "+", "1"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rpath", "=", 
              RowBox[{"Reverse", "[", "path", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PathToLoop", "[", 
               RowBox[{"ConcatenatePaths", "[", 
                RowBox[{"path", ",", "rpath"}], "]"}], "]"}], "\[Rule]", 
              "1"}]}]}], "\[IndentingNewLine]", "]"}], "/@", "paths"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"G", ",", 
        RowBox[{"Most", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"over1", ",", "over2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
        "values"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549347531085*^9, 3.542549398567725*^9}, {
   3.542549492266087*^9, 3.5425495062339487`*^9}, {3.542549543800351*^9, 
   3.5425495590890493`*^9}, {3.542549732095945*^9, 3.542549789658887*^9}, {
   3.542549848409892*^9, 3.542549848471713*^9}, {3.5425498921747713`*^9, 
   3.542549979376711*^9}, {3.542550086566765*^9, 3.542550106946743*^9}, {
   3.542550275818598*^9, 3.542550365254471*^9}, {3.5425504623320427`*^9, 
   3.5425504978659477`*^9}, {3.542550555696291*^9, 3.5425505574158363`*^9}, {
   3.5425506408520184`*^9, 3.542550746508684*^9}, {3.542550888180461*^9, 
   3.5425509014950447`*^9}, {3.542551056996614*^9, 3.542551302602466*^9}, {
   3.542551466136601*^9, 3.542551602768509*^9}, 3.54255168838967*^9, {
   3.5425517486600037`*^9, 3.542551767258574*^9}, {3.542551856051229*^9, 
   3.542551915945138*^9}, {3.542551952767187*^9, 3.542551977833879*^9}, {
   3.542552063597136*^9, 3.542552071701633*^9}, {3.542552254702835*^9, 
   3.5425522609355297`*^9}, {3.542552325221184*^9, 3.542552325535075*^9}, {
   3.542552580780795*^9, 3.542552586140863*^9}, {3.542553736857193*^9, 
   3.54255378681605*^9}, {3.542996390840514*^9, 3.5429963949292793`*^9}, {
   3.5429964306611633`*^9, 3.542996568303993*^9}, {3.542996795415884*^9, 
   3.5429967955821667`*^9}, {3.542996847838813*^9, 3.5429968532936993`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "a", " ", "counts", " ", "the", " ", "number", " ", "of", " ", "strands", 
    " ", "until", " ", "the", " ", "cup", " ", "from", " ", "the", " ", "top",
     " ", "left"}], ",", " ", 
   RowBox[{
   "b", " ", "counts", " ", "from", " ", "the", " ", "bottom", " ", 
    "right"}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549646821637*^9, 3.542549663669264*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "OneCupTL", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542552376036706*^9, 3.5425523780411377`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"OneCupTL", "[", 
    RowBox[{
     RowBox[{"G", ":", 
      RowBox[{"{", 
       RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
     "n_Integer", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], ",", 
     RowBox[{"over1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"over2", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"pivotalStructure", ":", 
      RowBox[{"(", 
       RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OneCupTL", "[", 
      RowBox[{"G", ",", "n", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
       "pivotalStructure"}], "]"}], "="}], "*)"}], 
   RowBox[{"TurnDownTopRightCorner", "[", 
    RowBox[{
     RowBox[{"AddStrandOnRight", "[", 
      RowBox[{
       RowBox[{"TurnUpBottomRightCorner", "[", 
        RowBox[{
         RowBox[{"AddStrandOnRight", "[", 
          RowBox[{
           RowBox[{"TurnDownTopRightCorner", "[", 
            RowBox[{
             RowBox[{"IdentityTL", "[", 
              RowBox[{"G", ",", 
               RowBox[{"n", "-", "2"}], ",", "over1", ",", "over2", ",", 
               "pivotalStructure"}], "]"}], ",", 
             RowBox[{"n", "-", "a", "-", "2"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"over1", ",", "over2"}], "}"}], "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"a", "+", "1"}], ",", "2"}], "]"}], "+", "1"}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"n", "-", "a", "-", "1", "+", "b"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"over1", ",", "over2"}], "}"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"n", "-", "b", "-", "1"}], ",", "2"}], "]"}], "+", "1"}], 
        "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"b", "+", "1"}]}], "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418583166325607`*^9, 3.541858319982934*^9}, {
  3.541858362169094*^9, 3.5418584045668993`*^9}, {3.541858732779777*^9, 
  3.54185879894238*^9}, {3.5418588585405397`*^9, 3.541858970489895*^9}, {
  3.541859000968294*^9, 3.541859009245247*^9}, {3.54185905202522*^9, 
  3.541859052905414*^9}, {3.541859182728691*^9, 3.541859183056011*^9}, {
  3.541859278100749*^9, 3.541859279638279*^9}, {3.541861862844687*^9, 
  3.541861876797091*^9}, {3.542549329978086*^9, 3.542549334768881*^9}, {
  3.542551173769002*^9, 3.5425511749842243`*^9}, {3.542551306601775*^9, 
  3.5425513094278812`*^9}, {3.542552372132662*^9, 3.542552373521541*^9}, {
  3.542552576534317*^9, 3.542552578812096*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupPaths", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupPaths", "[", 
    RowBox[{"G", ",", "n", ",", "over1", ",", "over2"}], "]"}], "=", 
   RowBox[{"GraphPaths", "[", 
    RowBox[{"G", ",", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"over1", ",", "over2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", "/", "2"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5430043074203653`*^9, 3.543004333779272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupTL", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", "|", "\"\<Lopsided\>\""}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupTL", "[", 
    RowBox[{"G", ",", "n", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
     "pivotalStructure"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "over", ",", "paths", ",", "rpath", ",", "ae", ",", "be", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "values"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<Computing OneCupTL[G,\>\"", ",", "n", ",", "\"\<,\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", "\"\<...\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "0", "]"}], "=", "over1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"over", "[", "1", "]"}], "=", "over2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paths", "=", 
       RowBox[{"OneCupPaths", "[", 
        RowBox[{"G", ",", "n", ",", "over1", ",", "over2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rpath", "=", 
              RowBox[{"Reverse", "[", "path", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ae", "=", 
              RowBox[{"EdgesAdjacentTo", "[", 
               RowBox[{"G", ",", 
                RowBox[{"path", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"over", "[", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"a", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"be", "=", 
              RowBox[{"EdgesAdjacentTo", "[", 
               RowBox[{"G", ",", 
                RowBox[{"rpath", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"over", "[", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "b", "+", "1"}], ",", "2"}], "]"}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p1", ",", "p2"}], "}"}], "=", 
              RowBox[{"SplitPathAt", "[", 
               RowBox[{"path", ",", "a"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p3", ",", "p4"}], "}"}], "=", 
              RowBox[{"SplitPathAt", "[", 
               RowBox[{"rpath", ",", "b"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Outer", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"PathToLoop", "[", 
                    RowBox[{"ConcatenatePaths", "[", 
                    RowBox[{"p1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "p2", ",", "p3", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "p4"}], "]"}], 
                    "]"}], "\[Rule]", 
                   RowBox[{
                    RowBox[{"CriticalPointCoefficient", "[", 
                    RowBox[{"G", ",", "1", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "a"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", "pivotalStructure"}], "]"}], 
                    RowBox[{"CriticalPointCoefficient", "[", 
                    RowBox[{"G", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"rpath", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", "b"}], "+", "1"}], "\[RightDoubleBracket]"}],
                     ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "pivotalStructure"}], 
                    "]"}]}]}], "&"}], ",", "\[IndentingNewLine]", "ae", ",", 
                 "be", ",", "1"}], "]"}], ",", "1"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], "/@", "paths"}], ",", "1"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"GPA4Element", "[", 
       RowBox[{"G", ",", 
        RowBox[{"Most", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"over1", ",", "over2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}], ",", "pivotalStructure", ",", 
        "values"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542549347531085*^9, 3.542549398567725*^9}, {
   3.542549492266087*^9, 3.5425495062339487`*^9}, {3.542549543800351*^9, 
   3.5425495590890493`*^9}, {3.542549732095945*^9, 3.542549789658887*^9}, {
   3.542549848409892*^9, 3.542549848471713*^9}, {3.5425498921747713`*^9, 
   3.542549979376711*^9}, {3.542550086566765*^9, 3.542550106946743*^9}, {
   3.542550275818598*^9, 3.542550365254471*^9}, {3.5425504623320427`*^9, 
   3.5425504978659477`*^9}, {3.542550555696291*^9, 3.5425505574158363`*^9}, {
   3.5425506408520184`*^9, 3.542550746508684*^9}, {3.542550888180461*^9, 
   3.5425509014950447`*^9}, {3.542551056996614*^9, 3.542551302602466*^9}, {
   3.542551466136601*^9, 3.542551602768509*^9}, 3.54255168838967*^9, {
   3.5425517486600037`*^9, 3.542551767258574*^9}, {3.542551856051229*^9, 
   3.542551915945138*^9}, {3.542551952767187*^9, 3.542551977833879*^9}, {
   3.542552063597136*^9, 3.542552071701633*^9}, {3.542552254702835*^9, 
   3.5425522609355297`*^9}, {3.542552325221184*^9, 3.542552325535075*^9}, {
   3.542552580780795*^9, 3.542552586140863*^9}, {3.542553736857193*^9, 
   3.54255378681605*^9}, 3.543004345810095*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneCupJonesWenzl", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    "n_Integer", ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"OneCupJonesWenzl", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IdentityTL", "[", 
     RowBox[{
     "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
     "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Delta]", "=", 
            RowBox[{"DimensionOfGenerator", "[", "G", "]"}]}], ",", 
           RowBox[{"aa", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"a", ",", 
              RowBox[{"n", "-", "b", "-", "2"}]}], "]"}]}], ",", 
           RowBox[{"bb", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"b", ",", 
              RowBox[{"n", "-", "a", "-", "2"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cc", "=", 
             RowBox[{"n", "-", "aa", "-", "bb", "-", "2"}]}], "}"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{"cc", "+", "1"}]], 
            RowBox[{
             RowBox[{"qInteger\[Delta]", "[", 
              RowBox[{"aa", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
            RowBox[{
             RowBox[{"qInteger\[Delta]", "[", 
              RowBox[{"bb", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
            SuperscriptBox[
             RowBox[{
              RowBox[{"qInteger\[Delta]", "[", "n", "]"}], "[", "\[Delta]", 
              "]"}], 
             RowBox[{"-", "1"}]]}]}], "]"}]}], "]"}], 
       RowBox[{"OneCupTL", "[", 
        RowBox[{"G", ",", "n", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",", 
         "pivotalStructure"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "0", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418619882353897`*^9, 3.5418620706816998`*^9}, {
  3.541862225138234*^9, 3.541862229481957*^9}, {3.541862464817371*^9, 
  3.541862599399908*^9}, {3.5418629506343317`*^9, 3.541862950770574*^9}, {
  3.5418635520063*^9, 3.541863563732616*^9}, {3.542552602680297*^9, 
  3.54255263204488*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SomeOneCupJonesWenzl", "[", 
   RowBox[{
    RowBox[{"G", ":", 
     RowBox[{"{", 
      RowBox[{"_BigraphWithDuals", ",", "_BigraphWithDuals"}], "}"}]}], ",", 
    RowBox[{"n_Integer", "/;", 
     RowBox[{"EvenQ", "[", "n", "]"}]}], ",", 
    RowBox[{"over1", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"over2", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ")"}]}], ",", 
    RowBox[{"pivotalStructure", ":", "\"\<Spherical\>\""}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SomeOneCupJonesWenzl", "[", 
    RowBox[{
    "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}], 
    "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DebugPrint", "[", 
       RowBox[{
       "\"\<beginning SomeOneCupJonesWenzl[\>\"", ",", "G", ",", "\"\<,\>\"", 
        ",", "n", ",", "\"\<...]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{"IdentityTL", "[", 
         RowBox[{
         "G", ",", "n", ",", "over1", ",", "over2", ",", "pivotalStructure"}],
          "]"}], "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Delta]", "=", 
                RowBox[{"DimensionOfGenerator", "[", "G", "]"}]}], ",", 
               RowBox[{"aa", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"n", "-", "b", "-", "2"}]}], "]"}]}], ",", 
               RowBox[{"bb", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"n", "-", "a", "-", "2"}]}], "]"}]}]}], "}"}], ",", 
             
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cc", "=", 
                 RowBox[{"n", "-", "aa", "-", "bb", "-", "2"}]}], "}"}], ",", 
               
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], ",", 
                  RowBox[{"cc", "+", "1"}]}], "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", 
                  RowBox[{"aa", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                RowBox[{
                 RowBox[{"qInteger\[Delta]", "[", 
                  RowBox[{"bb", "+", "1"}], "]"}], "[", "\[Delta]", "]"}], 
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"qInteger\[Delta]", "[", "n", "]"}], "[", 
                   "\[Delta]", "]"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], 
           RowBox[{"OneCupTL", "[", 
            RowBox[{"G", ",", "n", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}], ",", "over1", ",", "over2", ",",
              "pivotalStructure"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"n", "/", "2"}], "-", "1"}], ",", 
              RowBox[{"n", "-", "2"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "0", ",", 
            RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "DebugPrint", "[", "\"\<...finished SomeOneCupJonesWenzl\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5418619882353897`*^9, 3.5418620706816998`*^9}, {
  3.541862225138234*^9, 3.541862229481957*^9}, {3.541862464817371*^9, 
  3.541862599399908*^9}, {3.5418629506343317`*^9, 3.541862950770574*^9}, {
  3.5418635520063*^9, 3.541863563732616*^9}, {3.542552602680297*^9, 
  3.542552677740378*^9}, {3.542553624325164*^9, 3.5425537082733192`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddStrandOnLeft", "[", 
   RowBox[{"A_GPA4Element", ",", "newOver_"}], "]"}], ":=", 
  RowBox[{"TurnUpBottomRightCorner", "[", 
   RowBox[{
    RowBox[{"TurnDownTopLeftCorner", "[", 
     RowBox[{"AddStrandOnRight", "[", 
      RowBox[{
       RowBox[{"TurnDownTopRightCorner", "[", 
        RowBox[{"A", ",", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
       "newOver"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5430257568029423`*^9, 3.5430257801197367`*^9}, {
   3.543025889345511*^9, 3.543025943646214*^9}, 3.543026145401775*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AnnularConsequences", "[", 
   RowBox[{"A_GPA4Element", ",", "\[Sigma]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AnnularConsequences", "[", 
    RowBox[{"A", ",", "\[Sigma]"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{
        "A", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GPAFourierTransformTwice", "[", "#", "]"}], "&"}], ",", 
            
            RowBox[{"AddStrandOnLeft", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Sigma]", 
                RowBox[{"-", "1"}]], 
               RowBox[{"GPAFourierTransform", "[", "A", "]"}]}], ",", 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            ",", 
            RowBox[{"n", "/", "2"}]}], "]"}], ",", 
          RowBox[{"GPAFourierTransform", "/@", 
           RowBox[{"NestList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GPAFourierTransformTwice", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"AddStrandOnLeft", "[", 
              RowBox[{"A", ",", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
             ",", 
             RowBox[{"n", "/", "2"}]}], "]"}]}]}], "}"}], "]"}], ",", "1"}], 
      "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543025423208015*^9, 3.5430254256193657`*^9}, {
  3.5430254963718853`*^9, 3.5430254997944183`*^9}, {3.5430255869590263`*^9, 
  3.543025753413122*^9}, {3.543026016131926*^9, 3.543026085471298*^9}, {
  3.543026144244259*^9, 3.543026157010627*^9}, {3.543027391520307*^9, 
  3.543027392894012*^9}, {3.5430274262654743`*^9, 3.543027428292946*^9}, {
  3.543027731200832*^9, 3.5430277334161053`*^9}, {3.54308811263421*^9, 
  3.54308811303325*^9}, {3.543168904355732*^9, 3.543168937566701*^9}, {
  3.543168986537202*^9, 3.543168988571419*^9}, {3.5431709579689207`*^9, 
  3.5431709678243437`*^9}, {3.544298576914394*^9, 3.5442985815677843`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPACirc", "[", 
   RowBox[{"A_GPA4Element", ",", "B_GPA4Element"}], "]"}], ":=", 
  RowBox[{"GPAMultiply", "[", 
   RowBox[{
    RowBox[{"TurnDownTopRightCorner", "[", "A", "]"}], ",", 
    RowBox[{"TurnUpBottomRightCorner", "[", "B", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.543026104352758*^9, 3.543026140254827*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GPAStar", "[", 
   RowBox[{"S_GPA4Element", ",", "T_GPA4Element"}], "]"}], ":=", 
  RowBox[{"GPAFourierTransform", "[", 
   RowBox[{"GPACirc", "[", 
    RowBox[{
     RowBox[{"GPAFourierTransform", "[", "S", "]"}], ",", 
     RowBox[{"GPAFourierTransform", "[", "T", "]"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556487184723236*^9, 3.556487211391399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
Evaluator->"Local (3)",
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1005, 18, 46, "Input",
 InitializationCell->True],
Cell[1553, 40, 2429, 36, 199, "Input",
 InitializationCell->True],
Cell[3985, 78, 466, 11, 46, "Input",
 InitializationCell->True],
Cell[4454, 91, 119, 3, 28, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4598, 98, 128, 2, 44, "Subsection",
 InitializationCell->True],
Cell[4729, 102, 761, 20, 35, "Input",
 InitializationCell->True],
Cell[5493, 124, 822, 19, 46, "Input",
 InitializationCell->True],
Cell[6318, 145, 2327, 56, 216, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8682, 206, 134, 2, 44, "Subsection",
 InitializationCell->True],
Cell[8819, 210, 2935, 67, 212, "Input",
 InitializationCell->True],
Cell[11757, 279, 100, 2, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11894, 286, 184, 3, 44, "Subsection",
 InitializationCell->True],
Cell[12081, 291, 168, 3, 28, "Input",
 InitializationCell->True],
Cell[12252, 296, 1565, 35, 63, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[13854, 336, 144, 2, 44, "Subsection",
 InitializationCell->True],
Cell[14001, 340, 1572, 38, 143, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15610, 383, 135, 2, 44, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15770, 389, 140, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[15913, 393, 649, 11, 49, "Text",
 InitializationCell->True],
Cell[16565, 406, 1320, 36, 47, "Input",
 InitializationCell->True],
Cell[17888, 444, 564, 15, 46, "Input",
 InitializationCell->True],
Cell[18455, 461, 4994, 114, 167, "Input",
 InitializationCell->True],
Cell[23452, 577, 3372, 88, 149, "Input",
 InitializationCell->True],
Cell[26827, 667, 164, 3, 28, "Input",
 InitializationCell->True],
Cell[26994, 672, 417, 8, 28, "Input",
 InitializationCell->True],
Cell[27414, 682, 5890, 132, 184, "Input",
 InitializationCell->True],
Cell[33307, 816, 3533, 91, 183, "Input",
 InitializationCell->True],
Cell[36843, 909, 537, 14, 28, "Input",
 InitializationCell->True],
Cell[37383, 925, 1565, 43, 63, "Input",
 InitializationCell->True],
Cell[38951, 970, 578, 17, 31, "Input",
 InitializationCell->True],
Cell[39532, 989, 2791, 69, 133, "Input",
 InitializationCell->True],
Cell[42326, 1060, 2943, 71, 133, "Input",
 InitializationCell->True],
Cell[45272, 1133, 2956, 72, 116, "Input",
 InitializationCell->True],
Cell[48231, 1207, 2830, 70, 99, "Input",
 InitializationCell->True],
Cell[51064, 1279, 1725, 44, 83, "Input",
 InitializationCell->True],
Cell[52792, 1325, 1335, 35, 64, "Input",
 InitializationCell->True],
Cell[54130, 1362, 491, 11, 46, "Input",
 InitializationCell->True],
Cell[54624, 1375, 2921, 78, 134, "Input",
 InitializationCell->True],
Cell[57548, 1455, 301, 6, 28, "Input",
 InitializationCell->True],
Cell[57852, 1463, 5701, 136, 218, "Input",
 InitializationCell->True],
Cell[63556, 1601, 5412, 132, 150, "Input",
 InitializationCell->True],
Cell[68971, 1735, 243, 6, 28, "Input",
 InitializationCell->True],
Cell[69217, 1743, 430, 11, 28, "Input",
 InitializationCell->True],
Cell[69650, 1756, 163, 3, 28, "Input",
 InitializationCell->True],
Cell[69816, 1761, 12013, 288, 424, "Input",
 InitializationCell->True],
Cell[81832, 2051, 347, 9, 28, "Input",
 InitializationCell->True],
Cell[82182, 2062, 3542, 87, 132, "Input",
 InitializationCell->True],
Cell[85727, 2151, 2042, 49, 47, "Input",
 InitializationCell->True],
Cell[87772, 2202, 312, 7, 28, "Input",
 InitializationCell->True],
Cell[88087, 2211, 161, 3, 28, "Input",
 InitializationCell->True],
Cell[88251, 2216, 1548, 38, 137, "Input",
 InitializationCell->True],
Cell[89802, 2256, 217, 5, 28, "Input",
 InitializationCell->True],
Cell[90022, 2263, 1575, 41, 47, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[91634, 2309, 127, 2, 35, "Subsubsection",
 InitializationCell->True],
Cell[91764, 2313, 1609, 43, 49, "Input",
 InitializationCell->True],
Cell[93376, 2358, 3633, 94, 152, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[97046, 2457, 188, 3, 35, "Subsubsection",
 InitializationCell->True],
Cell[97237, 2462, 3699, 87, 184, "Input",
 InitializationCell->True],
Cell[100939, 2551, 3317, 87, 201, "Input",
 InitializationCell->True],
Cell[104259, 2640, 1702, 43, 49, "Input",
 InitializationCell->True],
Cell[105964, 2685, 1446, 41, 80, "Input",
 InitializationCell->True],
Cell[107413, 2728, 417, 10, 28, "Input",
 InitializationCell->True],
Cell[107833, 2740, 1559, 40, 47, "Input",
 InitializationCell->True],
Cell[109395, 2782, 1782, 49, 65, "Input",
 InitializationCell->True],
Cell[111180, 2833, 5906, 138, 235, "Input",
 InitializationCell->True],
Cell[117089, 2973, 467, 12, 46, "Input",
 InitializationCell->True],
Cell[117559, 2987, 2910, 82, 101, "Input",
 InitializationCell->True],
Cell[120472, 3071, 2716, 76, 101, "Input",
 InitializationCell->True],
Cell[123191, 3149, 1638, 45, 65, "Input",
 InitializationCell->True],
Cell[124832, 3196, 385, 10, 28, "Input",
 InitializationCell->True],
Cell[125220, 3208, 4155, 97, 201, "Input",
 InitializationCell->True],
Cell[129378, 3307, 4101, 112, 152, "Input",
 InitializationCell->True],
Cell[133482, 3421, 1062, 25, 80, "Input",
 InitializationCell->True],
Cell[134547, 3448, 607, 14, 46, "Input",
 InitializationCell->True],
Cell[135157, 3464, 731, 17, 63, "Input",
 InitializationCell->True],
Cell[135891, 3483, 2802, 73, 131, "Input",
 InitializationCell->True],
Cell[138696, 3558, 1950, 50, 65, "Input",
 InitializationCell->True],
Cell[140649, 3610, 1161, 31, 47, "Input",
 InitializationCell->True],
Cell[141813, 3643, 334, 8, 28, "Input",
 InitializationCell->True],
Cell[142150, 3653, 1228, 33, 49, "Input",
 InitializationCell->True],
Cell[143381, 3688, 1236, 33, 66, "Input",
 InitializationCell->True],
Cell[144620, 3723, 2384, 66, 148, "Input",
 InitializationCell->True],
Cell[147007, 3791, 171, 3, 28, "Input",
 InitializationCell->True],
Cell[147181, 3796, 284, 6, 28, "Input",
 InitializationCell->True],
Cell[147468, 3804, 2570, 61, 167, "Input",
 InitializationCell->True],
Cell[150041, 3867, 2659, 62, 167, "Input",
 InitializationCell->True],
Cell[152703, 3931, 2798, 68, 167, "Input",
 InitializationCell->True],
Cell[155504, 4001, 2735, 66, 167, "Input",
 InitializationCell->True],
Cell[158242, 4069, 1222, 28, 82, "Input",
 InitializationCell->True],
Cell[159467, 4099, 164, 3, 28, "Input",
 InitializationCell->True],
Cell[159634, 4104, 1521, 53, 97, "Input",
 InitializationCell->True],
Cell[161158, 4159, 1095, 30, 49, "Input",
 InitializationCell->True],
Cell[162256, 4191, 1086, 27, 46, "Input",
 InitializationCell->True],
Cell[163345, 4220, 1314, 33, 80, "Input",
 InitializationCell->True],
Cell[164662, 4255, 2921, 69, 116, "Input",
 InitializationCell->True],
Cell[167586, 4326, 3366, 78, 169, "Input",
 InitializationCell->True],
Cell[170955, 4406, 169, 3, 28, "Input",
 InitializationCell->True],
Cell[171127, 4411, 2331, 65, 98, "Input",
 InitializationCell->True],
Cell[173461, 4478, 1550, 43, 98, "Input",
 InitializationCell->True],
Cell[175014, 4523, 5603, 133, 252, "Input",
 InitializationCell->True],
Cell[180620, 4658, 1438, 37, 66, "Input",
 InitializationCell->True],
Cell[182061, 4697, 2588, 66, 98, "Input",
 InitializationCell->True],
Cell[184652, 4765, 362, 8, 28, "Input",
 InitializationCell->True],
Cell[185017, 4775, 2420, 59, 98, "Input",
 InitializationCell->True],
Cell[187440, 4836, 1183, 23, 46, "Input",
 InitializationCell->True],
Cell[188626, 4861, 175, 3, 28, "Input",
 InitializationCell->True],
Cell[188804, 4866, 9188, 216, 369, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198041, 5088, 132, 2, 44, "Subsection",
 InitializationCell->True],
Cell[198176, 5092, 6619, 150, 471, "Input",
 InitializationCell->True],
Cell[204798, 5244, 819, 19, 28, "Input",
 InitializationCell->True],
Cell[205620, 5265, 840, 23, 28, "Input",
 InitializationCell->True],
Cell[206463, 5290, 4081, 96, 167, "Input",
 InitializationCell->True],
Cell[210547, 5388, 1241, 33, 64, "Input",
 InitializationCell->True],
Cell[211791, 5423, 1151, 32, 64, "Input",
 InitializationCell->True],
Cell[212945, 5457, 2712, 60, 99, "Input",
 InitializationCell->True],
Cell[215660, 5519, 1176, 32, 64, "Input",
 InitializationCell->True],
Cell[216839, 5553, 1071, 30, 64, "Input",
 InitializationCell->True],
Cell[217913, 5585, 3805, 87, 216, "Input",
 InitializationCell->True],
Cell[221721, 5674, 641, 15, 46, "Input",
 InitializationCell->True],
Cell[222365, 5691, 1550, 41, 46, "Input",
 InitializationCell->True],
Cell[223918, 5734, 1596, 41, 46, "Input",
 InitializationCell->True],
Cell[225517, 5777, 172, 3, 28, "Input",
 InitializationCell->True],
Cell[225692, 5782, 9113, 202, 438, "Input",
 InitializationCell->True],
Cell[234808, 5986, 169, 3, 28, "Input",
 InitializationCell->True],
Cell[234980, 5991, 8484, 186, 438, "Input",
 InitializationCell->True],
Cell[243467, 6179, 1600, 37, 131, "Input",
 InitializationCell->True],
Cell[245070, 6218, 174, 3, 28, "Input",
 InitializationCell->True],
Cell[245247, 6223, 6033, 134, 287, "Input",
 InitializationCell->True],
Cell[251283, 6359, 196, 4, 28, "Input",
 InitializationCell->True],
Cell[251482, 6365, 1216, 31, 46, "Input",
 InitializationCell->True],
Cell[252701, 6398, 664, 17, 28, "Input",
 InitializationCell->True],
Cell[253368, 6417, 448, 9, 28, "Input",
 InitializationCell->True],
Cell[253819, 6428, 1751, 47, 112, "Input",
 InitializationCell->True],
Cell[255573, 6477, 1448, 38, 80, "Input",
 InitializationCell->True],
Cell[257024, 6517, 1768, 43, 148, "Input",
 InitializationCell->True],
Cell[258795, 6562, 8023, 188, 472, "Input",
 InitializationCell->True],
Cell[266821, 6752, 453, 11, 46, "Input",
 InitializationCell->True],
Cell[267277, 6765, 2719, 65, 217, "Input",
 InitializationCell->True],
Cell[269999, 6832, 4625, 111, 302, "Input",
 InitializationCell->True],
Cell[274627, 6945, 3162, 79, 182, "Input",
 InitializationCell->True],
Cell[277792, 7026, 1334, 35, 80, "Input",
 InitializationCell->True],
Cell[279129, 7063, 3330, 67, 115, "Input",
 InitializationCell->True],
Cell[282462, 7132, 170, 3, 28, "Input",
 InitializationCell->True],
Cell[282635, 7137, 4656, 110, 101, "Input",
 InitializationCell->True],
Cell[287294, 7249, 9273, 200, 286, "Input",
 InitializationCell->True],
Cell[296570, 7451, 6552, 137, 382, "Input",
 InitializationCell->True],
Cell[303125, 7590, 1634, 37, 131, "Input",
 InitializationCell->True],
Cell[304762, 7629, 2503, 61, 131, "Input",
 InitializationCell->True],
Cell[307268, 7692, 1935, 52, 165, "Input",
 InitializationCell->True],
Cell[309206, 7746, 2697, 63, 199, "Input",
 InitializationCell->True],
Cell[311906, 7811, 163, 3, 28, "Input",
 InitializationCell->True],
Cell[312072, 7816, 4208, 98, 199, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[316317, 7919, 127, 2, 44, "Subsection",
 InitializationCell->True],
Cell[316447, 7923, 160, 3, 28, "Input",
 InitializationCell->True],
Cell[316610, 7928, 1307, 38, 65, "Input",
 InitializationCell->True],
Cell[317920, 7968, 5129, 125, 218, "Input",
 InitializationCell->True],
Cell[323052, 8095, 459, 11, 28, "Input",
 InitializationCell->True],
Cell[323514, 8108, 160, 3, 28, "Input",
 InitializationCell->True],
Cell[323677, 8113, 3450, 87, 99, "Input",
 InitializationCell->True],
Cell[327130, 8202, 1553, 47, 47, "Input",
 InitializationCell->True],
Cell[328686, 8251, 9328, 217, 320, "Input",
 InitializationCell->True],
Cell[338017, 8470, 3483, 95, 129, "Input",
 InitializationCell->True],
Cell[341503, 8567, 4625, 118, 183, "Input",
 InitializationCell->True],
Cell[346131, 8687, 829, 20, 28, "Input",
 InitializationCell->True],
Cell[346963, 8709, 2436, 56, 78, "Input",
 InitializationCell->True],
Cell[349402, 8767, 390, 9, 28, "Input",
 InitializationCell->True],
Cell[349795, 8778, 433, 11, 28, "Input",
 InitializationCell->True],
Cell[350231, 8791, 96, 3, 28, "Input",
 InitializationCell->True],
Cell[350330, 8796, 103, 3, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
